(this["webpackJsonp"] = this["webpackJsonp"] || []).push([[1],{

/***/ "./node_modules/@cmao/codemao-tone/build/Tone.js":
/*!*******************************************************!*\
  !*** ./node_modules/@cmao/codemao-tone/build/Tone.js ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

!function(t,e){ true?module.exports=e():undefined}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=148)}([function(t,e,i){"use strict";i.r(e),function(t){var s=i(93),n=function(){if(!(this instanceof n))throw new Error("constructor needs to be called with the 'new' keyword")};
/**
 *  Tone.js
 *  @author Yotam Mann
 *  @license http://opensource.org/licenses/MIT MIT License
 *  @copyright 2014-2019 Yotam Mann
 */n.prototype.toString=function(){for(var t in n){var e=t[0].match(/^[A-Z]$/),i=n[t]===this.constructor;if(n.isFunction(n[t])&&e&&i)return t}return"Tone"},n.prototype.dispose=function(){return this},n.prototype.set=function(t,e){if(n.isString(t)){var i={};i[t]=e,t=i}t:for(var s in t){e=t[s];var o=this;if(-1!==s.indexOf(".")){for(var a=s.split("."),r=0;r<a.length-1;r++)if((o=o[a[r]])instanceof n){a.splice(0,r+1);var l=a.join(".");o.set(l,e);continue t}s=a[a.length-1]}var u=o[s];n.isUndef(u)||(n.Signal&&u instanceof n.Signal||n.Param&&u instanceof n.Param?u.value!==e&&(u.value=e):u instanceof AudioParam?u.value!==e&&(u.value=e):n.TimeBase&&u instanceof n.TimeBase?o[s]=e:u instanceof n?u.set(e):u!==e&&(o[s]=e))}return this},n.prototype.get=function(t){n.isUndef(t)?t=this._collectDefaults(this.constructor):n.isString(t)&&(t=[t]);for(var e={},i=0;i<t.length;i++){var s=t[i],o=this,a=e;if(-1!==s.indexOf(".")){for(var r=s.split("."),l=0;l<r.length-1;l++){var u=r[l];a[u]=a[u]||{},a=a[u],o=o[u]}s=r[r.length-1]}var f=o[s];n.isObject(t[s])?a[s]=f.get():n.Signal&&f instanceof n.Signal?a[s]=f.value:n.Param&&f instanceof n.Param?a[s]=f.value:f instanceof AudioParam?a[s]=f.value:f instanceof n?a[s]=f.get():!n.isFunction(f)&&n.isDefined(f)&&(a[s]=f)}return e},n.prototype._collectDefaults=function(t){var e=[];if(n.isDefined(t.defaults)&&(e=Object.keys(t.defaults)),n.isDefined(t._super))for(var i=this._collectDefaults(t._super),s=0;s<i.length;s++)-1===e.indexOf(i[s])&&e.push(i[s]);return e},n.defaults=function(t,e,i){var s={};if(1===t.length&&n.isObject(t[0]))s=t[0];else for(var o=0;o<e.length;o++)s[e[o]]=t[o];return n.isDefined(i.defaults)?n.defaultArg(s,i.defaults):n.isObject(i)?n.defaultArg(s,i):s},n.defaultArg=function(t,e){if(n.isObject(t)&&n.isObject(e)){var i={};for(var s in t)i[s]=n.defaultArg(e[s],t[s]);for(var o in e)i[o]=n.defaultArg(t[o],e[o]);return i}return n.isUndef(t)?e:t},n.prototype.log=function(){if(this.debug||this.toString()===n.global.TONE_DEBUG_CLASS){var t=Array.from(arguments);t.unshift(this.toString()+":"),console.log.apply(void 0,t)}},n.prototype.assert=function(t,e){if(!t)throw new Error(e)},n.connectSeries=function(){for(var t=arguments[0],e=1;e<arguments.length;e++){var i=arguments[e];n.connect(t,i),t=i}return n},n.connect=function(t,e,i,s){for(;n.isDefined(e.input);)n.isArray(e.input)?(s=n.defaultArg(s,0),e=e.input[s],s=0):e.input&&(e=e.input);return e instanceof AudioParam?t.connect(e,i):e instanceof AudioNode&&t.connect(e,i,s),n},n.disconnect=function(t,e,i,s){if(e){for(var o=!1;!o;)n.isArray(e.input)?(n.isDefined(s)?n.disconnect(t,e.input[s],i):e.input.forEach(function(e){try{n.disconnect(t,e,i)}catch(t){}}),o=!0):e.input?e=e.input:o=!0;e instanceof AudioParam?t.disconnect(e,i):e instanceof AudioNode&&t.disconnect(e,i,s)}else t.disconnect();return n},n.isUndef=function(t){return void 0===t},n.isDefined=function(t){return!n.isUndef(t)},n.isFunction=function(t){return"function"==typeof t},n.isNumber=function(t){return"number"==typeof t},n.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object},n.isBoolean=function(t){return"boolean"==typeof t},n.isArray=function(t){return Array.isArray(t)},n.isString=function(t){return"string"==typeof t},n.isNote=function(t){return n.isString(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)},n.noOp=function(){},n.prototype._readOnly=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._readOnly(t[e]);else Object.defineProperty(this,t,{writable:!1,enumerable:!0})},n.prototype._writable=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._writable(t[e]);else Object.defineProperty(this,t,{writable:!0})},n.State={Started:"started",Stopped:"stopped",Paused:"paused"},n.global=n.isUndef(t)?window:t,n.equalPowerScale=function(t){var e=.5*Math.PI;return Math.sin(t*e)},n.dbToGain=function(t){return Math.pow(10,t/20)},n.gainToDb=function(t){return Math.log(t)/Math.LN10*20},n.intervalToFrequencyRatio=function(t){return Math.pow(2,t/12)},n.prototype.now=function(){return n.context.now()},n.now=function(){return n.context.now()},n.prototype.immediate=function(){return n.context.currentTime},n.immediate=function(){return n.context.currentTime},n.extend=function(t,e){function i(){}n.isUndef(e)&&(e=n),i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,t._super=e},n._audioContext=null,n.start=function(){return n.context.resume()},Object.defineProperty(n,"context",{get:function(){return n._audioContext},set:function(t){t.isContext?n._audioContext=t:n._audioContext=new n.Context(t),n.Context.emit("init",n._audioContext)}}),Object.defineProperty(n.prototype,"context",{get:function(){return n.context}}),n.setContext=function(t){n.context=t},Object.defineProperty(n.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate}}),Object.defineProperty(n.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate}}),Object.defineProperty(n,"supported",{get:function(){var t=n.global.hasOwnProperty("AudioContext")||n.global.hasOwnProperty("webkitAudioContext"),e=n.global.hasOwnProperty("Promise");return t&&e}}),Object.defineProperty(n,"initialized",{get:function(){return Boolean(n.context)}}),n.getContext=function(t){if(n.initialized)t(n.context);else{var e=function(){t(n.context),n.Context.off("init",e)};n.Context.on("init",e)}return n},n.version=s.a,e.default=n}.call(this,i(147))},function(t,e,i){"use strict";i.r(e);var s=i(0);i(20);if(s.default.supported){var n=new OfflineAudioContext(2,1,44100),o=n.createGain(),a=n.createGain();if(o.connect(a)!==a){var r=AudioNode.prototype.connect;AudioNode.prototype.connect=function(){return r.apply(this,arguments),arguments[0]}}}s.default.AudioNode=function(){s.default.call(this);var t=s.default.defaults(arguments,["context"],{context:s.default.context});this._context=t.context},s.default.extend(s.default.AudioNode),Object.defineProperty(s.default.AudioNode.prototype,"context",{get:function(){return this._context}}),s.default.AudioNode.prototype.createInsOuts=function(t,e){1===t?this.input=this.context.createGain():t>1&&(this.input=new Array(t)),1===e?this.output=this.context.createGain():e>1&&(this.output=new Array(e))},Object.defineProperty(s.default.AudioNode.prototype,"channelCount",{get:function(){return this.output.channelCount},set:function(t){return this.output.channelCount=t}}),Object.defineProperty(s.default.AudioNode.prototype,"channelCountMode",{get:function(){return this.output.channelCountMode},set:function(t){return this.output.channelCountMode=t}}),Object.defineProperty(s.default.AudioNode.prototype,"channelInterpretation",{get:function(){return this.output.channelInterpretation},set:function(t){return this.output.channelInterpretation=t}}),Object.defineProperty(s.default.AudioNode.prototype,"numberOfInputs",{get:function(){return this.input?s.default.isArray(this.input)?this.input.length:1:0}}),Object.defineProperty(s.default.AudioNode.prototype,"numberOfOutputs",{get:function(){return this.output?s.default.isArray(this.output)?this.output.length:1:0}}),s.default.AudioNode.prototype.connect=function(t,e,i){return s.default.isArray(this.output)?(e=s.default.defaultArg(e,0),this.output[e].connect(t,0,i)):s.default.connect(this.output,t,e,i),this},s.default.AudioNode.prototype.disconnect=function(t,e,i){return s.default.isArray(this.output)?(e=s.default.defaultArg(e,0),this.output[e].disconnect(t,0,i)):s.default.disconnect(this.output,t,e,i),this},s.default.AudioNode.prototype.chain=function(){var t=Array.from(arguments);return t.unshift(this),s.default.connectSeries.apply(void 0,t),this},s.default.AudioNode.prototype.fan=function(){for(var t=0;t<arguments.length;t++)this.connect(arguments[t]);return this},s.default.AudioNode.prototype.dispose=function(){return s.default.isDefined(this.input)&&(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),s.default.isDefined(this.output)&&(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this._context=null,this};e.default=s.default.AudioNode},function(t,e,i){"use strict";i.r(e);var s=i(0);i(4),i(14),i(30),i(44),i(20),i(3);if(s.default.supported&&!s.default.global.AudioContext.prototype.createConstantSource){var n=function(t){this.context=t;for(var e=t.createBuffer(1,128,t.sampleRate),i=e.getChannelData(0),s=0;s<i.length;s++)i[s]=1;this._bufferSource=t.createBufferSource(),this._bufferSource.channelCount=1,this._bufferSource.channelCountMode="explicit",this._bufferSource.buffer=e,this._bufferSource.loop=!0;var n=this._output=t.createGain();this.offset=n.gain,this._bufferSource.connect(n)};n.prototype.start=function(t){return this._bufferSource.start(t),this},n.prototype.stop=function(t){return this._bufferSource.stop(t),this},n.prototype.connect=function(){return this._output.connect.apply(this._output,arguments),this},n.prototype.disconnect=function(){return this._output.disconnect.apply(this._output,arguments),this},AudioContext.prototype.createConstantSource=function(){return new n(this)},s.default.Context.prototype.createConstantSource=function(){return new n(this)}}s.default.Signal=function(){var t=s.default.defaults(arguments,["value","units"],s.default.Signal);s.default.Param.call(this,t),this._constantSource=this.context.createConstantSource(),this._constantSource.start(0),this._param=this._constantSource.offset,this.value=t.value,this.output=this._constantSource,this.input=this._param=this.output.offset},s.default.extend(s.default.Signal,s.default.Param),s.default.Signal.defaults={value:0,units:s.default.Type.Default,convert:!0},s.default.Signal.prototype.connect=s.default.SignalBase.prototype.connect,s.default.Signal.prototype.disconnect=s.default.SignalBase.prototype.disconnect,s.default.Signal.prototype.getValueAtTime=function(t){return this._param.getValueAtTime?this._param.getValueAtTime(t):s.default.Param.prototype.getValueAtTime.call(this,t)},s.default.Signal.prototype.dispose=function(){return s.default.Param.prototype.dispose.call(this),this._constantSource.stop(),this._constantSource.disconnect(),this._constantSource=null,this};e.default=s.default.Signal},function(t,e,i){"use strict";i.r(e);var s=i(0);i(14),i(4),i(1);s.default.Gain=function(){var t=s.default.defaults(arguments,["gain","units"],s.default.Gain);s.default.AudioNode.call(this,t),this.input=this.output=this._gainNode=this.context.createGain(),this.gain=new s.default.Param({param:this._gainNode.gain,units:t.units,value:t.gain,convert:t.convert}),this._readOnly("gain")},s.default.extend(s.default.Gain,s.default.AudioNode),s.default.Gain.defaults={gain:1,convert:!0},s.default.Gain.prototype.dispose=function(){s.default.AudioNode.prototype.dispose.call(this),this._gainNode.disconnect(),this._gainNode=null,this._writable("gain"),this.gain.dispose(),this.gain=null},e.default=s.default.Gain},function(t,e,i){"use strict";i.r(e);var s=i(0);i(63),i(46),i(45),i(20);s.default.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Gain:"gain",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"},s.default.prototype.toSeconds=function(t){return s.default.isNumber(t)?t:s.default.isUndef(t)?this.now():s.default.isString(t)||s.default.isObject(t)?new s.default.Time(t).toSeconds():t instanceof s.default.TimeBase?t.toSeconds():void 0},s.default.prototype.toFrequency=function(t){return s.default.isNumber(t)?t:s.default.isString(t)||s.default.isUndef(t)||s.default.isObject(t)?new s.default.Frequency(t).valueOf():t instanceof s.default.TimeBase?t.toFrequency():void 0},s.default.prototype.toTicks=function(t){return s.default.isNumber(t)||s.default.isString(t)||s.default.isObject(t)?new s.default.TransportTime(t).toTicks():s.default.isUndef(t)?s.default.Transport.ticks:t instanceof s.default.TimeBase?t.toTicks():void 0},e.default=s.default},function(t,e,i){"use strict";i.r(e);var s=i(0);i(14),i(3),i(30);s.default.Multiply=function(t){s.default.Signal.call(this),this.createInsOuts(2,0),this._mult=this.input[0]=this.output=new s.default.Gain,this._param=this.input[1]=this.output.gain,this.value=s.default.defaultArg(t,0)},s.default.extend(s.default.Multiply,s.default.Signal),s.default.Multiply.prototype.dispose=function(){return s.default.Signal.prototype.dispose.call(this),this._mult.dispose(),this._mult=null,this._param=null,this},e.default=s.default.Multiply},function(t,e,i){"use strict";i.r(e);var s=i(0);i(16),i(27),i(40),i(4),i(34),i(2),i(1);s.default.Source=function(t){t=s.default.defaultArg(t,s.default.Source.defaults),s.default.AudioNode.call(this),this._volume=this.output=new s.default.Volume(t.volume),this.volume=this._volume.volume,this._readOnly("volume"),this._state=new s.default.TimelineState(s.default.State.Stopped),this._state.memory=100,this._synced=!1,this._scheduled=[],this._volume.output.output.channelCount=2,this._volume.output.output.channelCountMode="explicit",this.mute=t.mute},s.default.extend(s.default.Source,s.default.AudioNode),s.default.Source.defaults={volume:0,mute:!1},Object.defineProperty(s.default.Source.prototype,"state",{get:function(){return this._synced?s.default.Transport.state===s.default.State.Started?this._state.getValueAtTime(s.default.Transport.seconds):s.default.State.Stopped:this._state.getValueAtTime(this.now())}}),Object.defineProperty(s.default.Source.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}}),s.default.Source.prototype._start=s.default.noOp,s.default.Source.prototype.restart=s.default.noOp,s.default.Source.prototype._stop=s.default.noOp,s.default.Source.prototype.start=function(t,e,i){if(s.default.isUndef(t)&&this._synced?t=s.default.Transport.seconds:(t=this.toSeconds(t),t=Math.max(t,this.context.currentTime)),this._state.getValueAtTime(t)===s.default.State.Started)this._state.cancel(t),this._state.setStateAtTime(s.default.State.Started,t),this.restart(t,e,i);else if(this._state.setStateAtTime(s.default.State.Started,t),this._synced){var n=this._state.get(t);n.offset=s.default.defaultArg(e,0),n.duration=i;var o=s.default.Transport.schedule(function(t){this._start(t,e,i)}.bind(this),t);this._scheduled.push(o),s.default.Transport.state===s.default.State.Started&&this._syncedStart(this.now(),s.default.Transport.seconds)}else this._start.apply(this,arguments);return this},s.default.Source.prototype.stop=function(t){if(s.default.isUndef(t)&&this._synced?t=s.default.Transport.seconds:(t=this.toSeconds(t),t=Math.max(t,this.context.currentTime)),this._synced){var e=s.default.Transport.schedule(this._stop.bind(this),t);this._scheduled.push(e)}else this._stop.apply(this,arguments);return this._state.cancel(t),this._state.setStateAtTime(s.default.State.Stopped,t),this},s.default.Source.prototype.sync=function(){return this._synced=!0,this._syncedStart=function(t,e){if(e>0){var i=this._state.get(e);if(i&&i.state===s.default.State.Started&&i.time!==e){var n,o=e-this.toSeconds(i.time);i.duration&&(n=this.toSeconds(i.duration)-o),this._start(t,this.toSeconds(i.offset)+o,n)}}}.bind(this),this._syncedStop=function(t){var e=s.default.Transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));this._state.getValueAtTime(e)===s.default.State.Started&&this._stop(t)}.bind(this),s.default.Transport.on("start loopStart",this._syncedStart),s.default.Transport.on("stop pause loopEnd",this._syncedStop),this},s.default.Source.prototype.unsync=function(){this._synced&&(s.default.Transport.off("stop pause loopEnd",this._syncedStop),s.default.Transport.off("start loopStart",this._syncedStart)),this._synced=!1;for(var t=0;t<this._scheduled.length;t++){var e=this._scheduled[t];s.default.Transport.clear(e)}return this._scheduled=[],this._state.cancel(0),this},s.default.Source.prototype.dispose=function(){s.default.AudioNode.prototype.dispose.call(this),this.unsync(),this._scheduled=null,this._writable("volume"),this._volume.dispose(),this._volume=null,this.volume=null,this._state.dispose(),this._state=null},e.default=s.default.Source},function(t,e,i){"use strict";i.r(e);var s=i(0);i(30),i(44);if(s.default.supported&&!s.default.global.AudioContext.prototype._native_createWaveShaper){var n=navigator.userAgent.toLowerCase();if(n.includes("safari")&&!n.includes("chrome")){var o=function(t){for(var e in this._internalNode=this.input=this.output=t._native_createWaveShaper(),this._curve=null,this._internalNode)this._defineProperty(this._internalNode,e)};Object.defineProperty(o.prototype,"curve",{get:function(){return this._curve},set:function(t){this._curve=t;var e=new Float32Array(t.length+1);e.set(t,1),e[0]=t[0],this._internalNode.curve=e}}),o.prototype._defineProperty=function(t,e){s.default.isUndef(this[e])&&Object.defineProperty(this,e,{get:function(){return"function"==typeof t[e]?t[e].bind(t):t[e]},set:function(i){t[e]=i}})},s.default.global.AudioContext.prototype._native_createWaveShaper=s.default.global.AudioContext.prototype.createWaveShaper,s.default.global.AudioContext.prototype.createWaveShaper=function(){return new o(this)}}}s.default.WaveShaper=function(t,e){s.default.SignalBase.call(this),this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(t)?this.curve=t:isFinite(t)||s.default.isUndef(t)?this._curve=new Float32Array(s.default.defaultArg(t,1024)):s.default.isFunction(t)&&(this._curve=new Float32Array(s.default.defaultArg(e,1024)),this.setMap(t))},s.default.extend(s.default.WaveShaper,s.default.SignalBase),s.default.WaveShaper.prototype.setMap=function(t){for(var e=new Array(this._curve.length),i=0,s=this._curve.length;i<s;i++){var n=i/(s-1)*2-1;e[i]=t(n,i)}return this.curve=e,this},Object.defineProperty(s.default.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(t){this._curve=new Float32Array(t),this._shaper.curve=this._curve}}),Object.defineProperty(s.default.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){if(!["none","2x","4x"].includes(t))throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");this._shaper.oversample=t}}),s.default.WaveShaper.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this};e.default=s.default.WaveShaper},function(t,e,i){"use strict";i.r(e);var s=i(0);i(23),i(1);s.default.Effect=function(){var t=s.default.defaults(arguments,["wet"],s.default.Effect);s.default.AudioNode.call(this),this.createInsOuts(1,1),this._dryWet=new s.default.CrossFade(t.wet),this.wet=this._dryWet.fade,this.effectSend=new s.default.Gain,this.effectReturn=new s.default.Gain,s.default.connect(this.input,this._dryWet.a),s.default.connect(this.input,this.effectSend),this.effectReturn.connect(this._dryWet.b),this._dryWet.connect(this.output),this._readOnly(["wet"])},s.default.extend(s.default.Effect,s.default.AudioNode),s.default.Effect.defaults={wet:1},s.default.Effect.prototype.connectEffect=function(t){return this.effectSend.chain(t,this.effectReturn),this},s.default.Effect.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this.effectSend.dispose(),this.effectSend=null,this.effectReturn.dispose(),this.effectReturn=null,this._writable(["wet"]),this.wet=null,this},e.default=s.default.Effect},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2),i(1);s.default.Filter=function(){var t=s.default.defaults(arguments,["frequency","type","rolloff"],s.default.Filter);s.default.AudioNode.call(this),this.createInsOuts(1,1),this._filters=[],this.frequency=new s.default.Signal(t.frequency,s.default.Type.Frequency),this.detune=new s.default.Signal(0,s.default.Type.Cents),this.gain=new s.default.Signal({value:t.gain,convert:!0,type:s.default.Type.Decibels}),this.Q=new s.default.Signal(t.Q),this._type=t.type,this._rolloff=t.rolloff,this.rolloff=t.rolloff,this._readOnly(["detune","frequency","gain","Q"])},s.default.extend(s.default.Filter,s.default.AudioNode),s.default.Filter.defaults={type:"lowpass",frequency:350,rolloff:-12,Q:1,gain:0},Object.defineProperty(s.default.Filter.prototype,"type",{get:function(){return this._type},set:function(t){if(-1===["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t))throw new TypeError("Tone.Filter: invalid type "+t);this._type=t;for(var e=0;e<this._filters.length;e++)this._filters[e].type=t}}),Object.defineProperty(s.default.Filter.prototype,"rolloff",{get:function(){return this._rolloff},set:function(t){t=parseInt(t,10);var e=[-12,-24,-48,-96].indexOf(t);if(-1===e)throw new RangeError("Tone.Filter: rolloff can only be -12, -24, -48 or -96");e+=1,this._rolloff=t,this.input.disconnect();for(var i=0;i<this._filters.length;i++)this._filters[i].disconnect(),this._filters[i]=null;this._filters=new Array(e);for(var n=0;n<e;n++){var o=this.context.createBiquadFilter();o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[n]=o}var a=[this.input].concat(this._filters).concat([this.output]);s.default.connectSeries.apply(s.default,a)}}),s.default.Filter.prototype.getFrequencyResponse=function(t){t=s.default.defaultArg(t,128);for(var e=new Float32Array(t).map(function(){return 1}),i=new Float32Array(t),n=0;n<t;n++){var o=19980*Math.pow(n/t,2)+20;i[n]=o}var a=new Float32Array(t),r=new Float32Array(t);return this._filters.forEach(function(){var t=this.context.createBiquadFilter();t.type=this._type,t.Q.value=this.Q.value,t.frequency.value=this.frequency.value,t.gain.value=this.gain.value,t.getFrequencyResponse(i,a,r),a.forEach(function(t,i){e[i]*=t})}.bind(this)),e},s.default.Filter.prototype.dispose=function(){s.default.AudioNode.prototype.dispose.call(this);for(var t=0;t<this._filters.length;t++)this._filters[t].disconnect(),this._filters[t]=null;return this._filters=null,this._writable(["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.frequency=null,this.Q=null,this.detune.dispose(),this.detune=null,this.gain.dispose(),this.gain=null,this},e.default=s.default.Filter},function(t,e,i){"use strict";i.r(e);var s=i(0);i(1);s.default.Merge=function(t){t=s.default.defaultArg(t,2),s.default.AudioNode.call(this),this.createInsOuts(t,0),this._merger=this.output=this.context.createChannelMerger(t);for(var e=0;e<t;e++)this.input[e]=new s.default.Gain,this.input[e].connect(this._merger,0,e),this.input[e].channelCount=1,this.input[e].channelCountMode="explicit";this.left=this.input[0],this.right=this.input[1]},s.default.extend(s.default.Merge,s.default.AudioNode),s.default.Merge.prototype.dispose=function(){return this.input.forEach(function(t){t.dispose()}),s.default.AudioNode.prototype.dispose.call(this),this.left=null,this.right=null,this._merger.disconnect(),this._merger=null,this},e.default=s.default.Merge},function(t,e,i){"use strict";i.r(e);var s=i(0);i(35),i(4);s.default.supported&&(AudioBuffer.prototype.copyToChannel||(AudioBuffer.prototype.copyToChannel=function(t,e,i){var s=this.getChannelData(e);i=i||0;for(var n=0;n<s.length;n++)s[n+i]=t[n]},AudioBuffer.prototype.copyFromChannel=function(t,e,i){var s=this.getChannelData(e);i=i||0;for(var n=0;n<t.length;n++)t[n]=s[n+i]})),s.default.Buffer=function(){var t=s.default.defaults(arguments,["url","onload","onerror"],s.default.Buffer);s.default.call(this),this._buffer=null,this._reversed=t.reverse,this._xhr=null,this.onload=s.default.noOp,t.url instanceof AudioBuffer||t.url instanceof s.default.Buffer?(this.set(t.url),this.loaded||(this.onload=t.onload)):s.default.isString(t.url)&&this.load(t.url).then(t.onload).catch(t.onerror)},s.default.extend(s.default.Buffer),s.default.Buffer.defaults={url:void 0,reverse:!1,onload:s.default.noOp,onerror:s.default.noOp},s.default.Buffer.prototype.set=function(t){return t instanceof s.default.Buffer?t.loaded?this._buffer=t.get():t.onload=function(){this.set(t),this.onload(this)}.bind(this):this._buffer=t,this._reversed&&this._reverse(),this},s.default.Buffer.prototype.get=function(){return this._buffer},s.default.Buffer.prototype.load=function(t,e,i){return new Promise(function(n,o){this._xhr=s.default.Buffer.load(t,function(t){this._xhr=null,this.set(t),n(this),this.onload(this),e&&e(this)}.bind(this),function(t){if(this._xhr=null,o(t),!i)throw t;i(t)}.bind(this))}.bind(this))},s.default.Buffer.prototype.dispose=function(){return s.default.prototype.dispose.call(this),this._buffer=null,this._xhr&&(s.default.Buffer._removeFromDownloadQueue(this._xhr),this._xhr.abort(),this._xhr=null),this},Object.defineProperty(s.default.Buffer.prototype,"loaded",{get:function(){return this.length>0}}),Object.defineProperty(s.default.Buffer.prototype,"duration",{get:function(){return this._buffer?this._buffer.duration:0}}),Object.defineProperty(s.default.Buffer.prototype,"length",{get:function(){return this._buffer?this._buffer.length:0}}),Object.defineProperty(s.default.Buffer.prototype,"numberOfChannels",{get:function(){return this._buffer?this._buffer.numberOfChannels:0}}),s.default.Buffer.prototype.fromArray=function(t){var e=t[0].length>0,i=e?t.length:1,s=e?t[0].length:t.length,n=this.context.createBuffer(i,s,this.context.sampleRate);e||1!==i||(t=[t]);for(var o=0;o<i;o++)n.copyToChannel(t[o],o);return this._buffer=n,this},s.default.Buffer.prototype.toMono=function(t){if(s.default.isNumber(t))this.fromArray(this.toArray(t));else{for(var e=new Float32Array(this.length),i=this.numberOfChannels,n=0;n<i;n++)for(var o=this.toArray(n),a=0;a<o.length;a++)e[a]+=o[a];e=e.map(function(t){return t/i}),this.fromArray(e)}return this},s.default.Buffer.prototype.toArray=function(t){if(s.default.isNumber(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);for(var e=[],i=0;i<this.numberOfChannels;i++)e[i]=this.getChannelData(i);return e},s.default.Buffer.prototype.getChannelData=function(t){return this._buffer.getChannelData(t)},s.default.Buffer.prototype.slice=function(t,e){e=s.default.defaultArg(e,this.duration);for(var i=Math.floor(this.context.sampleRate*this.toSeconds(t)),n=Math.floor(this.context.sampleRate*this.toSeconds(e)),o=[],a=0;a<this.numberOfChannels;a++)o[a]=this.toArray(a).slice(i,n);return(new s.default.Buffer).fromArray(o)},s.default.Buffer.prototype._reverse=function(){if(this.loaded)for(var t=0;t<this.numberOfChannels;t++)Array.prototype.reverse.call(this.getChannelData(t));return this},Object.defineProperty(s.default.Buffer.prototype,"reverse",{get:function(){return this._reversed},set:function(t){this._reversed!==t&&(this._reversed=t,this._reverse())}}),s.default.Emitter.mixin(s.default.Buffer),s.default.Buffer._downloadQueue=[],s.default.Buffer.baseUrl="",s.default.Buffer.fromArray=function(t){return(new s.default.Buffer).fromArray(t)},s.default.Buffer.fromUrl=function(t){var e=new s.default.Buffer;return e.load(t).then(function(){return e})},s.default.Buffer._removeFromDownloadQueue=function(t){var e=s.default.Buffer._downloadQueue.indexOf(t);-1!==e&&s.default.Buffer._downloadQueue.splice(e,1)},s.default.Buffer.load=function(t,e,i){e=s.default.defaultArg(e,s.default.noOp);var n=t.match(/\[(.+\|?)+\]$/);if(n){for(var o=n[1].split("|"),a=o[0],r=0;r<o.length;r++)if(s.default.Buffer.supportsType(o[r])){a=o[r];break}t=t.replace(n[0],a)}function l(t){if(s.default.Buffer._removeFromDownloadQueue(f),s.default.Buffer.emit("error",t),!i)throw t;i(t)}function u(){for(var t=0,e=0;e<s.default.Buffer._downloadQueue.length;e++)t+=s.default.Buffer._downloadQueue[e].progress;s.default.Buffer.emit("progress",t/s.default.Buffer._downloadQueue.length)}var f=new XMLHttpRequest;return f.open("GET",s.default.Buffer.baseUrl+t,!0),f.responseType="arraybuffer",f.progress=0,s.default.Buffer._downloadQueue.push(f),f.addEventListener("load",function(){200===f.status?s.default.context.decodeAudioData(f.response).then(function(t){f.progress=1,u(),e(t),s.default.Buffer._removeFromDownloadQueue(f),0===s.default.Buffer._downloadQueue.length&&s.default.Buffer.emit("load")}).catch(function(){s.default.Buffer._removeFromDownloadQueue(f),l("Tone.Buffer: could not decode audio data: "+t)}):l("Tone.Buffer: could not locate file: "+t)}),f.addEventListener("error",l),f.addEventListener("progress",function(t){t.lengthComputable&&(f.progress=t.loaded/t.total*.95,u())}),f.send(),f},s.default.Buffer.cancelDownloads=function(){return s.default.Buffer._downloadQueue.slice().forEach(function(t){s.default.Buffer._removeFromDownloadQueue(t),t.abort()}),s.default.Buffer},s.default.Buffer.supportsType=function(t){var e=t.split(".");return e=e[e.length-1],""!==document.createElement("audio").canPlayType("audio/"+e)},s.default.loaded=function(){var t,e;function i(){s.default.Buffer.off("load",t),s.default.Buffer.off("error",e)}return new Promise(function(i,n){t=function(){i()},e=function(){n()},s.default.Buffer.on("load",t),s.default.Buffer.on("error",e)}).then(i).catch(function(t){throw i(),new Error(t)})};e.default=s.default.Buffer},function(t,e,i){"use strict";i.r(e);var s=i(0);i(17),i(26),i(1),i(2),i(22),i(4),i(28);s.default.LFO=function(){var t=s.default.defaults(arguments,["frequency","min","max"],s.default.LFO);s.default.AudioNode.call(this),this._oscillator=new s.default.Oscillator({frequency:t.frequency,type:t.type}),this.frequency=this._oscillator.frequency,this.amplitude=this._oscillator.volume,this.amplitude.units=s.default.Type.NormalRange,this.amplitude.value=t.amplitude,this._stoppedSignal=new s.default.Signal(0,s.default.Type.AudioRange),this._zeros=new s.default.Zero,this._stoppedValue=0,this._a2g=new s.default.AudioToGain,this._scaler=this.output=new s.default.Scale(t.min,t.max),this._units=s.default.Type.Default,this.units=t.units,this._oscillator.chain(this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),this._readOnly(["amplitude","frequency"]),this.phase=t.phase},s.default.extend(s.default.LFO,s.default.AudioNode),s.default.LFO.defaults={type:"sine",min:0,max:1,phase:0,frequency:"4n",amplitude:1,units:s.default.Type.Default},s.default.LFO.prototype.start=function(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this},s.default.LFO.prototype.stop=function(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this},s.default.LFO.prototype.sync=function(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this},s.default.LFO.prototype.unsync=function(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this},Object.defineProperty(s.default.LFO.prototype,"min",{get:function(){return this._toUnits(this._scaler.min)},set:function(t){t=this._fromUnits(t),this._scaler.min=t}}),Object.defineProperty(s.default.LFO.prototype,"max",{get:function(){return this._toUnits(this._scaler.max)},set:function(t){t=this._fromUnits(t),this._scaler.max=t}}),Object.defineProperty(s.default.LFO.prototype,"type",{get:function(){return this._oscillator.type},set:function(t){this._oscillator.type=t,this._stoppedValue=this._oscillator._getInitialValue(),this._stoppedSignal.value=this._stoppedValue}}),Object.defineProperty(s.default.LFO.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(t){this._oscillator.phase=t,this._stoppedValue=this._oscillator._getInitialValue(),this._stoppedSignal.value=this._stoppedValue}}),Object.defineProperty(s.default.LFO.prototype,"units",{get:function(){return this._units},set:function(t){var e=this.min,i=this.max;this._units=t,this.min=e,this.max=i}}),Object.defineProperty(s.default.LFO.prototype,"state",{get:function(){return this._oscillator.state}}),s.default.LFO.prototype.connect=function(t){return t.constructor!==s.default.Signal&&t.constructor!==s.default.Param||(this.convert=t.convert,this.units=t.units),s.default.SignalBase.prototype.connect.apply(this,arguments),this},s.default.LFO.prototype._fromUnits=s.default.Param.prototype._fromUnits,s.default.LFO.prototype._toUnits=s.default.Param.prototype._toUnits,s.default.LFO.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable(["amplitude","frequency"]),this._oscillator.dispose(),this._oscillator=null,this._stoppedSignal.dispose(),this._stoppedSignal=null,this._zeros.dispose(),this._zeros=null,this._scaler.dispose(),this._scaler=null,this._a2g.dispose(),this._a2g=null,this.frequency=null,this.amplitude=null,this},e.default=s.default.LFO},function(t,e,i){"use strict";i.r(e);var s=i(0);i(29),i(90),i(2),i(3);s.default.Subtract=function(t){s.default.Signal.call(this),this.createInsOuts(2,0),this._sum=this.input[0]=this.output=new s.default.Gain,this._neg=new s.default.Negate,this._param=this.input[1]=new s.default.Signal(t),this._param.chain(this._neg,this._sum)},s.default.extend(s.default.Subtract,s.default.Signal),s.default.Subtract.prototype.dispose=function(){return s.default.Signal.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this},e.default=s.default.Subtract},function(t,e,i){"use strict";i.r(e);var s=i(0);i(4),i(1),i(24);s.default.Param=function(){var t=s.default.defaults(arguments,["param","units","convert"],s.default.Param);s.default.AudioNode.call(this,t),this._param=this.input=t.param,this.units=t.units,this.convert=t.convert,this.overridden=!1,this._events=new s.default.Timeline(1e3),s.default.isDefined(t.value)&&this._param&&this.setValueAtTime(t.value,0)},s.default.extend(s.default.Param,s.default.AudioNode),s.default.Param.defaults={units:s.default.Type.Default,convert:!0,param:void 0},Object.defineProperty(s.default.Param.prototype,"value",{get:function(){var t=this.now();return this._toUnits(this.getValueAtTime(t))},set:function(t){this._initialValue=this._fromUnits(t),this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}}),Object.defineProperty(s.default.Param.prototype,"minValue",{get:function(){return this.units===s.default.Type.Time||this.units===s.default.Type.Frequency||this.units===s.default.Type.NormalRange||this.units===s.default.Type.Positive||this.units===s.default.Type.BPM?0:this.units===s.default.Type.AudioRange?-1:this.units===s.default.Type.Decibels?-1/0:this._param.minValue}}),Object.defineProperty(s.default.Param.prototype,"maxValue",{get:function(){return this.units===s.default.Type.NormalRange||this.units===s.default.Type.AudioRange?1:this._param.maxValue}}),s.default.Param.prototype._fromUnits=function(t){if(!this.convert&&!s.default.isUndef(this.convert)||this.overridden)return t;switch(this.units){case s.default.Type.Time:return this.toSeconds(t);case s.default.Type.Frequency:return this.toFrequency(t);case s.default.Type.Decibels:return s.default.dbToGain(t);case s.default.Type.NormalRange:return Math.min(Math.max(t,0),1);case s.default.Type.AudioRange:return Math.min(Math.max(t,-1),1);case s.default.Type.Positive:return Math.max(t,0);default:return t}},s.default.Param.prototype._toUnits=function(t){if(!this.convert&&!s.default.isUndef(this.convert))return t;switch(this.units){case s.default.Type.Decibels:return s.default.gainToDb(t);default:return t}},s.default.Param.prototype._minOutput=1e-5,s.default.Param.AutomationType={Linear:"linearRampToValueAtTime",Exponential:"exponentialRampToValueAtTime",Target:"setTargetAtTime",SetValue:"setValueAtTime",Cancel:"cancelScheduledValues"},s.default.Param.prototype.setValueAtTime=function(t,e){return e=this.toSeconds(e),t=this._fromUnits(t),this._events.add({type:s.default.Param.AutomationType.SetValue,value:t,time:e}),this.log(s.default.Param.AutomationType.SetValue,t,e),this._param.setValueAtTime(t,e),this},s.default.Param.prototype.getValueAtTime=function(t){t=this.toSeconds(t);var e=this._events.getAfter(t),i=this._events.get(t),n=s.default.defaultArg(this._initialValue,this._param.defaultValue),o=n;if(null===i)o=n;else if(i.type===s.default.Param.AutomationType.Target){var a,r=this._events.getBefore(i.time);a=null===r?n:r.value,o=this._exponentialApproach(i.time,a,i.value,i.constant,t)}else o=null===e?i.value:e.type===s.default.Param.AutomationType.Linear?this._linearInterpolate(i.time,i.value,e.time,e.value,t):e.type===s.default.Param.AutomationType.Exponential?this._exponentialInterpolate(i.time,i.value,e.time,e.value,t):i.value;return o},s.default.Param.prototype.setRampPoint=function(t){t=this.toSeconds(t);var e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===e&&(e=this._minOutput),this.setValueAtTime(this._toUnits(e),t),this},s.default.Param.prototype.linearRampToValueAtTime=function(t,e){return t=this._fromUnits(t),e=this.toSeconds(e),this._events.add({type:s.default.Param.AutomationType.Linear,value:t,time:e}),this.log(s.default.Param.AutomationType.Linear,t,e),this._param.linearRampToValueAtTime(t,e),this},s.default.Param.prototype.exponentialRampToValueAtTime=function(t,e){return t=this._fromUnits(t),t=Math.max(this._minOutput,t),e=this.toSeconds(e),this._events.add({type:s.default.Param.AutomationType.Exponential,time:e,value:t}),this.log(s.default.Param.AutomationType.Exponential,t,e),this._param.exponentialRampToValueAtTime(t,e),this},s.default.Param.prototype.exponentialRampTo=function(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialRampToValueAtTime(t,i+this.toSeconds(e)),this},s.default.Param.prototype.linearRampTo=function(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.linearRampToValueAtTime(t,i+this.toSeconds(e)),this},s.default.Param.prototype.targetRampTo=function(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialApproachValueAtTime(t,i,e),this},s.default.Param.prototype.exponentialApproachValueAtTime=function(t,e,i){var s=Math.log(this.toSeconds(i)+1)/Math.log(200);return e=this.toSeconds(e),this.setTargetAtTime(t,e,s),this.cancelAndHoldAtTime(e+.9*i),this.linearRampToValueAtTime(t,e+i),this},s.default.Param.prototype.setTargetAtTime=function(t,e,i){if(t=this._fromUnits(t),i<=0)throw new Error("timeConstant must be greater than 0");return e=this.toSeconds(e),this._events.add({type:s.default.Param.AutomationType.Target,value:t,time:e,constant:i}),this.log(s.default.Param.AutomationType.Target,t,e,i),this._param.setTargetAtTime(t,e,i),this},s.default.Param.prototype.setValueCurveAtTime=function(t,e,i,n){n=s.default.defaultArg(n,1),i=this.toSeconds(i),e=this.toSeconds(e),this.setValueAtTime(t[0]*n,e);for(var o=i/(t.length-1),a=1;a<t.length;a++)this.linearRampToValueAtTime(t[a]*n,e+a*o);return this},s.default.Param.prototype.cancelScheduledValues=function(t){return t=this.toSeconds(t),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(s.default.Param.AutomationType.Cancel,t),this},s.default.Param.prototype.cancelAndHoldAtTime=function(t){t=this.toSeconds(t);var e=this.getValueAtTime(t);this.log("cancelAndHoldAtTime",t,"value="+e),this._param.cancelScheduledValues(t);var i=this._events.get(t),n=this._events.getAfter(t);return i&&i.time===t?n?this._events.cancel(n.time):this._events.cancel(t+this.sampleTime):n&&(this._events.cancel(n.time),n.type===s.default.Param.AutomationType.Linear?this.linearRampToValueAtTime(e,t):n.type===s.default.Param.AutomationType.Exponential&&this.exponentialRampToValueAtTime(e,t)),this._events.add({type:s.default.Param.AutomationType.SetValue,value:e,time:t}),this._param.setValueAtTime(e,t),this},s.default.Param.prototype.rampTo=function(t,e,i){return e=s.default.defaultArg(e,.1),this.units===s.default.Type.Frequency||this.units===s.default.Type.BPM||this.units===s.default.Type.Decibels?this.exponentialRampTo(t,e,i):this.linearRampTo(t,e,i),this},s.default.Param.prototype._exponentialApproach=function(t,e,i,s,n){return i+(e-i)*Math.exp(-(n-t)/s)},s.default.Param.prototype._linearInterpolate=function(t,e,i,s,n){return e+(n-t)/(i-t)*(s-e)},s.default.Param.prototype._exponentialInterpolate=function(t,e,i,s,n){return e*Math.pow(s/e,(n-t)/(i-t))},s.default.Param.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._param=null,this._events=null,this},e.default=s.default.Param},function(t,e,i){"use strict";i.r(e);var s=i(0);i(8),i(19),i(10),i(23);s.default.StereoEffect=function(){s.default.AudioNode.call(this);var t=s.default.defaults(arguments,["wet"],s.default.Effect);this.createInsOuts(1,1),this._dryWet=new s.default.CrossFade(t.wet),this.wet=this._dryWet.fade,this._split=new s.default.Split,this.effectSendL=this._split.left,this.effectSendR=this._split.right,this._merge=new s.default.Merge,this.effectReturnL=this._merge.left,this.effectReturnR=this._merge.right,s.default.connect(this.input,this._split),s.default.connect(this.input,this._dryWet,0,0),this._merge.connect(this._dryWet,0,1),this._dryWet.connect(this.output),this._readOnly(["wet"])},s.default.extend(s.default.StereoEffect,s.default.Effect),s.default.StereoEffect.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this._split.dispose(),this._split=null,this._merge.dispose(),this._merge=null,this.effectSendL=null,this.effectSendR=null,this.effectReturnL=null,this.effectReturnR=null,this._writable(["wet"]),this.wet=null,this},e.default=s.default.StereoEffect},function(t,e,i){"use strict";i.r(e);var s=i(0);i(83),i(4),i(24),i(35),i(3),i(81),i(80),i(56);s.default.Transport=function(){s.default.Emitter.call(this),s.default.getContext(function(){this.loop=!1,this._loopStart=0,this._loopEnd=0,this._ppq=n.defaults.PPQ,this._clock=new s.default.Clock({callback:this._processTick.bind(this),frequency:0}),this._bindClockEvents(),this.bpm=this._clock.frequency,this.bpm._toUnits=this._toUnits.bind(this),this.bpm._fromUnits=this._fromUnits.bind(this),this.bpm.units=s.default.Type.BPM,this.bpm.value=n.defaults.bpm,this._readOnly("bpm"),this._timeSignature=n.defaults.timeSignature,this._scheduledEvents={},this._timeline=new s.default.Timeline,this._repeatedEvents=new s.default.IntervalTimeline,this._syncedSignals=[],this._swingTicks=n.defaults.PPQ/2,this._swingAmount=0,this.context.transport=this}.bind(this))},s.default.extend(s.default.Transport,s.default.Emitter),s.default.Transport.defaults={bpm:120,swing:0,swingSubdivision:"8n",timeSignature:4,loopStart:0,loopEnd:"4m",PPQ:192},s.default.Transport.prototype.isTransport=!0,s.default.Transport.prototype._processTick=function(t,e){if(this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){var i=e%(2*this._swingTicks)/(2*this._swingTicks),n=Math.sin(i*Math.PI)*this._swingAmount;t+=s.default.Ticks(2*this._swingTicks/3).toSeconds()*n}this.loop&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._timeline.forEachAtTime(e,function(e){e.invoke(t)})},s.default.Transport.prototype.schedule=function(t,e){var i=new s.default.TransportEvent(this,{time:s.default.TransportTime(e),callback:t});return this._addEvent(i,this._timeline)},s.default.Transport.prototype.scheduleRepeat=function(t,e,i,n){var o=new s.default.TransportRepeatEvent(this,{callback:t,interval:s.default.Time(e),time:s.default.TransportTime(i),duration:s.default.Time(s.default.defaultArg(n,1/0))});return this._addEvent(o,this._repeatedEvents)},s.default.Transport.prototype.scheduleOnce=function(t,e){var i=new s.default.TransportEvent(this,{time:s.default.TransportTime(e),callback:t,once:!0});return this._addEvent(i,this._timeline)},s.default.Transport.prototype.clear=function(t){if(this._scheduledEvents.hasOwnProperty(t)){var e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this},s.default.Transport.prototype._addEvent=function(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id},s.default.Transport.prototype.cancel=function(t){return t=s.default.defaultArg(t,0),t=this.toTicks(t),this._timeline.forEachFrom(t,function(t){this.clear(t.id)}.bind(this)),this._repeatedEvents.forEachFrom(t,function(t){this.clear(t.id)}.bind(this)),this},s.default.Transport.prototype._bindClockEvents=function(){this._clock.on("start",function(t,e){e=s.default.Ticks(e).toSeconds(),this.emit("start",t,e)}.bind(this)),this._clock.on("stop",function(t){this.emit("stop",t)}.bind(this)),this._clock.on("pause",function(t){this.emit("pause",t)}.bind(this))},Object.defineProperty(s.default.Transport.prototype,"state",{get:function(){return this._clock.getStateAtTime(this.now())}}),s.default.Transport.prototype.start=function(t,e){return s.default.isDefined(e)&&(e=this.toTicks(e)),this._clock.start(t,e),this},s.default.Transport.prototype.stop=function(t){return this._clock.stop(t),this},s.default.Transport.prototype.pause=function(t){return this._clock.pause(t),this},s.default.Transport.prototype.toggle=function(t){return t=this.toSeconds(t),this._clock.getStateAtTime(t)!==s.default.State.Started?this.start(t):this.stop(t),this},Object.defineProperty(s.default.Transport.prototype,"timeSignature",{get:function(){return this._timeSignature},set:function(t){s.default.isArray(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}}),Object.defineProperty(s.default.Transport.prototype,"loopStart",{get:function(){return s.default.Ticks(this._loopStart).toSeconds()},set:function(t){this._loopStart=this.toTicks(t)}}),Object.defineProperty(s.default.Transport.prototype,"loopEnd",{get:function(){return s.default.Ticks(this._loopEnd).toSeconds()},set:function(t){this._loopEnd=this.toTicks(t)}}),s.default.Transport.prototype.setLoopPoints=function(t,e){return this.loopStart=t,this.loopEnd=e,this},Object.defineProperty(s.default.Transport.prototype,"swing",{get:function(){return this._swingAmount},set:function(t){this._swingAmount=t}}),Object.defineProperty(s.default.Transport.prototype,"swingSubdivision",{get:function(){return s.default.Ticks(this._swingTicks).toNotation()},set:function(t){this._swingTicks=this.toTicks(t)}}),Object.defineProperty(s.default.Transport.prototype,"position",{get:function(){var t=this.now(),e=this._clock.getTicksAtTime(t);return s.default.Ticks(e).toBarsBeatsSixteenths()},set:function(t){var e=this.toTicks(t);this.ticks=e}}),Object.defineProperty(s.default.Transport.prototype,"seconds",{get:function(){return this._clock.seconds},set:function(t){var e=this.now(),i=this.bpm.timeToTicks(t,e);this.ticks=i}}),Object.defineProperty(s.default.Transport.prototype,"progress",{get:function(){if(this.loop){var t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}}),Object.defineProperty(s.default.Transport.prototype,"ticks",{get:function(){return this._clock.ticks},set:function(t){if(this._clock.ticks!==t){var e=this.now();this.state===s.default.State.Started?(this.emit("stop",e),this._clock.setTicksAtTime(t,e),this.emit("start",e,this.seconds)):this._clock.setTicksAtTime(t,e)}}}),s.default.Transport.prototype.getTicksAtTime=function(t){return Math.round(this._clock.getTicksAtTime(t))},s.default.Transport.prototype.getSecondsAtTime=function(t){return this._clock.getSecondsAtTime(t)},Object.defineProperty(s.default.Transport.prototype,"PPQ",{get:function(){return this._ppq},set:function(t){var e=this.bpm.value;this._ppq=t,this.bpm.value=e}}),s.default.Transport.prototype._fromUnits=function(t){return 1/(60/t/this.PPQ)},s.default.Transport.prototype._toUnits=function(t){return t/this.PPQ*60},s.default.Transport.prototype.nextSubdivision=function(t){if(t=this.toTicks(t),this.state!==s.default.State.Started)return 0;var e=this.now(),i=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(i,e)},s.default.Transport.prototype.syncSignal=function(t,e){if(!e){var i=this.now();e=0!==t.getValueAtTime(i)?t.getValueAtTime(i)/this.bpm.getValueAtTime(i):0}var n=new s.default.Gain(e);return this.bpm.chain(n,t._param),this._syncedSignals.push({ratio:n,signal:t,initial:t.value}),t.value=0,this},s.default.Transport.prototype.unsyncSignal=function(t){for(var e=this._syncedSignals.length-1;e>=0;e--){var i=this._syncedSignals[e];i.signal===t&&(i.ratio.dispose(),i.signal.value=i.initial,this._syncedSignals.splice(e,1))}return this},s.default.Transport.prototype.dispose=function(){return s.default.Emitter.prototype.dispose.call(this),this._clock.dispose(),this._clock=null,this._writable("bpm"),this.bpm=null,this._timeline.dispose(),this._timeline=null,this._repeatedEvents.dispose(),this._repeatedEvents=null,this};var n=s.default.Transport;s.default.Transport=new n,s.default.Context.on("init",function(t){t.transport&&t.transport.isTransport?s.default.Transport=t.transport:s.default.Transport=new n}),s.default.Context.on("close",function(t){t.transport&&t.transport.isTransport&&t.transport.dispose()}),e.default=s.default.Transport},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2),i(6),i(16),i(79);s.default.Oscillator=function(){var t=s.default.defaults(arguments,["frequency","type"],s.default.Oscillator);s.default.Source.call(this,t),this._oscillator=null,this.frequency=new s.default.Signal(t.frequency,s.default.Type.Frequency),this.detune=new s.default.Signal(t.detune,s.default.Type.Cents),this._wave=null,this._partials=t.partials,this._partialCount=t.partialCount,this._phase=t.phase,this._type=t.type,t.partialCount&&t.type!==s.default.Oscillator.Type.Custom&&(this._type=this.baseType+t.partialCount.toString()),this.phase=this._phase,this._readOnly(["frequency","detune"])},s.default.extend(s.default.Oscillator,s.default.Source),s.default.Oscillator.defaults={type:"sine",frequency:440,detune:0,phase:0,partials:[],partialCount:0},s.default.Oscillator.Type={Sine:"sine",Triangle:"triangle",Sawtooth:"sawtooth",Square:"square",Custom:"custom"},s.default.Oscillator.prototype._start=function(t){this.log("start",t);var e=new s.default.OscillatorNode;this._oscillator=e,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),t=this.toSeconds(t),this._oscillator.start(t)},s.default.Oscillator.prototype._stop=function(t){return this.log("stop",t),this._oscillator&&(t=this.toSeconds(t),this._oscillator.stop(t)),this},s.default.Oscillator.prototype.restart=function(t){return this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(this.toSeconds(t)),this},s.default.Oscillator.prototype.syncFrequency=function(){return s.default.Transport.syncSignal(this.frequency),this},s.default.Oscillator.prototype.unsyncFrequency=function(){return s.default.Transport.unsyncSignal(this.frequency),this},Object.defineProperty(s.default.Oscillator.prototype,"type",{get:function(){return this._type},set:function(t){var e=[s.default.Oscillator.Type.Sine,s.default.Oscillator.Type.Square,s.default.Oscillator.Type.Triangle,s.default.Oscillator.Type.Sawtooth].includes(t);if(0===this._phase&&e)this._wave=null,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{var i=this._getRealImaginary(t,this._phase),n=this.context.createPeriodicWave(i[0],i[1]);this._wave=n,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}this._type=t}}),Object.defineProperty(s.default.Oscillator.prototype,"baseType",{get:function(){return this._type.replace(this.partialCount,"")},set:function(t){this.partialCount&&this._type!==s.default.Oscillator.Type.Custom&&t!==s.default.Oscillator.Type.Custom?this.type=t+this.partialCount:this.type=t}}),Object.defineProperty(s.default.Oscillator.prototype,"partialCount",{get:function(){return this._partialCount},set:function(t){var e=this._type,i=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);i&&(e=i[1]),this._type!==s.default.Oscillator.Type.Custom&&(this.type=0===t?e:e+t.toString())}}),s.default.Oscillator.prototype.get=function(){var t=s.default.prototype.get.apply(this,arguments);return t.type!==s.default.Oscillator.Type.Custom&&delete t.partials,t},s.default.Oscillator.prototype._getRealImaginary=function(t,e){var i=2048,n=new Float32Array(i),o=new Float32Array(i),a=1;if(t===s.default.Oscillator.Type.Custom)a=this._partials.length+1,this._partialCount=this._partials.length,i=a;else{var r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);r?(a=parseInt(r[2])+1,this._partialCount=parseInt(r[2]),t=r[1],i=a=Math.max(a,2)):this._partialCount=0,this._partials=[]}for(var l=1;l<i;++l){var u,f=2/(l*Math.PI);switch(t){case s.default.Oscillator.Type.Sine:u=l<=a?1:0,this._partials[l-1]=u;break;case s.default.Oscillator.Type.Square:u=1&l?2*f:0,this._partials[l-1]=u;break;case s.default.Oscillator.Type.Sawtooth:u=f*(1&l?1:-1),this._partials[l-1]=u;break;case s.default.Oscillator.Type.Triangle:u=1&l?f*f*2*(l-1>>1&1?-1:1):0,this._partials[l-1]=u;break;case s.default.Oscillator.Type.Custom:u=this._partials[l-1];break;default:throw new TypeError("Tone.Oscillator: invalid type: "+t)}0!==u?(n[l]=-u*Math.sin(e*l),o[l]=u*Math.cos(e*l)):(n[l]=0,o[l]=0)}return[n,o]},s.default.Oscillator.prototype._inverseFFT=function(t,e,i){for(var s=0,n=t.length,o=0;o<n;o++)s+=t[o]*Math.cos(o*i)+e[o]*Math.sin(o*i);return s},s.default.Oscillator.prototype._getInitialValue=function(){for(var t=this._getRealImaginary(this._type,0),e=t[0],i=t[1],s=0,n=2*Math.PI,o=0;o<8;o++)s=Math.max(this._inverseFFT(e,i,o/8*n),s);return-this._inverseFFT(e,i,this._phase)/s},Object.defineProperty(s.default.Oscillator.prototype,"partials",{get:function(){return this._partials},set:function(t){this._partials=t,this.type=s.default.Oscillator.Type.Custom}}),Object.defineProperty(s.default.Oscillator.prototype,"phase",{get:function(){return this._phase*(180/Math.PI)},set:function(t){this._phase=t*Math.PI/180,this.type=this._type}}),s.default.Oscillator.prototype.dispose=function(){return s.default.Source.prototype.dispose.call(this),null!==this._oscillator&&(this._oscillator.dispose(),this._oscillator=null),this._wave=null,this._writable(["frequency","detune"]),this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this._partials=null,this},e.default=s.default.Oscillator},function(t,e,i){"use strict";i.r(e);var s=i(0);i(14),i(1);s.default.Delay=function(){var t=s.default.defaults(arguments,["delayTime","maxDelay"],s.default.Delay);s.default.AudioNode.call(this,t),this._maxDelay=Math.max(this.toSeconds(t.maxDelay),this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(this._maxDelay),this.delayTime=new s.default.Param({param:this._delayNode.delayTime,units:s.default.Type.Time,value:t.delayTime}),this._readOnly("delayTime")},s.default.extend(s.default.Delay,s.default.AudioNode),s.default.Delay.defaults={maxDelay:1,delayTime:0},Object.defineProperty(s.default.Delay.prototype,"maxDelay",{get:function(){return this._maxDelay}}),s.default.Delay.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._delayNode.disconnect(),this._delayNode=null,this._writable("delayTime"),this.delayTime=null,this},e.default=s.default.Delay},function(t,e,i){"use strict";i.r(e);var s=i(0);i(3),i(1);s.default.Split=function(t){t=s.default.defaultArg(t,2),s.default.AudioNode.call(this),this.createInsOuts(0,t),this._splitter=this.input=this.context.createChannelSplitter(t);for(var e=0;e<t;e++)this.output[e]=new s.default.Gain,s.default.connect(this._splitter,this.output[e],e,0),this.output[e].channelCount=1,this.output[e].channelCountMode="explicit";this.left=this.output[0],this.right=this.output[1]},s.default.extend(s.default.Split,s.default.AudioNode),s.default.Split.prototype.dispose=function(){return this.output.forEach(function(t){t.dispose()}),s.default.AudioNode.prototype.dispose.call(this),this._splitter.disconnect(),this.left=null,this.right=null,this._splitter=null,this},e.default=s.default.Split},function(t,e,i){"use strict";i.r(e);var s=i(0),n=(i(35),i(24),i(44),["baseLatency","destination","currentTime","sampleRate","listener","state"]),o=["suspend","close","resume","getOutputTimestamp","createMediaElementSource","createMediaStreamSource","createMediaStreamDestination","createBuffer","decodeAudioData","createBufferSource","createConstantSource","createGain","createDelay","createBiquadFilter","createIIRFilter","createWaveShaper","createPanner","createConvolver","createDynamicsCompressor","createAnalyser","createScriptProcessor","createStereoPanner","createOscillator","createPeriodicWave","createChannelSplitter","createChannelMerger","audioWorklet"];s.default.Context=function(){s.default.Emitter.call(this);var t=s.default.defaults(arguments,["context"],s.default.Context);if(!t.context&&(t.context=new s.default.global.AudioContext,!t.context))throw new Error("could not create AudioContext. Possibly too many AudioContexts running already.");for(this._context=t.context;this._context.rawContext;)this._context=this._context.rawContext;n.forEach(function(t){this._defineProperty(this._context,t)}.bind(this)),o.forEach(function(t){this._defineMethod(this._context,t)}.bind(this)),this._latencyHint=t.latencyHint,this._constants={},this.lookAhead=t.lookAhead,this._computedUpdateInterval=0,this._ticker=new a(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this._timeouts=new s.default.Timeline,this._timeoutIds=0,this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=function(t){this.emit("statechange",t)}.bind(this)},s.default.extend(s.default.Context,s.default.Emitter),s.default.Emitter.mixin(s.default.Context),s.default.Context.defaults={clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.03},s.default.Context.prototype.isContext=!0,s.default.Context.prototype._defineProperty=function(t,e){s.default.isUndef(this[e])&&Object.defineProperty(this,e,{get:function(){return t[e]},set:function(i){t[e]=i}})},s.default.Context.prototype._defineMethod=function(t,e){s.default.isUndef(this[e])&&Object.defineProperty(this,e,{get:function(){return t[e].bind(t)}})},s.default.Context.prototype.now=function(){return this._context.currentTime+this.lookAhead},Object.defineProperty(s.default.Context.prototype,"destination",{get:function(){return this.master?this.master:this._context.destination}}),s.default.Context.prototype.resume=function(){return"suspended"===this._context.state&&this._context instanceof AudioContext?this._context.resume():Promise.resolve()},s.default.Context.prototype.close=function(){var t=Promise.resolve();return this!==s.default.global.TONE_AUDIO_CONTEXT&&(t=this.rawContext.close()),t.then(function(){s.default.Context.emit("close",this)}.bind(this))},s.default.Context.prototype.getConstant=function(t){if(this._constants[t])return this._constants[t];for(var e=this._context.createBuffer(1,128,this._context.sampleRate),i=e.getChannelData(0),s=0;s<i.length;s++)i[s]=t;var n=this._context.createBufferSource();return n.channelCount=1,n.channelCountMode="explicit",n.buffer=e,n.loop=!0,n.start(0),this._constants[t]=n,n},s.default.Context.prototype._timeoutLoop=function(){for(var t=this.now();this._timeouts&&this._timeouts.length&&this._timeouts.peek().time<=t;)this._timeouts.shift().callback()},s.default.Context.prototype.setTimeout=function(t,e){this._timeoutIds++;var i=this.now();return this._timeouts.add({callback:t,time:i+e,id:this._timeoutIds}),this._timeoutIds},s.default.Context.prototype.clearTimeout=function(t){return this._timeouts.forEach(function(e){e.id===t&&this.remove(e)}),this},Object.defineProperty(s.default.Context.prototype,"updateInterval",{get:function(){return this._ticker.updateInterval},set:function(t){this._ticker.updateInterval=t}}),Object.defineProperty(s.default.Context.prototype,"rawContext",{get:function(){return this._context}}),Object.defineProperty(s.default.Context.prototype,"clockSource",{get:function(){return this._ticker.type},set:function(t){this._ticker.type=t}}),Object.defineProperty(s.default.Context.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(t){var e=t;if(this._latencyHint=t,s.default.isString(t))switch(t){case"interactive":e=.1,this._context.latencyHint=t;break;case"playback":e=.8,this._context.latencyHint=t;break;case"balanced":e=.25,this._context.latencyHint=t;break;case"fastest":this._context.latencyHint="interactive",e=.01}this.lookAhead=e,this.updateInterval=e/3}}),s.default.Context.prototype.dispose=function(){return this.close().then(function(){for(var t in s.default.Emitter.prototype.dispose.call(this),this._ticker.dispose(),this._ticker=null,this._timeouts.dispose(),this._timeouts=null,this._constants)this._constants[t].disconnect();this._constants=null}.bind(this))};var a=function(t,e,i){this._type=e,this._updateInterval=i,this._callback=s.default.defaultArg(t,s.default.noOp),this._createClock()};a.Type={Worker:"worker",Timeout:"timeout",Offline:"offline"},a.prototype._createWorker=function(){s.default.global.URL=s.default.global.URL||s.default.global.webkitURL;var t=new Blob(["var timeoutTime = "+(1e3*this._updateInterval).toFixed(1)+";self.onmessage = function(msg){\ttimeoutTime = parseInt(msg.data);};function tick(){\tsetTimeout(tick, timeoutTime);\tself.postMessage('tick');}tick();"]),e=URL.createObjectURL(t),i=new Worker(e);i.onmessage=this._callback.bind(this),this._worker=i},a.prototype._createTimeout=function(){this._timeout=setTimeout(function(){this._createTimeout(),this._callback()}.bind(this),1e3*this._updateInterval)},a.prototype._createClock=function(){if(this._type===a.Type.Worker)try{this._createWorker()}catch(t){this._type=a.Type.Timeout,this._createClock()}else this._type===a.Type.Timeout&&this._createTimeout()},Object.defineProperty(a.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(t){this._updateInterval=Math.max(t,128/44100),this._type===a.Type.Worker&&this._worker.postMessage(Math.max(1e3*t,1))}}),Object.defineProperty(a.prototype,"type",{get:function(){return this._type},set:function(t){this._disposeClock(),this._type=t,this._createClock()}}),a.prototype._disposeClock=function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this._worker&&(this._worker.terminate(),this._worker.onmessage=null,this._worker=null)},a.prototype.dispose=function(){this._disposeClock(),this._callback=null},s.default.supported&&!s.default.initialized?(s.default.global.TONE_AUDIO_CONTEXT||(s.default.global.TONE_AUDIO_CONTEXT=new s.default.Context),s.default.context=s.default.global.TONE_AUDIO_CONTEXT):s.default.supported||s.default.global.TONE_SILENCE_LOGGING||console.warn("This browser does not support Tone.js"),e.default=s.default.Context},function(t,e,i){"use strict";i.r(e);var s=i(0);i(4),i(40);s.default.Instrument=function(t){t=s.default.defaultArg(t,s.default.Instrument.defaults),s.default.AudioNode.call(this),this._volume=this.output=new s.default.Volume(t.volume),this.volume=this._volume.volume,this._readOnly("volume"),this._scheduledEvents=[]},s.default.extend(s.default.Instrument,s.default.AudioNode),s.default.Instrument.defaults={volume:0},s.default.Instrument.prototype.triggerAttack=s.default.noOp,s.default.Instrument.prototype.triggerRelease=s.default.noOp,s.default.Instrument.prototype.sync=function(){return this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this},s.default.Instrument.prototype._syncMethod=function(t,e){var i=this["_original_"+t]=this[t];this[t]=function(){var t=Array.prototype.slice.call(arguments),n=t[e],o=s.default.Transport.schedule(function(s){t[e]=s,i.apply(this,t)}.bind(this),n);this._scheduledEvents.push(o)}.bind(this)},s.default.Instrument.prototype.unsync=function(){return this._scheduledEvents.forEach(function(t){s.default.Transport.clear(t)}),this._scheduledEvents=[],this._original_triggerAttack&&(this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this},s.default.Instrument.prototype.triggerAttackRelease=function(t,e,i,s){return i=this.toSeconds(i),e=this.toSeconds(e),this.triggerAttack(t,i,s),this.triggerRelease(i+e),this},s.default.Instrument.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._volume.dispose(),this._volume=null,this._writable(["volume"]),this.volume=null,this.unsync(),this._scheduledEvents=null,this},e.default=s.default.Instrument},function(t,e,i){"use strict";i.r(e);var s=i(0);i(7),i(2);s.default.AudioToGain=function(){s.default.SignalBase.call(this),this._norm=this.input=this.output=new s.default.WaveShaper(function(t){return(t+1)/2})},s.default.extend(s.default.AudioToGain,s.default.SignalBase),s.default.AudioToGain.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},e.default=s.default.AudioToGain},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2),i(13),i(89),i(3),i(1);s.default.CrossFade=function(t){s.default.AudioNode.call(this),this.createInsOuts(2,1),this.a=this.input[0]=new s.default.Gain,this.b=this.input[1]=new s.default.Gain,this.fade=new s.default.Signal(s.default.defaultArg(t,.5),s.default.Type.NormalRange),this._equalPowerA=new s.default.EqualPowerGain,this._equalPowerB=new s.default.EqualPowerGain,this._one=this.context.getConstant(1),this._invert=new s.default.Subtract,this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),s.default.connect(this._one,this._invert,0,0),this.fade.connect(this._invert,0,1),this._invert.chain(this._equalPowerA,this.a.gain),this._readOnly("fade")},s.default.extend(s.default.CrossFade,s.default.AudioNode),s.default.CrossFade.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this._one=null,this.a.dispose(),this.a=null,this.b.dispose(),this.b=null,this},e.default=s.default.CrossFade},function(t,e,i){"use strict";i.r(e);var s=i(0);s.default.Timeline=function(){var t=s.default.defaults(arguments,["memory"],s.default.Timeline);s.default.call(this),this._timeline=[],this.memory=t.memory},s.default.extend(s.default.Timeline),s.default.Timeline.defaults={memory:1/0},Object.defineProperty(s.default.Timeline.prototype,"length",{get:function(){return this._timeline.length}}),s.default.Timeline.prototype.add=function(t){if(s.default.isUndef(t.time))throw new Error("Tone.Timeline: events must have a time attribute");t.time=t.time.valueOf();var e=this._search(t.time);if(this._timeline.splice(e+1,0,t),this.length>this.memory){var i=this.length-this.memory;this._timeline.splice(0,i)}return this},s.default.Timeline.prototype.remove=function(t){var e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this},s.default.Timeline.prototype.get=function(t,e){e=s.default.defaultArg(e,"time");var i=this._search(t,e);return-1!==i?this._timeline[i]:null},s.default.Timeline.prototype.peek=function(){return this._timeline[0]},s.default.Timeline.prototype.shift=function(){return this._timeline.shift()},s.default.Timeline.prototype.getAfter=function(t,e){e=s.default.defaultArg(e,"time");var i=this._search(t,e);return i+1<this._timeline.length?this._timeline[i+1]:null},s.default.Timeline.prototype.getBefore=function(t,e){e=s.default.defaultArg(e,"time");var i=this._timeline.length;if(i>0&&this._timeline[i-1][e]<t)return this._timeline[i-1];var n=this._search(t,e);return n-1>=0?this._timeline[n-1]:null},s.default.Timeline.prototype.cancel=function(t){if(this._timeline.length>1){var e=this._search(t);if(e>=0)if(this._timeline[e].time===t){for(var i=e;i>=0&&this._timeline[i].time===t;i--)e=i;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&this._timeline[0].time>=t&&(this._timeline=[]);return this},s.default.Timeline.prototype.cancelBefore=function(t){var e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this},s.default.Timeline.prototype.previousEvent=function(t){var e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null},s.default.Timeline.prototype._search=function(t,e){if(0===this._timeline.length)return-1;e=s.default.defaultArg(e,"time");var i=0,n=this._timeline.length,o=n;if(n>0&&this._timeline[n-1][e]<=t)return n-1;for(;i<o;){var a=Math.floor(i+(o-i)/2),r=this._timeline[a],l=this._timeline[a+1];if(r[e]===t){for(var u=a;u<this._timeline.length;u++){this._timeline[u][e]===t&&(a=u)}return a}if(r[e]<t&&l[e]>t)return a;r[e]>t?o=a:i=a+1}return-1},s.default.Timeline.prototype._iterate=function(t,e,i){e=s.default.defaultArg(e,0),i=s.default.defaultArg(i,this._timeline.length-1),this._timeline.slice(e,i+1).forEach(function(e){t.call(this,e)}.bind(this))},s.default.Timeline.prototype.forEach=function(t){return this._iterate(t),this},s.default.Timeline.prototype.forEachBefore=function(t,e){var i=this._search(t);return-1!==i&&this._iterate(e,0,i),this},s.default.Timeline.prototype.forEachAfter=function(t,e){var i=this._search(t);return this._iterate(e,i+1),this},s.default.Timeline.prototype.forEachBetween=function(t,e,i){var s=this._search(t),n=this._search(e);return-1!==s&&-1!==n?(this._timeline[s].time!==t&&(s+=1),this._timeline[n].time===e&&(n-=1),this._iterate(i,s,n)):-1===s&&this._iterate(i,0,n),this},s.default.Timeline.prototype.forEachFrom=function(t,e){for(var i=this._search(t);i>=0&&this._timeline[i].time>=t;)i--;return this._iterate(e,i+1),this},s.default.Timeline.prototype.forEachAtTime=function(t,e){var i=this._search(t);return-1!==i&&this._iterate(function(i){i.time===t&&e.call(this,i)},0,i),this},s.default.Timeline.prototype.dispose=function(){return s.default.prototype.dispose.call(this),this._timeline=null,this},e.default=s.default.Timeline},function(t,e,i){"use strict";i.r(e);var s=i(0);i(21),i(2);s.default.Monophonic=function(t){t=s.default.defaultArg(t,s.default.Monophonic.defaults),s.default.Instrument.call(this,t),this.portamento=t.portamento},s.default.extend(s.default.Monophonic,s.default.Instrument),s.default.Monophonic.defaults={portamento:0},s.default.Monophonic.prototype.triggerAttack=function(t,e,i){return this.log("triggerAttack",t,e,i),e=this.toSeconds(e),this._triggerEnvelopeAttack(e,i),this.setNote(t,e),this},s.default.Monophonic.prototype.triggerRelease=function(t){return this.log("triggerRelease",t),t=this.toSeconds(t),this._triggerEnvelopeRelease(t),this},s.default.Monophonic.prototype._triggerEnvelopeAttack=function(){},s.default.Monophonic.prototype._triggerEnvelopeRelease=function(){},s.default.Monophonic.prototype.getLevelAtTime=function(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)},s.default.Monophonic.prototype.setNote=function(t,e){if(e=this.toSeconds(e),this.portamento>0&&this.getLevelAtTime(e)>.05){var i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(t,i,e)}else this.frequency.setValueAtTime(t,e);return this},e.default=s.default.Monophonic},function(t,e,i){"use strict";i.r(e);var s=i(0);i(29),i(5),i(2);s.default.Scale=function(t,e){s.default.SignalBase.call(this),this._outputMin=s.default.defaultArg(t,0),this._outputMax=s.default.defaultArg(e,1),this._scale=this.input=new s.default.Multiply(1),this._add=this.output=new s.default.Add(0),this._scale.connect(this._add),this._setRange()},s.default.extend(s.default.Scale,s.default.SignalBase),Object.defineProperty(s.default.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(t){this._outputMin=t,this._setRange()}}),Object.defineProperty(s.default.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(t){this._outputMax=t,this._setRange()}}),s.default.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},s.default.Scale.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},e.default=s.default.Scale},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2),i(3),i(1);s.default.Volume=function(){var t=s.default.defaults(arguments,["volume"],s.default.Volume);s.default.AudioNode.call(this,t),this.output=this.input=new s.default.Gain(t.volume,s.default.Type.Decibels),this._unmutedVolume=t.volume,this.volume=this.output.gain,this._readOnly("volume"),this.mute=t.mute},s.default.extend(s.default.Volume,s.default.AudioNode),s.default.Volume.defaults={volume:0,mute:!1},Object.defineProperty(s.default.Volume.prototype,"mute",{get:function(){return this.volume.value===-1/0},set:function(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}}),s.default.Volume.prototype.dispose=function(){return this.input.dispose(),s.default.AudioNode.prototype.dispose.call(this),this._writable("volume"),this.volume.dispose(),this.volume=null,this},e.default=s.default.Volume},function(t,e,i){"use strict";i.r(e);var s=i(0);i(3),i(30);s.default.Zero=function(){s.default.SignalBase.call(this),this._gain=this.input=this.output=new s.default.Gain,s.default.connect(this.context.getConstant(0),this._gain)},s.default.extend(s.default.Zero,s.default.SignalBase),s.default.Zero.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._gain.dispose(),this._gain=null,this},e.default=s.default.Zero},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2),i(3);s.default.Add=function(t){s.default.Signal.call(this),this.createInsOuts(2,0),this._sum=this.input[0]=this.input[1]=this.output=new s.default.Gain,this._param=this.input[1]=new s.default.Signal(t),this._param.connect(this._sum)},s.default.extend(s.default.Add,s.default.Signal),s.default.Add.prototype.dispose=function(){return s.default.Signal.prototype.dispose.call(this),this._sum.dispose(),this._sum=null,this},e.default=s.default.Add},function(t,e,i){"use strict";i.r(e);var s=i(0);i(1);s.default.SignalBase=function(){s.default.AudioNode.call(this)},s.default.extend(s.default.SignalBase,s.default.AudioNode),s.default.SignalBase.prototype.connect=function(t,e,i){return s.default.Signal&&s.default.Signal===t.constructor||s.default.Param&&s.default.Param===t.constructor?(t._param.cancelScheduledValues(0),t._param.setValueAtTime(0,0),t.overridden=!0):t instanceof AudioParam&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0)),s.default.AudioNode.prototype.connect.call(this,t,e,i),this},e.default=s.default.SignalBase},function(t,e,i){"use strict";i.r(e);var s=i(0);i(47),i(3);s.default.AmplitudeEnvelope=function(){s.default.Envelope.apply(this,arguments),this.input=this.output=new s.default.Gain,this._sig.connect(this.output.gain)},s.default.extend(s.default.AmplitudeEnvelope,s.default.Envelope),s.default.AmplitudeEnvelope.prototype.dispose=function(){return s.default.Envelope.prototype.dispose.call(this),this},e.default=s.default.AmplitudeEnvelope},function(t,e,i){"use strict";i.r(e);var s=i(0);i(11),i(6),i(3),i(1);s.default.BufferSource=function(){var t=s.default.defaults(arguments,["buffer","onload"],s.default.BufferSource);s.default.AudioNode.call(this,t),this.onended=t.onended,this._startTime=-1,this._sourceStarted=!1,this._sourceStopped=!1,this._stopTime=-1,this._gainNode=this.output=new s.default.Gain(0),this._source=this.context.createBufferSource(),s.default.connect(this._source,this._gainNode),this._source.onended=this._onended.bind(this),this._buffer=new s.default.Buffer(t.buffer,t.onload),this.playbackRate=new s.default.Param({param:this._source.playbackRate,units:s.default.Type.Positive,value:t.playbackRate}),this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut,this.curve=t.curve,this._onendedTimeout=-1,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd},s.default.extend(s.default.BufferSource,s.default.AudioNode),s.default.BufferSource.defaults={onended:s.default.noOp,onload:s.default.noOp,loop:!1,loopStart:0,loopEnd:0,fadeIn:0,fadeOut:0,curve:"linear",playbackRate:1},Object.defineProperty(s.default.BufferSource.prototype,"state",{get:function(){return this.getStateAtTime(this.now())}}),s.default.BufferSource.prototype.getStateAtTime=function(t){return t=this.toSeconds(t),-1!==this._startTime&&this._startTime<=t&&(-1===this._stopTime||t<this._stopTime)&&!this._sourceStopped?s.default.State.Started:s.default.State.Stopped},s.default.BufferSource.prototype.start=function(t,e,i,n){this.log("start",t,e,i,n),this.assert(-1===this._startTime,"can only be started once"),this.assert(this.buffer.loaded,"buffer is either not set or not loaded"),this.assert(!this._sourceStopped,"source is already stopped"),t=this.toSeconds(t),e=this.loop?s.default.defaultArg(e,this.loopStart):s.default.defaultArg(e,0),e=this.toSeconds(e),e=Math.max(e,0),n=s.default.defaultArg(n,1);var o=this.toSeconds(this.fadeIn);if(o>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this.curve?this._gainNode.gain.linearRampToValueAtTime(n,t+o):this._gainNode.gain.exponentialApproachValueAtTime(n,t,o)):this._gainNode.gain.setValueAtTime(n,t),this._startTime=t,s.default.isDefined(i)){var a=this.toSeconds(i);a=Math.max(a,0),this.stop(t+a)}if(this.loop){var r=this.loopEnd||this.buffer.duration,l=this.loopStart;e>=r&&(e=(e-l)%(r-l)+l)}return this._source.buffer=this.buffer.get(),this._source.loopEnd=this.loopEnd||this.buffer.duration,e<this.buffer.duration&&(this._sourceStarted=!0,this._source.start(t,e)),this},s.default.BufferSource.prototype.stop=function(t){this.log("stop",t),this.assert(this.buffer.loaded,"buffer is either not set or not loaded"),this.assert(!this._sourceStopped,"source is already stopped"),t=this.toSeconds(t),-1!==this._stopTime&&this.cancelStop();var e=this.toSeconds(this.fadeOut);return this._stopTime=t+e,e>0?"linear"===this.curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),s.default.context.clearTimeout(this._onendedTimeout),this._onendedTimeout=s.default.context.setTimeout(this._onended.bind(this),this._stopTime-this.now()),this},s.default.BufferSource.prototype.cancelStop=function(){if(-1!==this._startTime&&!this._sourceStopped){var t=this.toSeconds(this.fadeIn);this._gainNode.gain.cancelScheduledValues(this._startTime+t+this.sampleTime),this.context.clearTimeout(this._onendedTimeout),this._stopTime=-1}return this},s.default.BufferSource.prototype._onended=function(){if(!this._sourceStopped){this._sourceStopped=!0;var t="exponential"===this.curve?2*this.fadeOut:0;this._sourceStarted&&-1!==this._stopTime&&this._source.stop(this._stopTime+t),this.onended(this),setTimeout(function(){this._source&&(this._source.disconnect(),this._gainNode.disconnect())}.bind(this),1e3*t+100)}},Object.defineProperty(s.default.BufferSource.prototype,"loopStart",{get:function(){return this._source.loopStart},set:function(t){this._source.loopStart=this.toSeconds(t)}}),Object.defineProperty(s.default.BufferSource.prototype,"loopEnd",{get:function(){return this._source.loopEnd},set:function(t){this._source.loopEnd=this.toSeconds(t)}}),Object.defineProperty(s.default.BufferSource.prototype,"buffer",{get:function(){return this._buffer},set:function(t){this._buffer.set(t)}}),Object.defineProperty(s.default.BufferSource.prototype,"loop",{get:function(){return this._source.loop},set:function(t){this._source.loop=t,this.cancelStop()}}),s.default.BufferSource.prototype.dispose=function(){return this._wasDisposed||(this._wasDisposed=!0,s.default.AudioNode.prototype.dispose.call(this),this.onended=null,this._source.onended=null,this._source.disconnect(),this._source=null,this._gainNode.dispose(),this._gainNode=null,this._buffer.dispose(),this._buffer=null,this._startTime=-1,this.playbackRate=null,s.default.context.clearTimeout(this._onendedTimeout)),this},e.default=s.default.BufferSource},function(t,e,i){"use strict";i.r(e);var s=i(0);i(8),i(2),i(5),i(3);s.default.FeedbackEffect=function(){var t=s.default.defaults(arguments,["feedback"],s.default.FeedbackEffect);s.default.Effect.call(this,t),this._feedbackGain=new s.default.Gain(t.feedback,s.default.Type.NormalRange),this.feedback=this._feedbackGain.gain,this.effectReturn.chain(this._feedbackGain,this.effectSend),this._readOnly(["feedback"])},s.default.extend(s.default.FeedbackEffect,s.default.Effect),s.default.FeedbackEffect.defaults={feedback:.125},s.default.FeedbackEffect.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this._writable(["feedback"]),this._feedbackGain.dispose(),this._feedbackGain=null,this.feedback=null,this},e.default=s.default.FeedbackEffect},function(t,e,i){"use strict";i.r(e);var s=i(0);i(24),i(4);s.default.TimelineState=function(t){s.default.Timeline.call(this),this._initial=t},s.default.extend(s.default.TimelineState,s.default.Timeline),s.default.TimelineState.prototype.getValueAtTime=function(t){var e=this.get(t);return null!==e?e.state:this._initial},s.default.TimelineState.prototype.setStateAtTime=function(t,e){return this.add({state:t,time:e}),this},s.default.TimelineState.prototype.getLastState=function(t,e){e=this.toSeconds(e);for(var i=this._search(e);i>=0;i--){var s=this._timeline[i];if(s.state===t)return s}},s.default.TimelineState.prototype.getNextState=function(t,e){e=this.toSeconds(e);var i=this._search(e);if(-1!==i)for(var s=i;s<this._timeline.length;s++){var n=this._timeline[s];if(n.state===t)return n}},e.default=s.default.TimelineState},function(t,e,i){"use strict";i.r(e);var s=i(0);s.default.Emitter=function(){s.default.call(this),this._events={}},s.default.extend(s.default.Emitter),s.default.Emitter.prototype.on=function(t,e){for(var i=t.split(/\W+/),s=0;s<i.length;s++){var n=i[s];this._events.hasOwnProperty(n)||(this._events[n]=[]),this._events[n].push(e)}return this},s.default.Emitter.prototype.once=function(t,e){var i=function(){e.apply(this,arguments),this.off(t,i)}.bind(this);return this.on(t,i),this},s.default.Emitter.prototype.off=function(t,e){for(var i=t.split(/\W+/),n=0;n<i.length;n++)if(t=i[n],this._events.hasOwnProperty(t))if(s.default.isUndef(e))this._events[t]=[];else for(var o=this._events[t],a=0;a<o.length;a++)o[a]===e&&o.splice(a,1);return this},s.default.Emitter.prototype.emit=function(t){if(this._events){var e=Array.apply(null,arguments).slice(1);if(this._events.hasOwnProperty(t))for(var i=this._events[t].slice(0),s=0,n=i.length;s<n;s++)i[s].apply(this,e)}return this},s.default.Emitter.mixin=function(t){var e=["on","once","off","emit"];t._events={};for(var i=0;i<e.length;i++){var n=e[i],o=s.default.Emitter.prototype[n];t[n]=o}return s.default.Emitter},s.default.Emitter.prototype.dispose=function(){return s.default.prototype.dispose.call(this),this._events=null,this},e.default=s.default.Emitter},function(t,e,i){"use strict";i.r(e);var s=i(0);i(1),i(44);s.default.supported&&(AnalyserNode.prototype.getFloatTimeDomainData||(AnalyserNode.prototype.getFloatTimeDomainData=function(t){var e=new Uint8Array(t.length);this.getByteTimeDomainData(e);for(var i=0;i<e.length;i++)t[i]=(e[i]-128)/128})),s.default.Analyser=function(){var t=s.default.defaults(arguments,["type","size"],s.default.Analyser);s.default.AudioNode.call(this),this._analyser=this.input=this.output=this.context.createAnalyser(),this._type=t.type,this._buffer=null,this.size=t.size,this.type=t.type},s.default.extend(s.default.Analyser,s.default.AudioNode),s.default.Analyser.defaults={size:1024,type:"fft",smoothing:.8},s.default.Analyser.Type={Waveform:"waveform",FFT:"fft"},s.default.Analyser.prototype.getValue=function(){return this._type===s.default.Analyser.Type.FFT?this._analyser.getFloatFrequencyData(this._buffer):this._type===s.default.Analyser.Type.Waveform&&this._analyser.getFloatTimeDomainData(this._buffer),this._buffer},Object.defineProperty(s.default.Analyser.prototype,"size",{get:function(){return this._analyser.frequencyBinCount},set:function(t){this._analyser.fftSize=2*t,this._buffer=new Float32Array(t)}}),Object.defineProperty(s.default.Analyser.prototype,"type",{get:function(){return this._type},set:function(t){if(t!==s.default.Analyser.Type.Waveform&&t!==s.default.Analyser.Type.FFT)throw new TypeError("Tone.Analyser: invalid type: "+t);this._type=t}}),Object.defineProperty(s.default.Analyser.prototype,"smoothing",{get:function(){return this._analyser.smoothingTimeConstant},set:function(t){this._analyser.smoothingTimeConstant=t}}),s.default.Analyser.prototype.dispose=function(){s.default.AudioNode.prototype.dispose.call(this),this._analyser.disconnect(),this._analyser=null,this._buffer=null};e.default=s.default.Analyser},function(t,e,i){"use strict";i.r(e);var s=i(0);i(6),i(17),i(50),i(68),i(49),i(67),i(66);s.default.OmniOscillator=function(){var t=s.default.defaults(arguments,["frequency","type"],s.default.OmniOscillator);s.default.Source.call(this,t),this.frequency=new s.default.Signal(t.frequency,s.default.Type.Frequency),this.detune=new s.default.Signal(t.detune,s.default.Type.Cents),this._sourceType=void 0,this._oscillator=null,this.type=t.type,this._readOnly(["frequency","detune"]),this.set(t)},s.default.extend(s.default.OmniOscillator,s.default.Source),s.default.OmniOscillator.defaults={frequency:440,detune:0,type:"sine",phase:0};var n="PulseOscillator",o="PWMOscillator",a="Oscillator",r="FMOscillator",l="AMOscillator",u="FatOscillator";s.default.OmniOscillator.prototype._start=function(t){this._oscillator.start(t)},s.default.OmniOscillator.prototype._stop=function(t){this._oscillator.stop(t)},s.default.OmniOscillator.prototype.restart=function(t){this._oscillator.restart(t)},Object.defineProperty(s.default.OmniOscillator.prototype,"type",{get:function(){var t="";return this._sourceType===r?t="fm":this._sourceType===l?t="am":this._sourceType===u&&(t="fat"),t+this._oscillator.type},set:function(t){"fm"===t.substr(0,2)?(this._createNewOscillator(r),this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator(l),this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator(u),this._oscillator.type=t.substr(3)):"pwm"===t?this._createNewOscillator(o):"pulse"===t?this._createNewOscillator(n):(this._createNewOscillator(a),this._oscillator.type=t)}}),Object.defineProperty(s.default.OmniOscillator.prototype,"partials",{get:function(){return this._oscillator.partials},set:function(t){this._oscillator.partials=t}}),Object.defineProperty(s.default.OmniOscillator.prototype,"partialCount",{get:function(){return this._oscillator.partialCount},set:function(t){this._oscillator.partialCount=t}}),s.default.OmniOscillator.prototype.set=function(t,e){return"type"===t?this.type=e:s.default.isObject(t)&&t.hasOwnProperty("type")&&(this.type=t.type),s.default.prototype.set.apply(this,arguments),this},s.default.OmniOscillator.prototype.get=function(t){var e=this._oscillator.get(t);return e.type=this.type,e},s.default.OmniOscillator.prototype._createNewOscillator=function(t){if(t!==this._sourceType){this._sourceType=t;var e=s.default[t],i=this.now();if(null!==this._oscillator){var n=this._oscillator;n.stop(i),this.context.setTimeout(function(){n.dispose(),n=null},this.blockTime)}this._oscillator=new e,this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this.state===s.default.State.Started&&this._oscillator.start(i)}},Object.defineProperty(s.default.OmniOscillator.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(t){this._oscillator.phase=t}});var f={PulseOscillator:"pulse",PWMOscillator:"pwm",Oscillator:"oscillator",FMOscillator:"fm",AMOscillator:"am",FatOscillator:"fat"};Object.defineProperty(s.default.OmniOscillator.prototype,"sourceType",{get:function(){return f[this._sourceType]},set:function(t){var e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),t===f.FMOscillator?this.type="fm"+e:t===f.AMOscillator?this.type="am"+e:t===f.FatOscillator?this.type="fat"+e:t===f.Oscillator?this.type=e:t===f.PulseOscillator?this.type="pulse":t===f.PWMOscillator&&(this.type="pwm")}}),Object.defineProperty(s.default.OmniOscillator.prototype,"baseType",{get:function(){return this._oscillator.baseType},set:function(t){this.sourceType!==f.PulseOscillator&&this.sourceType!==f.PWMOscillator&&(this._oscillator.baseType=t)}}),Object.defineProperty(s.default.OmniOscillator.prototype,"width",{get:function(){return this._sourceType===n?this._oscillator.width:void 0}}),Object.defineProperty(s.default.OmniOscillator.prototype,"count",{get:function(){return this._sourceType===u?this._oscillator.count:void 0},set:function(t){this._sourceType===u&&(this._oscillator.count=t)}}),Object.defineProperty(s.default.OmniOscillator.prototype,"spread",{get:function(){return this._sourceType===u?this._oscillator.spread:void 0},set:function(t){this._sourceType===u&&(this._oscillator.spread=t)}}),Object.defineProperty(s.default.OmniOscillator.prototype,"modulationType",{get:function(){return this._sourceType===r||this._sourceType===l?this._oscillator.modulationType:void 0},set:function(t){this._sourceType!==r&&this._sourceType!==l||(this._oscillator.modulationType=t)}}),Object.defineProperty(s.default.OmniOscillator.prototype,"modulationIndex",{get:function(){return this._sourceType===r?this._oscillator.modulationIndex:void 0}}),Object.defineProperty(s.default.OmniOscillator.prototype,"harmonicity",{get:function(){return this._sourceType===r||this._sourceType===l?this._oscillator.harmonicity:void 0}}),Object.defineProperty(s.default.OmniOscillator.prototype,"modulationFrequency",{get:function(){return this._sourceType===o?this._oscillator.modulationFrequency:void 0}}),s.default.OmniOscillator.prototype.dispose=function(){return s.default.Source.prototype.dispose.call(this),this._writable(["frequency","detune"]),this.detune.dispose(),this.detune=null,this.frequency.dispose(),this.frequency=null,this._oscillator.dispose(),this._oscillator=null,this._sourceType=null,this},e.default=s.default.OmniOscillator},function(t,e,i){"use strict";i.r(e);var s=i(0);i(31),i(37),i(25);s.default.Synth=function(t){t=s.default.defaultArg(t,s.default.Synth.defaults),s.default.Monophonic.call(this,t),this.oscillator=new s.default.OmniOscillator(t.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new s.default.AmplitudeEnvelope(t.envelope),this.oscillator.chain(this.envelope,this.output),this._readOnly(["oscillator","frequency","detune","envelope"])},s.default.extend(s.default.Synth,s.default.Monophonic),s.default.Synth.defaults={oscillator:{type:"triangle"},envelope:{attack:.005,decay:.1,sustain:.3,release:1}},s.default.Synth.prototype._triggerEnvelopeAttack=function(t,e){return this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain&&this.oscillator.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this},s.default.Synth.prototype._triggerEnvelopeRelease=function(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release)),this},s.default.Synth.prototype.dispose=function(){return s.default.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.frequency=null,this.detune=null,this},e.default=s.default.Synth},function(t,e,i){"use strict";i.r(e);var s=i(0);i(6),i(11),i(32);s.default.Noise=function(){var t=s.default.defaults(arguments,["type"],s.default.Noise);s.default.Source.call(this,t),this._source=null,this._type=t.type,this._playbackRate=t.playbackRate},s.default.extend(s.default.Noise,s.default.Source),s.default.Noise.defaults={type:"white",playbackRate:1},Object.defineProperty(s.default.Noise.prototype,"type",{get:function(){return this._type},set:function(t){if(this._type!==t){if(!(t in n))throw new TypeError("Tone.Noise: invalid type: "+t);if(this._type=t,this.state===s.default.State.Started){var e=this.now();this._stop(e),this._start(e)}}}}),Object.defineProperty(s.default.Noise.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}}),s.default.Noise.prototype._start=function(t){var e=n[this._type];this._source=new s.default.BufferSource(e).connect(this.output),this._source.loop=!0,this._source.playbackRate.value=this._playbackRate,this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))},s.default.Noise.prototype._stop=function(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)},s.default.Noise.prototype.restart=function(t){return this._stop(t),this._start(t),this},s.default.Noise.prototype.dispose=function(){return s.default.Source.prototype.dispose.call(this),null!==this._source&&(this._source.disconnect(),this._source=null),this._buffer=null,this};var n={},o={};Object.defineProperty(n,"pink",{get:function(){if(!o.pink){for(var t=[],e=0;e<2;e++){var i,n,a,r,l,u,f,d=new Float32Array(220500);t[e]=d,i=n=a=r=l=u=f=0;for(var h=0;h<220500;h++){var c=2*Math.random()-1;i=.99886*i+.0555179*c,n=.99332*n+.0750759*c,a=.969*a+.153852*c,r=.8665*r+.3104856*c,l=.55*l+.5329522*c,u=-.7616*u-.016898*c,d[h]=i+n+a+r+l+u+f+.5362*c,d[h]*=.11,f=.115926*c}}o.pink=(new s.default.Buffer).fromArray(t)}return o.pink}}),Object.defineProperty(n,"brown",{get:function(){if(!o.brown){for(var t=[],e=0;e<2;e++){var i=new Float32Array(220500);t[e]=i;for(var n=0,a=0;a<220500;a++){var r=2*Math.random()-1;i[a]=(n+.02*r)/1.02,n=i[a],i[a]*=3.5}}o.brown=(new s.default.Buffer).fromArray(t)}return o.brown}}),Object.defineProperty(n,"white",{get:function(){if(!o.white){for(var t=[],e=0;e<2;e++){var i=new Float32Array(220500);t[e]=i;for(var n=0;n<220500;n++)i[n]=2*Math.random()-1}o.white=(new s.default.Buffer).fromArray(t)}return o.white}}),e.default=s.default.Noise},function(t,e,i){"use strict";i.r(e);var s=i(0);i(27),i(20),i(1);s.default.Master=function(){s.default.AudioNode.call(this),s.default.getContext(function(){this.createInsOuts(1,0),this._volume=this.output=new s.default.Volume,this.volume=this._volume.volume,this._readOnly("volume"),s.default.connectSeries(this.input,this.output,this.context.destination),this.context.master=this}.bind(this))},s.default.extend(s.default.Master,s.default.AudioNode),s.default.Master.defaults={volume:0,mute:!1},s.default.Master.prototype.isMaster=!0,Object.defineProperty(s.default.Master.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}}),s.default.Master.prototype.chain=function(){this.input.disconnect();var t=Array.from(arguments);t.unshift(this.input),t.push(this.output),s.default.connectSeries.apply(void 0,t)},s.default.Master.prototype.dispose=function(){s.default.AudioNode.prototype.dispose.call(this),this._writable("volume"),this._volume.dispose(),this._volume=null,this.volume=null},s.default.AudioNode.prototype.toMaster=function(){return this.connect(this.context.master),this};var n=s.default.Master;s.default.Master=new n,s.default.Context.on("init",function(t){t.master&&t.master.isMaster?s.default.Master=t.master:s.default.Master=new n}),s.default.Context.on("close",function(t){t.master&&t.master.isMaster&&t.master.dispose()}),e.default=s.default.Master},function(t,e,i){"use strict";i.r(e);var s=i(0);i(86),i(47);s.default.FrequencyEnvelope=function(){var t=s.default.defaults(arguments,["attack","decay","sustain","release"],s.default.Envelope);t=s.default.defaultArg(t,s.default.FrequencyEnvelope.defaults),s.default.ScaledEnvelope.call(this,t),this._octaves=t.octaves,this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this.exponent=t.exponent},s.default.extend(s.default.FrequencyEnvelope,s.default.Envelope),s.default.FrequencyEnvelope.defaults={baseFrequency:200,octaves:4,exponent:1},Object.defineProperty(s.default.FrequencyEnvelope.prototype,"baseFrequency",{get:function(){return this._scale.min},set:function(t){this._scale.min=this.toFrequency(t),this.octaves=this._octaves}}),Object.defineProperty(s.default.FrequencyEnvelope.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._scale.max=this.baseFrequency*Math.pow(2,t)}}),Object.defineProperty(s.default.FrequencyEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(t){this._exp.value=t}}),s.default.FrequencyEnvelope.prototype.dispose=function(){return s.default.ScaledEnvelope.prototype.dispose.call(this),this},e.default=s.default.FrequencyEnvelope},function(t,e,i){"use strict";i.r(e);var s=i(0);i(26),i(61);s.default.ScaleExp=function(t,e,i){s.default.SignalBase.call(this),this._scale=this.output=new s.default.Scale(t,e),this._exp=this.input=new s.default.Pow(s.default.defaultArg(i,2)),this._exp.connect(this._scale)},s.default.extend(s.default.ScaleExp,s.default.SignalBase),Object.defineProperty(s.default.ScaleExp.prototype,"exponent",{get:function(){return this._exp.value},set:function(t){this._exp.value=t}}),Object.defineProperty(s.default.ScaleExp.prototype,"min",{get:function(){return this._scale.min},set:function(t){this._scale.min=t}}),Object.defineProperty(s.default.ScaleExp.prototype,"max",{get:function(){return this._scale.max},set:function(t){this._scale.max=t}}),s.default.ScaleExp.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},e.default=s.default.ScaleExp},function(t,e,i){"use strict";i.r(e);var s=i(0);i(14),i(1);s.default.Compressor=function(){var t=s.default.defaults(arguments,["threshold","ratio"],s.default.Compressor);s.default.AudioNode.call(this),this._compressor=this.input=this.output=this.context.createDynamicsCompressor(),this.threshold=new s.default.Param({param:this._compressor.threshold,units:s.default.Type.Decibels,convert:!1}),this.attack=new s.default.Param(this._compressor.attack,s.default.Type.Time),this.release=new s.default.Param(this._compressor.release,s.default.Type.Time),this.knee=new s.default.Param({param:this._compressor.knee,units:s.default.Type.Decibels,convert:!1}),this.ratio=new s.default.Param({param:this._compressor.ratio,convert:!1}),this._readOnly(["knee","release","attack","ratio","threshold"]),this.set(t)},s.default.extend(s.default.Compressor,s.default.AudioNode),s.default.Compressor.defaults={ratio:12,threshold:-24,release:.25,attack:.003,knee:30},s.default.Compressor.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable(["knee","release","attack","ratio","threshold"]),this._compressor.disconnect(),this._compressor=null,this.attack.dispose(),this.attack=null,this.release.dispose(),this.release=null,this.threshold.dispose(),this.threshold=null,this.ratio.dispose(),this.ratio=null,this.knee.dispose(),this.knee=null,this},e.default=s.default.Compressor},function(t,e,i){"use strict";var s=i(0);i(92);if(s.default.supported){!s.default.global.hasOwnProperty("AudioContext")&&s.default.global.hasOwnProperty("webkitAudioContext")&&(s.default.global.AudioContext=s.default.global.webkitAudioContext),AudioContext.prototype.close||(AudioContext.prototype.close=function(){return s.default.isFunction(this.suspend)&&this.suspend(),Promise.resolve()}),AudioContext.prototype.resume||(AudioContext.prototype.resume=function(){var t=this.createBuffer(1,1,this.sampleRate),e=this.createBufferSource();return e.buffer=t,e.connect(this.destination),e.start(0),Promise.resolve()}),!AudioContext.prototype.createGain&&AudioContext.prototype.createGainNode&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),!AudioContext.prototype.createDelay&&AudioContext.prototype.createDelayNode&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode);var n=!1,o=new OfflineAudioContext(1,1,44100),a=new Uint32Array([1179011410,48,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,8,0,0,0,0]).buffer;try{var r=o.decodeAudioData(a);r&&s.default.isFunction(r.then)&&(n=!0)}catch(t){n=!1}n||(AudioContext.prototype._native_decodeAudioData=AudioContext.prototype.decodeAudioData,AudioContext.prototype.decodeAudioData=function(t){return new Promise(function(e,i){this._native_decodeAudioData(t,e,i)}.bind(this))})}},function(t,e,i){"use strict";i.r(e);var s=i(0);i(63);s.default.TransportTime=function(t,e){if(!(this instanceof s.default.TransportTime))return new s.default.TransportTime(t,e);s.default.Time.call(this,t,e)},s.default.extend(s.default.TransportTime,s.default.Time),s.default.TransportTime.prototype._now=function(){return s.default.Transport.seconds},e.default=s.default.TransportTime},function(t,e,i){"use strict";i.r(e);var s=i(0);i(62);s.default.Frequency=function(t,e){if(!(this instanceof s.default.Frequency))return new s.default.Frequency(t,e);s.default.TimeBase.call(this,t,e)},s.default.extend(s.default.Frequency,s.default.TimeBase),s.default.Frequency.prototype._expressions=Object.assign({},s.default.TimeBase.prototype._expressions,{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method:function(t){return"midi"===this._defaultUnits?t:s.default.Frequency.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(t,e){var i=n[t.toLowerCase()]+12*(parseInt(e)+1);return"midi"===this._defaultUnits?i:s.default.Frequency.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,i){var s=1;return t&&"0"!==t&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(s*=this._beatsToUnits(parseFloat(e))),i&&"0"!==i&&(s*=this._beatsToUnits(parseFloat(i)/4)),s}}}),s.default.Frequency.prototype.transpose=function(t){return new this.constructor(this.valueOf()*s.default.intervalToFrequencyRatio(t))},s.default.Frequency.prototype.harmonize=function(t){return t.map(function(t){return this.transpose(t)}.bind(this))},s.default.Frequency.prototype.toMidi=function(){return s.default.Frequency.ftom(this.valueOf())},s.default.Frequency.prototype.toNote=function(){var t=this.toFrequency(),e=Math.log2(t/s.default.Frequency.A4),i=Math.round(12*e)+57,n=Math.floor(i/12);return n<0&&(i+=-12*n),o[i%12]+n.toString()},s.default.Frequency.prototype.toSeconds=function(){return 1/s.default.TimeBase.prototype.toSeconds.call(this)},s.default.Frequency.prototype.toFrequency=function(){return s.default.TimeBase.prototype.toFrequency.call(this)},s.default.Frequency.prototype.toTicks=function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*s.default.Transport.PPQ)},s.default.Frequency.prototype._noArg=function(){return 0},s.default.Frequency.prototype._frequencyToUnits=function(t){return t},s.default.Frequency.prototype._ticksToUnits=function(t){return 1/(60*t/(s.default.Transport.bpm.value*s.default.Transport.PPQ))},s.default.Frequency.prototype._beatsToUnits=function(t){return 1/s.default.TimeBase.prototype._beatsToUnits.call(this,t)},s.default.Frequency.prototype._secondsToUnits=function(t){return 1/t},s.default.Frequency.prototype._defaultUnits="hz";var n={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},o=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];s.default.Frequency.A4=440,s.default.Frequency.mtof=function(t){return s.default.Frequency.A4*Math.pow(2,(t-69)/12)},s.default.Frequency.ftom=function(t){return 69+Math.round(12*Math.log2(t/s.default.Frequency.A4))},e.default=s.default.Frequency},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2),i(61),i(4),i(1);s.default.Envelope=function(){var t=s.default.defaults(arguments,["attack","decay","sustain","release"],s.default.Envelope);s.default.AudioNode.call(this),this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this._attackCurve="linear",this._releaseCurve="exponential",this._sig=this.output=new s.default.Signal(0),this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve},s.default.extend(s.default.Envelope,s.default.AudioNode),s.default.Envelope.defaults={attack:.01,decay:.1,sustain:.5,release:1,attackCurve:"linear",decayCurve:"exponential",releaseCurve:"exponential"},Object.defineProperty(s.default.Envelope.prototype,"value",{get:function(){return this.getValueAtTime(this.now())}}),s.default.Envelope.prototype._getCurve=function(t,e){if(s.default.isString(t))return t;if(s.default.isArray(t))for(var i in s.default.Envelope.Type)if(s.default.Envelope.Type[i][e]===t)return i},s.default.Envelope.prototype._setCurve=function(t,e,i){if(s.default.Envelope.Type.hasOwnProperty(i)){var n=s.default.Envelope.Type[i];s.default.isObject(n)?this[t]=n[e]:this[t]=n}else{if(!s.default.isArray(i))throw new Error("Tone.Envelope: invalid curve: "+i);this[t]=i}},Object.defineProperty(s.default.Envelope.prototype,"attackCurve",{get:function(){return this._getCurve(this._attackCurve,"In")},set:function(t){this._setCurve("_attackCurve","In",t)}}),Object.defineProperty(s.default.Envelope.prototype,"releaseCurve",{get:function(){return this._getCurve(this._releaseCurve,"Out")},set:function(t){this._setCurve("_releaseCurve","Out",t)}}),Object.defineProperty(s.default.Envelope.prototype,"decayCurve",{get:function(){return this._decayCurve},set:function(t){if(!["linear","exponential"].includes(t))throw new Error("Tone.Envelope: invalid curve: "+t);this._decayCurve=t}}),s.default.Envelope.prototype.triggerAttack=function(t,e){this.log("triggerAttack",t,e),t=this.toSeconds(t);var i=this.toSeconds(this.attack),n=this.toSeconds(this.decay);e=s.default.defaultArg(e,1);var o=this.getValueAtTime(t);o>0&&(i=(1-o)/(1/i));if(0===i)this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,i,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,i,t);else if(i>0){this._sig.cancelAndHoldAtTime(t);for(var a=this._attackCurve,r=1;r<a.length;r++)if(a[r-1]<=o&&o<=a[r]){(a=this._attackCurve.slice(r))[0]=o;break}this._sig.setValueCurveAtTime(a,t,i,e)}if(n){var l=e*this.sustain,u=t+i;this.log("decay",u),"linear"===this._decayCurve?this._sig.linearRampTo(l,n,u+this.sampleTime):"exponential"===this._decayCurve&&this._sig.exponentialApproachValueAtTime(l,u,n)}return this},s.default.Envelope.prototype.triggerRelease=function(t){this.log("triggerRelease",t),t=this.toSeconds(t);var e=this.getValueAtTime(t);if(e>0){var i=this.toSeconds(this.release);if("linear"===this._releaseCurve)this._sig.linearRampTo(0,i,t);else if("exponential"===this._releaseCurve)this._sig.targetRampTo(0,i,t);else{var n=this._releaseCurve;s.default.isArray(n)&&(this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(n,t,i,e))}}return this},s.default.Envelope.prototype.getValueAtTime=function(t){return this._sig.getValueAtTime(t)},s.default.Envelope.prototype.triggerAttackRelease=function(t,e,i){return e=this.toSeconds(e),this.triggerAttack(e,i),this.triggerRelease(e+this.toSeconds(t)),this},s.default.Envelope.prototype.cancel=function(t){return this._sig.cancelScheduledValues(t),this},s.default.Envelope.prototype.connect=s.default.SignalBase.prototype.connect,function(){var t,e,i=[];for(t=0;t<128;t++)i[t]=Math.sin(t/127*(Math.PI/2));var n=[];for(t=0;t<127;t++){e=t/127;var o=Math.sin(e*(2*Math.PI)*6.4-Math.PI/2)+1;n[t]=o/10+.83*e}n[127]=1;var a=[];for(t=0;t<128;t++)a[t]=Math.ceil(t/127*5)/5;var r=[];for(t=0;t<128;t++)e=t/127,r[t]=.5*(1-Math.cos(Math.PI*e));var l,u=[];for(t=0;t<128;t++){e=t/127;var f=4*Math.pow(e,3)+.2,d=Math.cos(f*Math.PI*2*e);u[t]=Math.abs(d*(1-e))}function h(t){for(var e=new Array(t.length),i=0;i<t.length;i++)e[i]=1-t[i];return e}s.default.Envelope.Type={linear:"linear",exponential:"exponential",bounce:{In:h(u),Out:u},cosine:{In:i,Out:(l=i,l.slice(0).reverse())},step:{In:a,Out:h(a)},ripple:{In:n,Out:h(n)},sine:{In:r,Out:h(r)}}}(),s.default.Envelope.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._sig.dispose(),this._sig=null,this._attackCurve=null,this._releaseCurve=null,this},e.default=s.default.Envelope},function(t,e,i){"use strict";i.r(e);var s=i(0);i(23),i(10),i(19),i(7),i(28),i(3),i(2),i(20);if(s.default.supported&&!s.default.global.AudioContext.prototype.createStereoPanner){var n=function(t){this.context=t,this.pan=new s.default.Signal(0,s.default.Type.AudioRange);var e=new s.default.WaveShaper(function(t){return s.default.equalPowerScale((t+1)/2)},4096),i=new s.default.WaveShaper(function(t){return s.default.equalPowerScale(1-(t+1)/2)},4096),n=new s.default.Gain,o=new s.default.Gain,a=this.input=new s.default.Split;a._splitter.channelCountMode="explicit",(new s.default.Zero).fan(e,i);var r=this.output=new s.default.Merge;a.left.chain(n,r.left),a.right.chain(o,r.right),this.pan.chain(i,n.gain),this.pan.chain(e,o.gain)};n.prototype.disconnect=function(){this.output.disconnect.apply(this.output,arguments)},n.prototype.connect=function(){this.output.connect.apply(this.output,arguments)},AudioContext.prototype.createStereoPanner=function(){return new n(this)},s.default.Context.prototype.createStereoPanner=function(){return new n(this)}}i(22),i(1);s.default.Panner=function(){var t=s.default.defaults(arguments,["pan"],s.default.Panner);s.default.AudioNode.call(this),this._panner=this.input=this.output=this.context.createStereoPanner(),this.pan=this._panner.pan,this.pan.value=t.pan,this._readOnly("pan")},s.default.extend(s.default.Panner,s.default.AudioNode),s.default.Panner.defaults={pan:0},s.default.Panner.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable("pan"),this._panner.disconnect(),this._panner=null,this.pan=null,this};e.default=s.default.Panner},function(t,e,i){"use strict";i.r(e);var s=i(0);i(6),i(17),i(5),i(3);s.default.FMOscillator=function(){var t=s.default.defaults(arguments,["frequency","type","modulationType"],s.default.FMOscillator);s.default.Source.call(this,t),this._carrier=new s.default.Oscillator(t.frequency,t.type),this.frequency=new s.default.Signal(t.frequency,s.default.Type.Frequency),this.detune=this._carrier.detune,this.detune.value=t.detune,this.modulationIndex=new s.default.Multiply(t.modulationIndex),this.modulationIndex.units=s.default.Type.Positive,this._modulator=new s.default.Oscillator(t.frequency,t.modulationType),this.harmonicity=new s.default.Multiply(t.harmonicity),this.harmonicity.units=s.default.Type.Positive,this._modulationNode=new s.default.Gain(0),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),this.phase=t.phase,this._readOnly(["modulationIndex","frequency","detune","harmonicity"])},s.default.extend(s.default.FMOscillator,s.default.Source),s.default.FMOscillator.defaults={frequency:440,detune:0,phase:0,type:"sine",modulationIndex:2,modulationType:"square",harmonicity:1},s.default.FMOscillator.prototype._start=function(t){this._modulator.start(t),this._carrier.start(t)},s.default.FMOscillator.prototype._stop=function(t){this._modulator.stop(t),this._carrier.stop(t)},s.default.FMOscillator.prototype.restart=function(t){this._modulator.restart(t),this._carrier.restart(t)},Object.defineProperty(s.default.FMOscillator.prototype,"type",{get:function(){return this._carrier.type},set:function(t){this._carrier.type=t}}),Object.defineProperty(s.default.FMOscillator.prototype,"baseType",{get:function(){return this._carrier.baseType},set:function(t){this._carrier.baseType=t}}),Object.defineProperty(s.default.FMOscillator.prototype,"partialCount",{get:function(){return this._carrier.partialCount},set:function(t){this._carrier.partialCount=t}}),Object.defineProperty(s.default.FMOscillator.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(t){this._modulator.type=t}}),Object.defineProperty(s.default.FMOscillator.prototype,"phase",{get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t}}),Object.defineProperty(s.default.FMOscillator.prototype,"partials",{get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t}}),s.default.FMOscillator.prototype.dispose=function(){return s.default.Source.prototype.dispose.call(this),this._writable(["modulationIndex","frequency","detune","harmonicity"]),this.frequency.dispose(),this.frequency=null,this.detune=null,this.harmonicity.dispose(),this.harmonicity=null,this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this._modulationNode.dispose(),this._modulationNode=null,this.modulationIndex.dispose(),this.modulationIndex=null,this},e.default=s.default.FMOscillator},function(t,e,i){"use strict";i.r(e);var s=i(0);i(6),i(17),i(2),i(7),i(3);s.default.PulseOscillator=function(){var t=s.default.defaults(arguments,["frequency","width"],s.default.Oscillator);s.default.Source.call(this,t),this.width=new s.default.Signal(t.width,s.default.Type.NormalRange),this._widthGate=new s.default.Gain(0),this._sawtooth=new s.default.Oscillator({frequency:t.frequency,detune:t.detune,type:"sawtooth",phase:t.phase}),this.frequency=this._sawtooth.frequency,this.detune=this._sawtooth.detune,this._thresh=new s.default.WaveShaper(function(t){return t<0?-1:1}),this._sawtooth.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),this._readOnly(["width","frequency","detune"])},s.default.extend(s.default.PulseOscillator,s.default.Source),s.default.PulseOscillator.defaults={frequency:440,detune:0,phase:0,width:.2},s.default.PulseOscillator.prototype._start=function(t){t=this.toSeconds(t),this._sawtooth.start(t),this._widthGate.gain.setValueAtTime(1,t)},s.default.PulseOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._sawtooth.stop(t),this._widthGate.gain.setValueAtTime(0,t)},s.default.PulseOscillator.prototype.restart=function(t){this._sawtooth.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)},Object.defineProperty(s.default.PulseOscillator.prototype,"phase",{get:function(){return this._sawtooth.phase},set:function(t){this._sawtooth.phase=t}}),Object.defineProperty(s.default.PulseOscillator.prototype,"type",{get:function(){return"pulse"}}),Object.defineProperty(s.default.PulseOscillator.prototype,"baseType",{get:function(){return"pulse"}}),Object.defineProperty(s.default.PulseOscillator.prototype,"partials",{get:function(){return[]}}),s.default.PulseOscillator.prototype.dispose=function(){return s.default.Source.prototype.dispose.call(this),this._sawtooth.dispose(),this._sawtooth=null,this._writable(["width","frequency","detune"]),this.width.dispose(),this.width=null,this._widthGate.dispose(),this._widthGate=null,this._thresh.dispose(),this._thresh=null,this.frequency=null,this.detune=null,this},e.default=s.default.PulseOscillator},function(t,e,i){"use strict";i.r(e);var s=i(0);i(16),i(4),i(34);s.default.Event=function(){var t=s.default.defaults(arguments,["callback","value"],s.default.Event);s.default.call(this),this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._state=new s.default.TimelineState(s.default.State.Stopped),this._playbackRate=1,this._startOffset=0,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate},s.default.extend(s.default.Event),s.default.Event.defaults={callback:s.default.noOp,loop:!1,loopEnd:"1m",loopStart:0,playbackRate:1,value:null,probability:1,mute:!1,humanize:!1},s.default.Event.prototype._rescheduleEvents=function(t){return t=s.default.defaultArg(t,-1),this._state.forEachFrom(t,function(t){var e;if(t.state===s.default.State.Started){s.default.isDefined(t.id)&&s.default.Transport.clear(t.id);var i=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||s.default.isNumber(this._loop)&&this._loop>1){e=1/0,s.default.isNumber(this._loop)&&(e=this._loop*this._getLoopDuration());var n=this._state.getAfter(i);null!==n&&(e=Math.min(e,n.time-i)),e!==1/0&&(this._state.setStateAtTime(s.default.State.Stopped,i+e+1),e=s.default.Ticks(e));var o=s.default.Ticks(this._getLoopDuration());t.id=s.default.Transport.scheduleRepeat(this._tick.bind(this),o,s.default.Ticks(i),e)}else t.id=s.default.Transport.schedule(this._tick.bind(this),s.default.Ticks(i))}}.bind(this)),this},Object.defineProperty(s.default.Event.prototype,"state",{get:function(){return this._state.getValueAtTime(s.default.Transport.ticks)}}),Object.defineProperty(s.default.Event.prototype,"startOffset",{get:function(){return this._startOffset},set:function(t){this._startOffset=t}}),Object.defineProperty(s.default.Event.prototype,"probability",{get:function(){return this._probability},set:function(t){this._probability=t}}),Object.defineProperty(s.default.Event.prototype,"humanize",{get:function(){return this._humanize},set:function(t){this._humanize=t}}),s.default.Event.prototype.start=function(t){return t=this.toTicks(t),this._state.getValueAtTime(t)===s.default.State.Stopped&&(this._state.add({state:s.default.State.Started,time:t,id:void 0}),this._rescheduleEvents(t)),this},s.default.Event.prototype.stop=function(t){if(this.cancel(t),t=this.toTicks(t),this._state.getValueAtTime(t)===s.default.State.Started){this._state.setStateAtTime(s.default.State.Stopped,t);var e=this._state.getBefore(t),i=t;null!==e&&(i=e.time),this._rescheduleEvents(i)}return this},s.default.Event.prototype.cancel=function(t){return t=s.default.defaultArg(t,-1/0),t=this.toTicks(t),this._state.forEachFrom(t,function(t){s.default.Transport.clear(t.id)}),this._state.cancel(t),this},s.default.Event.prototype._tick=function(t){var e=s.default.Transport.getTicksAtTime(t);if(!this.mute&&this._state.getValueAtTime(e)===s.default.State.Started){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){var i=.02;s.default.isBoolean(this.humanize)||(i=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*i}this.callback(t,this.value)}},s.default.Event.prototype._getLoopDuration=function(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)},Object.defineProperty(s.default.Event.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._rescheduleEvents()}}),Object.defineProperty(s.default.Event.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._rescheduleEvents()}}),Object.defineProperty(s.default.Event.prototype,"loopEnd",{get:function(){return s.default.Ticks(this._loopEnd).toSeconds()},set:function(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}}),Object.defineProperty(s.default.Event.prototype,"loopStart",{get:function(){return s.default.Ticks(this._loopStart).toSeconds()},set:function(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}}),Object.defineProperty(s.default.Event.prototype,"progress",{get:function(){if(this._loop){var t=s.default.Transport.ticks,e=this._state.get(t);if(null!==e&&e.state===s.default.State.Started){var i=this._getLoopDuration();return(t-e.time)%i/i}return 0}return 0}}),s.default.Event.prototype.dispose=function(){this.cancel(),this._state.dispose(),this._state=null,this.callback=null,this.value=null},e.default=s.default.Event},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2),i(13),i(29),i(10),i(3),i(1);s.default.MidSideMerge=function(){s.default.AudioNode.call(this),this.createInsOuts(2,0),this.mid=this.input[0]=new s.default.Gain,this._left=new s.default.Add,this._timesTwoLeft=new s.default.Multiply(Math.SQRT1_2),this.side=this.input[1]=new s.default.Gain,this._right=new s.default.Subtract,this._timesTwoRight=new s.default.Multiply(Math.SQRT1_2),this._merge=this.output=new s.default.Merge,this.mid.connect(this._left,0,0),this.side.connect(this._left,0,1),this.mid.connect(this._right,0,0),this.side.connect(this._right,0,1),this._left.connect(this._timesTwoLeft),this._right.connect(this._timesTwoRight),this._timesTwoLeft.connect(this._merge,0,0),this._timesTwoRight.connect(this._merge,0,1)},s.default.extend(s.default.MidSideMerge,s.default.AudioNode),s.default.MidSideMerge.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._left.dispose(),this._left=null,this._timesTwoLeft.dispose(),this._timesTwoLeft=null,this._right.dispose(),this._right=null,this._timesTwoRight.dispose(),this._timesTwoRight=null,this._merge.dispose(),this._merge=null,this},e.default=s.default.MidSideMerge},function(t,e,i){"use strict";i.r(e);var s=i(0);i(29),i(13),i(2),i(19),i(1);s.default.MidSideSplit=function(){s.default.AudioNode.call(this),this.createInsOuts(0,2),this._split=this.input=new s.default.Split,this._midAdd=new s.default.Add,this.mid=this.output[0]=new s.default.Multiply(Math.SQRT1_2),this._sideSubtract=new s.default.Subtract,this.side=this.output[1]=new s.default.Multiply(Math.SQRT1_2),this._split.connect(this._midAdd,0,0),this._split.connect(this._midAdd,1,1),this._split.connect(this._sideSubtract,0,0),this._split.connect(this._sideSubtract,1,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)},s.default.extend(s.default.MidSideSplit,s.default.AudioNode),s.default.MidSideSplit.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._midAdd.dispose(),this._midAdd=null,this._sideSubtract.dispose(),this._sideSubtract=null,this._split.dispose(),this._split=null,this},e.default=s.default.MidSideSplit},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2),i(9),i(1),i(59);s.default.LowpassCombFilter=function(){var t=s.default.defaults(arguments,["delayTime","resonance","dampening"],s.default.LowpassCombFilter);s.default.AudioNode.call(this),this._combFilter=this.output=new s.default.FeedbackCombFilter(t.delayTime,t.resonance),this.delayTime=this._combFilter.delayTime,this._lowpass=this.input=new s.default.Filter({frequency:t.dampening,type:"lowpass",Q:0,rolloff:-12}),this.dampening=this._lowpass.frequency,this.resonance=this._combFilter.resonance,this._lowpass.connect(this._combFilter),this._readOnly(["dampening","resonance","delayTime"])},s.default.extend(s.default.LowpassCombFilter,s.default.AudioNode),s.default.LowpassCombFilter.defaults={delayTime:.1,resonance:.5,dampening:3e3},s.default.LowpassCombFilter.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable(["dampening","resonance","delayTime"]),this._combFilter.dispose(),this._combFilter=null,this.resonance=null,this.delayTime=null,this._lowpass.dispose(),this._lowpass=null,this.dampening=null,this},e.default=s.default.LowpassCombFilter},function(t,e,i){"use strict";i.r(e);var s=i(0);i(45);s.default.Ticks=function(t,e){if(!(this instanceof s.default.Ticks))return new s.default.Ticks(t,e);s.default.TransportTime.call(this,t,e)},s.default.extend(s.default.Ticks,s.default.TransportTime),s.default.Ticks.prototype._defaultUnits="i",s.default.Ticks.prototype._now=function(){return s.default.Transport.ticks},s.default.Ticks.prototype._beatsToUnits=function(t){return this._getPPQ()*t},s.default.Ticks.prototype._secondsToUnits=function(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())},s.default.Ticks.prototype._ticksToUnits=function(t){return t},s.default.Ticks.prototype.toTicks=function(){return this.valueOf()},s.default.Ticks.prototype.toSeconds=function(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())},e.default=s.default.Ticks},function(t,e,i){"use strict";i.r(e);var s=i(0);i(55);s.default.TransportEvent=function(t,e){e=s.default.defaultArg(e,s.default.TransportEvent.defaults),s.default.call(this),this.Transport=t,this.id=s.default.TransportEvent._eventId++,this.time=s.default.Ticks(e.time),this.callback=e.callback,this._once=e.once},s.default.extend(s.default.TransportEvent),s.default.TransportEvent.defaults={once:!1,callback:s.default.noOp},s.default.TransportEvent._eventId=0,s.default.TransportEvent.prototype.invoke=function(t){this.callback&&(this.callback(t),this._once&&this.Transport&&this.Transport.clear(this.id))},s.default.TransportEvent.prototype.dispose=function(){return s.default.prototype.dispose.call(this),this.Transport=null,this.callback=null,this.time=null,this},e.default=s.default.TransportEvent},function(t,e,i){"use strict";i.r(e);var s=i(0);i(82),i(34),i(24),i(14);s.default.TickSource=function(){var t=s.default.defaults(arguments,["frequency"],s.default.TickSource);this.frequency=new s.default.TickSignal(t.frequency),this._readOnly("frequency"),this._state=new s.default.TimelineState(s.default.State.Stopped),this._state.setStateAtTime(s.default.State.Stopped,0),this._tickOffset=new s.default.Timeline,this.setTicksAtTime(0,0)},s.default.extend(s.default.TickSource),s.default.TickSource.defaults={frequency:1},Object.defineProperty(s.default.TickSource.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),s.default.TickSource.prototype.start=function(t,e){return t=this.toSeconds(t),this._state.getValueAtTime(t)!==s.default.State.Started&&(this._state.setStateAtTime(s.default.State.Started,t),s.default.isDefined(e)&&this.setTicksAtTime(e,t)),this},s.default.TickSource.prototype.stop=function(t){if(t=this.toSeconds(t),this._state.getValueAtTime(t)===s.default.State.Stopped){var e=this._state.get(t);e.time>0&&(this._tickOffset.cancel(e.time),this._state.cancel(e.time))}return this._state.cancel(t),this._state.setStateAtTime(s.default.State.Stopped,t),this.setTicksAtTime(0,t),this},s.default.TickSource.prototype.pause=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)===s.default.State.Started&&this._state.setStateAtTime(s.default.State.Paused,t),this},s.default.TickSource.prototype.cancel=function(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this},s.default.TickSource.prototype.getTicksAtTime=function(t){t=this.toSeconds(t);var e=this._state.getLastState(s.default.State.Stopped,t),i={state:s.default.State.Paused,time:t};this._state.add(i);var n=e,o=0;return this._state.forEachBetween(e.time,t+this.sampleTime,function(t){var e=n.time,i=this._tickOffset.get(t.time);i.time>=n.time&&(o=i.ticks,e=i.time),n.state===s.default.State.Started&&t.state!==s.default.State.Started&&(o+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),n=t}.bind(this)),this._state.remove(i),o},Object.defineProperty(s.default.TickSource.prototype,"ticks",{get:function(){return this.getTicksAtTime(this.now())},set:function(t){this.setTicksAtTime(t,this.now())}}),Object.defineProperty(s.default.TickSource.prototype,"seconds",{get:function(){return this.getSecondsAtTime(this.now())},set:function(t){var e=this.now(),i=this.frequency.timeToTicks(t,e);this.setTicksAtTime(i,e)}}),s.default.TickSource.prototype.getSecondsAtTime=function(t){t=this.toSeconds(t);var e=this._state.getLastState(s.default.State.Stopped,t),i={state:s.default.State.Paused,time:t};this._state.add(i);var n=e,o=0;return this._state.forEachBetween(e.time,t+this.sampleTime,function(t){var e=n.time,i=this._tickOffset.get(t.time);i.time>=n.time&&(o=i.seconds,e=i.time),n.state===s.default.State.Started&&t.state!==s.default.State.Started&&(o+=t.time-e),n=t}.bind(this)),this._state.remove(i),o},s.default.TickSource.prototype.setTicksAtTime=function(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({time:e,ticks:t,seconds:this.frequency.getDurationOfTicks(t,e)}),this},s.default.TickSource.prototype.getStateAtTime=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)},s.default.TickSource.prototype.getTimeOfTick=function(t,e){e=s.default.defaultArg(e,this.now());var i=this._tickOffset.get(e),n=this._state.get(e),o=Math.max(i.time,n.time),a=this.frequency.getTicksAtTime(o)+t-i.ticks;return this.frequency.getTimeOfTick(a)},s.default.TickSource.prototype.forEachTickBetween=function(t,e,i){var n=this._state.get(t);if(this._state.forEachBetween(t,e,function(e){n.state===s.default.State.Started&&e.state!==s.default.State.Started&&this.forEachTickBetween(Math.max(n.time,t),e.time-this.sampleTime,i),n=e}.bind(this)),t=Math.max(n.time,t),n.state===s.default.State.Started&&this._state){var o=this.frequency.getTicksAtTime(t),a=(o-this.frequency.getTicksAtTime(n.time))%1;0!==a&&(a=1-a);for(var r=this.frequency.getTimeOfTick(o+a),l=null;r<e&&this._state;){try{i(r,Math.round(this.getTicksAtTime(r)))}catch(t){l=t;break}this._state&&(r+=this.frequency.getDurationOfTicks(1,r))}}if(l)throw l;return this},s.default.TickSource.prototype.dispose=function(){return s.default.Param.prototype.dispose.call(this),this._state.dispose(),this._state=null,this._tickOffset.dispose(),this._tickOffset=null,this._writable("frequency"),this.frequency.dispose(),this.frequency=null,this},e.default=s.default.TickSource},function(t,e,i){"use strict";i.r(e);var s=i(0);i(87),i(13),i(2),i(4),i(18),i(1);s.default.Follower=function(){var t=s.default.defaults(arguments,["smoothing"],s.default.Follower);s.default.AudioNode.call(this),this.createInsOuts(1,1),this._abs=new s.default.Abs,this._filter=this.context.createBiquadFilter(),this._filter.type="lowpass",this._filter.frequency.value=0,this._filter.Q.value=0,this._sub=new s.default.Subtract,this._delay=new s.default.Delay(this.blockTime),this._smoothing=t.smoothing,s.default.connect(this.input,this._delay),s.default.connect(this.input,this._sub,0,1),this._sub.chain(this._abs,this._filter,this.output),this.smoothing=t.smoothing},s.default.extend(s.default.Follower,s.default.AudioNode),s.default.Follower.defaults={smoothing:.05},Object.defineProperty(s.default.Follower.prototype,"smoothing",{get:function(){return this._smoothing},set:function(t){this._smoothing=t,this._filter.frequency.value=.5*s.default.Time(t).toFrequency()}}),s.default.Follower.prototype.connect=s.default.SignalBase.prototype.connect,s.default.Follower.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._filter.disconnect(),this._filter=null,this._delay.dispose(),this._delay=null,this._sub.disconnect(),this._sub=null,this._abs.dispose(),this._abs=null,this},e.default=s.default.Follower},function(t,e,i){"use strict";i.r(e);var s=i(0);i(42),i(2),i(14),i(18),i(3),i(1);s.default.FeedbackCombFilter=function(){var t=s.default.defaults(arguments,["delayTime","resonance"],s.default.FeedbackCombFilter);s.default.AudioNode.call(this),this._delay=this.input=this.output=new s.default.Delay(t.delayTime),this.delayTime=this._delay.delayTime,this._feedback=new s.default.Gain(t.resonance,s.default.Type.NormalRange),this.resonance=this._feedback.gain,this._delay.chain(this._feedback,this._delay),this._readOnly(["resonance","delayTime"])},s.default.extend(s.default.FeedbackCombFilter,s.default.AudioNode),s.default.FeedbackCombFilter.defaults={delayTime:.1,resonance:.5},s.default.FeedbackCombFilter.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable(["resonance","delayTime"]),this._delay.dispose(),this._delay=null,this.delayTime=null,this._feedback.dispose(),this._feedback=null,this.resonance=null,this},e.default=s.default.FeedbackCombFilter},function(t,e,i){"use strict";i.r(e);var s=i(0);i(9),i(2),i(3),i(1);s.default.MultibandSplit=function(){var t=s.default.defaults(arguments,["lowFrequency","highFrequency"],s.default.MultibandSplit);s.default.AudioNode.call(this),this.input=new s.default.Gain,this.output=new Array(3),this.low=this.output[0]=new s.default.Filter(0,"lowpass"),this._lowMidFilter=new s.default.Filter(0,"highpass"),this.mid=this.output[1]=new s.default.Filter(0,"lowpass"),this.high=this.output[2]=new s.default.Filter(0,"highpass"),this.lowFrequency=new s.default.Signal(t.lowFrequency,s.default.Type.Frequency),this.highFrequency=new s.default.Signal(t.highFrequency,s.default.Type.Frequency),this.Q=new s.default.Signal(t.Q),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.connect(this.low.frequency),this.lowFrequency.connect(this._lowMidFilter.frequency),this.highFrequency.connect(this.mid.frequency),this.highFrequency.connect(this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},s.default.extend(s.default.MultibandSplit,s.default.AudioNode),s.default.MultibandSplit.defaults={lowFrequency:400,highFrequency:2500,Q:1},s.default.MultibandSplit.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.low=null,this._lowMidFilter.dispose(),this._lowMidFilter=null,this.mid.dispose(),this.mid=null,this.high.dispose(),this.high=null,this.lowFrequency.dispose(),this.lowFrequency=null,this.highFrequency.dispose(),this.highFrequency=null,this.Q.dispose(),this.Q=null,this},e.default=s.default.MultibandSplit},function(t,e,i){"use strict";i.r(e);var s=i(0);i(7);s.default.Pow=function(t){s.default.SignalBase.call(this),this._exp=s.default.defaultArg(t,1),this._expScaler=this.input=this.output=new s.default.WaveShaper(this._expFunc(this._exp),8192)},s.default.extend(s.default.Pow,s.default.SignalBase),Object.defineProperty(s.default.Pow.prototype,"value",{get:function(){return this._exp},set:function(t){this._exp=t,this._expScaler.setMap(this._expFunc(this._exp))}}),s.default.Pow.prototype._expFunc=function(t){return function(e){return Math.pow(Math.abs(e),t)}},s.default.Pow.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},e.default=s.default.Pow},function(t,e,i){"use strict";i.r(e);var s=i(0);s.default.TimeBase=function(t,e){if(!(this instanceof s.default.TimeBase))return new s.default.TimeBase(t,e);if(this._val=t,this._units=e,s.default.isUndef(this._units)&&s.default.isString(this._val)&&parseFloat(this._val)==this._val&&"+"!==this._val.charAt(0))this._val=parseFloat(this._val),this._units=this._defaultUnits;else if(t&&t.constructor===this.constructor)this._val=t._val,this._units=t._units;else if(t instanceof s.default.TimeBase)switch(this._defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi();break;default:throw new Error("Unrecognized default units "+this._defaultUnits)}},s.default.extend(s.default.TimeBase),s.default.TimeBase.prototype._expressions={n:{regexp:/^(\d+)n(\.?)$/i,method:function(t,e){t=parseInt(t);var i="."===e?1.5:1;return 1===t?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/t)*i}},t:{regexp:/^(\d+)t$/i,method:function(t){return t=parseInt(t),this._beatsToUnits(8/(3*parseInt(t)))}},m:{regexp:/^(\d+)m$/i,method:function(t){return this._beatsToUnits(parseInt(t)*this._getTimeSignature())}},i:{regexp:/^(\d+)i$/i,method:function(t){return this._ticksToUnits(parseInt(t))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz$/i,method:function(t){return this._frequencyToUnits(parseFloat(t))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/,method:function(t,e,i){var s=0;return t&&"0"!==t&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(s+=this._beatsToUnits(parseFloat(e))),i&&"0"!==i&&(s+=this._beatsToUnits(parseFloat(i)/4)),s}},s:{regexp:/^(\d+(?:\.\d+)?)s$/,method:function(t){return this._secondsToUnits(parseFloat(t))}},samples:{regexp:/^(\d+)samples$/,method:function(t){return parseInt(t)/this.context.sampleRate}},default:{regexp:/^(\d+(?:\.\d+)?)$/,method:function(t){return this._expressions[this._defaultUnits].method.call(this,t)}}},s.default.TimeBase.prototype._defaultUnits="s",s.default.TimeBase.prototype._getBpm=function(){return s.default.Transport?s.default.Transport.bpm.value:120},s.default.TimeBase.prototype._getTimeSignature=function(){return s.default.Transport?s.default.Transport.timeSignature:4},s.default.TimeBase.prototype._getPPQ=function(){return s.default.Transport?s.default.Transport.PPQ:192},s.default.TimeBase.prototype._now=function(){return this.now()},s.default.TimeBase.prototype._frequencyToUnits=function(t){return 1/t},s.default.TimeBase.prototype._beatsToUnits=function(t){return 60/this._getBpm()*t},s.default.TimeBase.prototype._secondsToUnits=function(t){return t},s.default.TimeBase.prototype._ticksToUnits=function(t){return t*(this._beatsToUnits(1)/this._getPPQ())},s.default.TimeBase.prototype._noArg=function(){return this._now()},s.default.TimeBase.prototype.valueOf=function(){if(s.default.isUndef(this._val))return this._noArg();if(s.default.isString(this._val)&&s.default.isUndef(this._units)){for(var t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(s.default.isObject(this._val)){var e=0;for(var i in this._val){var n=this._val[i];e+=new this.constructor(i).valueOf()*n}return e}if(s.default.isDefined(this._units)){var o=this._expressions[this._units],a=this._val.toString().trim().match(o.regexp);return a?o.method.apply(this,a.slice(1)):o.method.call(this,parseFloat(this._val))}return this._val},s.default.TimeBase.prototype.toSeconds=function(){return this.valueOf()},s.default.TimeBase.prototype.toFrequency=function(){return 1/this.toSeconds()},s.default.TimeBase.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},s.default.TimeBase.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},s.default.TimeBase.prototype.dispose=function(){this._val=null,this._units=null},e.default=s.default.TimeBase},function(t,e,i){"use strict";i.r(e);var s=i(0);i(62),i(46);s.default.Time=function(t,e){if(!(this instanceof s.default.Time))return new s.default.Time(t,e);s.default.TimeBase.call(this,t,e)},s.default.extend(s.default.Time,s.default.TimeBase),s.default.Time.prototype._expressions=Object.assign({},s.default.TimeBase.prototype._expressions,{quantize:{regexp:/^@(.+)/,method:function(t){if(s.default.Transport){var e=new this.constructor(t);return this._secondsToUnits(s.default.Transport.nextSubdivision(e))}return 0}},now:{regexp:/^\+(.+)/,method:function(t){return this._now()+new this.constructor(t)}}}),s.default.Time.prototype.quantize=function(t,e){e=s.default.defaultArg(e,1);var i=new this.constructor(t),n=this.valueOf();return n+(Math.round(n/i)*i-n)*e},s.default.Time.prototype.toNotation=function(){for(var t=this.toSeconds(),e=["1m"],i=1;i<8;i++){var n=Math.pow(2,i);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");var o=e[0],a=s.default.Time(e[0]).toSeconds();return e.forEach(function(e){var i=s.default.Time(e).toSeconds();Math.abs(i-t)<Math.abs(a-t)&&(o=e,a=i)}),o},s.default.Time.prototype.toBarsBeatsSixteenths=function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;e=parseFloat(e.toFixed(4));var i=Math.floor(e/this._getTimeSignature()),s=e%1*4;return e=Math.floor(e)%this._getTimeSignature(),(s=s.toString()).length>3&&(s=parseFloat(parseFloat(s).toFixed(3))),[i,e,s].join(":")},s.default.Time.prototype.toTicks=function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())},s.default.Time.prototype.toSeconds=function(){return this.valueOf()},s.default.Time.prototype.toMidi=function(){return s.default.Frequency.ftom(this.toFrequency())},e.default=s.default.Time},function(t,e,i){"use strict";i.r(e);var s=i(0);i(11),i(6),i(57),i(32);s.default.Player=function(t){var e;t instanceof s.default.Buffer&&t.loaded?(t=t.get(),e=s.default.Player.defaults):e=s.default.defaults(arguments,["url","onload"],s.default.Player),s.default.Source.call(this,e),this.autostart=e.autostart,this._buffer=new s.default.Buffer({url:e.url,onload:this._onload.bind(this,e.onload),reverse:e.reverse}),t instanceof AudioBuffer&&this._buffer.set(t),this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this._activeSources=[],this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut},s.default.extend(s.default.Player,s.default.Source),s.default.Player.defaults={onload:s.default.noOp,playbackRate:1,loop:!1,autostart:!1,loopStart:0,loopEnd:0,reverse:!1,fadeIn:0,fadeOut:0},s.default.Player.prototype.load=function(t,e){return this._buffer.load(t,this._onload.bind(this,e))},s.default.Player.prototype._onload=function(t){(t=s.default.defaultArg(t,s.default.noOp))(this),this.autostart&&this.start()},s.default.Player.prototype._onSourceEnd=function(t){var e=this._activeSources.indexOf(t);this._activeSources.splice(e,1),0!==this._activeSources.length||this._synced||this._state.setStateAtTime(s.default.State.Stopped,s.default.now())},s.default.Player.prototype._start=function(t,e,i){e=this._loop?s.default.defaultArg(e,this._loopStart):s.default.defaultArg(e,0),e=this.toSeconds(e),this._synced&&(e*=this._playbackRate);var n=s.default.defaultArg(i,Math.max(this._buffer.duration-e,0));n=this.toSeconds(n),n/=this._playbackRate,t=this.toSeconds(t);var o=new s.default.BufferSource({buffer:this._buffer,loop:this._loop,loopStart:this._loopStart,loopEnd:this._loopEnd,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate,fadeIn:this.fadeIn,fadeOut:this.fadeOut}).connect(this.output);return this._loop||this._synced||this._state.setStateAtTime(s.default.State.Stopped,t+n),this._activeSources.push(o),this._loop&&s.default.isUndef(i)?o.start(t,e):o.start(t,e,n-this.toSeconds(this.fadeOut)),this},s.default.Player.prototype._stop=function(t){return t=this.toSeconds(t),this._activeSources.forEach(function(e){e.stop(t)}),this},s.default.Player.prototype.restart=function(t,e,i){return this._stop(t),this._start(t,e,i),this},s.default.Player.prototype.seek=function(t,e){return e=this.toSeconds(e),this._state.getValueAtTime(e)===s.default.State.Started&&(t=this.toSeconds(t),this._stop(e),this._start(e,t)),this},s.default.Player.prototype.setLoopPoints=function(t,e){return this.loopStart=t,this.loopEnd=e,this},Object.defineProperty(s.default.Player.prototype,"loopStart",{get:function(){return this._loopStart},set:function(t){this._loopStart=t,this._activeSources.forEach(function(e){e.loopStart=t})}}),Object.defineProperty(s.default.Player.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(t){this._loopEnd=t,this._activeSources.forEach(function(e){e.loopEnd=t})}}),Object.defineProperty(s.default.Player.prototype,"buffer",{get:function(){return this._buffer},set:function(t){this._buffer.set(t)}}),Object.defineProperty(s.default.Player.prototype,"loop",{get:function(){return this._loop},set:function(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(function(e){e.loop=t}),t)){var e=this._state.getNextState(s.default.State.Stopped,this.now());e&&this._state.cancel(e.time)}}}),Object.defineProperty(s.default.Player.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t;var e=this.now(),i=this._state.getNextState(s.default.State.Stopped,e);i&&this._state.cancel(i.time),this._activeSources.forEach(function(i){i.cancelStop(),i.playbackRate.setValueAtTime(t,e)})}}),Object.defineProperty(s.default.Player.prototype,"reverse",{get:function(){return this._buffer.reverse},set:function(t){this._buffer.reverse=t}}),Object.defineProperty(s.default.Player.prototype,"loaded",{get:function(){return this._buffer.loaded}}),s.default.Player.prototype.dispose=function(){return this._activeSources.forEach(function(t){t.dispose()}),this._activeSources=null,s.default.Source.prototype.dispose.call(this),this._buffer.dispose(),this._buffer=null,this},e.default=s.default.Player},function(t,e,i){"use strict";i.r(e);var s=i(0);i(31),i(41),i(37),i(2),i(9),i(25);s.default.MonoSynth=function(t){t=s.default.defaultArg(t,s.default.MonoSynth.defaults),s.default.Monophonic.call(this,t),this.oscillator=new s.default.OmniOscillator(t.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new s.default.Filter(t.filter),this.filter.frequency.value=5e3,this.filterEnvelope=new s.default.FrequencyEnvelope(t.filterEnvelope),this.envelope=new s.default.AmplitudeEnvelope(t.envelope),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),this._readOnly(["oscillator","frequency","detune","filter","filterEnvelope","envelope"])},s.default.extend(s.default.MonoSynth,s.default.Monophonic),s.default.MonoSynth.defaults={frequency:"C4",detune:0,oscillator:{type:"square"},filter:{Q:6,type:"lowpass",rolloff:-24},envelope:{attack:.005,decay:.1,sustain:.9,release:1},filterEnvelope:{attack:.06,decay:.2,sustain:.5,release:2,baseFrequency:200,octaves:7,exponent:2}},s.default.MonoSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain&&this.oscillator.stop(t+this.envelope.attack+this.envelope.decay),this},s.default.MonoSynth.prototype._triggerEnvelopeRelease=function(t){return this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.envelope.release),this},s.default.MonoSynth.prototype.dispose=function(){return s.default.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","filter","filterEnvelope","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.filterEnvelope.dispose(),this.filterEnvelope=null,this.filter.dispose(),this.filter=null,this.frequency=null,this.detune=null,this},e.default=s.default.MonoSynth},function(t,e,i){"use strict";i.r(e);var s=i(0);i(6),i(17),i(5),i(3);s.default.FatOscillator=function(){var t=s.default.defaults(arguments,["frequency","type","spread"],s.default.FatOscillator);s.default.Source.call(this,t),this.frequency=new s.default.Signal(t.frequency,s.default.Type.Frequency),this.detune=new s.default.Signal(t.detune,s.default.Type.Cents),this._oscillators=[],this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,this._readOnly(["frequency","detune"])},s.default.extend(s.default.FatOscillator,s.default.Source),s.default.FatOscillator.defaults={frequency:440,detune:0,phase:0,spread:20,count:3,type:"sawtooth",partials:[],partialCount:0},s.default.FatOscillator.prototype._start=function(t){t=this.toSeconds(t),this._forEach(function(e){e.start(t)})},s.default.FatOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._forEach(function(e){e.stop(t)})},s.default.FatOscillator.prototype.restart=function(t){t=this.toSeconds(t),this._forEach(function(e){e.restart(t)})},s.default.FatOscillator.prototype._forEach=function(t){for(var e=0;e<this._oscillators.length;e++)t.call(this,this._oscillators[e],e)},Object.defineProperty(s.default.FatOscillator.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this._forEach(function(e){e.type=t})}}),Object.defineProperty(s.default.FatOscillator.prototype,"spread",{get:function(){return this._spread},set:function(t){if(this._spread=t,this._oscillators.length>1){var e=-t/2,i=t/(this._oscillators.length-1);this._forEach(function(t,s){t.detune.value=e+i*s})}}}),Object.defineProperty(s.default.FatOscillator.prototype,"count",{get:function(){return this._oscillators.length},set:function(t){if(t=Math.max(t,1),this._oscillators.length!==t){this._forEach(function(t){t.dispose()}),this._oscillators=[];for(var e=0;e<t;e++){var i=new s.default.Oscillator;this.type===s.default.Oscillator.Type.Custom?i.partials=this._partials:i.type=this._type,i.partialCount=this._partialCount,i.phase=this._phase+e/t*360,i.volume.value=-6-1.1*t,this.frequency.connect(i.frequency),this.detune.connect(i.detune),i.connect(this.output),this._oscillators[e]=i}this.spread=this._spread,this.state===s.default.State.Started&&this._forEach(function(t){t.start()})}}}),Object.defineProperty(s.default.FatOscillator.prototype,"phase",{get:function(){return this._phase},set:function(t){this._phase=t,this._forEach(function(e){e.phase=t})}}),Object.defineProperty(s.default.FatOscillator.prototype,"baseType",{get:function(){return this._oscillators[0].baseType},set:function(t){this._forEach(function(e){e.baseType=t}),this._type=this._oscillators[0].type}}),Object.defineProperty(s.default.FatOscillator.prototype,"partials",{get:function(){return this._oscillators[0].partials},set:function(t){this._partials=t,this._type=s.default.Oscillator.Type.Custom,this._forEach(function(e){e.partials=t})}}),Object.defineProperty(s.default.FatOscillator.prototype,"partialCount",{get:function(){return this._oscillators[0].partialCount},set:function(t){this._partialCount=t,this._forEach(function(e){e.partialCount=t}),this._type=this._oscillators[0].type}}),s.default.FatOscillator.prototype.dispose=function(){return s.default.Source.prototype.dispose.call(this),this._writable(["frequency","detune"]),this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this._forEach(function(t){t.dispose()}),this._oscillators=null,this._partials=null,this},e.default=s.default.FatOscillator},function(t,e,i){"use strict";i.r(e);var s=i(0);i(6),i(17),i(5),i(3),i(22);s.default.AMOscillator=function(){var t=s.default.defaults(arguments,["frequency","type","modulationType"],s.default.AMOscillator);s.default.Source.call(this,t),this._carrier=new s.default.Oscillator(t.frequency,t.type),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this.detune.value=t.detune,this._modulator=new s.default.Oscillator(t.frequency,t.modulationType),this._modulationScale=new s.default.AudioToGain,this.harmonicity=new s.default.Multiply(t.harmonicity),this.harmonicity.units=s.default.Type.Positive,this._modulationNode=new s.default.Gain(0),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.connect(this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),this.phase=t.phase,this._readOnly(["frequency","detune","harmonicity"])},s.default.extend(s.default.AMOscillator,s.default.Oscillator),s.default.AMOscillator.defaults={frequency:440,detune:0,phase:0,type:"sine",modulationType:"square",harmonicity:1},s.default.AMOscillator.prototype._start=function(t){this._modulator.start(t),this._carrier.start(t)},s.default.AMOscillator.prototype._stop=function(t){this._modulator.stop(t),this._carrier.stop(t)},s.default.AMOscillator.prototype.restart=function(t){this._modulator.restart(t),this._carrier.restart(t)},Object.defineProperty(s.default.AMOscillator.prototype,"type",{get:function(){return this._carrier.type},set:function(t){this._carrier.type=t}}),Object.defineProperty(s.default.AMOscillator.prototype,"baseType",{get:function(){return this._carrier.baseType},set:function(t){this._carrier.baseType=t}}),Object.defineProperty(s.default.AMOscillator.prototype,"partialCount",{get:function(){return this._carrier.partialCount},set:function(t){this._carrier.partialCount=t}}),Object.defineProperty(s.default.AMOscillator.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(t){this._modulator.type=t}}),Object.defineProperty(s.default.AMOscillator.prototype,"phase",{get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t}}),Object.defineProperty(s.default.AMOscillator.prototype,"partials",{get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t}}),s.default.AMOscillator.prototype.dispose=function(){return s.default.Source.prototype.dispose.call(this),this._writable(["frequency","detune","harmonicity"]),this.frequency=null,this.detune=null,this.harmonicity.dispose(),this.harmonicity=null,this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this._modulationNode.dispose(),this._modulationNode=null,this._modulationScale.dispose(),this._modulationScale=null,this},e.default=s.default.AMOscillator},function(t,e,i){"use strict";i.r(e);var s=i(0);i(6),i(50),i(17),i(5);s.default.PWMOscillator=function(){var t=s.default.defaults(arguments,["frequency","modulationFrequency"],s.default.PWMOscillator);s.default.Source.call(this,t),this._pulse=new s.default.PulseOscillator(t.modulationFrequency),this._pulse._sawtooth.type="sine",this._modulator=new s.default.Oscillator({frequency:t.frequency,detune:t.detune,phase:t.phase}),this._scale=new s.default.Multiply(2),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this.modulationFrequency=this._pulse.frequency,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),this._readOnly(["modulationFrequency","frequency","detune"])},s.default.extend(s.default.PWMOscillator,s.default.Source),s.default.PWMOscillator.defaults={frequency:440,detune:0,phase:0,modulationFrequency:.4},s.default.PWMOscillator.prototype._start=function(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)},s.default.PWMOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)},s.default.PWMOscillator.prototype.restart=function(t){this._modulator.restart(t),this._pulse.restart(t)},Object.defineProperty(s.default.PWMOscillator.prototype,"type",{get:function(){return"pwm"}}),Object.defineProperty(s.default.PWMOscillator.prototype,"baseType",{get:function(){return"pwm"}}),Object.defineProperty(s.default.PWMOscillator.prototype,"partials",{get:function(){return[]}}),Object.defineProperty(s.default.PWMOscillator.prototype,"phase",{get:function(){return this._modulator.phase},set:function(t){this._modulator.phase=t}}),s.default.PWMOscillator.prototype.dispose=function(){return s.default.Source.prototype.dispose.call(this),this._pulse.dispose(),this._pulse=null,this._scale.dispose(),this._scale=null,this._modulator.dispose(),this._modulator=null,this._writable(["modulationFrequency","frequency","detune"]),this.frequency=null,this.detune=null,this.modulationFrequency=null,this},e.default=s.default.PWMOscillator},function(t,e,i){"use strict";i.r(e);var s=i(0);i(51),i(4),i(16);s.default.Part=function(){var t=s.default.defaults(arguments,["callback","events"],s.default.Part);s.default.Event.call(this,t),this._events=[];for(var e=0;e<t.events.length;e++)Array.isArray(t.events[e])?this.add(t.events[e][0],t.events[e][1]):this.add(t.events[e])},s.default.extend(s.default.Part,s.default.Event),s.default.Part.defaults={callback:s.default.noOp,loop:!1,loopEnd:"1m",loopStart:0,playbackRate:1,probability:1,humanize:!1,mute:!1,events:[]},s.default.Part.prototype.start=function(t,e){var i=this.toTicks(t);return this._state.getValueAtTime(i)!==s.default.State.Started&&(e=this._loop?s.default.defaultArg(e,this._loopStart):s.default.defaultArg(e,0),e=this.toTicks(e),this._state.add({state:s.default.State.Started,time:i,offset:e}),this._forEach(function(t){this._startNote(t,i,e)})),this},s.default.Part.prototype._startNote=function(t,e,i){e-=i,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<i&&(e+=this._getLoopDuration()),t.start(s.default.Ticks(e))):t.startOffset<this._loopStart&&t.startOffset>=i&&(t.loop=!1,t.start(s.default.Ticks(e))):t.startOffset>=i&&t.start(s.default.Ticks(e))},Object.defineProperty(s.default.Part.prototype,"startOffset",{get:function(){return this._startOffset},set:function(t){this._startOffset=t,this._forEach(function(t){t.startOffset+=this._startOffset})}}),s.default.Part.prototype.stop=function(t){var e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime(s.default.State.Stopped,e),this._forEach(function(e){e.stop(t)}),this},s.default.Part.prototype.at=function(t,e){t=s.default.TransportTime(t);for(var i=s.default.Ticks(1).toSeconds(),n=0;n<this._events.length;n++){var o=this._events[n];if(Math.abs(t.toTicks()-o.startOffset)<i)return s.default.isDefined(e)&&(o.value=e),o}return s.default.isDefined(e)?(this.add(t,e),this._events[this._events.length-1]):null},s.default.Part.prototype.add=function(t,e){var i;return t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),e instanceof s.default.Event?(i=e).callback=this._tick.bind(this):i=new s.default.Event({callback:this._tick.bind(this),value:e}),i.startOffset=t,i.set({loopEnd:this.loopEnd,loopStart:this.loopStart,loop:this.loop,humanize:this.humanize,playbackRate:this.playbackRate,probability:this.probability}),this._events.push(i),this._restartEvent(i),this},s.default.Part.prototype._restartEvent=function(t){this._state.forEach(function(e){e.state===s.default.State.Started?this._startNote(t,e.time,e.offset):t.stop(s.default.Ticks(e.time))}.bind(this))},s.default.Part.prototype.remove=function(t,e){t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t);for(var i=this._events.length-1;i>=0;i--){var n=this._events[i];n.startOffset===t&&(s.default.isUndef(e)||s.default.isDefined(e)&&n.value===e)&&(this._events.splice(i,1),n.dispose())}return this},s.default.Part.prototype.removeAll=function(){return this._forEach(function(t){t.dispose()}),this._events=[],this},s.default.Part.prototype.cancel=function(t){return this._forEach(function(e){e.cancel(t)}),this._state.cancel(this.toTicks(t)),this},s.default.Part.prototype._forEach=function(t,e){if(this._events){e=s.default.defaultArg(e,this);for(var i=this._events.length-1;i>=0;i--){var n=this._events[i];n instanceof s.default.Part?n._forEach(t,e):t.call(e,n)}}return this},s.default.Part.prototype._setAll=function(t,e){this._forEach(function(i){i[t]=e})},s.default.Part.prototype._tick=function(t,e){this.mute||this.callback(t,e)},s.default.Part.prototype._testLoopBoundries=function(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):t.state===s.default.State.Stopped&&this._restartEvent(t)},Object.defineProperty(s.default.Part.prototype,"probability",{get:function(){return this._probability},set:function(t){this._probability=t,this._setAll("probability",t)}}),Object.defineProperty(s.default.Part.prototype,"humanize",{get:function(){return this._humanize},set:function(t){this._humanize=t,this._setAll("humanize",t)}}),Object.defineProperty(s.default.Part.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._forEach(function(e){e._loopStart=this._loopStart,e._loopEnd=this._loopEnd,e.loop=t,this._testLoopBoundries(e)})}}),Object.defineProperty(s.default.Part.prototype,"loopEnd",{get:function(){return s.default.Ticks(this._loopEnd).toSeconds()},set:function(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach(function(e){e.loopEnd=t,this._testLoopBoundries(e)})}}),Object.defineProperty(s.default.Part.prototype,"loopStart",{get:function(){return s.default.Ticks(this._loopStart).toSeconds()},set:function(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach(function(t){t.loopStart=this.loopStart,this._testLoopBoundries(t)})}}),Object.defineProperty(s.default.Part.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._setAll("playbackRate",t)}}),Object.defineProperty(s.default.Part.prototype,"length",{get:function(){return this._events.length}}),s.default.Part.prototype.dispose=function(){return s.default.Event.prototype.dispose.call(this),this.removeAll(),this.callback=null,this._events=null,this},e.default=s.default.Part},function(t,e,i){"use strict";i.r(e);var s=i(0);i(51);s.default.Loop=function(){var t=s.default.defaults(arguments,["callback","interval"],s.default.Loop);s.default.call(this),this._event=new s.default.Event({callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations},s.default.extend(s.default.Loop),s.default.Loop.defaults={interval:"4n",callback:s.default.noOp,playbackRate:1,iterations:1/0,probability:!0,mute:!1},s.default.Loop.prototype.start=function(t){return this._event.start(t),this},s.default.Loop.prototype.stop=function(t){return this._event.stop(t),this},s.default.Loop.prototype.cancel=function(t){return this._event.cancel(t),this},s.default.Loop.prototype._tick=function(t){this.callback(t)},Object.defineProperty(s.default.Loop.prototype,"state",{get:function(){return this._event.state}}),Object.defineProperty(s.default.Loop.prototype,"progress",{get:function(){return this._event.progress}}),Object.defineProperty(s.default.Loop.prototype,"interval",{get:function(){return this._event.loopEnd},set:function(t){this._event.loopEnd=t}}),Object.defineProperty(s.default.Loop.prototype,"playbackRate",{get:function(){return this._event.playbackRate},set:function(t){this._event.playbackRate=t}}),Object.defineProperty(s.default.Loop.prototype,"humanize",{get:function(){return this._event.humanize},set:function(t){this._event.humanize=t}}),Object.defineProperty(s.default.Loop.prototype,"probability",{get:function(){return this._event.probability},set:function(t){this._event.probability=t}}),Object.defineProperty(s.default.Loop.prototype,"mute",{get:function(){return this._event.mute},set:function(t){this._event.mute=t}}),Object.defineProperty(s.default.Loop.prototype,"iterations",{get:function(){return!0===this._event.loop?1/0:this._event.loop},set:function(t){this._event.loop=t===1/0||t}}),s.default.Loop.prototype.dispose=function(){this._event.dispose(),this._event=null,this.callback=null},e.default=s.default.Loop},function(t,e,i){"use strict";i.r(e);var s=i(0);i(15),i(33);s.default.StereoXFeedbackEffect=function(){var t=s.default.defaults(arguments,["feedback"],s.default.FeedbackEffect);s.default.StereoEffect.call(this,t),this.feedback=new s.default.Signal(t.feedback,s.default.Type.NormalRange),this._feedbackLR=new s.default.Gain,this._feedbackRL=new s.default.Gain,this.effectReturnL.chain(this._feedbackLR,this.effectSendR),this.effectReturnR.chain(this._feedbackRL,this.effectSendL),this.feedback.fan(this._feedbackLR.gain,this._feedbackRL.gain),this._readOnly(["feedback"])},s.default.extend(s.default.StereoXFeedbackEffect,s.default.StereoEffect),s.default.StereoXFeedbackEffect.prototype.dispose=function(){return s.default.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackLR.dispose(),this._feedbackLR=null,this._feedbackRL.dispose(),this._feedbackRL=null,this},e.default=s.default.StereoXFeedbackEffect},function(t,e,i){"use strict";i.r(e);var s=i(0);i(8),i(53),i(52);s.default.MidSideEffect=function(){s.default.Effect.apply(this,arguments),this._midSideSplit=new s.default.MidSideSplit,this._midSideMerge=new s.default.MidSideMerge,this.midSend=this._midSideSplit.mid,this.sideSend=this._midSideSplit.side,this.midReturn=this._midSideMerge.mid,this.sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)},s.default.extend(s.default.MidSideEffect,s.default.Effect),s.default.MidSideEffect.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this.midSend=null,this.sideSend=null,this.midReturn=null,this.sideReturn=null,this},e.default=s.default.MidSideEffect},function(t,e,i){"use strict";i.r(e);var s=i(0);i(11),i(8);s.default.Convolver=function(){var t=s.default.defaults(arguments,["url","onload"],s.default.Convolver);s.default.Effect.call(this,t),this._convolver=this.context.createConvolver(),this._buffer=new s.default.Buffer(t.url,function(e){this.buffer=e.get(),t.onload()}.bind(this)),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=t.normalize,this.connectEffect(this._convolver)},s.default.extend(s.default.Convolver,s.default.Effect),s.default.Convolver.defaults={onload:s.default.noOp,normalize:!0},Object.defineProperty(s.default.Convolver.prototype,"buffer",{get:function(){return this._buffer.length?this._buffer:null},set:function(t){this._buffer.set(t),this._convolver.buffer&&(this.effectSend.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.connectEffect(this._convolver)),this._convolver.buffer=this._buffer.get()}}),Object.defineProperty(s.default.Convolver.prototype,"normalize",{get:function(){return this._convolver.normalize},set:function(t){this._convolver.normalize=t}}),s.default.Convolver.prototype.load=function(t,e){return this._buffer.load(t,function(t){this.buffer=t,e&&e()}.bind(this))},s.default.Convolver.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this._buffer.dispose(),this._buffer=null,this._convolver.disconnect(),this._convolver=null,this},e.default=s.default.Convolver},function(t,e,i){"use strict";i.r(e);var s=i(0);i(7),i(5),i(13);s.default.Modulo=function(t){s.default.SignalBase.call(this),this.createInsOuts(1,0),this._shaper=new s.default.WaveShaper(Math.pow(2,16)),this._multiply=new s.default.Multiply,this._subtract=this.output=new s.default.Subtract,this._modSignal=new s.default.Signal(t),s.default.connect(this.input,this._shaper),s.default.connect(this.input,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(t)},s.default.extend(s.default.Modulo,s.default.SignalBase),s.default.Modulo.prototype._setWaveShaper=function(t){this._shaper.setMap(function(e){return Math.floor((e+1e-4)/t)})},Object.defineProperty(s.default.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(t){this._modSignal.value=t,this._setWaveShaper(t)}}),s.default.Modulo.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},e.default=s.default.Modulo},function(t,e,i){"use strict";i.r(e);var s=i(0);i(20),i(92);s.default.OfflineContext=function(t,e,i){var n=new OfflineAudioContext(t,e*i,i);s.default.Context.call(this,{context:n,clockSource:"offline",lookAhead:0,updateInterval:128/i}),this._duration=e,this._currentTime=0},s.default.extend(s.default.OfflineContext,s.default.Context),s.default.OfflineContext.prototype.now=function(){return this._currentTime},s.default.OfflineContext.prototype.resume=function(){return Promise.resolve()},s.default.OfflineContext.prototype.render=function(){for(;this._duration-this._currentTime>=0;)this.emit("tick"),this._currentTime+=.005;return this._context.startRendering()},s.default.OfflineContext.prototype.close=function(){return this._context=null,Promise.resolve()},e.default=s.default.OfflineContext},function(t,e,i){"use strict";i.r(e);var s=i(0);i(16),i(11),i(75),i(40);s.default.Offline=function(t,e){var i=s.default.context.sampleRate,n=s.default.context,o=new s.default.OfflineContext(2,e,i);s.default.context=o;var a=t(s.default.Transport),r=null;return r=a&&s.default.isFunction(a.then)?a.then(function(){return o.render()}):o.render(),s.default.context=n,r.then(function(t){return new s.default.Buffer(t)})},e.default=s.default.Offline},function(t,e,i){"use strict";i.r(e);var s=i(0);i(11);s.default.Buffers=function(t){var e=Array.prototype.slice.call(arguments);e.shift();var i=s.default.defaults(e,["onload","baseUrl","onerror"],s.default.Buffers);for(var n in s.default.call(this),this._buffers={},this.baseUrl=i.baseUrl,this._loadingCount=0,t)this._loadingCount++,this.add(n,t[n],this._bufferLoaded.bind(this,i.onload),i.onerror)},s.default.extend(s.default.Buffers),s.default.Buffers.defaults={onload:s.default.noOp,baseUrl:""},s.default.Buffers.prototype.has=function(t){return this._buffers.hasOwnProperty(t)},s.default.Buffers.prototype.get=function(t){if(this.has(t))return this._buffers[t];throw new Error("Tone.Buffers: no buffer named "+t)},s.default.Buffers.prototype._bufferLoaded=function(t){this._loadingCount--,0===this._loadingCount&&t&&t(this)},Object.defineProperty(s.default.Buffers.prototype,"loaded",{get:function(){var t=!0;for(var e in this._buffers){var i=this.get(e);t=t&&i.loaded}return t}}),s.default.Buffers.prototype.add=function(t,e,i,n){return i=s.default.defaultArg(i,s.default.noOp),e instanceof s.default.Buffer?(this._buffers[t]=e,i(this)):e instanceof AudioBuffer?(this._buffers[t]=new s.default.Buffer(e),i(this)):s.default.isString(e)&&(this._buffers[t]=new s.default.Buffer(this.baseUrl+e,i,n)),this},s.default.Buffers.prototype.dispose=function(){for(var t in s.default.prototype.dispose.call(this),this._buffers)this._buffers[t].dispose();return this._buffers=null,this},e.default=s.default.Buffers},function(t,e,i){"use strict";i.r(e);var s=i(0);s.default.CtrlPattern=function(){var t=s.default.defaults(arguments,["values","type"],s.default.CtrlPattern);s.default.call(this),this.values=t.values,this.index=0,this._type=null,this._shuffled=null,this._direction=null,this.type=t.type},s.default.extend(s.default.CtrlPattern),s.default.CtrlPattern.Type={Up:"up",Down:"down",UpDown:"upDown",DownUp:"downUp",AlternateUp:"alternateUp",AlternateDown:"alternateDown",Random:"random",RandomWalk:"randomWalk",RandomOnce:"randomOnce"},s.default.CtrlPattern.defaults={type:s.default.CtrlPattern.Type.Up,values:[]},Object.defineProperty(s.default.CtrlPattern.prototype,"value",{get:function(){if(0!==this.values.length){if(1===this.values.length)return this.values[0];this.index=Math.min(this.index,this.values.length-1);var t=this.values[this.index];return this.type===s.default.CtrlPattern.Type.RandomOnce&&(this.values.length!==this._shuffled.length&&this._shuffleValues(),t=this.values[this._shuffled[this.index]]),t}}}),Object.defineProperty(s.default.CtrlPattern.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this._shuffled=null,this._type===s.default.CtrlPattern.Type.Up||this._type===s.default.CtrlPattern.Type.UpDown||this._type===s.default.CtrlPattern.Type.RandomOnce||this._type===s.default.CtrlPattern.Type.AlternateUp?this.index=0:this._type!==s.default.CtrlPattern.Type.Down&&this._type!==s.default.CtrlPattern.Type.DownUp&&this._type!==s.default.CtrlPattern.Type.AlternateDown||(this.index=this.values.length-1),this._type===s.default.CtrlPattern.Type.UpDown||this._type===s.default.CtrlPattern.Type.AlternateUp?this._direction=s.default.CtrlPattern.Type.Up:this._type!==s.default.CtrlPattern.Type.DownUp&&this._type!==s.default.CtrlPattern.Type.AlternateDown||(this._direction=s.default.CtrlPattern.Type.Down),this._type===s.default.CtrlPattern.Type.RandomOnce?this._shuffleValues():this._type===s.default.CtrlPattern.Type.Random&&(this.index=Math.floor(Math.random()*this.values.length))}}),s.default.CtrlPattern.prototype.next=function(){var t=this.type;return t===s.default.CtrlPattern.Type.Up?(this.index++,this.index>=this.values.length&&(this.index=0)):t===s.default.CtrlPattern.Type.Down?(this.index--,this.index<0&&(this.index=this.values.length-1)):t===s.default.CtrlPattern.Type.UpDown||t===s.default.CtrlPattern.Type.DownUp?(this._direction===s.default.CtrlPattern.Type.Up?this.index++:this.index--,this.index<0?(this.index=1,this._direction=s.default.CtrlPattern.Type.Up):this.index>=this.values.length&&(this.index=this.values.length-2,this._direction=s.default.CtrlPattern.Type.Down)):t===s.default.CtrlPattern.Type.Random?this.index=Math.floor(Math.random()*this.values.length):t===s.default.CtrlPattern.Type.RandomWalk?Math.random()<.5?(this.index--,this.index=Math.max(this.index,0)):(this.index++,this.index=Math.min(this.index,this.values.length-1)):t===s.default.CtrlPattern.Type.RandomOnce?(this.index++,this.index>=this.values.length&&(this.index=0,this._shuffleValues())):t===s.default.CtrlPattern.Type.AlternateUp?(this._direction===s.default.CtrlPattern.Type.Up?(this.index+=2,this._direction=s.default.CtrlPattern.Type.Down):(this.index-=1,this._direction=s.default.CtrlPattern.Type.Up),this.index>=this.values.length&&(this.index=0,this._direction=s.default.CtrlPattern.Type.Up)):t===s.default.CtrlPattern.Type.AlternateDown&&(this._direction===s.default.CtrlPattern.Type.Up?(this.index+=1,this._direction=s.default.CtrlPattern.Type.Down):(this.index-=2,this._direction=s.default.CtrlPattern.Type.Up),this.index<0&&(this.index=this.values.length-1,this._direction=s.default.CtrlPattern.Type.Down)),this.value},s.default.CtrlPattern.prototype._shuffleValues=function(){var t=[];this._shuffled=[];for(var e=0;e<this.values.length;e++)t[e]=e;for(;t.length>0;){var i=t.splice(Math.floor(t.length*Math.random()),1);this._shuffled.push(i[0])}},s.default.CtrlPattern.prototype.dispose=function(){this._shuffled=null,this.values=null},e.default=s.default.CtrlPattern},function(t,e,i){"use strict";i.r(e);var s=i(0);i(11),i(6),i(3),i(1);s.default.OscillatorNode=function(){var t=s.default.defaults(arguments,["frequency","type"],s.default.OscillatorNode);s.default.AudioNode.call(this,t),this.onended=t.onended,this._startTime=-1,this._stopTime=-1,this._gainNode=this.output=new s.default.Gain(0),this._oscillator=this.context.createOscillator(),s.default.connect(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new s.default.Param({param:this._oscillator.frequency,units:s.default.Type.Frequency,value:t.frequency}),this.detune=new s.default.Param({param:this._oscillator.detune,units:s.default.Type.Cents,value:t.detune}),this._gain=1},s.default.extend(s.default.OscillatorNode,s.default.AudioNode),s.default.OscillatorNode.defaults={frequency:440,detune:0,type:"sine",onended:s.default.noOp},Object.defineProperty(s.default.OscillatorNode.prototype,"state",{get:function(){return this.getStateAtTime(this.now())}}),s.default.OscillatorNode.prototype.getStateAtTime=function(t){return t=this.toSeconds(t),-1!==this._startTime&&t>=this._startTime&&(-1===this._stopTime||t<=this._stopTime)?s.default.State.Started:s.default.State.Stopped},s.default.OscillatorNode.prototype.start=function(t){if(this.log("start",t),-1!==this._startTime)throw new Error("cannot call OscillatorNode.start more than once");return this._startTime=this.toSeconds(t),this._startTime=Math.max(this._startTime,this.context.currentTime),this._oscillator.start(this._startTime),this._gainNode.gain.setValueAtTime(1,this._startTime),this},s.default.OscillatorNode.prototype.setPeriodicWave=function(t){return this._oscillator.setPeriodicWave(t),this},s.default.OscillatorNode.prototype.stop=function(t){return this.log("stop",t),this.assert(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop(),this._stopTime=this.toSeconds(t),this._stopTime=Math.max(this._stopTime,this.context.currentTime),this._stopTime>this._startTime?(this._gainNode.gain.setValueAtTime(0,this._stopTime),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(function(){this._oscillator.stop(this.now()),this.onended(),setTimeout(function(){this._oscillator&&(this._oscillator.disconnect(),this._gainNode.disconnect())}.bind(this),100)}.bind(this),this._stopTime-this.context.currentTime)):this._gainNode.gain.cancelScheduledValues(this._startTime),this},s.default.OscillatorNode.prototype.cancelStop=function(){return-1!==this._startTime&&(this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1),this},Object.defineProperty(s.default.OscillatorNode.prototype,"type",{get:function(){return this._oscillator.type},set:function(t){this._oscillator.type=t}}),s.default.OscillatorNode.prototype.dispose=function(){return this._wasDisposed||(this._wasDisposed=!0,this.context.clearTimeout(this._timeout),s.default.AudioNode.prototype.dispose.call(this),this.onended=null,this._oscillator.disconnect(),this._oscillator=null,this._gainNode.dispose(),this._gainNode=null,this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null),this},e.default=s.default.OscillatorNode},function(t,e,i){"use strict";i.r(e);var s=i(0);i(56),i(55);s.default.TransportRepeatEvent=function(t,e){s.default.TransportEvent.call(this,t,e),e=s.default.defaultArg(e,s.default.TransportRepeatEvent.defaults),this.duration=s.default.Ticks(e.duration),this._interval=s.default.Ticks(e.interval),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this),this.Transport.on("start loopStart",this._boundRestart),this._restart()},s.default.extend(s.default.TransportRepeatEvent,s.default.TransportEvent),s.default.TransportRepeatEvent.defaults={duration:1/0,interval:1},s.default.TransportRepeatEvent.prototype.invoke=function(t){this._createEvents(t),s.default.TransportEvent.prototype.invoke.call(this,t)},s.default.TransportRepeatEvent.prototype._createEvents=function(t){var e=this.Transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.Transport.scheduleOnce(this.invoke.bind(this),s.default.Ticks(this._nextTick)))},s.default.TransportRepeatEvent.prototype._restart=function(t){this.Transport.clear(this._currentId),this.Transport.clear(this._nextId),this._nextTick=this.time;var e=this.Transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.Transport.scheduleOnce(this.invoke.bind(this),s.default.Ticks(this._nextTick)),this._nextTick+=this._interval,this._nextId=this.Transport.scheduleOnce(this.invoke.bind(this),s.default.Ticks(this._nextTick))},s.default.TransportRepeatEvent.prototype.dispose=function(){return this.Transport.clear(this._currentId),this.Transport.clear(this._nextId),this.Transport.off("start loopStart",this._boundRestart),this._boundCreateEvents=null,s.default.TransportEvent.prototype.dispose.call(this),this.duration=null,this._interval=null,this},e.default=s.default.TransportRepeatEvent},function(t,e,i){"use strict";i.r(e);var s=i(0);i(4);s.default.IntervalTimeline=function(){s.default.call(this),this._root=null,this._length=0},s.default.extend(s.default.IntervalTimeline),s.default.IntervalTimeline.prototype.add=function(t){if(s.default.isUndef(t.time)||s.default.isUndef(t.duration))throw new Error("Tone.IntervalTimeline: events must have time and duration parameters");t.time=t.time.valueOf();var e=new n(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this},s.default.IntervalTimeline.prototype.remove=function(t){if(null!==this._root){var e=[];this._root.search(t.time,e);for(var i=0;i<e.length;i++){var s=e[i];if(s.event===t){this._removeNode(s),this._length--;break}}}return this},Object.defineProperty(s.default.IntervalTimeline.prototype,"length",{get:function(){return this._length}}),s.default.IntervalTimeline.prototype.cancel=function(t){return this.forEachFrom(t,function(t){this.remove(t)}.bind(this)),this},s.default.IntervalTimeline.prototype._setRoot=function(t){this._root=t,null!==this._root&&(this._root.parent=null)},s.default.IntervalTimeline.prototype._replaceNodeInParent=function(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)},s.default.IntervalTimeline.prototype._removeNode=function(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{var e,i;if(t.getBalance()>0)if(null===t.left.right)(e=t.left).right=t.right,i=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent.right=e.left,i=e.parent,e.left=t.left,e.right=t.right}else if(null===t.right.left)(e=t.right).left=t.left,i=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent.left=e.right,i=e.parent,e.left=t.left,e.right=t.right}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),this._rebalance(i)}t.dispose()},s.default.IntervalTimeline.prototype._rotateLeft=function(t){var e=t.parent,i=t.isLeftChild(),s=t.right;t.right=s.left,s.left=t,null!==e?i?e.left=s:e.right=s:this._setRoot(s)},s.default.IntervalTimeline.prototype._rotateRight=function(t){var e=t.parent,i=t.isLeftChild(),s=t.left;t.left=s.right,s.right=t,null!==e?i?e.left=s:e.right=s:this._setRoot(s)},s.default.IntervalTimeline.prototype._rebalance=function(t){var e=t.getBalance();e>1?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))},s.default.IntervalTimeline.prototype.get=function(t){if(null!==this._root){var e=[];if(this._root.search(t,e),e.length>0){for(var i=e[0],s=1;s<e.length;s++)e[s].low>i.low&&(i=e[s]);return i.event}}return null},s.default.IntervalTimeline.prototype.forEach=function(t){if(null!==this._root){var e=[];this._root.traverse(function(t){e.push(t)});for(var i=0;i<e.length;i++){var s=e[i].event;s&&t(s)}}return this},s.default.IntervalTimeline.prototype.forEachAtTime=function(t,e){if(null!==this._root){var i=[];this._root.search(t,i);for(var s=i.length-1;s>=0;s--){var n=i[s].event;n&&e(n)}}return this},s.default.IntervalTimeline.prototype.forEachFrom=function(t,e){if(null!==this._root){var i=[];this._root.searchAfter(t,i);for(var s=i.length-1;s>=0;s--){e(i[s].event)}}return this},s.default.IntervalTimeline.prototype.dispose=function(){var t=[];null!==this._root&&this._root.traverse(function(e){t.push(e)});for(var e=0;e<t.length;e++)t[e].dispose();return t=null,this._root=null,this};var n=function(t,e,i){this.event=i,this.low=t,this.high=e,this.max=this.high,this._left=null,this._right=null,this.parent=null,this.height=0};n.prototype.insert=function(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)},n.prototype.search=function(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))},n.prototype.searchAfter=function(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)},n.prototype.traverse=function(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)},n.prototype.updateHeight=function(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0},n.prototype.updateMax=function(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))},n.prototype.getBalance=function(){var t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t},n.prototype.isLeftChild=function(){return null!==this.parent&&this.parent.left===this},Object.defineProperty(n.prototype,"left",{get:function(){return this._left},set:function(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}}),Object.defineProperty(n.prototype,"right",{get:function(){return this._right},set:function(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}}),n.prototype.dispose=function(){this.parent=null,this._left=null,this._right=null,this.event=null},e.default=s.default.IntervalTimeline},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2);function n(t){return function(e,i){i=this.toSeconds(i),t.apply(this,arguments);var s=this._events.get(i),n=this._events.previousEvent(s),o=this._getTicksUntilEvent(n,i);return s.ticks=Math.max(o,0),this}}s.default.TickSignal=function(t){t=s.default.defaultArg(t,1),s.default.Signal.call(this,{units:s.default.Type.Ticks,value:t}),this._events.memory=1/0,this.cancelScheduledValues(0),this._events.add({type:s.default.Param.AutomationType.SetValue,time:0,value:t})},s.default.extend(s.default.TickSignal,s.default.Signal),s.default.TickSignal.prototype.setValueAtTime=n(s.default.Signal.prototype.setValueAtTime),s.default.TickSignal.prototype.linearRampToValueAtTime=n(s.default.Signal.prototype.linearRampToValueAtTime),s.default.TickSignal.prototype.setTargetAtTime=function(t,e,i){e=this.toSeconds(e),this.setRampPoint(e),t=this._fromUnits(t);for(var s=this._events.get(e),n=Math.round(Math.max(1/i,1)),o=0;o<=n;o++){var a=i*o+e,r=this._exponentialApproach(s.time,s.value,t,i,a);this.linearRampToValueAtTime(this._toUnits(r),a)}return this},s.default.TickSignal.prototype.exponentialRampToValueAtTime=function(t,e){e=this.toSeconds(e),t=this._fromUnits(t);for(var i=this._events.get(e),s=Math.round(Math.max(10*(e-i.time),1)),n=(e-i.time)/s,o=0;o<=s;o++){var a=n*o+i.time,r=this._exponentialInterpolate(i.time,i.value,e,t,a);this.linearRampToValueAtTime(this._toUnits(r),a)}return this},s.default.TickSignal.prototype._getTicksUntilEvent=function(t,e){if(null===t)t={ticks:0,time:0};else if(s.default.isUndef(t.ticks)){var i=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(i,t.time)}var n=this.getValueAtTime(t.time),o=this.getValueAtTime(e);return this._events.get(e).time===e&&this._events.get(e).type===s.default.Param.AutomationType.SetValue&&(o=this.getValueAtTime(e-this.sampleTime)),.5*(e-t.time)*(n+o)+t.ticks},s.default.TickSignal.prototype.getTicksAtTime=function(t){t=this.toSeconds(t);var e=this._events.get(t);return Math.max(this._getTicksUntilEvent(e,t),0)},s.default.TickSignal.prototype.getDurationOfTicks=function(t,e){e=this.toSeconds(e);var i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-e},s.default.TickSignal.prototype.getTimeOfTick=function(t){var e=this._events.get(t,"ticks"),i=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&i&&i.type===s.default.Param.AutomationType.Linear&&e.value!==i.value){var n=this.getValueAtTime(e.time),o=(this.getValueAtTime(i.time)-n)/(i.time-e.time),a=Math.sqrt(Math.pow(n,2)-2*o*(e.ticks-t)),r=(-n+a)/o;return(r>0?r:(-n-a)/o)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue},s.default.TickSignal.prototype.ticksToTime=function(t,e){return e=this.toSeconds(e),new s.default.Time(this.getDurationOfTicks(t,e))},s.default.TickSignal.prototype.timeToTicks=function(t,e){e=this.toSeconds(e),t=this.toSeconds(t);var i=this.getTicksAtTime(e),n=this.getTicksAtTime(e+t);return new s.default.Ticks(n-i)},e.default=s.default.TickSignal},function(t,e,i){"use strict";i.r(e);var s=i(0);i(57),i(34),i(35),i(20);s.default.Clock=function(){var t=s.default.defaults(arguments,["callback","frequency"],s.default.Clock);s.default.Emitter.call(this),this.callback=t.callback,this._nextTick=0,this._tickSource=new s.default.TickSource(t.frequency),this._lastUpdate=0,this.frequency=this._tickSource.frequency,this._readOnly("frequency"),this._state=new s.default.TimelineState(s.default.State.Stopped),this._state.setStateAtTime(s.default.State.Stopped,0),this._boundLoop=this._loop.bind(this),this.context.on("tick",this._boundLoop)},s.default.extend(s.default.Clock,s.default.Emitter),s.default.Clock.defaults={callback:s.default.noOp,frequency:1},Object.defineProperty(s.default.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),s.default.Clock.prototype.start=function(t,e){return this.context.resume(),t=this.toSeconds(t),this._state.getValueAtTime(t)!==s.default.State.Started&&(this._state.setStateAtTime(s.default.State.Started,t),this._tickSource.start(t,e),t<this._lastUpdate&&this.emit("start",t,e)),this},s.default.Clock.prototype.stop=function(t){return t=this.toSeconds(t),this._state.cancel(t),this._state.setStateAtTime(s.default.State.Stopped,t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this},s.default.Clock.prototype.pause=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)===s.default.State.Started&&(this._state.setStateAtTime(s.default.State.Paused,t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this},Object.defineProperty(s.default.Clock.prototype,"ticks",{get:function(){return Math.ceil(this.getTicksAtTime(this.now()))},set:function(t){this._tickSource.ticks=t}}),Object.defineProperty(s.default.Clock.prototype,"seconds",{get:function(){return this._tickSource.seconds},set:function(t){this._tickSource.seconds=t}}),s.default.Clock.prototype.getSecondsAtTime=function(t){return this._tickSource.getSecondsAtTime(t)},s.default.Clock.prototype.setTicksAtTime=function(t,e){return this._tickSource.setTicksAtTime(t,e),this},s.default.Clock.prototype.getTicksAtTime=function(t){return this._tickSource.getTicksAtTime(t)},s.default.Clock.prototype.nextTickTime=function(t,e){e=this.toSeconds(e);var i=this.getTicksAtTime(e);return this._tickSource.getTimeOfTick(i+t,e)},s.default.Clock.prototype._loop=function(){var t=this._lastUpdate,e=this.now();this._lastUpdate=e,t!==e&&(this._state.forEachBetween(t,e,function(t){switch(t.state){case s.default.State.Started:var e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case s.default.State.Stopped:0!==t.time&&this.emit("stop",t.time);break;case s.default.State.Paused:this.emit("pause",t.time)}}.bind(this)),this._tickSource.forEachTickBetween(t,e,function(t,e){this.callback(t,e)}.bind(this)))},s.default.Clock.prototype.getStateAtTime=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)},s.default.Clock.prototype.dispose=function(){s.default.Emitter.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._writable("frequency"),this._tickSource.dispose(),this._tickSource=null,this.frequency=null,this._boundLoop=null,this._nextTick=1/0,this.callback=null,this._state.dispose(),this._state=null},e.default=s.default.Clock},function(t,e,i){"use strict";i.r(e);var s=i(0);i(2),i(5),i(7);s.default.GreaterThanZero=function(){s.default.SignalBase.call(this),this._thresh=this.output=new s.default.WaveShaper(function(t){return t<=0?0:1},127),this._scale=this.input=new s.default.Multiply(1e4),this._scale.connect(this._thresh)},s.default.extend(s.default.GreaterThanZero,s.default.SignalBase),s.default.GreaterThanZero.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},e.default=s.default.GreaterThanZero},function(t,e,i){"use strict";i.r(e);var s=i(0);i(84),i(13),i(2);s.default.GreaterThan=function(t){s.default.Signal.call(this),this.createInsOuts(2,0),this._param=this.input[0]=new s.default.Subtract(t),this.input[1]=this._param.input[1],this._gtz=this.output=new s.default.GreaterThanZero,this._param.connect(this._gtz)},s.default.extend(s.default.GreaterThan,s.default.Signal),s.default.GreaterThan.prototype.dispose=function(){return s.default.Signal.prototype.dispose.call(this),this._gtz.dispose(),this._gtz=null,this},e.default=s.default.GreaterThan},function(t,e,i){"use strict";i.r(e);var s=i(0);i(47),i(26);s.default.ScaledEnvelope=function(){var t=s.default.defaults(arguments,["attack","decay","sustain","release"],s.default.Envelope);s.default.Envelope.call(this,t),t=s.default.defaultArg(t,s.default.ScaledEnvelope.defaults),this._exp=this.output=new s.default.Pow(t.exponent),this._scale=this.output=new s.default.Scale(t.min,t.max),this._sig.chain(this._exp,this._scale)},s.default.extend(s.default.ScaledEnvelope,s.default.Envelope),s.default.ScaledEnvelope.defaults={min:0,max:1,exponent:1},Object.defineProperty(s.default.ScaledEnvelope.prototype,"min",{get:function(){return this._scale.min},set:function(t){this._scale.min=t}}),Object.defineProperty(s.default.ScaledEnvelope.prototype,"max",{get:function(){return this._scale.max},set:function(t){this._scale.max=t}}),Object.defineProperty(s.default.ScaledEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(t){this._exp.value=t}}),s.default.ScaledEnvelope.prototype.dispose=function(){return s.default.Envelope.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},e.default=s.default.ScaledEnvelope},function(t,e,i){"use strict";i.r(e);var s=i(0);i(7),i(30);s.default.Abs=function(){s.default.SignalBase.call(this),this._abs=this.input=this.output=new s.default.WaveShaper(function(t){return Math.abs(t)<.001?0:Math.abs(t)},1024)},s.default.extend(s.default.Abs,s.default.SignalBase),s.default.Abs.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._abs.dispose(),this._abs=null,this},e.default=s.default.Abs},function(t,e,i){"use strict";i.r(e);var s=i(0);i(3),i(1);s.default.Solo=function(){var t=s.default.defaults(arguments,["solo"],s.default.Solo);s.default.AudioNode.call(this),this.input=this.output=new s.default.Gain,this._soloBind=this._soloed.bind(this),this.context.on("solo",this._soloBind),this.solo=t.solo},s.default.extend(s.default.Solo,s.default.AudioNode),s.default.Solo.defaults={solo:!1},Object.defineProperty(s.default.Solo.prototype,"solo",{get:function(){return this._isSoloed()},set:function(t){t?this._addSolo():this._removeSolo(),this.context.emit("solo",this)}}),Object.defineProperty(s.default.Solo.prototype,"muted",{get:function(){return 0===this.input.gain.value}}),s.default.Solo.prototype._addSolo=function(){s.default.isArray(this.context._currentSolo)||(this.context._currentSolo=[]),this._isSoloed()||this.context._currentSolo.push(this)},s.default.Solo.prototype._removeSolo=function(){if(this._isSoloed()){var t=this.context._currentSolo.indexOf(this);this.context._currentSolo.splice(t,1)}},s.default.Solo.prototype._isSoloed=function(){return!!s.default.isArray(this.context._currentSolo)&&(0!==this.context._currentSolo.length&&-1!==this.context._currentSolo.indexOf(this))},s.default.Solo.prototype._noSolos=function(){return!s.default.isArray(this.context._currentSolo)||0===this.context._currentSolo.length},s.default.Solo.prototype._soloed=function(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0},s.default.Solo.prototype.dispose=function(){return this.context.off("solo",this._soloBind),this._removeSolo(),this._soloBind=null,s.default.AudioNode.prototype.dispose.call(this),this},e.default=s.default.Solo},function(t,e,i){"use strict";i.r(e);var s=i(0);i(7);s.default.EqualPowerGain=function(){s.default.SignalBase.call(this),this._eqPower=this.input=this.output=new s.default.WaveShaper(function(t){return Math.abs(t)<.001?0:s.default.equalPowerScale(t)}.bind(this),4096)},s.default.extend(s.default.EqualPowerGain,s.default.SignalBase),s.default.EqualPowerGain.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},e.default=s.default.EqualPowerGain},function(t,e,i){"use strict";i.r(e);var s=i(0);i(5),i(2);s.default.Negate=function(){s.default.SignalBase.call(this),this._multiply=this.input=this.output=new s.default.Multiply(-1)},s.default.extend(s.default.Negate,s.default.SignalBase),s.default.Negate.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},e.default=s.default.Negate},function(t,e,i){"use strict";i.r(e);var s=i(0);i(48),i(27),i(1);s.default.PanVol=function(){var t=s.default.defaults(arguments,["pan","volume"],s.default.PanVol);s.default.AudioNode.call(this),this._panner=this.input=new s.default.Panner(t.pan),this.pan=this._panner.pan,this._volume=this.output=new s.default.Volume(t.volume),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,this._readOnly(["pan","volume"])},s.default.extend(s.default.PanVol,s.default.AudioNode),s.default.PanVol.defaults={pan:0,volume:0,mute:!1},Object.defineProperty(s.default.PanVol.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}}),s.default.PanVol.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable(["pan","volume"]),this._panner.dispose(),this._panner=null,this.pan=null,this._volume.dispose(),this._volume=null,this.volume=null,this},e.default=s.default.PanVol},function(t,e,i){"use strict";var s=i(0);if(s.default.supported){!s.default.global.hasOwnProperty("OfflineAudioContext")&&s.default.global.hasOwnProperty("webkitOfflineAudioContext")&&(s.default.global.OfflineAudioContext=s.default.global.webkitOfflineAudioContext);var n=new OfflineAudioContext(1,1,44100).startRendering();n&&s.default.isFunction(n.then)||(OfflineAudioContext.prototype._native_startRendering=OfflineAudioContext.prototype.startRendering,OfflineAudioContext.prototype.startRendering=function(){return new Promise(function(t){this.oncomplete=function(e){t(e.renderedBuffer)},this._native_startRendering()}.bind(this))})}},function(t,e,i){"use strict";e.a="dev"},function(t,e,i){"use strict";i.r(e);var s=i(0);i(46);s.default.Midi=function(t,e){if(!(this instanceof s.default.Midi))return new s.default.Midi(t,e);s.default.Frequency.call(this,t,e)},s.default.extend(s.default.Midi,s.default.Frequency),s.default.Midi.prototype._defaultUnits="midi",s.default.Midi.prototype._frequencyToUnits=function(t){return s.default.Frequency.ftom(s.default.Frequency.prototype._frequencyToUnits.call(this,t))},s.default.Midi.prototype._ticksToUnits=function(t){return s.default.Frequency.ftom(s.default.Frequency.prototype._ticksToUnits.call(this,t))},s.default.Midi.prototype._beatsToUnits=function(t){return s.default.Frequency.ftom(s.default.Frequency.prototype._beatsToUnits.call(this,t))},s.default.Midi.prototype._secondsToUnits=function(t){return s.default.Frequency.ftom(s.default.Frequency.prototype._secondsToUnits.call(this,t))},s.default.Midi.prototype.toMidi=function(){return this.valueOf()},s.default.Midi.prototype.toFrequency=function(){return s.default.Frequency.mtof(this.toMidi())},s.default.Midi.prototype.transpose=function(t){return new this.constructor(this.toMidi()+t)},e.default=s.default.Midi},function(t,e,i){"use strict";i.r(e);var s=i(0);i(27),i(1);s.default.UserMedia=function(){var t=s.default.defaults(arguments,["volume"],s.default.UserMedia);s.default.AudioNode.call(this),this._mediaStream=null,this._stream=null,this._device=null,this._volume=this.output=new s.default.Volume(t.volume),this.volume=this._volume.volume,this._readOnly("volume"),this.mute=t.mute},s.default.extend(s.default.UserMedia,s.default.AudioNode),s.default.UserMedia.defaults={volume:0,mute:!1},s.default.UserMedia.prototype.open=function(t){return this.state===s.default.State.Started&&this.close(),s.default.UserMedia.enumerateDevices().then(function(e){var i;if(s.default.isNumber(t))i=e[t];else if(!(i=e.find(function(e){return e.label===t||e.deviceId===t}))&&e.length>0)i=e[0];else if(!i&&s.default.isDefined(t))throw new Error("Tone.UserMedia: no matching device: "+t);this._device=i;var n={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};return i&&(n.audio.deviceId=i.deviceId),navigator.mediaDevices.getUserMedia(n).then(function(t){return this._stream||(this._stream=t,this._mediaStream=this.context.createMediaStreamSource(t),s.default.connect(this._mediaStream,this.output)),this}.bind(this))}.bind(this))},s.default.UserMedia.prototype.close=function(){return this._stream&&(this._stream.getAudioTracks().forEach(function(t){t.stop()}),this._stream=null,this._mediaStream.disconnect(),this._mediaStream=null),this._device=null,this},s.default.UserMedia.enumerateDevices=function(){return navigator.mediaDevices.enumerateDevices().then(function(t){return t.filter(function(t){return"audioinput"===t.kind})})},Object.defineProperty(s.default.UserMedia.prototype,"state",{get:function(){return this._stream&&this._stream.active?s.default.State.Started:s.default.State.Stopped}}),Object.defineProperty(s.default.UserMedia.prototype,"deviceId",{get:function(){return this._device?this._device.deviceId:null}}),Object.defineProperty(s.default.UserMedia.prototype,"groupId",{get:function(){return this._device?this._device.groupId:null}}),Object.defineProperty(s.default.UserMedia.prototype,"label",{get:function(){return this._device?this._device.label:null}}),Object.defineProperty(s.default.UserMedia.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}}),s.default.UserMedia.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this.close(),this._writable("volume"),this._volume.dispose(),this._volume=null,this.volume=null,this},Object.defineProperty(s.default.UserMedia,"supported",{get:function(){return s.default.isDefined(navigator.mediaDevices)&&s.default.isFunction(navigator.mediaDevices.getUserMedia)}}),e.default=s.default.UserMedia},function(t,e,i){"use strict";i.r(e);var s=i(0);i(64),i(27),i(1);s.default.Players=function(t){var e=Array.prototype.slice.call(arguments);e.shift();var i=s.default.defaults(e,["onload"],s.default.Players);for(var n in s.default.AudioNode.call(this,i),this._volume=this.output=new s.default.Volume(i.volume),this.volume=this._volume.volume,this._readOnly("volume"),this._volume.output.output.channelCount=2,this._volume.output.output.channelCountMode="explicit",this.mute=i.mute,this._players={},this._loadingCount=0,this._fadeIn=i.fadeIn,this._fadeOut=i.fadeOut,t)this._loadingCount++,this.add(n,t[n],this._bufferLoaded.bind(this,i.onload))},s.default.extend(s.default.Players,s.default.AudioNode),s.default.Players.defaults={volume:0,mute:!1,onload:s.default.noOp,fadeIn:0,fadeOut:0},s.default.Players.prototype._bufferLoaded=function(t){this._loadingCount--,0===this._loadingCount&&t&&t(this)},Object.defineProperty(s.default.Players.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}}),Object.defineProperty(s.default.Players.prototype,"fadeIn",{get:function(){return this._fadeIn},set:function(t){this._fadeIn=t,this._forEach(function(e){e.fadeIn=t})}}),Object.defineProperty(s.default.Players.prototype,"fadeOut",{get:function(){return this._fadeOut},set:function(t){this._fadeOut=t,this._forEach(function(e){e.fadeOut=t})}}),Object.defineProperty(s.default.Players.prototype,"state",{get:function(){var t=!1;return this._forEach(function(e){t=t||e.state===s.default.State.Started}),t?s.default.State.Started:s.default.State.Stopped}}),s.default.Players.prototype.has=function(t){return this._players.hasOwnProperty(t)},s.default.Players.prototype.get=function(t){if(this.has(t))return this._players[t];throw new Error("Tone.Players: no player named "+t)},s.default.Players.prototype._forEach=function(t){for(var e in this._players)t(this._players[e],e);return this},Object.defineProperty(s.default.Players.prototype,"loaded",{get:function(){var t=!0;return this._forEach(function(e){t=t&&e.loaded}),t}}),s.default.Players.prototype.add=function(t,e,i){return this._players[t]=new s.default.Player(e,i).connect(this.output),this._players[t].fadeIn=this._fadeIn,this._players[t].fadeOut=this._fadeOut,this},s.default.Players.prototype.stopAll=function(t){this._forEach(function(e){e.stop(t)})},s.default.Players.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._volume.dispose(),this._volume=null,this._writable("volume"),this.volume=null,this.output=null,this._forEach(function(t){t.dispose()}),this._players=null,this},e.default=s.default.Players},function(t,e,i){"use strict";i.r(e);var s=i(0);i(6),i(11),i(32);s.default.GrainPlayer=function(){var t=s.default.defaults(arguments,["url","onload"],s.default.GrainPlayer);s.default.Source.call(this,t),this.buffer=new s.default.Buffer(t.url,t.onload.bind(void 0,this)),this._clock=new s.default.Clock(this._tick.bind(this),t.grainSize),this._loopStart=0,this._loopEnd=0,this._activeSources=[],this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))},s.default.extend(s.default.GrainPlayer,s.default.Source),s.default.GrainPlayer.defaults={onload:s.default.noOp,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1},s.default.GrainPlayer.prototype._start=function(t,e,i){e=s.default.defaultArg(e,0),e=this.toSeconds(e),t=this.toSeconds(t),this._offset=e,this._clock.start(t),i&&this.stop(t+this.toSeconds(i))},s.default.GrainPlayer.prototype._stop=function(t){this._clock.stop(t)},s.default.GrainPlayer.prototype._onstop=function(t){this._activeSources.forEach(function(e){e.fadeOut=0,e.stop(t)})},s.default.GrainPlayer.prototype._tick=function(t){if(!this.loop&&this._offset>this.buffer.duration)this.stop(t);else{var e=this._offset<this._overlap?0:this._overlap,i=new s.default.BufferSource({buffer:this.buffer,fadeIn:e,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:s.default.intervalToFrequencyRatio(this.detune/100)}).connect(this.output);i.start(t,this._offset),this._offset+=this.grainSize,i.stop(t+this.grainSize/this.playbackRate),this._activeSources.push(i),i.onended=function(){var t=this._activeSources.indexOf(i);-1!==t&&this._activeSources.splice(t,1)}.bind(this)}},Object.defineProperty(s.default.GrainPlayer.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this.grainSize=this._grainSize}}),Object.defineProperty(s.default.GrainPlayer.prototype,"loopStart",{get:function(){return this._loopStart},set:function(t){this._loopStart=this.toSeconds(t)}}),Object.defineProperty(s.default.GrainPlayer.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(t){this._loopEnd=this.toSeconds(t)}}),Object.defineProperty(s.default.GrainPlayer.prototype,"reverse",{get:function(){return this.buffer.reverse},set:function(t){this.buffer.reverse=t}}),Object.defineProperty(s.default.GrainPlayer.prototype,"grainSize",{get:function(){return this._grainSize},set:function(t){this._grainSize=this.toSeconds(t),this._clock.frequency.value=this._playbackRate/this._grainSize}}),Object.defineProperty(s.default.GrainPlayer.prototype,"overlap",{get:function(){return this._overlap},set:function(t){this._overlap=this.toSeconds(t)}}),Object.defineProperty(s.default.GrainPlayer.prototype,"loaded",{get:function(){return this.buffer.loaded}}),s.default.GrainPlayer.prototype.dispose=function(){return s.default.Source.prototype.dispose.call(this),this.buffer.dispose(),this.buffer=null,this._clock.dispose(),this._clock=null,this._activeSources.forEach(function(t){t.dispose()}),this._activeSources=null,this},e.default=s.default.GrainPlayer},function(t,e,i){"use strict";i.r(e);var s=i(0);i(16),i(2),i(45);s.default.TransportTimelineSignal=function(){s.default.Signal.apply(this,arguments),this.output=this._outputSig=new s.default.Signal(this._initialValue),this._lastVal=this.value,this._synced=s.default.Transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._bindAnchorValue=this._anchorValue.bind(this),s.default.Transport.on("start stop pause",this._bindAnchorValue),this._events.memory=1/0},s.default.extend(s.default.TransportTimelineSignal,s.default.Signal),s.default.TransportTimelineSignal.prototype._onTick=function(t){var e=this.getValueAtTime(s.default.Transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._outputSig.linearRampToValueAtTime(e,t))},s.default.TransportTimelineSignal.prototype._anchorValue=function(t){var e=this.getValueAtTime(s.default.Transport.seconds);return this._lastVal=e,this._outputSig.cancelScheduledValues(t),this._outputSig.setValueAtTime(e,t),this},s.default.TransportTimelineSignal.prototype.getValueAtTime=function(t){return t=s.default.TransportTime(t),s.default.Signal.prototype.getValueAtTime.call(this,t)},s.default.TransportTimelineSignal.prototype.setValueAtTime=function(t,e){return e=s.default.TransportTime(e),s.default.Signal.prototype.setValueAtTime.call(this,t,e),this},s.default.TransportTimelineSignal.prototype.linearRampToValueAtTime=function(t,e){return e=s.default.TransportTime(e),s.default.Signal.prototype.linearRampToValueAtTime.call(this,t,e),this},s.default.TransportTimelineSignal.prototype.exponentialRampToValueAtTime=function(t,e){return e=s.default.TransportTime(e),s.default.Signal.prototype.exponentialRampToValueAtTime.call(this,t,e),this},s.default.TransportTimelineSignal.prototype.setTargetAtTime=function(t,e,i){return e=s.default.TransportTime(e),s.default.Signal.prototype.setTargetAtTime.call(this,t,e,i),this},s.default.TransportTimelineSignal.prototype.cancelScheduledValues=function(t){return t=s.default.TransportTime(t),s.default.Signal.prototype.cancelScheduledValues.call(this,t),this},s.default.TransportTimelineSignal.prototype.setValueCurveAtTime=function(t,e,i,n){return e=s.default.TransportTime(e),i=s.default.TransportTime(i),s.default.Signal.prototype.setValueCurveAtTime.call(this,t,e,i,n),this},s.default.TransportTimelineSignal.prototype.cancelAndHoldAtTime=function(t){return s.default.Signal.prototype.cancelAndHoldAtTime.call(this,s.default.TransportTime(t))},s.default.TransportTimelineSignal.prototype.dispose=function(){s.default.Transport.clear(this._synced),s.default.Transport.off("start stop pause",this._syncedCallback),this._events.cancel(0),s.default.Signal.prototype.dispose.call(this),this._outputSig.dispose(),this._outputSig=null},e.default=s.default.TransportTimelineSignal},function(t,e,i){"use strict";i.r(e);var s=i(0);i(29),i(5);s.default.Normalize=function(t,e){s.default.SignalBase.call(this),this._inputMin=s.default.defaultArg(t,0),this._inputMax=s.default.defaultArg(e,1),this._sub=this.input=new s.default.Add(0),this._div=this.output=new s.default.Multiply(1),this._sub.connect(this._div),this._setRange()},s.default.extend(s.default.Normalize,s.default.SignalBase),Object.defineProperty(s.default.Normalize.prototype,"min",{get:function(){return this._inputMin},set:function(t){this._inputMin=t,this._setRange()}}),Object.defineProperty(s.default.Normalize.prototype,"max",{get:function(){return this._inputMax},set:function(t){this._inputMax=t,this._setRange()}}),s.default.Normalize.prototype._setRange=function(){this._sub.value=-this._inputMin,this._div.value=1/(this._inputMax-this._inputMin)},s.default.Normalize.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._sub.dispose(),this._sub=null,this._div.dispose(),this._div=null,this},e.default=s.default.Normalize},function(t,e,i){"use strict";i.r(e);var s=i(0);i(7),i(2);s.default.GainToAudio=function(){s.default.SignalBase.call(this),this._norm=this.input=this.output=new s.default.WaveShaper(function(t){return 2*Math.abs(t)-1})},s.default.extend(s.default.GainToAudio,s.default.SignalBase),s.default.GainToAudio.prototype.dispose=function(){return s.default.SignalBase.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},e.default=s.default.GainToAudio},function(t,e,i){"use strict";i.r(e);var s=i(0);i(21),i(77),i(32);s.default.Sampler=function(t){var e=Array.prototype.slice.call(arguments);e.shift();var i=s.default.defaults(e,["onload","baseUrl"],s.default.Sampler);s.default.Instrument.call(this,i);var n={};for(var o in t)if(s.default.isNote(o)){n[s.default.Frequency(o).toMidi()]=t[o]}else{if(isNaN(parseFloat(o)))throw new Error("Tone.Sampler: url keys must be the note's pitch");n[o]=t[o]}this._buffers=new s.default.Buffers(n,i.onload,i.baseUrl),this._activeSources={},this.attack=i.attack,this.release=i.release,this.curve=i.curve},s.default.extend(s.default.Sampler,s.default.Instrument),s.default.Sampler.defaults={attack:0,release:.1,onload:s.default.noOp,baseUrl:"",curve:"exponential"},s.default.Sampler.prototype._findClosest=function(t){for(var e=0;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error("No available buffers for note: "+t)},s.default.Sampler.prototype.triggerAttack=function(t,e,i){this.log("triggerAttack",t,e,i),Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var o=s.default.Frequency(t[n]).toMidi(),a=this._findClosest(o),r=o-a,l=this._buffers.get(r),u=s.default.intervalToFrequencyRatio(a),f=new s.default.BufferSource({buffer:l,playbackRate:u,fadeIn:this.attack,fadeOut:this.release,curve:this.curve}).connect(this.output);f.start(e,0,l.duration/u,i),s.default.isArray(this._activeSources[o])||(this._activeSources[o]=[]),this._activeSources[o].push(f),f.onended=function(){if(this._activeSources&&this._activeSources[o]){var t=this._activeSources[o].indexOf(f);-1!==t&&this._activeSources[o].splice(t,1)}}.bind(this)}return this},s.default.Sampler.prototype.triggerRelease=function(t,e){this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var n=s.default.Frequency(t[i]).toMidi();this._activeSources[n]&&this._activeSources[n].length&&(e=this.toSeconds(e),this._activeSources[n].forEach(function(t){t.stop(e)}),this._activeSources[n]=[])}return this},s.default.Sampler.prototype.releaseAll=function(t){for(var e in t=this.toSeconds(t),this._activeSources)for(var i=this._activeSources[e];i.length;){i.shift().stop(t)}return this},s.default.Sampler.prototype.sync=function(){return this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this},s.default.Sampler.prototype.triggerAttackRelease=function(t,e,i,n){if(i=this.toSeconds(i),this.triggerAttack(t,i,n),s.default.isArray(e)&&s.default.isArray(t))for(var o=0;o<t.length;o++){var a=e[Math.min(o,e.length-1)];this.triggerRelease(t[o],i+this.toSeconds(a))}else this.triggerRelease(t,i+this.toSeconds(e));return this},s.default.Sampler.prototype.add=function(t,e,i){if(s.default.isNote(t)){var n=s.default.Frequency(t).toMidi();this._buffers.add(n,e,i)}else{if(isNaN(parseFloat(t)))throw new Error("Tone.Sampler: note must be the note's pitch. Instead got "+t);this._buffers.add(t,e,i)}},Object.defineProperty(s.default.Sampler.prototype,"loaded",{get:function(){return this._buffers.loaded}}),s.default.Sampler.prototype.dispose=function(){for(var t in s.default.Instrument.prototype.dispose.call(this),this._buffers.dispose(),this._buffers=null,this._activeSources)this._activeSources[t].forEach(function(t){t.dispose()});return this._activeSources=null,this},e.default=s.default.Sampler},function(t,e,i){"use strict";i.r(e);var s=i(0);i(38),i(6);s.default.PolySynth=function(){var t=s.default.defaults(arguments,["polyphony","voice"],s.default.PolySynth);s.default.Instrument.call(this,t),(t=s.default.defaultArg(t,s.default.Instrument.defaults)).polyphony=Math.min(s.default.PolySynth.MAX_POLYPHONY,t.polyphony),this.voices=new Array(t.polyphony),this.assert(t.polyphony>0,"polyphony must be greater than 0"),this.detune=new s.default.Signal(t.detune,s.default.Type.Cents),this._readOnly("detune");for(var e=0;e<t.polyphony;e++){var i=new t.voice(arguments[2],arguments[3]);if(!(i instanceof s.default.Monophonic))throw new Error("Synth constructor must be instance of Tone.Monophonic");this.voices[e]=i,i.index=e,i.connect(this.output),i.hasOwnProperty("detune")&&this.detune.connect(i.detune)}},s.default.extend(s.default.PolySynth,s.default.Instrument),s.default.PolySynth.defaults={polyphony:4,volume:0,detune:0,voice:s.default.Synth},s.default.PolySynth.prototype._getClosestVoice=function(t,e){var i=this.voices.find(function(i){if(Math.abs(i.frequency.getValueAtTime(t)-s.default.Frequency(e))<1e-4&&i.getLevelAtTime(t)>1e-5)return i});return i||this.voices.slice().sort(function(e,i){var s=e.getLevelAtTime(t+this.blockTime),n=i.getLevelAtTime(t+this.blockTime);return s<1e-5&&(s=0),n<1e-5&&(n=0),s-n}.bind(this))[0]},s.default.PolySynth.prototype.triggerAttack=function(t,e,i){return Array.isArray(t)||(t=[t]),e=this.toSeconds(e),t.forEach(function(t){var s=this._getClosestVoice(e,t);s.triggerAttack(t,e,i),this.log("triggerAttack",s.index,t)}.bind(this)),this},s.default.PolySynth.prototype.triggerRelease=function(t,e){return Array.isArray(t)||(t=[t]),e=this.toSeconds(e),t.forEach(function(t){var i=this._getClosestVoice(e,t);this.log("triggerRelease",i.index,t),i.triggerRelease(e)}.bind(this)),this},s.default.PolySynth.prototype.triggerAttackRelease=function(t,e,i,n){if(i=this.toSeconds(i),this.triggerAttack(t,i,n),s.default.isArray(e)&&s.default.isArray(t))for(var o=0;o<t.length;o++){var a=e[Math.min(o,e.length-1)];this.triggerRelease(t[o],i+this.toSeconds(a))}else this.triggerRelease(t,i+this.toSeconds(e));return this},s.default.PolySynth.prototype.sync=function(){return this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this},s.default.PolySynth.prototype.set=function(t,e,i){for(var s=0;s<this.voices.length;s++)this.voices[s].set(t,e,i);return this},s.default.PolySynth.prototype.get=function(t){return this.voices[0].get(t)},s.default.PolySynth.prototype.releaseAll=function(t){return t=this.toSeconds(t),this.voices.forEach(function(e){e.triggerRelease(t)}),this},s.default.PolySynth.prototype.dispose=function(){return s.default.Instrument.prototype.dispose.call(this),this.voices.forEach(function(t){t.dispose()}),this._writable("detune"),this.detune.dispose(),this.detune=null,this.voices=null,this},s.default.PolySynth.MAX_POLYPHONY=20,e.default=s.default.PolySynth},function(t,e,i){"use strict";i.r(e);var s=i(0);i(21),i(39),i(54);s.default.PluckSynth=function(t){t=s.default.defaultArg(t,s.default.PluckSynth.defaults),s.default.Instrument.call(this,t),this._noise=new s.default.Noise("pink"),this.attackNoise=t.attackNoise,this._lfcf=new s.default.LowpassCombFilter({resonance:t.resonance,dampening:t.dampening}),this.resonance=this._lfcf.resonance,this.dampening=this._lfcf.dampening,this._noise.connect(this._lfcf),this._lfcf.connect(this.output),this._readOnly(["resonance","dampening"])},s.default.extend(s.default.PluckSynth,s.default.Instrument),s.default.PluckSynth.defaults={attackNoise:1,dampening:4e3,resonance:.7},s.default.PluckSynth.prototype.triggerAttack=function(t,e){t=this.toFrequency(t),e=this.toSeconds(e);var i=1/t;return this._lfcf.delayTime.setValueAtTime(i,e),this._noise.start(e),this._noise.stop(e+i*this.attackNoise),this},s.default.PluckSynth.prototype.dispose=function(){return s.default.Instrument.prototype.dispose.call(this),this._noise.dispose(),this._lfcf.dispose(),this._noise=null,this._lfcf=null,this._writable(["resonance","dampening"]),this.dampening=null,this.resonance=null,this},e.default=s.default.PluckSynth},function(t,e,i){"use strict";i.r(e);var s=i(0);i(31),i(41),i(39),i(2),i(9),i(21);s.default.NoiseSynth=function(t){t=s.default.defaultArg(t,s.default.NoiseSynth.defaults),s.default.Instrument.call(this,t),this.noise=new s.default.Noise(t.noise),this.envelope=new s.default.AmplitudeEnvelope(t.envelope),this.noise.chain(this.envelope,this.output),this._readOnly(["noise","envelope"])},s.default.extend(s.default.NoiseSynth,s.default.Instrument),s.default.NoiseSynth.defaults={noise:{type:"white"},envelope:{attack:.005,decay:.1,sustain:0}},s.default.NoiseSynth.prototype.triggerAttack=function(t,e){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.envelope.attack+this.envelope.decay),this},s.default.NoiseSynth.prototype.triggerRelease=function(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.envelope.release),this},s.default.NoiseSynth.prototype.sync=function(){return this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0),this},s.default.NoiseSynth.prototype.triggerAttackRelease=function(t,e,i){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,i),this.triggerRelease(e+t),this},s.default.NoiseSynth.prototype.dispose=function(){return s.default.Instrument.prototype.dispose.call(this),this._writable(["noise","envelope"]),this.noise.dispose(),this.noise=null,this.envelope.dispose(),this.envelope=null,this},e.default=s.default.NoiseSynth},function(t,e,i){"use strict";i.r(e);var s=i(0),n=(i(21),i(49),i(9),i(41),i(31),i(3),i(26),i(5),[1,1.483,1.932,2.546,2.63,3.897]);s.default.MetalSynth=function(t){t=s.default.defaultArg(t,s.default.MetalSynth.defaults),s.default.Instrument.call(this,t),this.frequency=new s.default.Signal(t.frequency,s.default.Type.Frequency),this._oscillators=[],this._freqMultipliers=[],this._amplitue=new s.default.Gain(0).connect(this.output),this._highpass=new s.default.Filter({type:"highpass",Q:-3.0102999566398125}).connect(this._amplitue),this._octaves=t.octaves,this._filterFreqScaler=new s.default.Scale(t.resonance,7e3),this.envelope=new s.default.Envelope({attack:t.envelope.attack,attackCurve:"linear",decay:t.envelope.decay,sustain:0,release:t.envelope.release}).chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitue.gain);for(var e=0;e<n.length;e++){var i=new s.default.FMOscillator({type:"square",modulationType:"square",harmonicity:t.harmonicity,modulationIndex:t.modulationIndex});i.connect(this._highpass),this._oscillators[e]=i;var o=new s.default.Multiply(n[e]);this._freqMultipliers[e]=o,this.frequency.chain(o,i.frequency)}this.octaves=t.octaves},s.default.extend(s.default.MetalSynth,s.default.Instrument),s.default.MetalSynth.defaults={frequency:200,envelope:{attack:.001,decay:1.4,release:.2},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5},s.default.MetalSynth.prototype.triggerAttack=function(t,e){return t=this.toSeconds(t),e=s.default.defaultArg(e,1),this.envelope.triggerAttack(t,e),this._oscillators.forEach(function(e){e.start(t)}),0===this.envelope.sustain&&this._oscillators.forEach(function(e){e.stop(t+this.envelope.attack+this.envelope.decay)}.bind(this)),this},s.default.MetalSynth.prototype.triggerRelease=function(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this._oscillators.forEach(function(e){e.stop(t+this.envelope.release)}.bind(this)),this},s.default.MetalSynth.prototype.sync=function(){return this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0),this},s.default.MetalSynth.prototype.triggerAttackRelease=function(t,e,i){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,i),this.triggerRelease(e+t),this},Object.defineProperty(s.default.MetalSynth.prototype,"modulationIndex",{get:function(){return this._oscillators[0].modulationIndex.value},set:function(t){for(var e=0;e<this._oscillators.length;e++)this._oscillators[e].modulationIndex.value=t}}),Object.defineProperty(s.default.MetalSynth.prototype,"harmonicity",{get:function(){return this._oscillators[0].harmonicity.value},set:function(t){for(var e=0;e<this._oscillators.length;e++)this._oscillators[e].harmonicity.value=t}}),Object.defineProperty(s.default.MetalSynth.prototype,"resonance",{get:function(){return this._filterFreqScaler.min},set:function(t){this._filterFreqScaler.min=t,this.octaves=this._octaves}}),Object.defineProperty(s.default.MetalSynth.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}}),s.default.MetalSynth.prototype.dispose=function(){s.default.Instrument.prototype.dispose.call(this);for(var t=0;t<this._oscillators.length;t++)this._oscillators[t].dispose(),this._freqMultipliers[t].dispose();this._oscillators=null,this._freqMultipliers=null,this.frequency.dispose(),this.frequency=null,this._filterFreqScaler.dispose(),this._filterFreqScaler=null,this._amplitue.dispose(),this._amplitue=null,this.envelope.dispose(),this.envelope=null,this._highpass.dispose(),this._highpass=null},e.default=s.default.MetalSynth},function(t,e,i){"use strict";i.r(e);var s=i(0);i(37),i(21),i(31);s.default.MembraneSynth=function(t){t=s.default.defaultArg(t,s.default.MembraneSynth.defaults),s.default.Instrument.call(this,t),this.oscillator=new s.default.OmniOscillator(t.oscillator),this.envelope=new s.default.AmplitudeEnvelope(t.envelope),this.octaves=t.octaves,this.pitchDecay=t.pitchDecay,this.oscillator.chain(this.envelope,this.output),this._readOnly(["oscillator","envelope"])},s.default.extend(s.default.MembraneSynth,s.default.Instrument),s.default.MembraneSynth.defaults={pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:.4,sustain:.01,release:1.4,attackCurve:"exponential"}},s.default.MembraneSynth.prototype.triggerAttack=function(t,e,i){e=this.toSeconds(e);var s=(t=this.toFrequency(t))*this.octaves;return this.oscillator.frequency.setValueAtTime(s,e),this.oscillator.frequency.exponentialRampToValueAtTime(t,e+this.toSeconds(this.pitchDecay)),this.envelope.triggerAttack(e,i),this.oscillator.start(e),0===this.envelope.sustain&&this.oscillator.stop(e+this.envelope.attack+this.envelope.decay),this},s.default.MembraneSynth.prototype.triggerRelease=function(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.oscillator.stop(t+this.envelope.release),this},s.default.MembraneSynth.prototype.dispose=function(){return s.default.Instrument.prototype.dispose.call(this),this._writable(["oscillator","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this},e.default=s.default.MembraneSynth},function(t,e,i){"use strict";i.r(e);var s=i(0);i(38),i(2),i(5),i(25);s.default.FMSynth=function(t){t=s.default.defaultArg(t,s.default.FMSynth.defaults),s.default.Monophonic.call(this,t),this._carrier=new s.default.Synth(t.carrier),this._carrier.volume.value=-10,this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope.set(t.envelope),this._modulator=new s.default.Synth(t.modulator),this._modulator.volume.value=-10,this.modulation=this._modulator.oscillator.set(t.modulation),this.modulationEnvelope=this._modulator.envelope.set(t.modulationEnvelope),this.frequency=new s.default.Signal(440,s.default.Type.Frequency),this.detune=new s.default.Signal(t.detune,s.default.Type.Cents),this.harmonicity=new s.default.Multiply(t.harmonicity),this.harmonicity.units=s.default.Type.Positive,this.modulationIndex=new s.default.Multiply(t.modulationIndex),this.modulationIndex.units=s.default.Type.Positive,this._modulationNode=new s.default.Gain(0),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this._readOnly(["frequency","harmonicity","modulationIndex","oscillator","envelope","modulation","modulationEnvelope","detune"])},s.default.extend(s.default.FMSynth,s.default.Monophonic),s.default.FMSynth.defaults={harmonicity:3,modulationIndex:10,detune:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}},s.default.FMSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t),this},s.default.FMSynth.prototype._triggerEnvelopeRelease=function(t){return t=this.toSeconds(t),this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this},s.default.FMSynth.prototype.dispose=function(){return s.default.Monophonic.prototype.dispose.call(this),this._writable(["frequency","harmonicity","modulationIndex","oscillator","envelope","modulation","modulationEnvelope","detune"]),this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this.modulationIndex.dispose(),this.modulationIndex=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationNode.dispose(),this._modulationNode=null,this.oscillator=null,this.envelope=null,this.modulationEnvelope=null,this.modulation=null,this},e.default=s.default.FMSynth},function(t,e,i){"use strict";i.r(e);var s=i(0);i(65),i(12),i(2),i(5),i(25),i(14);s.default.DuoSynth=function(t){t=s.default.defaultArg(t,s.default.DuoSynth.defaults),s.default.Monophonic.call(this,t),this.voice0=new s.default.MonoSynth(t.voice0),this.voice0.volume.value=-10,this.voice1=new s.default.MonoSynth(t.voice1),this.voice1.volume.value=-10,this._vibrato=new s.default.LFO(t.vibratoRate,-50,50),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new s.default.Gain(t.vibratoAmount,s.default.Type.Positive),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new s.default.Signal(440,s.default.Type.Frequency),this.harmonicity=new s.default.Multiply(t.harmonicity),this.harmonicity.units=s.default.Type.Positive,this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),this._readOnly(["voice0","voice1","frequency","vibratoAmount","vibratoRate"])},s.default.extend(s.default.DuoSynth,s.default.Monophonic),s.default.DuoSynth.defaults={vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}},voice1:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}},s.default.DuoSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e),this},s.default.DuoSynth.prototype._triggerEnvelopeRelease=function(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this},s.default.DuoSynth.prototype.getLevelAtTime=function(t){return(this.voice0.getLevelAtTime(t)+this.voice1.getLevelAtTime(t))/2},s.default.DuoSynth.prototype.dispose=function(){return s.default.Monophonic.prototype.dispose.call(this),this._writable(["voice0","voice1","frequency","vibratoAmount","vibratoRate"]),this.voice0.dispose(),this.voice0=null,this.voice1.dispose(),this.voice1=null,this.frequency.dispose(),this.frequency=null,this._vibratoGain.dispose(),this._vibratoGain=null,this._vibrato=null,this.harmonicity.dispose(),this.harmonicity=null,this.vibratoAmount.dispose(),this.vibratoAmount=null,this.vibratoRate=null,this},e.default=s.default.DuoSynth},function(t,e,i){"use strict";i.r(e);var s=i(0);i(38),i(2),i(5),i(25),i(22),i(3);s.default.AMSynth=function(t){t=s.default.defaultArg(t,s.default.AMSynth.defaults),s.default.Monophonic.call(this,t),this._carrier=new s.default.Synth,this._carrier.volume.value=-10,this.oscillator=this._carrier.oscillator.set(t.oscillator),this.envelope=this._carrier.envelope.set(t.envelope),this._modulator=new s.default.Synth,this._modulator.volume.value=-10,this.modulation=this._modulator.oscillator.set(t.modulation),this.modulationEnvelope=this._modulator.envelope.set(t.modulationEnvelope),this.frequency=new s.default.Signal(440,s.default.Type.Frequency),this.detune=new s.default.Signal(t.detune,s.default.Type.Cents),this.harmonicity=new s.default.Multiply(t.harmonicity),this.harmonicity.units=s.default.Type.Positive,this._modulationScale=new s.default.AudioToGain,this._modulationNode=new s.default.Gain,this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),this._readOnly(["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])},s.default.extend(s.default.AMSynth,s.default.Monophonic),s.default.AMSynth.defaults={harmonicity:3,detune:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}},s.default.AMSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t),this},s.default.AMSynth.prototype._triggerEnvelopeRelease=function(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this},s.default.AMSynth.prototype.dispose=function(){return s.default.Monophonic.prototype.dispose.call(this),this._writable(["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"]),this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationScale.dispose(),this._modulationScale=null,this._modulationNode.dispose(),this._modulationNode=null,this.oscillator=null,this.envelope=null,this.modulationEnvelope=null,this.modulation=null,this},e.default=s.default.AMSynth},function(t,e,i){"use strict";i.r(e);var s=i(0);i(69),i(16);s.default.Sequence=function(){var t=s.default.defaults(arguments,["callback","events","subdivision"],s.default.Sequence),e=t.events;if(delete t.events,s.default.Part.call(this,t),this._subdivision=this.toTicks(t.subdivision),s.default.isUndef(t.loopEnd)&&s.default.isDefined(e)&&(this._loopEnd=e.length*this._subdivision),this._loop=!0,s.default.isDefined(e))for(var i=0;i<e.length;i++)this.add(i,e[i])},s.default.extend(s.default.Sequence,s.default.Part),s.default.Sequence.defaults={subdivision:"4n"},Object.defineProperty(s.default.Sequence.prototype,"subdivision",{get:function(){return s.default.Ticks(this._subdivision).toSeconds()}}),s.default.Sequence.prototype.at=function(t,e){return s.default.isArray(e)&&this.remove(t),s.default.Part.prototype.at.call(this,this._indexTime(t),e)},s.default.Sequence.prototype.add=function(t,e){if(null===e)return this;if(s.default.isArray(e)){var i=Math.round(this._subdivision/e.length);e=new s.default.Sequence(this._tick.bind(this),e,s.default.Ticks(i))}return s.default.Part.prototype.add.call(this,this._indexTime(t),e),this},s.default.Sequence.prototype.remove=function(t,e){return s.default.Part.prototype.remove.call(this,this._indexTime(t),e),this},s.default.Sequence.prototype._indexTime=function(t){return t instanceof s.default.TransportTime?t:s.default.Ticks(t*this._subdivision+this.startOffset).toSeconds()},s.default.Sequence.prototype.dispose=function(){return s.default.Part.prototype.dispose.call(this),this},e.default=s.default.Sequence},function(t,e,i){"use strict";i.r(e);var s=i(0);i(70),i(78);s.default.Pattern=function(){var t=s.default.defaults(arguments,["callback","values","pattern"],s.default.Pattern);s.default.Loop.call(this,t),this._pattern=new s.default.CtrlPattern({values:t.values,type:t.pattern,index:t.index})},s.default.extend(s.default.Pattern,s.default.Loop),s.default.Pattern.defaults={pattern:s.default.CtrlPattern.Type.Up,callback:s.default.noOp,values:[]},s.default.Pattern.prototype._tick=function(t){this.callback(t,this._pattern.value),this._pattern.next()},Object.defineProperty(s.default.Pattern.prototype,"index",{get:function(){return this._pattern.index},set:function(t){this._pattern.index=t}}),Object.defineProperty(s.default.Pattern.prototype,"values",{get:function(){return this._pattern.values},set:function(t){this._pattern.values=t}}),Object.defineProperty(s.default.Pattern.prototype,"value",{get:function(){return this._pattern.value}}),Object.defineProperty(s.default.Pattern.prototype,"pattern",{get:function(){return this._pattern.type},set:function(t){this._pattern.type=t}}),s.default.Pattern.prototype.dispose=function(){s.default.Loop.prototype.dispose.call(this),this._pattern.dispose(),this._pattern=null},e.default=s.default.Pattern},function(t,e,i){"use strict";i.r(e);var s=i(0);i(8),i(18),i(12);s.default.Vibrato=function(){var t=s.default.defaults(arguments,["frequency","depth"],s.default.Vibrato);s.default.Effect.call(this,t),this._delayNode=new s.default.Delay(0,t.maxDelay),this._lfo=new s.default.LFO({type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,this._readOnly(["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)},s.default.extend(s.default.Vibrato,s.default.Effect),s.default.Vibrato.defaults={maxDelay:.005,frequency:5,depth:.1,type:"sine"},Object.defineProperty(s.default.Vibrato.prototype,"type",{get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}}),s.default.Vibrato.prototype.dispose=function(){s.default.Effect.prototype.dispose.call(this),this._delayNode.dispose(),this._delayNode=null,this._lfo.dispose(),this._lfo=null,this._writable(["frequency","depth"]),this.frequency=null,this.depth=null},e.default=s.default.Vibrato},function(t,e,i){"use strict";i.r(e);var s=i(0);i(12),i(15);s.default.Tremolo=function(){var t=s.default.defaults(arguments,["frequency","depth"],s.default.Tremolo);s.default.StereoEffect.call(this,t),this._lfoL=new s.default.LFO({phase:t.spread,min:1,max:0}),this._lfoR=new s.default.LFO({phase:t.spread,min:1,max:0}),this._amplitudeL=new s.default.Gain,this._amplitudeR=new s.default.Gain,this.frequency=new s.default.Signal(t.frequency,s.default.Type.Frequency),this.depth=new s.default.Signal(t.depth,s.default.Type.NormalRange),this._readOnly(["frequency","depth"]),this.effectSendL.chain(this._amplitudeL,this.effectReturnL),this.effectSendR.chain(this._amplitudeR,this.effectReturnR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.type=t.type,this.spread=t.spread},s.default.extend(s.default.Tremolo,s.default.StereoEffect),s.default.Tremolo.defaults={frequency:10,type:"sine",depth:.5,spread:180},s.default.Tremolo.prototype.start=function(t){return this._lfoL.start(t),this._lfoR.start(t),this},s.default.Tremolo.prototype.stop=function(t){return this._lfoL.stop(t),this._lfoR.stop(t),this},s.default.Tremolo.prototype.sync=function(t){return this._lfoL.sync(t),this._lfoR.sync(t),s.default.Transport.syncSignal(this.frequency),this},s.default.Tremolo.prototype.unsync=function(){return this._lfoL.unsync(),this._lfoR.unsync(),s.default.Transport.unsyncSignal(this.frequency),this},Object.defineProperty(s.default.Tremolo.prototype,"type",{get:function(){return this._lfoL.type},set:function(t){this._lfoL.type=t,this._lfoR.type=t}}),Object.defineProperty(s.default.Tremolo.prototype,"spread",{get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}}),s.default.Tremolo.prototype.dispose=function(){return s.default.StereoEffect.prototype.dispose.call(this),this._writable(["frequency","depth"]),this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null,this._amplitudeL.dispose(),this._amplitudeL=null,this._amplitudeR.dispose(),this._amplitudeR=null,this.frequency=null,this.depth=null,this},e.default=s.default.Tremolo},function(t,e,i){"use strict";i.r(e);var s=i(0);i(72),i(2),i(5),i(13);s.default.StereoWidener=function(){var t=s.default.defaults(arguments,["width"],s.default.StereoWidener);s.default.MidSideEffect.call(this,t),this.width=new s.default.Signal(t.width,s.default.Type.NormalRange),this._readOnly(["width"]),this._twoTimesWidthMid=new s.default.Multiply(2),this._twoTimesWidthSide=new s.default.Multiply(2),this._midMult=new s.default.Multiply,this._twoTimesWidthMid.connect(this._midMult,0,1),this.midSend.chain(this._midMult,this.midReturn),this._oneMinusWidth=new s.default.Subtract,this._oneMinusWidth.connect(this._twoTimesWidthMid),s.default.connect(this.context.getConstant(1),this._oneMinusWidth,0,0),this.width.connect(this._oneMinusWidth,0,1),this._sideMult=new s.default.Multiply,this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult,0,1),this.sideSend.chain(this._sideMult,this.sideReturn)},s.default.extend(s.default.StereoWidener,s.default.MidSideEffect),s.default.StereoWidener.defaults={width:.5},s.default.StereoWidener.prototype.dispose=function(){return s.default.MidSideEffect.prototype.dispose.call(this),this._writable(["width"]),this.width.dispose(),this.width=null,this._midMult.dispose(),this._midMult=null,this._sideMult.dispose(),this._sideMult=null,this._twoTimesWidthMid.dispose(),this._twoTimesWidthMid=null,this._twoTimesWidthSide.dispose(),this._twoTimesWidthSide=null,this._oneMinusWidth.dispose(),this._oneMinusWidth=null,this},e.default=s.default.StereoWidener},function(t,e,i){"use strict";i.r(e);var s=i(0);i(15),i(33),i(3);s.default.StereoFeedbackEffect=function(){var t=s.default.defaults(arguments,["feedback"],s.default.FeedbackEffect);s.default.StereoEffect.call(this,t),this.feedback=new s.default.Signal(t.feedback,s.default.Type.NormalRange),this._feedbackL=new s.default.Gain,this._feedbackR=new s.default.Gain,this.effectReturnL.chain(this._feedbackL,this.effectSendL),this.effectReturnR.chain(this._feedbackR,this.effectSendR),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),this._readOnly(["feedback"])},s.default.extend(s.default.StereoFeedbackEffect,s.default.StereoEffect),s.default.StereoFeedbackEffect.prototype.dispose=function(){return s.default.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackL.dispose(),this._feedbackL=null,this._feedbackR.dispose(),this._feedbackR=null,this},e.default=s.default.StereoFeedbackEffect},function(t,e,i){"use strict";i.r(e);var s=i(0);i(76),i(9),i(10),i(39),i(3),i(73);s.default.Reverb=function(){var t=s.default.defaults(arguments,["decay"],s.default.Reverb);s.default.Effect.call(this,t),this._convolver=this.context.createConvolver(),this.decay=t.decay,this.preDelay=t.preDelay,this.connectEffect(this._convolver)},s.default.extend(s.default.Reverb,s.default.Effect),s.default.Reverb.defaults={decay:1.5,preDelay:.01},s.default.Reverb.prototype.generate=function(){return s.default.Offline(function(){var t=new s.default.Noise,e=new s.default.Noise,i=new s.default.Merge;t.connect(i.left),e.connect(i.right);var n=(new s.default.Gain).toMaster();i.connect(n),t.start(0),e.start(0),n.gain.setValueAtTime(0,0),n.gain.setValueAtTime(1,this.preDelay),n.gain.exponentialApproachValueAtTime(0,this.preDelay,this.decay+this.preDelay)}.bind(this),this.decay+this.preDelay).then(function(t){return this._convolver.buffer=t.get(),this}.bind(this))},s.default.Reverb.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this._convolver.disconnect(),this._convolver=null,this},e.default=s.default.Reverb},function(t,e,i){"use strict";i.r(e);var s=i(0);i(12),i(23),i(2),i(33),i(18);s.default.PitchShift=function(){var t=s.default.defaults(arguments,["pitch"],s.default.PitchShift);s.default.FeedbackEffect.call(this,t),this._frequency=new s.default.Signal(0),this._delayA=new s.default.Delay(0,1),this._lfoA=new s.default.LFO({min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new s.default.Delay(0,1),this._lfoB=new s.default.LFO({min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new s.default.CrossFade,this._crossFadeLFO=new s.default.LFO({min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new s.default.Delay(t.delayTime),this.delayTime=this._feedbackDelay.delayTime,this._readOnly("delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);var e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize},s.default.extend(s.default.PitchShift,s.default.FeedbackEffect),s.default.PitchShift.defaults={pitch:0,windowSize:.1,delayTime:0,feedback:0},Object.defineProperty(s.default.PitchShift.prototype,"pitch",{get:function(){return this._pitch},set:function(t){this._pitch=t;var e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=s.default.intervalToFrequencyRatio(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=s.default.intervalToFrequencyRatio(t)-1),this._frequency.value=e*(1.2/this._windowSize)}}),Object.defineProperty(s.default.PitchShift.prototype,"windowSize",{get:function(){return this._windowSize},set:function(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}}),s.default.PitchShift.prototype.dispose=function(){return s.default.FeedbackEffect.prototype.dispose.call(this),this._frequency.dispose(),this._frequency=null,this._delayA.disconnect(),this._delayA=null,this._delayB.disconnect(),this._delayB=null,this._lfoA.dispose(),this._lfoA=null,this._lfoB.dispose(),this._lfoB=null,this._crossFade.dispose(),this._crossFade=null,this._crossFadeLFO.dispose(),this._crossFadeLFO=null,this._writable("delayTime"),this._feedbackDelay.dispose(),this._feedbackDelay=null,this.delayTime=null,this},e.default=s.default.PitchShift},function(t,e,i){"use strict";i.r(e);var s=i(0);i(71),i(2),i(18);s.default.PingPongDelay=function(){var t=s.default.defaults(arguments,["delayTime","feedback"],s.default.PingPongDelay);s.default.StereoXFeedbackEffect.call(this,t),this._leftDelay=new s.default.Delay(0,t.maxDelayTime),this._rightDelay=new s.default.Delay(0,t.maxDelayTime),this._rightPreDelay=new s.default.Delay(0,t.maxDelayTime),this.delayTime=new s.default.Signal(t.delayTime,s.default.Type.Time),this.effectSendL.chain(this._leftDelay,this.effectReturnL),this.effectSendR.chain(this._rightPreDelay,this._rightDelay,this.effectReturnR),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackLR.disconnect(),this._feedbackLR.connect(this._rightDelay),this._readOnly(["delayTime"])},s.default.extend(s.default.PingPongDelay,s.default.StereoXFeedbackEffect),s.default.PingPongDelay.defaults={delayTime:.25,maxDelayTime:1},s.default.PingPongDelay.prototype.dispose=function(){return s.default.StereoXFeedbackEffect.prototype.dispose.call(this),this._leftDelay.dispose(),this._leftDelay=null,this._rightDelay.dispose(),this._rightDelay=null,this._rightPreDelay.dispose(),this._rightPreDelay=null,this._writable(["delayTime"]),this.delayTime.dispose(),this.delayTime=null,this},e.default=s.default.PingPongDelay},function(t,e,i){"use strict";i.r(e);var s=i(0);i(12),i(9),i(15);s.default.Phaser=function(){var t=s.default.defaults(arguments,["frequency","octaves","baseFrequency"],s.default.Phaser);s.default.StereoEffect.call(this,t),this._lfoL=new s.default.LFO(t.frequency,0,1),this._lfoR=new s.default.LFO(t.frequency,0,1),this._lfoR.phase=180,this._baseFrequency=t.baseFrequency,this._octaves=t.octaves,this.Q=new s.default.Signal(t.Q,s.default.Type.Positive),this._filtersL=this._makeFilters(t.stages,this._lfoL,this.Q),this._filtersR=this._makeFilters(t.stages,this._lfoR,this.Q),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.effectSendL.connect(this._filtersL[0]),this.effectSendR.connect(this._filtersR[0]),s.default.connect(this._filtersL[t.stages-1],this.effectReturnL),s.default.connect(this._filtersR[t.stages-1],this.effectReturnR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),this._readOnly(["frequency","Q"])},s.default.extend(s.default.Phaser,s.default.StereoEffect),s.default.Phaser.defaults={frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350},s.default.Phaser.prototype._makeFilters=function(t,e,i){for(var n=new Array(t),o=0;o<t;o++){var a=this.context.createBiquadFilter();a.type="allpass",i.connect(a.Q),e.connect(a.frequency),n[o]=a}return s.default.connectSeries.apply(s.default,n),n},Object.defineProperty(s.default.Phaser.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t;var e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}}),Object.defineProperty(s.default.Phaser.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(t){this._baseFrequency=t,this._lfoL.min=t,this._lfoR.min=t,this.octaves=this._octaves}}),s.default.Phaser.prototype.dispose=function(){s.default.StereoEffect.prototype.dispose.call(this),this._writable(["frequency","Q"]),this.Q.dispose(),this.Q=null,this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null;for(var t=0;t<this._filtersL.length;t++)this._filtersL[t].disconnect(),this._filtersL[t]=null;this._filtersL=null;for(var e=0;e<this._filtersR.length;e++)this._filtersR[e].disconnect(),this._filtersR[e]=null;return this._filtersR=null,this.frequency=null,this},e.default=s.default.Phaser},function(t,e,i){"use strict";i.r(e);var s=i(0),n=(i(59),i(15),i(26),[.06748,.06404,.08212,.09004]),o=[.773,.802,.753,.733],a=[347,113,37];s.default.JCReverb=function(){var t=s.default.defaults(arguments,["roomSize"],s.default.JCReverb);s.default.StereoEffect.call(this,t),this.roomSize=new s.default.Signal(t.roomSize,s.default.Type.NormalRange),this._scaleRoomSize=new s.default.Scale(-.733,.197),this._allpassFilters=[],this._feedbackCombFilters=[];for(var e=0;e<a.length;e++){var i=this.context.createBiquadFilter();i.type="allpass",i.frequency.value=a[e],this._allpassFilters.push(i)}for(var r=0;r<n.length;r++){var l=new s.default.FeedbackCombFilter(n[r],.1);this._scaleRoomSize.connect(l.resonance),l.resonance.value=o[r],s.default.connect(this._allpassFilters[this._allpassFilters.length-1],l),r<n.length/2?l.connect(this.effectReturnL):l.connect(this.effectReturnR),this._feedbackCombFilters.push(l)}this.roomSize.connect(this._scaleRoomSize),s.default.connectSeries.apply(s.default,this._allpassFilters),this.effectSendL.connect(this._allpassFilters[0]),this.effectSendR.connect(this._allpassFilters[0]),this._readOnly(["roomSize"])},s.default.extend(s.default.JCReverb,s.default.StereoEffect),s.default.JCReverb.defaults={roomSize:.5},s.default.JCReverb.prototype.dispose=function(){s.default.StereoEffect.prototype.dispose.call(this);for(var t=0;t<this._allpassFilters.length;t++)this._allpassFilters[t].disconnect(),this._allpassFilters[t]=null;this._allpassFilters=null;for(var e=0;e<this._feedbackCombFilters.length;e++)this._feedbackCombFilters[e].dispose(),this._feedbackCombFilters[e]=null;return this._feedbackCombFilters=null,this._writable(["roomSize"]),this.roomSize.dispose(),this.roomSize=null,this._scaleRoomSize.dispose(),this._scaleRoomSize=null,this},e.default=s.default.JCReverb},function(t,e,i){"use strict";i.r(e);var s=i(0),n=(i(54),i(15),i(2),i(19),i(10),i(42),[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100]),o=[225,556,441,341];s.default.Freeverb=function(){var t=s.default.defaults(arguments,["roomSize","dampening"],s.default.Freeverb);s.default.StereoEffect.call(this,t),this.roomSize=new s.default.Signal(t.roomSize,s.default.Type.NormalRange),this.dampening=new s.default.Signal(t.dampening,s.default.Type.Frequency),this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];for(var e=0;e<o.length;e++){var i=this.context.createBiquadFilter();i.type="allpass",i.frequency.value=o[e],this._allpassFiltersL.push(i)}for(var a=0;a<o.length;a++){var r=this.context.createBiquadFilter();r.type="allpass",r.frequency.value=o[a],this._allpassFiltersR.push(r)}for(var l=0;l<n.length;l++){var u=new s.default.LowpassCombFilter(n[l]);l<n.length/2?this.effectSendL.chain(u,this._allpassFiltersL[0]):this.effectSendR.chain(u,this._allpassFiltersR[0]),this.roomSize.connect(u.resonance),this.dampening.connect(u.dampening),this._combFilters.push(u)}s.default.connectSeries.apply(s.default,this._allpassFiltersL),s.default.connectSeries.apply(s.default,this._allpassFiltersR),s.default.connect(this._allpassFiltersL[this._allpassFiltersL.length-1],this.effectReturnL),s.default.connect(this._allpassFiltersR[this._allpassFiltersR.length-1],this.effectReturnR),this._readOnly(["roomSize","dampening"])},s.default.extend(s.default.Freeverb,s.default.StereoEffect),s.default.Freeverb.defaults={roomSize:.7,dampening:3e3},s.default.Freeverb.prototype.dispose=function(){s.default.StereoEffect.prototype.dispose.call(this);for(var t=0;t<this._allpassFiltersL.length;t++)this._allpassFiltersL[t].disconnect(),this._allpassFiltersL[t]=null;this._allpassFiltersL=null;for(var e=0;e<this._allpassFiltersR.length;e++)this._allpassFiltersR[e].disconnect(),this._allpassFiltersR[e]=null;this._allpassFiltersR=null;for(var i=0;i<this._combFilters.length;i++)this._combFilters[i].dispose(),this._combFilters[i]=null;return this._combFilters=null,this._writable(["roomSize","dampening"]),this.roomSize.dispose(),this.roomSize=null,this.dampening.dispose(),this.dampening=null,this},e.default=s.default.Freeverb},function(t,e,i){"use strict";i.r(e);var s=i(0);i(33),i(2),i(18);s.default.FeedbackDelay=function(){var t=s.default.defaults(arguments,["delayTime","feedback"],s.default.FeedbackDelay);s.default.FeedbackEffect.call(this,t),this._delayNode=new s.default.Delay(t.delayTime,t.maxDelay),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),this._readOnly(["delayTime"])},s.default.extend(s.default.FeedbackDelay,s.default.FeedbackEffect),s.default.FeedbackDelay.defaults={delayTime:.25,maxDelay:1},s.default.FeedbackDelay.prototype.dispose=function(){return s.default.FeedbackEffect.prototype.dispose.call(this),this._delayNode.dispose(),this._delayNode=null,this._writable(["delayTime"]),this.delayTime=null,this},e.default=s.default.FeedbackDelay},function(t,e,i){"use strict";i.r(e);var s=i(0);i(8),i(7);s.default.Distortion=function(){var t=s.default.defaults(arguments,["distortion"],s.default.Distortion);s.default.Effect.call(this,t),this._shaper=new s.default.WaveShaper(4096),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample},s.default.extend(s.default.Distortion,s.default.Effect),s.default.Distortion.defaults={distortion:.4,oversample:"none"},Object.defineProperty(s.default.Distortion.prototype,"distortion",{get:function(){return this._distortion},set:function(t){this._distortion=t;var e=100*t,i=Math.PI/180;this._shaper.setMap(function(t){return Math.abs(t)<.001?0:(3+e)*t*20*i/(Math.PI+e*Math.abs(t))})}}),Object.defineProperty(s.default.Distortion.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){this._shaper.oversample=t}}),s.default.Distortion.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},e.default=s.default.Distortion},function(t,e,i){"use strict";i.r(e);var s=i(0);i(12),i(15),i(18);s.default.Chorus=function(){var t=s.default.defaults(arguments,["frequency","delayTime","depth"],s.default.Chorus);s.default.StereoEffect.call(this,t),this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new s.default.LFO({frequency:t.frequency,min:0,max:1}),this._lfoR=new s.default.LFO({frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new s.default.Delay,this._delayNodeR=new s.default.Delay,this.frequency=this._lfoL.frequency,this.effectSendL.chain(this._delayNodeL,this.effectReturnL),this.effectSendR.chain(this._delayNodeR,this.effectReturnR),this.effectSendL.connect(this.effectReturnL),this.effectSendR.connect(this.effectReturnR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this._lfoL.start(),this._lfoR.start(),this._lfoL.frequency.connect(this._lfoR.frequency),this.depth=this._depth,this.frequency.value=t.frequency,this.type=t.type,this._readOnly(["frequency"]),this.spread=t.spread},s.default.extend(s.default.Chorus,s.default.StereoEffect),s.default.Chorus.defaults={frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180},Object.defineProperty(s.default.Chorus.prototype,"depth",{get:function(){return this._depth},set:function(t){this._depth=t;var e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}}),Object.defineProperty(s.default.Chorus.prototype,"delayTime",{get:function(){return 1e3*this._delayTime},set:function(t){this._delayTime=t/1e3,this.depth=this._depth}}),Object.defineProperty(s.default.Chorus.prototype,"type",{get:function(){return this._lfoL.type},set:function(t){this._lfoL.type=t,this._lfoR.type=t}}),Object.defineProperty(s.default.Chorus.prototype,"spread",{get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}}),s.default.Chorus.prototype.dispose=function(){return s.default.StereoEffect.prototype.dispose.call(this),this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null,this._delayNodeL.dispose(),this._delayNodeL=null,this._delayNodeR.dispose(),this._delayNodeR=null,this._writable("frequency"),this.frequency=null,this},e.default=s.default.Chorus},function(t,e,i){"use strict";i.r(e);var s=i(0);i(8),i(7);s.default.Chebyshev=function(){var t=s.default.defaults(arguments,["order"],s.default.Chebyshev);s.default.Effect.call(this,t),this._shaper=new s.default.WaveShaper(4096),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample},s.default.extend(s.default.Chebyshev,s.default.Effect),s.default.Chebyshev.defaults={order:1,oversample:"none"},s.default.Chebyshev.prototype._getCoefficient=function(t,e,i){return i.hasOwnProperty(e)?i[e]:(i[e]=0===e?0:1===e?t:2*t*this._getCoefficient(t,e-1,i)-this._getCoefficient(t,e-2,i),i[e])},Object.defineProperty(s.default.Chebyshev.prototype,"order",{get:function(){return this._order},set:function(t){this._order=t;for(var e=new Array(4096),i=e.length,s=0;s<i;++s){var n=2*s/i-1;e[s]=0===n?0:this._getCoefficient(n,t,{})}this._shaper.curve=e}}),Object.defineProperty(s.default.Chebyshev.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){this._shaper.oversample=t}}),s.default.Chebyshev.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},e.default=s.default.Chebyshev},function(t,e,i){"use strict";i.r(e);var s=i(0);i(8),i(13),i(74);s.default.BitCrusher=function(){var t=s.default.defaults(arguments,["bits"],s.default.BitCrusher);s.default.Effect.call(this,t);var e=1/Math.pow(2,t.bits-1);this._subtract=new s.default.Subtract,this._modulo=new s.default.Modulo(e),this._bits=t.bits,this.effectSend.fan(this._subtract,this._modulo),this._modulo.connect(this._subtract,0,1),this._subtract.connect(this.effectReturn)},s.default.extend(s.default.BitCrusher,s.default.Effect),s.default.BitCrusher.defaults={bits:4},Object.defineProperty(s.default.BitCrusher.prototype,"bits",{get:function(){return this._bits},set:function(t){this._bits=t;var e=1/Math.pow(2,t-1);this._modulo.value=e}}),s.default.BitCrusher.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this._subtract.dispose(),this._subtract=null,this._modulo.dispose(),this._modulo=null,this},e.default=s.default.BitCrusher},function(t,e,i){"use strict";i.r(e);var s=i(0);i(58),i(42),i(8),i(9);s.default.AutoWah=function(){var t=s.default.defaults(arguments,["baseFrequency","octaves","sensitivity"],s.default.AutoWah);s.default.Effect.call(this,t),this.follower=new s.default.Follower(t.follower),this._sweepRange=new s.default.ScaleExp(0,1,.5),this._baseFrequency=t.baseFrequency,this._octaves=t.octaves,this._inputBoost=new s.default.Gain,this._bandpass=new s.default.Filter({rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new s.default.Filter(0,"peaking"),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this.follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,this._readOnly(["gain","Q"])},s.default.extend(s.default.AutoWah,s.default.Effect),s.default.AutoWah.defaults={baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:{attack:.3,release:.5}},Object.defineProperty(s.default.AutoWah.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._setSweepRange()}}),Object.defineProperty(s.default.AutoWah.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(t){this._baseFrequency=t,this._setSweepRange()}}),Object.defineProperty(s.default.AutoWah.prototype,"sensitivity",{get:function(){return s.default.gainToDb(1/this._inputBoost.gain.value)},set:function(t){this._inputBoost.gain.value=1/s.default.dbToGain(t)}}),s.default.AutoWah.prototype._setSweepRange=function(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)},s.default.AutoWah.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this.follower.dispose(),this.follower=null,this._sweepRange.dispose(),this._sweepRange=null,this._bandpass.dispose(),this._bandpass=null,this._peaking.dispose(),this._peaking=null,this._inputBoost.dispose(),this._inputBoost=null,this._writable(["gain","Q"]),this.gain=null,this.Q=null,this},e.default=s.default.AutoWah},function(t,e,i){"use strict";i.r(e);var s=i(0);i(8),i(12),i(48);s.default.AutoPanner=function(){var t=s.default.defaults(arguments,["frequency"],s.default.AutoPanner);s.default.Effect.call(this,t),this._lfo=new s.default.LFO({frequency:t.frequency,amplitude:t.depth,min:-1,max:1}),this.depth=this._lfo.amplitude,this._panner=new s.default.Panner,this.frequency=this._lfo.frequency,this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this.type=t.type,this._readOnly(["depth","frequency"])},s.default.extend(s.default.AutoPanner,s.default.Effect),s.default.AutoPanner.defaults={frequency:1,type:"sine",depth:1},s.default.AutoPanner.prototype.start=function(t){return this._lfo.start(t),this},s.default.AutoPanner.prototype.stop=function(t){return this._lfo.stop(t),this},s.default.AutoPanner.prototype.sync=function(t){return this._lfo.sync(t),this},s.default.AutoPanner.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(s.default.AutoPanner.prototype,"type",{get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}}),s.default.AutoPanner.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this._panner.dispose(),this._panner=null,this._writable(["depth","frequency"]),this.frequency=null,this.depth=null,this},e.default=s.default.AutoPanner},function(t,e,i){"use strict";i.r(e);var s=i(0);i(8),i(12),i(9);s.default.AutoFilter=function(){var t=s.default.defaults(arguments,["frequency","baseFrequency","octaves"],s.default.AutoFilter);s.default.Effect.call(this,t),this._lfo=new s.default.LFO({frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.filter=new s.default.Filter(t.filter),this._octaves=0,this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.type=t.type,this._readOnly(["frequency","depth"]),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency},s.default.extend(s.default.AutoFilter,s.default.Effect),s.default.AutoFilter.defaults={frequency:1,type:"sine",depth:1,baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}},s.default.AutoFilter.prototype.start=function(t){return this._lfo.start(t),this},s.default.AutoFilter.prototype.stop=function(t){return this._lfo.stop(t),this},s.default.AutoFilter.prototype.sync=function(t){return this._lfo.sync(t),this},s.default.AutoFilter.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(s.default.AutoFilter.prototype,"type",{get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}}),Object.defineProperty(s.default.AutoFilter.prototype,"baseFrequency",{get:function(){return this._lfo.min},set:function(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}}),Object.defineProperty(s.default.AutoFilter.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._lfo.max=this.baseFrequency*Math.pow(2,t)}}),s.default.AutoFilter.prototype.dispose=function(){return s.default.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this.filter.dispose(),this.filter=null,this._writable(["frequency","depth"]),this.frequency=null,this.depth=null,this},e.default=s.default.AutoFilter},function(t,e,i){"use strict";i.r(e);var s=i(0);i(23),i(10),i(19),i(2),i(22),i(28);s.default.Listener=function(){s.default.call(this),this._orientation=[0,0,0,0,0,0],this._position=[0,0,0],s.default.getContext(function(){this.set(n.defaults)}.bind(this))},s.default.extend(s.default.Listener),s.default.Listener.defaults={positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:1,upX:0,upY:1,upZ:0},s.default.Listener.prototype.isListener=!0,s.default.Listener.prototype._rampTimeConstant=.01,s.default.Listener.prototype.setPosition=function(t,e,i){if(this.context.rawContext.listener.positionX){var s=this.now();this.context.rawContext.listener.positionX.setTargetAtTime(t,s,this._rampTimeConstant),this.context.rawContext.listener.positionY.setTargetAtTime(e,s,this._rampTimeConstant),this.context.rawContext.listener.positionZ.setTargetAtTime(i,s,this._rampTimeConstant)}else this.context.rawContext.listener.setPosition(t,e,i);return this._position=Array.prototype.slice.call(arguments),this},s.default.Listener.prototype.setOrientation=function(t,e,i,s,n,o){if(this.context.rawContext.listener.forwardX){var a=this.now();this.context.rawContext.listener.forwardX.setTargetAtTime(t,a,this._rampTimeConstant),this.context.rawContext.listener.forwardY.setTargetAtTime(e,a,this._rampTimeConstant),this.context.rawContext.listener.forwardZ.setTargetAtTime(i,a,this._rampTimeConstant),this.context.rawContext.listener.upX.setTargetAtTime(s,a,this._rampTimeConstant),this.context.rawContext.listener.upY.setTargetAtTime(n,a,this._rampTimeConstant),this.context.rawContext.listener.upZ.setTargetAtTime(o,a,this._rampTimeConstant)}else this.context.rawContext.listener.setOrientation(t,e,i,s,n,o);return this._orientation=Array.prototype.slice.call(arguments),this},Object.defineProperty(s.default.Listener.prototype,"positionX",{set:function(t){this._position[0]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[0]}}),Object.defineProperty(s.default.Listener.prototype,"positionY",{set:function(t){this._position[1]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[1]}}),Object.defineProperty(s.default.Listener.prototype,"positionZ",{set:function(t){this._position[2]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[2]}}),Object.defineProperty(s.default.Listener.prototype,"forwardX",{set:function(t){this._orientation[0]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[0]}}),Object.defineProperty(s.default.Listener.prototype,"forwardY",{set:function(t){this._orientation[1]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[1]}}),Object.defineProperty(s.default.Listener.prototype,"forwardZ",{set:function(t){this._orientation[2]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[2]}}),Object.defineProperty(s.default.Listener.prototype,"upX",{set:function(t){this._orientation[3]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[3]}}),Object.defineProperty(s.default.Listener.prototype,"upY",{set:function(t){this._orientation[4]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[4]}}),Object.defineProperty(s.default.Listener.prototype,"upZ",{set:function(t){this._orientation[5]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[5]}}),s.default.Listener.prototype.dispose=function(){return this._orientation=null,this._position=null,this};var n=s.default.Listener;s.default.Listener=new n,s.default.Context.on("init",function(t){t.listener&&t.listener.isListener?s.default.Listener=t.listener:s.default.Listener=new n}),e.default=s.default.Listener},function(t,e,i){"use strict";i.r(e);var s=i(0);i(24);s.default.Draw=function(){s.default.call(this),this._events=new s.default.Timeline,this.expiration=.25,this.anticipation=.008,this._boundDrawLoop=this._drawLoop.bind(this)},s.default.extend(s.default.Draw),s.default.Draw.prototype.schedule=function(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&requestAnimationFrame(this._boundDrawLoop),this},s.default.Draw.prototype.cancel=function(t){return this._events.cancel(this.toSeconds(t)),this},s.default.Draw.prototype._drawLoop=function(){for(var t=s.default.context.currentTime;this._events.length&&this._events.peek().time-this.anticipation<=t;){var e=this._events.shift();t-e.time<=this.expiration&&e.callback()}this._events.length>0&&requestAnimationFrame(this._boundDrawLoop)},s.default.Draw=new s.default.Draw,e.default=s.default.Draw},function(t,e,i){"use strict";i.r(e);var s=i(0),n=(i(3),{});s.default.prototype.send=function(t,e){n.hasOwnProperty(t)||(n[t]=this.context.createGain()),e=s.default.defaultArg(e,0);var i=new s.default.Gain(e,s.default.Type.Decibels);return this.connect(i),i.connect(n[t]),i},s.default.prototype.receive=function(t,e){return n.hasOwnProperty(t)||(n[t]=this.context.createGain()),s.default.connect(n[t],this,0,e),this},s.default.Context.on("init",function(t){t.buses?n=t.buses:(n={},t.buses=n)}),e.default=s.default},function(t,e,i){"use strict";i.r(e);var s=i(0);i(4);s.default.CtrlRandom=function(){var t=s.default.defaults(arguments,["min","max"],s.default.CtrlRandom);s.default.call(this),this.min=t.min,this.max=t.max,this.integer=t.integer},s.default.extend(s.default.CtrlRandom),s.default.CtrlRandom.defaults={min:0,max:1,integer:!1},Object.defineProperty(s.default.CtrlRandom.prototype,"value",{get:function(){var t=this.toSeconds(this.min),e=this.toSeconds(this.max),i=Math.random(),s=i*t+(1-i)*e;return this.integer&&(s=Math.floor(s)),s}}),e.default=s.default.CtrlRandom},function(t,e,i){"use strict";i.r(e);var s=i(0);s.default.CtrlMarkov=function(t,e){s.default.call(this),this.values=s.default.defaultArg(t,{}),this.value=s.default.defaultArg(e,Object.keys(this.values)[0])},s.default.extend(s.default.CtrlMarkov),s.default.CtrlMarkov.prototype.next=function(){if(this.values.hasOwnProperty(this.value)){var t=this.values[this.value];if(s.default.isArray(t))for(var e=this._getProbDistribution(t),i=Math.random(),n=0,o=0;o<e.length;o++){var a=e[o];if(i>n&&i<n+a){var r=t[o];s.default.isObject(r)?this.value=r.value:this.value=r}n+=a}else this.value=t}return this.value},s.default.CtrlMarkov.prototype._getProbDistribution=function(t){for(var e=[],i=0,n=!1,o=0;o<t.length;o++){var a=t[o];s.default.isObject(a)?(n=!0,e[o]=a.probability):e[o]=1/t.length,i+=e[o]}if(n)for(var r=0;r<e.length;r++)e[r]=e[r]/i;return e},s.default.CtrlMarkov.prototype.dispose=function(){this.values=null},e.default=s.default.CtrlMarkov},function(t,e,i){"use strict";i.r(e);var s=i(0);i(4);s.default.CtrlInterpolate=function(){var t=s.default.defaults(arguments,["values","index"],s.default.CtrlInterpolate);s.default.call(this),this.values=t.values,this.index=t.index},s.default.extend(s.default.CtrlInterpolate),s.default.CtrlInterpolate.defaults={index:0,values:[]},Object.defineProperty(s.default.CtrlInterpolate.prototype,"value",{get:function(){var t=this.index;t=Math.min(t,this.values.length-1);var e=Math.floor(t),i=this.values[e],s=this.values[Math.ceil(t)];return this._interpolate(t-e,i,s)}}),s.default.CtrlInterpolate.prototype._interpolate=function(t,e,i){if(s.default.isArray(e)){for(var n=[],o=0;o<e.length;o++)n[o]=this._interpolate(t,e[o],i[o]);return n}if(s.default.isObject(e)){var a={};for(var r in e)a[r]=this._interpolate(t,e[r],i[r]);return a}return(1-t)*(e=this._toNumber(e))+t*(i=this._toNumber(i))},s.default.CtrlInterpolate.prototype._toNumber=function(t){return s.default.isNumber(t)?t:this.toSeconds(t)},s.default.CtrlInterpolate.prototype.dispose=function(){this.values=null},e.default=s.default.CtrlInterpolate},function(t,e,i){"use strict";i.r(e);var s=i(0);i(36),i(1);s.default.Waveform=function(){var t=s.default.defaults(arguments,["size"],s.default.Waveform);t.type=s.default.Analyser.Type.Waveform,s.default.AudioNode.call(this),this._analyser=this.input=this.output=new s.default.Analyser(t)},s.default.extend(s.default.Waveform,s.default.AudioNode),s.default.Waveform.defaults={size:1024},s.default.Waveform.prototype.getValue=function(){return this._analyser.getValue()},Object.defineProperty(s.default.Waveform.prototype,"size",{get:function(){return this._analyser.size},set:function(t){this._analyser.size=t}}),s.default.Waveform.prototype.dispose=function(){s.default.AudioNode.prototype.dispose.call(this),this._analyser.dispose(),this._analyser=null},e.default=s.default.Waveform},function(t,e,i){"use strict";i.r(e);var s=i(0);i(23),i(10),i(19),i(2),i(22),i(28),i(1);s.default.Panner3D=function(){var t=s.default.defaults(arguments,["positionX","positionY","positionZ"],s.default.Panner3D);s.default.AudioNode.call(this),this._panner=this.input=this.output=this.context.createPanner(),this._panner.panningModel=t.panningModel,this._panner.maxDistance=t.maxDistance,this._panner.distanceModel=t.distanceModel,this._panner.coneOuterGain=t.coneOuterGain,this._panner.coneOuterAngle=t.coneOuterAngle,this._panner.coneInnerAngle=t.coneInnerAngle,this._panner.refDistance=t.refDistance,this._panner.rolloffFactor=t.rolloffFactor,this._orientation=[t.orientationX,t.orientationY,t.orientationZ],this._position=[t.positionX,t.positionY,t.positionZ],this.orientationX=t.orientationX,this.orientationY=t.orientationY,this.orientationZ=t.orientationZ,this.positionX=t.positionX,this.positionY=t.positionY,this.positionZ=t.positionZ},s.default.extend(s.default.Panner3D,s.default.AudioNode),s.default.Panner3D.defaults={positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",maxDistance:1e4,distanceModel:"inverse",coneOuterGain:0,coneOuterAngle:360,coneInnerAngle:360,refDistance:1,rolloffFactor:1},s.default.Panner3D.prototype._rampTimeConstant=.01,s.default.Panner3D.prototype.setPosition=function(t,e,i){if(this._panner.positionX){var s=this.now();this._panner.positionX.setTargetAtTime(t,s,this._rampTimeConstant),this._panner.positionY.setTargetAtTime(e,s,this._rampTimeConstant),this._panner.positionZ.setTargetAtTime(i,s,this._rampTimeConstant)}else this._panner.setPosition(t,e,i);return this._position=Array.prototype.slice.call(arguments),this},s.default.Panner3D.prototype.setOrientation=function(t,e,i){if(this._panner.orientationX){var s=this.now();this._panner.orientationX.setTargetAtTime(t,s,this._rampTimeConstant),this._panner.orientationY.setTargetAtTime(e,s,this._rampTimeConstant),this._panner.orientationZ.setTargetAtTime(i,s,this._rampTimeConstant)}else this._panner.setOrientation(t,e,i);return this._orientation=Array.prototype.slice.call(arguments),this},Object.defineProperty(s.default.Panner3D.prototype,"positionX",{set:function(t){this._position[0]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[0]}}),Object.defineProperty(s.default.Panner3D.prototype,"positionY",{set:function(t){this._position[1]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[1]}}),Object.defineProperty(s.default.Panner3D.prototype,"positionZ",{set:function(t){this._position[2]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[2]}}),Object.defineProperty(s.default.Panner3D.prototype,"orientationX",{set:function(t){this._orientation[0]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[0]}}),Object.defineProperty(s.default.Panner3D.prototype,"orientationY",{set:function(t){this._orientation[1]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[1]}}),Object.defineProperty(s.default.Panner3D.prototype,"orientationZ",{set:function(t){this._orientation[2]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[2]}}),s.default.Panner3D._aliasProperty=function(t){Object.defineProperty(s.default.Panner3D.prototype,t,{set:function(e){this._panner[t]=e},get:function(){return this._panner[t]}})},s.default.Panner3D._aliasProperty("panningModel"),s.default.Panner3D._aliasProperty("refDistance"),s.default.Panner3D._aliasProperty("rolloffFactor"),s.default.Panner3D._aliasProperty("distanceModel"),s.default.Panner3D._aliasProperty("coneInnerAngle"),s.default.Panner3D._aliasProperty("coneOuterAngle"),s.default.Panner3D._aliasProperty("coneOuterGain"),s.default.Panner3D._aliasProperty("maxDistance"),s.default.Panner3D.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._panner.disconnect(),this._panner=null,this._orientation=null,this._position=null,this},e.default=s.default.Panner3D},function(t,e,i){"use strict";i.r(e);var s=i(0);i(60),i(43),i(1);s.default.MultibandCompressor=function(t){s.default.AudioNode.call(this),t=s.default.defaultArg(arguments,s.default.MultibandCompressor.defaults),this._splitter=this.input=new s.default.MultibandSplit({lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new s.default.Gain,this.low=new s.default.Compressor(t.low),this.mid=new s.default.Compressor(t.mid),this.high=new s.default.Compressor(t.high),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},s.default.extend(s.default.MultibandCompressor,s.default.AudioNode),s.default.MultibandCompressor.defaults={low:s.default.Compressor.defaults,mid:s.default.Compressor.defaults,high:s.default.Compressor.defaults,lowFrequency:250,highFrequency:2e3},s.default.MultibandCompressor.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._splitter.dispose(),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this._splitter=null,this.low=null,this.mid=null,this.high=null,this.lowFrequency=null,this.highFrequency=null,this},e.default=s.default.MultibandCompressor},function(t,e,i){"use strict";i.r(e);var s=i(0);i(10),i(1);s.default.Mono=function(){s.default.AudioNode.call(this),this.createInsOuts(1,0),this._merge=this.output=new s.default.Merge,s.default.connect(this.input,this._merge,0,0),s.default.connect(this.input,this._merge,0,1)},s.default.extend(s.default.Mono,s.default.AudioNode),s.default.Mono.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._merge.dispose(),this._merge=null,this},e.default=s.default.Mono},function(t,e,i){"use strict";i.r(e);var s=i(0);i(53),i(52),i(43),i(1);s.default.MidSideCompressor=function(t){s.default.AudioNode.call(this),t=s.default.defaultArg(t,s.default.MidSideCompressor.defaults),this._midSideSplit=this.input=new s.default.MidSideSplit,this._midSideMerge=this.output=new s.default.MidSideMerge,this.mid=new s.default.Compressor(t.mid),this.side=new s.default.Compressor(t.side),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),this._readOnly(["mid","side"])},s.default.extend(s.default.MidSideCompressor,s.default.AudioNode),s.default.MidSideCompressor.defaults={mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}},s.default.MidSideCompressor.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable(["mid","side"]),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this},e.default=s.default.MidSideCompressor},function(t,e,i){"use strict";i.r(e);var s=i(0);i(36),i(1);s.default.Meter=function(){var t=s.default.defaults(arguments,["smoothing"],s.default.Meter);s.default.AudioNode.call(this),this.smoothing=t.smoothing,this._rms=0,this.input=this.output=this._analyser=new s.default.Analyser("waveform",256)},s.default.extend(s.default.Meter,s.default.AudioNode),s.default.Meter.defaults={smoothing:.8},s.default.Meter.prototype.getLevel=function(){for(var t=this._analyser.getValue(),e=0,i=0;i<t.length;i++){var n=t[i];e+=n*n}var o=Math.sqrt(e/t.length);return this._rms=Math.max(o,this._rms*this.smoothing),s.default.gainToDb(this._rms)},s.default.Meter.prototype.getValue=function(){return this._analyser.getValue()[0]},s.default.Meter.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._analyser.dispose(),this._analyser=null,this},e.default=s.default.Meter},function(t,e,i){"use strict";i.r(e);var s=i(0);i(43),i(1);s.default.Limiter=function(){var t=s.default.defaults(arguments,["threshold"],s.default.Limiter);s.default.AudioNode.call(this),this._compressor=this.input=this.output=new s.default.Compressor({attack:.001,decay:.001,threshold:t.threshold}),this.threshold=this._compressor.threshold,this._readOnly("threshold")},s.default.extend(s.default.Limiter,s.default.AudioNode),s.default.Limiter.defaults={threshold:-12},s.default.Limiter.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._compressor.dispose(),this._compressor=null,this._writable("threshold"),this.threshold=null,this},e.default=s.default.Limiter},function(t,e,i){"use strict";i.r(e);var s=i(0);i(58),i(85),i(1);s.default.Gate=function(){var t=s.default.defaults(arguments,["threshold","smoothing"],s.default.Gate);s.default.AudioNode.call(this),this.createInsOuts(1,1),this._follower=new s.default.Follower(t.smoothing),this._gt=new s.default.GreaterThan(s.default.dbToGain(t.threshold)),s.default.connect(this.input,this.output),s.default.connectSeries(this.input,this._follower,this._gt,this.output.gain)},s.default.extend(s.default.Gate,s.default.AudioNode),s.default.Gate.defaults={smoothing:.1,threshold:-40},Object.defineProperty(s.default.Gate.prototype,"threshold",{get:function(){return s.default.gainToDb(this._gt.value)},set:function(t){this._gt.value=s.default.dbToGain(t)}}),Object.defineProperty(s.default.Gate.prototype,"smoothing",{get:function(){return this._follower.smoothing},set:function(t){this._follower.smoothing=t}}),s.default.Gate.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._follower.dispose(),this._gt.dispose(),this._follower=null,this._gt=null,this},e.default=s.default.Gate},function(t,e,i){"use strict";i.r(e);var s=i(0);i(36),i(1);s.default.FFT=function(){var t=s.default.defaults(arguments,["size"],s.default.FFT);t.type=s.default.Analyser.Type.FFT,s.default.AudioNode.call(this),this._analyser=this.input=this.output=new s.default.Analyser(t)},s.default.extend(s.default.FFT,s.default.AudioNode),s.default.FFT.defaults={size:1024},s.default.FFT.prototype.getValue=function(){return this._analyser.getValue()},Object.defineProperty(s.default.FFT.prototype,"size",{get:function(){return this._analyser.size},set:function(t){this._analyser.size=t}}),s.default.FFT.prototype.dispose=function(){s.default.AudioNode.prototype.dispose.call(this),this._analyser.dispose(),this._analyser=null},e.default=s.default.FFT},function(t,e,i){"use strict";i.r(e);var s=i(0);i(60),i(3),i(1);s.default.EQ3=function(){var t=s.default.defaults(arguments,["low","mid","high"],s.default.EQ3);s.default.AudioNode.call(this),this.output=new s.default.Gain,this._multibandSplit=this.input=new s.default.MultibandSplit({lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this._lowGain=new s.default.Gain(t.low,s.default.Type.Decibels),this._midGain=new s.default.Gain(t.mid,s.default.Type.Decibels),this._highGain=new s.default.Gain(t.high,s.default.Type.Decibels),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),this._readOnly(["low","mid","high","lowFrequency","highFrequency"])},s.default.extend(s.default.EQ3,s.default.AudioNode),s.default.EQ3.defaults={low:0,mid:0,high:0,lowFrequency:400,highFrequency:2500},s.default.EQ3.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable(["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this._multibandSplit=null,this.lowFrequency=null,this.highFrequency=null,this._lowGain.dispose(),this._lowGain=null,this._midGain.dispose(),this._midGain=null,this._highGain.dispose(),this._highGain=null,this.low=null,this.mid=null,this.high=null,this.Q=null,this},e.default=s.default.EQ3},function(t,e,i){"use strict";i.r(e);var s=i(0);i(91),i(88),i(1);s.default.Channel=function(){var t=s.default.defaults(arguments,["volume","pan"],s.default.PanVol);s.default.AudioNode.call(this,t),this._solo=this.input=new s.default.Solo(t.solo),this._panVol=this.output=new s.default.PanVol({pan:t.pan,volume:t.volume,mute:t.mute}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),this._readOnly(["pan","volume"])},s.default.extend(s.default.Channel,s.default.AudioNode),s.default.Channel.defaults={pan:0,volume:0,mute:!1,solo:!1},Object.defineProperty(s.default.Channel.prototype,"solo",{get:function(){return this._solo.solo},set:function(t){this._solo.solo=t}}),Object.defineProperty(s.default.Channel.prototype,"muted",{get:function(){return this._solo.muted||this.mute}}),Object.defineProperty(s.default.Channel.prototype,"mute",{get:function(){return this._panVol.mute},set:function(t){this._panVol.mute=t}}),s.default.Channel.prototype.dispose=function(){return s.default.AudioNode.prototype.dispose.call(this),this._writable(["pan","volume"]),this._panVol.dispose(),this._panVol=null,this.pan=null,this.volume=null,this._solo.dispose(),this._solo=null,this},e.default=s.default.Channel},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){i(31),i(36),i(146),i(43),i(23),i(47),i(145),i(59),i(144),i(9),i(58),i(41),i(143),i(12),i(142),i(54),i(10),i(141),i(140),i(52),i(53),i(139),i(138),i(60),i(48),i(137),i(91),i(86),i(88),i(19),i(27),i(136),i(135),i(134),i(78),i(133),i(1),i(11),i(77),i(132),i(83),i(20),i(18),i(131),i(35),i(3),i(81),i(130),i(40),i(76),i(75),i(14),i(24),i(34),i(16),i(56),i(80),i(129),i(128),i(127),i(126),i(125),i(124),i(73),i(123),i(8),i(122),i(33),i(121),i(120),i(72),i(119),i(118),i(117),i(116),i(15),i(115),i(114),i(71),i(113),i(112),i(51),i(70),i(69),i(111),i(110),i(109),i(108),i(107),i(21),i(106),i(105),i(25),i(65),i(104),i(103),i(102),i(101),i(38),i(87),i(29),i(22),i(89),i(100),i(85),i(84),i(74),i(5),i(90),i(99),i(61),i(26),i(42),i(2),i(30),i(13),i(82),i(98),i(7),i(28),i(67),i(32),i(66),i(49),i(97),i(39),i(37),i(17),i(79),i(64),i(96),i(50),i(68),i(6),i(57),i(95),i(46),i(94),i(55),i(63),i(62),i(45),i(4),t.exports=i(0).default}])});
//# sourceMappingURL=Tone.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/__debugger__.js":
/*!*********************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/__debugger__.js ***!
  \*********************************************************/
/*! exports provided: __DEBUGGER__ */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__DEBUGGER__", function() { return __DEBUGGER__; });
const __DEBUGGER__ = location && /(debugger=true)$/g.test(location.search);
//# sourceMappingURL=__debugger__.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/config/const.js":
/*!*********************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/config/const.js ***!
  \*********************************************************/
/*! exports provided: ONE_MINUTE_SECONDS, BASE_BPM, HALF_BASE_BPM, NOTE_16, NOTE_8, NOTE_4, NOTE_2, NOTE_1, NOTE_TIME_RATE_BASE_ON_8n */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ONE_MINUTE_SECONDS", function() { return ONE_MINUTE_SECONDS; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BASE_BPM", function() { return BASE_BPM; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HALF_BASE_BPM", function() { return HALF_BASE_BPM; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NOTE_16", function() { return NOTE_16; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NOTE_8", function() { return NOTE_8; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NOTE_4", function() { return NOTE_4; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NOTE_2", function() { return NOTE_2; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NOTE_1", function() { return NOTE_1; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NOTE_TIME_RATE_BASE_ON_8n", function() { return NOTE_TIME_RATE_BASE_ON_8n; });
const ONE_MINUTE_SECONDS = 60;
const BASE_BPM = 120;
const HALF_BASE_BPM = 60;
const NOTE_16 = '16n';
const NOTE_8 = '8n';
const NOTE_4 = '4n';
const NOTE_2 = '2n';
const NOTE_1 = '1n';
const NOTE_TIME_RATE_BASE_ON_8n = {
    '1n': 8,
    '2n': 4,
    '4n': 2,
    '8n': 1,
    '16n': 0.5,
};
//# sourceMappingURL=const.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/controller/MidiMao.js":
/*!***************************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/controller/MidiMao.js ***!
  \***************************************************************/
/*! exports provided: MidiMao */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MidiMao", function() { return MidiMao; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @cmao/codemao-tone */ "./node_modules/@cmao/codemao-tone/build/Tone.js");
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _tonejs_midi__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @tonejs/midi */ "./node_modules/@tonejs/midi/dist/Midi.js");
/* harmony import */ var _tonejs_midi__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_tonejs_midi__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./node_modules/@cmao/midimao/dist/utils/index.js");
/* harmony import */ var _instrument__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../instrument */ "./node_modules/@cmao/midimao/dist/instrument/index.js");
/* harmony import */ var _config_const__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../config/const */ "./node_modules/@cmao/midimao/dist/config/const.js");
/* harmony import */ var _obb__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../obb */ "./node_modules/@cmao/midimao/dist/obb/index.js");
/* harmony import */ var _debugger___WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../__debugger__ */ "./node_modules/@cmao/midimao/dist/__debugger__.js");
/* harmony import */ var _ObbMao__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ObbMao */ "./node_modules/@cmao/midimao/dist/controller/ObbMao.js");
/* harmony import */ var _defs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./defs */ "./node_modules/@cmao/midimao/dist/controller/defs.js");


const Tone = _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_1___default.a;








const instrument_store = Object(_instrument__WEBPACK_IMPORTED_MODULE_4__["create_instrument_store"])();
const obb_store = Object(_obb__WEBPACK_IMPORTED_MODULE_6__["create_obb_store"])();
Tone.Transport.bpm.value = _config_const__WEBPACK_IMPORTED_MODULE_5__["BASE_BPM"];
Tone.Transport.start();
class MidiMao {
    constructor() {
        this.instrument_name = _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].GAME; // 乐器名（可为 midi）
        this.event_id_counter = 1; // 事件 id，自增
        const midi = arguments[0], obb = arguments[1];
        if (midi) {
            if (Object(_defs__WEBPACK_IMPORTED_MODULE_9__["is_processed_midi"])(midi)) {
                this.processed_midi = midi;
                this.raw_midi = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["parse_processed_midi_to_raw_midi"])(midi);
            }
            else {
                this.raw_midi = midi;
                this.processed_midi = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["parse_raw_midi_to_processed_midi"])(midi);
            }
        }
        else {
            // 无参，建立空白 midi
            const plain_midi = new _tonejs_midi__WEBPACK_IMPORTED_MODULE_2__["Midi"]();
            plain_midi.addTrack();
            plain_midi.name = `${_defs__WEBPACK_IMPORTED_MODULE_9__["MIDI_NAME_PREFIX"]}MIDI音乐`;
            plain_midi.header.setTempo(_config_const__WEBPACK_IMPORTED_MODULE_5__["BASE_BPM"]);
            this.raw_midi = Object.assign(Object.assign({}, plain_midi.toJSON()), { duration: plain_midi.duration, inst: _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].GAME, obb: _obb__WEBPACK_IMPORTED_MODULE_6__["ObbEnum"].NONE });
            this.processed_midi = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["parse_raw_midi_to_processed_midi"])(this.raw_midi);
        }
        this.event_list = {
            [_defs__WEBPACK_IMPORTED_MODULE_9__["MidiMaoEventType"].START]: new Map(),
            [_defs__WEBPACK_IMPORTED_MODULE_9__["MidiMaoEventType"].PLAYING]: new Map(),
            [_defs__WEBPACK_IMPORTED_MODULE_9__["MidiMaoEventType"].END]: new Map(),
            [_defs__WEBPACK_IMPORTED_MODULE_9__["MidiMaoEventType"].STOP]: new Map(),
        };
        this.bpm = Math.round(this.raw_midi.header.tempos[0].bpm);
        this.anchor_bpm = this.bpm;
        this.step = 0;
        this.state = _defs__WEBPACK_IMPORTED_MODULE_9__["StateEnum"].STOP;
        this.volume = 100;
        this.playback_rate = 1;
        this.loop = false;
        this.loop_start = -1;
        this.loop_end = -1;
        this.__tid = -1;
        this.gain_node = new Tone.Gain().toMaster();
        this.gain_node.gain.rampTo(1, 0.1);
        this.set_instrument(this.raw_midi.inst || _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].GAME);
        if (obb) {
            this.obb = new _ObbMao__WEBPACK_IMPORTED_MODULE_8__["ObbMao"](Object.assign(Object.assign({}, obb), { bpm: this.bpm }));
        }
        else {
            this.obb = null;
        }
    }
    /** ***************************************** 静态方法 *******************************************/
    /**
     * @description 初始化乐器
     * @param {string} name 乐器名
     * @param {InstrumentResourceConfig} config 加载配置
     * @param {(resource)=>void} onload 初始化完成后的回调函数，入参为乐器资源
     * @param {(err)=>void} onerror 初始化失败时的回调函数，入参为错误信息
     */
    static init_instrument(name, config, onload, onerror) {
        return instrument_store.init_instrument(name, config, onload, onerror);
    }
    /**
     * @description 获取乐器资源
     * @param {string} name 乐器名
     * @returns {ToneBuffers} 乐器资源
     */
    static get_instrument_resource(name) {
        return instrument_store.get_instrument_source(name);
    }
    /**
     * @description 替换指定乐器的资源
     * @param {string} name 乐器名
     * @param {ToneBuffers} source 用以替换的乐器资源
     */
    static replace_instrument_resource(name, source) {
        instrument_store.replace_instrument_source(name, source);
    }
    /**
     * @description 初始化伴奏资源
     * @param name 伴奏名
     * @param url 伴奏地址
     * @returns {Promise} 初始化过程的 Promise，无失败处理
     */
    static init_obb(name, url) {
        return obb_store.init_obb(name, url);
    }
    /**
     * @description 获取伴奏资源
     * @param name 伴奏名
     * @returns {ToneBuffer} 伴奏资源
     */
    static get_obb(name) {
        return obb_store.get_obb(name);
    }
    /**
     * @description 从 midi url 中解析 MidiJSON，返回一个包含 MidiMao 实例的 Promise
     * @param {string} url midi 资源 url
     * @returns {Promise<MidiMao | null>} MidiMao 实例或 null 的 Promise
     */
    static get_midi_by_url(url = '') {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            try {
                const raw_midi = yield _tonejs_midi__WEBPACK_IMPORTED_MODULE_2__["Midi"].fromUrl(url);
                raw_midi.name = decodeURIComponent(raw_midi.name);
                return new MidiMao(Object.assign(Object.assign({}, raw_midi.toJSON()), { duration: raw_midi.duration, inst: _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].GAME, obb: _obb__WEBPACK_IMPORTED_MODULE_6__["ObbEnum"].NONE }));
            }
            catch (_a) {
                return null;
            }
        });
    }
    /**
     * @description 将 midi 元数据转化为适用于监听的 midi 稀疏矩阵
     * @param {MidiJSON} midi midi 元数据
     * @returns {ProcessedMidi}
     */
    static parse(midi) {
        return Object(_utils__WEBPACK_IMPORTED_MODULE_3__["parse_raw_midi_to_processed_midi"])(midi);
    }
    /**
     * @description 将 midi 稀疏矩阵转化为 midi 元数据
     * @param {ProcessedMidi} processed_midi midi 稀疏矩阵
     * @returns {MidiJSON}
     */
    static parse_to_raw(processed_midi) {
        return Object(_utils__WEBPACK_IMPORTED_MODULE_3__["parse_processed_midi_to_raw_midi"])(processed_midi);
    }
    /**
     * @description 从一个 midi 资源文件 url 中获取并解析出 midi 元数据，返回一个搭载 MidiJson 的 Promise
     * @param {string} url midi 资源 url
     * @returns {Promise<MidiJSON>}
     */
    static parse_midi_file(url) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const midi = yield _tonejs_midi__WEBPACK_IMPORTED_MODULE_2__["Midi"].fromUrl(url);
            const { name, inst, obb } = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["destruct_midi_name"])(decodeURIComponent(midi.header.name));
            midi.header.name = name;
            return Object.assign(Object.assign({}, midi.toJSON()), { duration: midi.duration, inst,
                obb });
        });
    }
    /**
     * @description 将 midi 元数据输出成 8 进制数据
     * @param {MidiJSON} midi 要输出的 midi 元数据
     * @returns {{data: Uint8Array, MIME: string, suffix: string}} 返回一个包含 8 进制数据、MIME 类型、文件后缀的对象
     */
    static output_midi_file_in_Uint8Array(midi) {
        const file = new _tonejs_midi__WEBPACK_IMPORTED_MODULE_2__["Midi"]();
        file.fromJSON(midi);
        return { data: file.toArray(), MIME: 'audio/mid', suffix: 'mid' };
    }
    /**
     * @description 使用某个乐器播放单一音符
     * @param {string} instrument 指定乐器
     * @param {string} note 要播放的音符
     * @param {number} duration 持续时间
     */
    static play_note(instrument = _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].GAME, note, duration) {
        if (instrument === _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].MIDI) {
            const synth = new Tone.PolySynth().toMaster();
            synth.triggerAttackRelease(note, duration || '8n');
        }
        else if (instrument_store.is_ready(instrument)) {
            const sampler = new Tone.Sampler(instrument_store.get_instrument_source(instrument)._buffers).toMaster();
            sampler.triggerAttackRelease(note, duration || '8n');
        }
        else {
            console.warn(`The instrument(${instrument}) you used is not ready yet. Please make sure you have loaded the instrument resource.`);
        }
    }
    /**
     * @description 播放非 midi 音乐
     * @param {string} url 音乐资源 url
     * @returns {Tone.Player} 音乐控制器
     */
    static play_normal_music(url) {
        const player = new Tone.Player(url, () => player.start()).toMaster();
        return player;
    }
    /**
     * @description 创建一个空白 midi 元数据
     * @returns {Midi} 空 midi
     */
    static create_plain_midi() {
        return new _tonejs_midi__WEBPACK_IMPORTED_MODULE_2__["Midi"]();
    }
    /**
     * @description 重置全局 bpm 为 120
     */
    static reset_global_bpm() {
        Tone.Transport.bpm.value = _config_const__WEBPACK_IMPORTED_MODULE_5__["BASE_BPM"];
    }
    // ios safari 禁止中 AudioContext 自动激活。
    // 必须在用户主动触发的事件（不包含鼠标移动事件）中修改 AudioContext 的状态并激活它（同步、异步均可）。否则无法播放声音。
    // 保证 MidiMao 实例是在用户主动触发的事件中被实例化的，就能保证 Tone 的 AudioContext 被正确激活。
    // Tone.start() 就是执行了 AudioContext.resume();
    static activate_audio_context() {
        Tone.context.state === 'suspended' && (() => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () { return yield Tone.start(); }))();
    }
    /** ***************************************** 静态方法 end *******************************************/
    /** ***************************************** 实例方法 *******************************************/
    /**
     * @description 更新 MidiMao 实例的 midi 数据或伴奏数据
     * @param {{midi?: MidiJSON | ProcessedMidi, obb?: { data?: any; name?: string; bpm?: number }}} data midi 或伴奏数据载体，
     * 其中 obb.data 为伴奏资源，obb.name 为伴奏名，obb.bpm 为伴奏的节拍
     * @returns {MidiMao} MidiMao 实例本身
     */
    update(data) {
        if (this.state !== _defs__WEBPACK_IMPORTED_MODULE_9__["StateEnum"].STOP) {
            this.stop();
        }
        const { midi, obb } = data;
        // 主旋律、伴奏分开更新，忽略 midi 中携带的 obb 信息，只更新主旋律相关
        if (midi) {
            if (Object(_defs__WEBPACK_IMPORTED_MODULE_9__["is_processed_midi"])(midi)) {
                this.processed_midi = Object.assign(Object.assign({}, midi), { obb: this.processed_midi.obb });
                this.raw_midi = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["parse_processed_midi_to_raw_midi"])(midi);
            }
            else {
                this.raw_midi = Object.assign(Object.assign({}, midi), { obb: this.raw_midi.obb });
                this.processed_midi = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["parse_raw_midi_to_processed_midi"])(midi);
            }
            this.anchor_bpm = this.bpm = Math.round(this.raw_midi.header.tempos[0].bpm);
            this.instrument_name = midi.inst;
            this.set_instrument(midi.inst);
            this.set_playback_rate(1);
        }
        // 更新伴奏，将主旋律中伴奏信息一同更新
        if (obb) {
            this.obb = this.obb ? this.obb.update(obb) : new _ObbMao__WEBPACK_IMPORTED_MODULE_8__["ObbMao"]().update(obb);
            // 使伴奏与主旋律节拍一致
            this.obb.set_playback_rate_by_bpm(this.anchor_bpm * this.playback_rate);
            obb.name && (this.raw_midi.obb = obb.name);
            obb.name && (this.processed_midi.obb = obb.name);
        }
        return this;
    }
    /**
     * @description 清除 MidiMao 实例的伴奏
     * @returns {MidiMao} MidiMao 实例自身
     */
    clear_obb() {
        this.obb = null;
        return this;
    }
    /**
     * @description 播放实例加载的 midi 音乐
     * @param {number} target_step 区间播放时，区间终点
     * @param {number} obb_offset 伴奏开始偏移量
     * @returns {MidiInfo}
     */
    _play(target_step, obb_offset) {
        if (this.processed_midi.length === 0) {
            return this.get_midi_info();
        }
        if (this.instrument_name !== _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].MIDI && !this.instrument) {
            const res = this.set_instrument(this.instrument_name);
            if (!res) {
                return this.get_midi_info();
            }
        }
        const TIME_8n = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["get_8n_time_by_bpm"])(this.bpm);
        let new_play = true;
        let current_notes = [];
        const __play = (time) => {
            const __WAY = this.instrument_name === _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].MIDI ?
                this.play_with_midi :
                this.play_with_instrument;
            const __SYN = this.instrument_name === _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].MIDI ?
                this.instrument_midi :
                this.instrument;
            current_notes = __WAY.call(this, this.step, __SYN);
            _debugger___WEBPACK_IMPORTED_MODULE_7__["__DEBUGGER__"] && console.log('midi playing');
            this.trigger_event(_defs__WEBPACK_IMPORTED_MODULE_9__["MidiMaoEventType"].PLAYING, current_notes, time);
            return current_notes;
        };
        // 使每一个注册的 scheduleRepeat 锚定 120 的 bpm，以此来剥离 midi 本身的 bpm 和全局 bpm 的关系，避免在变速时产生纠缠影响。
        const TRUE_BPM = Tone.Transport.bpm.value;
        Tone.Transport.bpm.value = _config_const__WEBPACK_IMPORTED_MODULE_5__["BASE_BPM"];
        this.__tid = Tone.Transport.scheduleRepeat((time) => {
            var _a;
            if (new_play) {
                _debugger___WEBPACK_IMPORTED_MODULE_7__["__DEBUGGER__"] && console.log('midi start');
                this.trigger_event(_defs__WEBPACK_IMPORTED_MODULE_9__["MidiMaoEventType"].START, current_notes, time);
                // 开始播放时检测恢复播放长音符
                this.recover_long_note();
                (_a = this.obb) === null || _a === void 0 ? void 0 : _a.play(obb_offset);
                new_play = false;
            }
            current_notes = [];
            if (typeof target_step === 'number' && this.step <= target_step) {
                current_notes = __play(time);
            }
            else if (typeof target_step !== 'number' &&
                this.step < this.processed_midi.length) {
                current_notes = __play(time);
            }
            // 循环播放，调整步进器
            if (this.loop && this.step === this.loop_end) {
                return (this.step = this.loop_start);
            }
            // 区间播放或播放整首，播放结束要清除序列，主动清除，使用 >= 判断，避免 scheduleRepeat 意外多余调用
            if (typeof target_step === 'number' && this.step >= target_step + 1) {
                _debugger___WEBPACK_IMPORTED_MODULE_7__["__DEBUGGER__"] && console.log('midi end');
                this.trigger_event(_defs__WEBPACK_IMPORTED_MODULE_9__["MidiMaoEventType"].END, current_notes, time);
                return this.stop();
            }
            // 如果 target_step > midi_length，当播放完后也会停止
            if (this.step >= this.processed_midi.length) {
                _debugger___WEBPACK_IMPORTED_MODULE_7__["__DEBUGGER__"] && console.log('midi end');
                // 保证声音播放完毕后才触发 end 事件，但要立即清除 schedule，避免进入下一次播放（多余的）
                this.trigger_event(_defs__WEBPACK_IMPORTED_MODULE_9__["MidiMaoEventType"].END, current_notes, time);
                return this.stop();
            }
            // 当 step 步进到最后一列时继续 +1 再进行一次 scheduleRepeat，此次重复只用于触发 end 事件，避免使用计时器导致偶尔的无法停止播放
            // this.processed_midi - 1   ===>   this.processed_midi.length
            this.step++;
        }, TIME_8n, 0);
        this.state = _defs__WEBPACK_IMPORTED_MODULE_9__["StateEnum"].PLAYING;
        Tone.Transport.bpm.value = TRUE_BPM;
        Tone.Transport.start();
        return this.get_midi_info();
    }
    /**
     * @description 播放实例的 midi 音乐，如果是正在播放中则忽略
     * @returns {MidiInfo}
     */
    play() {
        if (this.state === _defs__WEBPACK_IMPORTED_MODULE_9__["StateEnum"].PLAYING) {
            return this.get_midi_info();
        }
        else if (this.state === _defs__WEBPACK_IMPORTED_MODULE_9__["StateEnum"].PAUSE) {
            // 暂停前可能是区间播放，传入 target_step
            this._play(this.target_step);
            return this.get_midi_info();
        }
        return this._play();
    }
    /**
     * @description 播放指定区域音符，先停止已存在播放序列，再播放区间。如果起点大于 midi 长度、end > start，忽略执行。只传 start 则只播放 start 列。
     * @param {number} start 区间起点，从 0 开始计算
     * @param {number} end 区间终点
     * @returns {MidiInfo}
     */
    play_part(start, end) {
        if (start > this.processed_midi.length - 1) {
            return this.get_midi_info();
        }
        if (this.state !== _defs__WEBPACK_IMPORTED_MODULE_9__["StateEnum"].STOP) {
            this.stop();
        }
        const len = typeof end === 'number' ? end - start : 1;
        if (len < 0) {
            return this.get_midi_info();
        }
        // 如果传了 end 且 end 大于曲子长度。
        if (end && end > this.processed_midi.length - 1) {
            end = this.processed_midi.length - 1;
        }
        this.step = start;
        this.target_step = end;
        const obb_offset = Object(_utils__WEBPACK_IMPORTED_MODULE_3__["get_8n_time_by_bpm"])(this.bpm) * start;
        return this._play(end || start, obb_offset);
    }
    /**
     * @description 区间播放或者是先前状态为暂停，检测当前位置是否有长音符，若有，则继续播放长音符剩余时值
     */
    recover_long_note() {
        // 先前状态为暂停，检测暂停时是否有长音符，若有，则继续播放长音符剩余时值
        const notes = this.get_current_long_notes();
        if (notes.length === 0)
            return this;
        if (this.instrument_name === _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].MIDI) {
            notes.forEach((item) => {
                this.instrument_midi[item[0]].triggerAttack(item[1].name, Tone.now(), 1);
            });
        }
        else {
            notes.forEach((item) => {
                this.instrument &&
                    this.instrument.triggerAttack(item[1].name, Tone.now(), 1);
            });
        }
        return this;
    }
    /**
     * @description 暂停播放序列，并卸载对应的 Tone 事件
     */
    pause() {
        var _a;
        _debugger___WEBPACK_IMPORTED_MODULE_7__["__DEBUGGER__"] && console.log('midi pause');
        Tone.Transport.clear(this.__tid);
        // 清除音符
        this.stop_notes();
        this.state = _defs__WEBPACK_IMPORTED_MODULE_9__["StateEnum"].PAUSE;
        this.__tid = -1;
        (_a = this.obb) === null || _a === void 0 ? void 0 : _a.stop();
        return this;
    }
    /**
     * @description 停止播放序列，注销对应 Tone 事件
     */
    stop() {
        var _a;
        _debugger___WEBPACK_IMPORTED_MODULE_7__["__DEBUGGER__"] && console.log('midi stop');
        Tone.Transport.clear(this.__tid);
        // 清除音符
        this.stop_notes();
        this.step = 0;
        this.__tid = -1;
        this.loop = false;
        this.loop_end = -1;
        this.loop_start = -1;
        this.target_step = undefined;
        (_a = this.obb) === null || _a === void 0 ? void 0 : _a.stop();
        if (this.state !== _defs__WEBPACK_IMPORTED_MODULE_9__["StateEnum"].STOP) {
            this.trigger_event(_defs__WEBPACK_IMPORTED_MODULE_9__["MidiMaoEventType"].STOP);
        }
        this.state = _defs__WEBPACK_IMPORTED_MODULE_9__["StateEnum"].STOP;
        return this;
    }
    /**
     * @description 停止在播的时值超过8分音符的长音符。
     * @comment 通过 triggerAttack 触发的声音如果不主动清除，则声音会一直持续，因此要主动清除
     */
    stop_notes() {
        if (this.instrument_name === _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].MIDI) {
            const notes = this.get_current_long_notes();
            notes.forEach((item) => this.instrument_midi[item[0]].triggerRelease(item[1].name));
        }
        else {
            this.instrument && this.instrument.releaseAll();
        }
    }
    /**
     * @description 获取当前在播的长音符。
     */
    get_current_long_notes() {
        const notes = [];
        this.processed_midi.tracks.forEach((track, index) => {
            const note = track.notes[this.step];
            note && note.padding_note && notes.push([index, note]);
        });
        return notes;
    }
    /**
     * @description 使用 midi 原音播放，返回被播放的音符，需求中无 midi 音色，暂用不上
     * @param {number} step 当前步进值
     * @param {Array} synths 合成器数组
     * @returns {Array<string>} 被播放的音符
     */
    play_with_midi(step, synths) {
        const current_notes = [];
        this.processed_midi.tracks.forEach((track, index) => {
            const note = track.notes[step];
            note && current_notes.push(note.name);
            note &&
                !note.padding_note &&
                synths[index].triggerAttackRelease(note.name, note.duration / this.playback_rate);
        });
        return current_notes;
    }
    /**
     * @description 使用乐器播放，返回被播放的音符
     * @param {number} step 当前步进值
     * @param {any} samp_synth 乐器合成器
     * @returns {Array<string>} 被播放的音符
     */
    play_with_instrument(step, samp_synth) {
        if (!samp_synth) {
            remind_instrument_error(this.instrument_name);
            return [];
        }
        // 播放前先清理上一次残留的音符
        this.release_last_notes(step, samp_synth);
        const current_notes = [];
        this.processed_midi.tracks.forEach((track) => {
            const note = track.notes[step];
            note && current_notes.push(note.name);
            note &&
                !note.padding_note &&
                samp_synth.triggerAttack(note.name, 
                // note.duration / this.playback_rate,
                Tone.now(), 1);
        });
        return current_notes;
    }
    /**
     * @description 清理单 8n 时长的音符和长音符的尾音符
     * @param {number} step 当前播放列
     * @param {any} 要清除声音的合成器
     */
    release_last_notes(step, samp_synth) {
        const prev_step = step - 1;
        if (prev_step < 0)
            return;
        const notes = [];
        this.processed_midi.tracks.forEach((track) => {
            const note = track.notes[prev_step];
            // 不是长音符、填充音符的音符就是正常 8n 时长的音符
            note && !note.start_note && !note.padding_note && notes.push(note.name);
            // 尾音符
            note && note.end_note && notes.push(note.name);
        });
        samp_synth.triggerRelease(notes);
    }
    /**
     * @description 开启歌曲循环，默认循环整首曲子，如果 start < end 或 start < 0 或 start > 曲子长度，放弃执行。
     * @param {boolean} loop 是否开启循环
     * @param {number} start 循环区间起点
     * @param {number} end 循环区间终点
     * @returns {MidiMao} 实例本身
     */
    set_loop(loop, start = 0, end = this.processed_midi.length - 1) {
        if (start < 0 || end < start) {
            return this;
        }
        if (start > this.processed_midi.length - 1) {
            return this;
        }
        this.loop = loop;
        this.loop_end = Math.trunc(end === 0 ?
            0 :
            end > this.processed_midi.length ?
                this.processed_midi.length - 1 :
                end);
        this.loop_start = Math.trunc(start);
        return this;
    }
    /**
     * @description 设置实例播放倍率
     * @param {number} rate 播放速度倍率
     * @returns {MidiMao} 实例本身
     */
    set_playback_rate(rate) {
        var _a;
        Tone.Transport.bpm.value = _config_const__WEBPACK_IMPORTED_MODULE_5__["BASE_BPM"] * rate;
        this.playback_rate = rate;
        (_a = this.obb) === null || _a === void 0 ? void 0 : _a.set_playback_rate_by_bpm(this.anchor_bpm * rate);
        // 避免性能问题下导致的变速时刻音符没有被清除
        this.instrument && this.instrument.releaseAll();
        this.long_note_compensate();
        return this;
    }
    /**
     * @description 以 bpm 设置实例播放倍率
     * @param {number}  bpm  目标 bpm
     * @returns {MidiMao} 实例本身
     */
    set_playback_rate_by_bpm(bpm) {
        var _a;
        const rate = bpm / this.anchor_bpm;
        Tone.Transport.bpm.value = _config_const__WEBPACK_IMPORTED_MODULE_5__["BASE_BPM"] * rate;
        this.playback_rate = rate;
        (_a = this.obb) === null || _a === void 0 ? void 0 : _a.set_playback_rate_by_bpm(bpm);
        this.instrument && this.instrument.releaseAll();
        this.long_note_compensate();
        return this;
    }
    /**
     * @description 注册监听事件，返回该事件 id
     * @param {MidiMaoEventType} type 事件类型
     * @param {EventCallback} evt 注册的回调函数
     * @returns {number} 事件 id
     */
    register_event(type, evt) {
        this.event_list[type].set(this.event_id_counter, {
            id: this.event_id_counter,
            cb: evt,
        });
        return this.event_id_counter++;
    }
    /**
     * @description 移除监听事件
     * @param {MidiMaoEventType} type 事件类型
     * @param {number} id 事件 id
     * @returns {MidiMao} 实例本身
     */
    remove_event(type, id) {
        this.event_list[type].has(id) && this.event_list[type].delete(id);
        return this;
    }
    /**
     * @description 移除所有监听事件
     * @returns {MidiMao} 实例本身
     */
    remove_all_event() {
        Object.keys(this.event_list).forEach((key) => {
            this.event_list[key].clear();
        });
        return this;
    }
    /**
     * @description 触发以注册事件，传入回调值
     * @param {MidiMaoEventType} type 事件类型
     * @param {Array} notes 当前播放的音符（按列记）
     * @param {number} time 当前播放时间（不是音乐已播放时间）
     */
    trigger_event(type, notes, time) {
        this.event_list[type].forEach((evt) => {
            evt.cb(notes, this.get_midi_info(), time, this.processed_midi);
        });
    }
    /**
     * @description 设置实例播放乐器
     * @param {string} name 乐器名
     * @returns {boolean} true: 成功， fale: 失败
     */
    set_instrument(name) {
        this.instrument_name = name;
        if (name === _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].MIDI) {
            // 先建立合成器，以便复用，无需重复创建，由于是每次播放时都是全新一套 PolySynth 合成器，无需断开音量节点。
            const midi_synths = [];
            this.processed_midi.tracks.forEach(() => {
                const synth = new Tone.PolySynth();
                synth.connect(this.gain_node);
                midi_synths.push(synth);
            });
            this.instrument_midi = midi_synths;
            this.instrument = null;
        }
        else {
            const res = this.get_truly_instrument(name);
            if (!res)
                return false;
            this.instrument && this.instrument.releaseAll();
            this.instrument = res;
            // 成功获取乐器后连接音量节点
            this.instrument.connect(this.gain_node);
            this.long_note_compensate();
        }
        return true;
    }
    /**
     * @description 变速、改变乐器后，长音符补偿
     */
    long_note_compensate() {
        if (!this.instrument) {
            return this;
        }
        const long_notes = [];
        this.processed_midi.tracks.forEach((track) => {
            const note = track.notes[this.step];
            note && note.padding_note && !note.end_note && long_notes.push(note.name);
        });
        this.instrument.triggerAttack(long_notes, Tone.now(), 1);
        return this;
    }
    /**
     * @description 从音色库中加载音色资源以创建乐器
     * @param {string} name 乐器名
     * @returns {any} 如果音色资源未准备好，返回 null，否则返回乐器
     */
    get_truly_instrument(name) {
        if (name === _instrument__WEBPACK_IMPORTED_MODULE_4__["InstrumentEnum"].MIDI || !instrument_store.is_ready(name)) {
            remind_instrument_error(this.instrument_name);
            return null;
        }
        const sampler = new Tone.Sampler(instrument_store.get_instrument_source(name)._buffers);
        return sampler;
    }
    /**
     * @description 设置实例音量
     * @param {number} value 音量大小（0～100）
     * @returns {MidiMao} 实例本身
     */
    set_volume(value) {
        var _a;
        this.volume = value > 100 ? 100 : value < 0 ? 0 : value;
        this.gain_node.gain.rampTo(this.volume / 100, 0.1);
        (_a = this.obb) === null || _a === void 0 ? void 0 : _a.set_volume(value);
        return this;
    }
    /**
     * @description 获取转化后的 midi 矩阵数据
     */
    get_pro_midi() {
        return this.processed_midi;
    }
    /**
     * @description 获取 midi 元数据
     */
    get_raw_midi() {
        return this.raw_midi;
    }
    /**
     * @description 获取 midi 音乐配置信息
     * @return {MidiInfo}
     */
    get_midi_info() {
        return {
            name: this.raw_midi.header.name,
            obb_name: this.obb ? this.obb.name : _obb__WEBPACK_IMPORTED_MODULE_6__["ObbEnum"].NONE,
            step: this.step,
            state: this.state,
            playback_rate: this.playback_rate,
            loop: this.loop,
            loop_part: [this.loop_start, this.loop_end],
            volume: this.volume,
            instrument_name: this.instrument_name,
            length: this.processed_midi.length,
            bpm: this.bpm,
            duration: this.processed_midi.duration,
        };
    }
    /**
     * @description 获取伴奏信息、资源
     * @returns {{obb_name: string, obb_data: any}} 伴奏名与伴奏资源
     */
    get_obb() {
        var _a, _b;
        return {
            obb_name: ((_a = this.obb) === null || _a === void 0 ? void 0 : _a.name) || _obb__WEBPACK_IMPORTED_MODULE_6__["ObbEnum"].NONE,
            obb_data: ((_b = this.obb) === null || _b === void 0 ? void 0 : _b._buffer) || null,
        };
    }
}
function remind_instrument_error(name) {
    console.warn(`Instrument(${name}) not ready yet. Please make sure you have loaded the instrument resource and reset instance's instrument.`);
}
//# sourceMappingURL=MidiMao.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/controller/ObbMao.js":
/*!**************************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/controller/ObbMao.js ***!
  \**************************************************************/
/*! exports provided: ObbMao */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObbMao", function() { return ObbMao; });
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @cmao/codemao-tone */ "./node_modules/@cmao/codemao-tone/build/Tone.js");
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils */ "./node_modules/@cmao/midimao/dist/utils/index.js");
/* harmony import */ var _config_const__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../config/const */ "./node_modules/@cmao/midimao/dist/config/const.js");
/* harmony import */ var _obb__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../obb */ "./node_modules/@cmao/midimao/dist/obb/index.js");
/* harmony import */ var _defs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./defs */ "./node_modules/@cmao/midimao/dist/controller/defs.js");

const Tone = _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0___default.a;




const obb_store = Object(_obb__WEBPACK_IMPORTED_MODULE_3__["create_obb_store"])();
class ObbMao {
    constructor() {
        this.playback_rate = 1;
        const obb = arguments[0];
        if (obb && obb.data) {
            this._buffer = obb.data;
            this.name = obb.name;
            this.speed_state = Object(_utils__WEBPACK_IMPORTED_MODULE_1__["judge_speed_state"])(obb.bpm);
            this.player = new Tone.Player(this._buffer);
        }
        else {
            this._buffer = null;
            this.name = _obb__WEBPACK_IMPORTED_MODULE_3__["ObbEnum"].NONE;
            this.speed_state = _defs__WEBPACK_IMPORTED_MODULE_4__["SpeedStateEnum"].HIGH;
            this.player = new Tone.Player();
        }
        this.gain_node = new Tone.Gain().toMaster();
        this.gain_node.gain.rampTo(1 * _defs__WEBPACK_IMPORTED_MODULE_4__["OBB_VOL_PERCENT"], 0.1);
        this.player.loop = true;
        this.player.connect(this.gain_node);
        this.set_playback_rate_by_bpm(obb ? obb.bpm : _config_const__WEBPACK_IMPORTED_MODULE_2__["BASE_BPM"]);
        this.state = _defs__WEBPACK_IMPORTED_MODULE_4__["StateEnum"].STOP;
        this.startTime = -1;
        this.stopTime = -1;
    }
    update(obb) {
        this.stop();
        if (obb.data === null || obb.data) {
            this._buffer = obb.data;
            this.player =
                obb.data === null ? new Tone.Player() : new Tone.Player(this._buffer);
            this.player.connect(this.gain_node);
            this.player.loop = true;
            this.player.playbackRate = this.playback_rate = 1;
        }
        if (obb.name) {
            this.name = obb.name;
        }
        if (obb.bpm) {
            this.speed_state = Object(_utils__WEBPACK_IMPORTED_MODULE_1__["judge_speed_state"])(obb.bpm);
        }
        return this;
    }
    update_base_speed(bpm) {
        this.speed_state = Object(_utils__WEBPACK_IMPORTED_MODULE_1__["judge_speed_state"])(bpm);
        return this;
    }
    play(offset) {
        // 播放器不存在 或 播放器加载资源时，资源可能尚未获取到，播放前重新获取下资源
        if (!this.player ||
            (!this.player.loaded && obb_store.is_ready(this.name))) {
            this.player && this.player.disconnect(this.gain_node);
            this.player = new Tone.Player(obb_store.get_obb(this.name));
            this.player.connect(this.gain_node);
            this.player.loop = true;
            this.player.playbackRate = this.playback_rate;
        }
        if (!this.player.loaded || this.state === _defs__WEBPACK_IMPORTED_MODULE_4__["StateEnum"].PLAYING) {
            return this;
        }
        if (this.state === _defs__WEBPACK_IMPORTED_MODULE_4__["StateEnum"].PAUSE) {
            this.player.start(undefined, (this.stopTime - this.startTime) % this.player.buffer.duration);
        }
        else {
            this.player.start(undefined, offset);
        }
        // 0.105 左右的循环补偿，纠正伴奏与主旋律的节奏
        this.player.loopEnd = this.player.buffer.duration - 0.106;
        this.state = _defs__WEBPACK_IMPORTED_MODULE_4__["StateEnum"].PLAYING;
        this.startTime = Tone.now();
        // 循环结束时间提前 0.09 秒，避免循环多次后伴奏旋律与主旋律不对齐。0.106 是体验出来的值（0.105 ~ 0.110内必有一个最佳值）
        this.player.loopEnd = this.player.buffer.duration - 0.106;
        return this;
    }
    /**
     * @description 停止播放序列，注销对应 Tone 事件
     */
    stop() {
        if (this.player && this.player.loaded) {
            this.player.stop();
            this.player.disconnect(this.gain_node);
            this.player.dispose();
            this.player = null;
        }
        this.state = _defs__WEBPACK_IMPORTED_MODULE_4__["StateEnum"].STOP;
        return this;
    }
    pause() {
        this.player.loaded && this.player.stop();
        this.stopTime = Tone.now();
        this.state = _defs__WEBPACK_IMPORTED_MODULE_4__["StateEnum"].PAUSE;
        return this;
    }
    /**
     * @description 设置实例音量，以百分比计算
     * @param {number} value 音量大小（0～100）
     */
    set_volume(value) {
        const volume = value > 100 ? 100 : value < 0 ? 0 : value;
        this.gain_node.gain.rampTo((volume / 100) * _defs__WEBPACK_IMPORTED_MODULE_4__["OBB_VOL_PERCENT"], 0.1);
        return this;
    }
    /**
     * @description 设置实例播放倍率
     * @param {number} bpm  目标 bpm
     */
    set_playback_rate_by_bpm(bpm) {
        let rate = 1;
        switch (this.speed_state) {
            case _defs__WEBPACK_IMPORTED_MODULE_4__["SpeedStateEnum"].HIGH: {
                rate = bpm / 180;
                break;
            }
            case _defs__WEBPACK_IMPORTED_MODULE_4__["SpeedStateEnum"].MID_HIGH: {
                rate = bpm / 150;
                break;
            }
            case _defs__WEBPACK_IMPORTED_MODULE_4__["SpeedStateEnum"].NORMAL: {
                rate = bpm / 120;
                break;
            }
            case _defs__WEBPACK_IMPORTED_MODULE_4__["SpeedStateEnum"].MID_LOW: {
                rate = bpm / 90;
                break;
            }
            case _defs__WEBPACK_IMPORTED_MODULE_4__["SpeedStateEnum"].LOW: {
                rate = bpm / 60;
                break;
            }
            default:
                break;
        }
        this.playback_rate = rate;
        this.player && (this.player.playbackRate = rate);
        return this;
    }
}
//# sourceMappingURL=ObbMao.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/controller/defs.js":
/*!************************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/controller/defs.js ***!
  \************************************************************/
/*! exports provided: MIDI_NAME_PREFIX, OBB_VOL_PERCENT, MidiMaoEventType, is_processed_midi, StateEnum, SpeedStateEnum */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MIDI_NAME_PREFIX", function() { return MIDI_NAME_PREFIX; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OBB_VOL_PERCENT", function() { return OBB_VOL_PERCENT; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MidiMaoEventType", function() { return MidiMaoEventType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "is_processed_midi", function() { return is_processed_midi; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "StateEnum", function() { return StateEnum; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SpeedStateEnum", function() { return SpeedStateEnum; });
const MIDI_NAME_PREFIX = 'cmao-midi_';
const OBB_VOL_PERCENT = 0.8;
var MidiMaoEventType;
(function (MidiMaoEventType) {
    MidiMaoEventType["START"] = "start";
    MidiMaoEventType["PLAYING"] = "playing";
    MidiMaoEventType["END"] = "end";
    MidiMaoEventType["STOP"] = "stop";
})(MidiMaoEventType || (MidiMaoEventType = {}));
function is_processed_midi(midi) {
    return midi.pro;
}
var StateEnum;
(function (StateEnum) {
    StateEnum[StateEnum["PLAYING"] = 1] = "PLAYING";
    StateEnum[StateEnum["STOP"] = 2] = "STOP";
    StateEnum[StateEnum["PAUSE"] = 3] = "PAUSE";
})(StateEnum || (StateEnum = {}));
var SpeedStateEnum;
(function (SpeedStateEnum) {
    SpeedStateEnum["HIGH"] = "high";
    SpeedStateEnum["MID_HIGH"] = "mid_high";
    SpeedStateEnum["NORMAL"] = "";
    SpeedStateEnum["MID_LOW"] = "mid_low";
    SpeedStateEnum["LOW"] = "low";
})(SpeedStateEnum || (SpeedStateEnum = {}));
//# sourceMappingURL=defs.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/controller/index.js":
/*!*************************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/controller/index.js ***!
  \*************************************************************/
/*! exports provided: MidiMao, ObbMao */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _MidiMao__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MidiMao */ "./node_modules/@cmao/midimao/dist/controller/MidiMao.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MidiMao", function() { return _MidiMao__WEBPACK_IMPORTED_MODULE_0__["MidiMao"]; });

/* harmony import */ var _ObbMao__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ObbMao */ "./node_modules/@cmao/midimao/dist/controller/ObbMao.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ObbMao", function() { return _ObbMao__WEBPACK_IMPORTED_MODULE_1__["ObbMao"]; });




//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/defs.js":
/*!*************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/defs.js ***!
  \*************************************************/
/*! exports provided: MIDI_NAME_PREFIX, OBB_VOL_PERCENT, MidiMaoEventType, is_processed_midi, StateEnum, SpeedStateEnum, InstrumentEnum, ObbEnum */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _controller_defs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./controller/defs */ "./node_modules/@cmao/midimao/dist/controller/defs.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MIDI_NAME_PREFIX", function() { return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["MIDI_NAME_PREFIX"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OBB_VOL_PERCENT", function() { return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["OBB_VOL_PERCENT"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MidiMaoEventType", function() { return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["MidiMaoEventType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "is_processed_midi", function() { return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["is_processed_midi"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "StateEnum", function() { return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["StateEnum"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SpeedStateEnum", function() { return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["SpeedStateEnum"]; });

/* harmony import */ var _instrument_defs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./instrument/defs */ "./node_modules/@cmao/midimao/dist/instrument/defs.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "InstrumentEnum", function() { return _instrument_defs__WEBPACK_IMPORTED_MODULE_1__["InstrumentEnum"]; });

/* harmony import */ var _obb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./obb */ "./node_modules/@cmao/midimao/dist/obb/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ObbEnum", function() { return _obb__WEBPACK_IMPORTED_MODULE_2__["ObbEnum"]; });




//# sourceMappingURL=defs.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/index.js":
/*!**************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/index.js ***!
  \**************************************************/
/*! exports provided: Midi, MidiCollection, Tone, ToneCollection, MidiMao, ObbMao, MIDI_NAME_PREFIX, OBB_VOL_PERCENT, MidiMaoEventType, is_processed_midi, StateEnum, SpeedStateEnum, InstrumentEnum, ObbEnum, ONE_MINUTE_SECONDS, BASE_BPM, HALF_BASE_BPM, NOTE_16, NOTE_8, NOTE_4, NOTE_2, NOTE_1, NOTE_TIME_RATE_BASE_ON_8n, get_8n_time_by_bpm, judge_speed_state */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _tonejs_midi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @tonejs/midi */ "./node_modules/@tonejs/midi/dist/Midi.js");
/* harmony import */ var _tonejs_midi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_tonejs_midi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Midi", function() { return _tonejs_midi__WEBPACK_IMPORTED_MODULE_0__["Midi"]; });

/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, "MidiCollection", function() { return _tonejs_midi__WEBPACK_IMPORTED_MODULE_0__; });
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @cmao/codemao-tone */ "./node_modules/@cmao/codemao-tone/build/Tone.js");
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_1__);
/* harmony reexport (default from non-harmony) */ __webpack_require__.d(__webpack_exports__, "Tone", function() { return _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_1___default.a; });
/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, "ToneCollection", function() { return _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_1__; });
/* harmony import */ var _controller__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./controller */ "./node_modules/@cmao/midimao/dist/controller/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MidiMao", function() { return _controller__WEBPACK_IMPORTED_MODULE_2__["MidiMao"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ObbMao", function() { return _controller__WEBPACK_IMPORTED_MODULE_2__["ObbMao"]; });

/* harmony import */ var _defs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./defs */ "./node_modules/@cmao/midimao/dist/defs.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MIDI_NAME_PREFIX", function() { return _defs__WEBPACK_IMPORTED_MODULE_3__["MIDI_NAME_PREFIX"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OBB_VOL_PERCENT", function() { return _defs__WEBPACK_IMPORTED_MODULE_3__["OBB_VOL_PERCENT"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MidiMaoEventType", function() { return _defs__WEBPACK_IMPORTED_MODULE_3__["MidiMaoEventType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "is_processed_midi", function() { return _defs__WEBPACK_IMPORTED_MODULE_3__["is_processed_midi"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "StateEnum", function() { return _defs__WEBPACK_IMPORTED_MODULE_3__["StateEnum"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "SpeedStateEnum", function() { return _defs__WEBPACK_IMPORTED_MODULE_3__["SpeedStateEnum"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "InstrumentEnum", function() { return _defs__WEBPACK_IMPORTED_MODULE_3__["InstrumentEnum"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ObbEnum", function() { return _defs__WEBPACK_IMPORTED_MODULE_3__["ObbEnum"]; });

/* harmony import */ var _config_const__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./config/const */ "./node_modules/@cmao/midimao/dist/config/const.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ONE_MINUTE_SECONDS", function() { return _config_const__WEBPACK_IMPORTED_MODULE_4__["ONE_MINUTE_SECONDS"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BASE_BPM", function() { return _config_const__WEBPACK_IMPORTED_MODULE_4__["BASE_BPM"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "HALF_BASE_BPM", function() { return _config_const__WEBPACK_IMPORTED_MODULE_4__["HALF_BASE_BPM"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NOTE_16", function() { return _config_const__WEBPACK_IMPORTED_MODULE_4__["NOTE_16"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NOTE_8", function() { return _config_const__WEBPACK_IMPORTED_MODULE_4__["NOTE_8"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NOTE_4", function() { return _config_const__WEBPACK_IMPORTED_MODULE_4__["NOTE_4"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NOTE_2", function() { return _config_const__WEBPACK_IMPORTED_MODULE_4__["NOTE_2"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NOTE_1", function() { return _config_const__WEBPACK_IMPORTED_MODULE_4__["NOTE_1"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "NOTE_TIME_RATE_BASE_ON_8n", function() { return _config_const__WEBPACK_IMPORTED_MODULE_4__["NOTE_TIME_RATE_BASE_ON_8n"]; });

/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils */ "./node_modules/@cmao/midimao/dist/utils/index.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "get_8n_time_by_bpm", function() { return _utils__WEBPACK_IMPORTED_MODULE_5__["get_8n_time_by_bpm"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "judge_speed_state", function() { return _utils__WEBPACK_IMPORTED_MODULE_5__["judge_speed_state"]; });














//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/instrument/defs.js":
/*!************************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/instrument/defs.js ***!
  \************************************************************/
/*! exports provided: InstrumentEnum */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InstrumentEnum", function() { return InstrumentEnum; });
var InstrumentEnum;
(function (InstrumentEnum) {
    InstrumentEnum["GAME"] = "game";
    InstrumentEnum["JOKER"] = "joker";
    InstrumentEnum["ELECTRIC"] = "electric";
    InstrumentEnum["DREAM"] = "dream";
    InstrumentEnum["PIANO"] = "piano";
    InstrumentEnum["GUITAR"] = "guitar";
    InstrumentEnum["BEAT"] = "beat";
    InstrumentEnum["MIDI"] = "midi";
})(InstrumentEnum || (InstrumentEnum = {}));
//# sourceMappingURL=defs.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/instrument/index.js":
/*!*************************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/instrument/index.js ***!
  \*************************************************************/
/*! exports provided: InstrumentEnum, create_instrument_store */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "create_instrument_store", function() { return create_instrument_store; });
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @cmao/codemao-tone */ "./node_modules/@cmao/codemao-tone/build/Tone.js");
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _debugger___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../__debugger__ */ "./node_modules/@cmao/midimao/dist/__debugger__.js");
/* harmony import */ var _defs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./defs */ "./node_modules/@cmao/midimao/dist/instrument/defs.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "InstrumentEnum", function() { return _defs__WEBPACK_IMPORTED_MODULE_2__["InstrumentEnum"]; });


const Tone = _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0___default.a;



const instruments = {
    [_defs__WEBPACK_IMPORTED_MODULE_2__["InstrumentEnum"].GUITAR]: null,
    [_defs__WEBPACK_IMPORTED_MODULE_2__["InstrumentEnum"].PIANO]: null,
    [_defs__WEBPACK_IMPORTED_MODULE_2__["InstrumentEnum"].JOKER]: null,
    [_defs__WEBPACK_IMPORTED_MODULE_2__["InstrumentEnum"].GAME]: null,
    [_defs__WEBPACK_IMPORTED_MODULE_2__["InstrumentEnum"].DREAM]: null,
    [_defs__WEBPACK_IMPORTED_MODULE_2__["InstrumentEnum"].ELECTRIC]: null,
    [_defs__WEBPACK_IMPORTED_MODULE_2__["InstrumentEnum"].BEAT]: null,
};
;
let store;
function create_instrument_store() {
    if (store)
        return store;
    function init_instrument(name, config, onload, onerror) {
        if (instruments[name]) {
            _debugger___WEBPACK_IMPORTED_MODULE_1__["__DEBUGGER__"] && console.log(`${name} had loaded`);
            onload && onload(instruments[name]);
            return Promise.resolve(instruments[name]);
        }
        return new Promise((resolve, reject) => {
            const source = new Tone.Buffers(config.notes_map, () => {
                instruments[name] = source;
                _debugger___WEBPACK_IMPORTED_MODULE_1__["__DEBUGGER__"] && console.log(`${name} loaded`);
                onload && onload(instruments[name]);
                resolve(instruments[name]);
            }, config.base_url, (err) => {
                onerror && onerror(err);
                reject(err);
            });
        });
    }
    function replace_instrument_source(name, source) {
        instruments[name] = source;
    }
    function get_instrument_source(name) {
        if (name === _defs__WEBPACK_IMPORTED_MODULE_2__["InstrumentEnum"].MIDI) {
            return null;
        }
        return instruments[name];
    }
    function is_ready(name) {
        return !!instruments[name];
    }
    store = {
        init_instrument,
        replace_instrument_source,
        get_instrument_source,
        is_ready,
    };
    return store;
}
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/obb/index.js":
/*!******************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/obb/index.js ***!
  \******************************************************/
/*! exports provided: ObbEnum, create_obb_store */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ObbEnum", function() { return ObbEnum; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "create_obb_store", function() { return create_obb_store; });
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @cmao/codemao-tone */ "./node_modules/@cmao/codemao-tone/build/Tone.js");
/* harmony import */ var _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0__);

var ObbEnum;
(function (ObbEnum) {
    ObbEnum["NONE"] = "__NONE__";
    ObbEnum["FUNK_LOW"] = "funk_low";
    ObbEnum["FUNK_MID_LOW"] = "funk_mid_low";
    ObbEnum["FUNK"] = "funk";
    ObbEnum["FUNK_MID_HIGH"] = "funk_mid_high";
    ObbEnum["FUNK_HIGH"] = "funk_high";
    ObbEnum["JAZZ_LOW"] = "jazz_low";
    ObbEnum["JAZZ_MID_LOW"] = "jazz_mid_low";
    ObbEnum["JAZZ"] = "jazz";
    ObbEnum["JAZZ_MID_HIGH"] = "jazz_mid_high";
    ObbEnum["JAZZ_HIGH"] = "jazz_high";
    ObbEnum["LATIN_LOW"] = "latin_low";
    ObbEnum["LATIN_MID_LOW"] = "latin_mid_low";
    ObbEnum["LATIN"] = "latin";
    ObbEnum["LATIN_MID_HIGH"] = "latin_mid_high";
    ObbEnum["LATIN_HIGH"] = "latin_high";
    ObbEnum["DANCE_LOW"] = "dance_low";
    ObbEnum["DANCE_MID_LOW"] = "dance_mid_low";
    ObbEnum["DANCE"] = "dance";
    ObbEnum["DANCE_MID_HIGH"] = "dance_mid_high";
    ObbEnum["DANCE_HIGH"] = "dance_high";
    ObbEnum["HIPHOP_LOW"] = "hiphop_low";
    ObbEnum["HIPHOP_MID_LOW"] = "hiphop_mid_low";
    ObbEnum["HIPHOP"] = "hiphop";
    ObbEnum["HIPHOP_MID_HIGH"] = "hiphop_mid_high";
    ObbEnum["HIPHOP_HIGH"] = "hiphop_high";
    ObbEnum["ROCK_LOW"] = "rock_low";
    ObbEnum["ROCK_MID_LOW"] = "rock_mid_low";
    ObbEnum["ROCK"] = "rock";
    ObbEnum["ROCK_MID_HIGH"] = "rock_mid_high";
    ObbEnum["ROCK_HIGH"] = "rock_high";
})(ObbEnum || (ObbEnum = {}));
const obbs = {
    [ObbEnum.NONE]: null,
    [ObbEnum.ROCK_LOW]: null,
    [ObbEnum.DANCE_LOW]: null,
    [ObbEnum.FUNK_LOW]: null,
    [ObbEnum.HIPHOP_LOW]: null,
    [ObbEnum.JAZZ_LOW]: null,
    [ObbEnum.LATIN_LOW]: null,
    [ObbEnum.ROCK_MID_LOW]: null,
    [ObbEnum.DANCE_MID_LOW]: null,
    [ObbEnum.FUNK_MID_LOW]: null,
    [ObbEnum.HIPHOP_MID_LOW]: null,
    [ObbEnum.JAZZ_MID_LOW]: null,
    [ObbEnum.LATIN_MID_LOW]: null,
    [ObbEnum.ROCK]: null,
    [ObbEnum.DANCE]: null,
    [ObbEnum.FUNK]: null,
    [ObbEnum.HIPHOP]: null,
    [ObbEnum.JAZZ]: null,
    [ObbEnum.LATIN]: null,
    [ObbEnum.ROCK_MID_HIGH]: null,
    [ObbEnum.DANCE_MID_HIGH]: null,
    [ObbEnum.FUNK_MID_HIGH]: null,
    [ObbEnum.HIPHOP_MID_HIGH]: null,
    [ObbEnum.JAZZ_MID_HIGH]: null,
    [ObbEnum.LATIN_MID_HIGH]: null,
    [ObbEnum.ROCK_HIGH]: null,
    [ObbEnum.DANCE_HIGH]: null,
    [ObbEnum.FUNK_HIGH]: null,
    [ObbEnum.HIPHOP_HIGH]: null,
    [ObbEnum.JAZZ_HIGH]: null,
    [ObbEnum.LATIN_HIGH]: null,
};
let store;
function create_obb_store() {
    if (store)
        return store;
    function init_obb(name, url) {
        // 始终保持 ObbEnum.NONE 资源为 null，ObbMao 加载它时静默失败
        if (name === ObbEnum.NONE) {
            return Promise.resolve([name, null]);
        }
        if (obbs[name]) {
            return Promise.resolve([name, obbs[name]]);
        }
        return new Promise((resolve) => {
            const obb_buffer = new _cmao_codemao_tone__WEBPACK_IMPORTED_MODULE_0___default.a.Buffer(url, () => {
                obbs[name] = obb_buffer;
                resolve([name, obb_buffer]);
            });
        });
    }
    function get_obb(name) {
        return obbs[name];
    }
    function is_ready(name) {
        return !!obbs[name];
    }
    store = {
        init_obb,
        get_obb,
        is_ready,
    };
    return store;
}
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@cmao/midimao/dist/utils/index.js":
/*!********************************************************!*\
  !*** ./node_modules/@cmao/midimao/dist/utils/index.js ***!
  \********************************************************/
/*! exports provided: get_8n_time_by_bpm, parse_raw_midi_to_processed_midi, parse_processed_midi_to_raw_midi, get_midi_duration, destruct_midi_name, shift_to_semitones, semitones_to_shift, judge_speed_state */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "get_8n_time_by_bpm", function() { return get_8n_time_by_bpm; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parse_raw_midi_to_processed_midi", function() { return parse_raw_midi_to_processed_midi; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "parse_processed_midi_to_raw_midi", function() { return parse_processed_midi_to_raw_midi; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "get_midi_duration", function() { return get_midi_duration; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "destruct_midi_name", function() { return destruct_midi_name; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "shift_to_semitones", function() { return shift_to_semitones; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "semitones_to_shift", function() { return semitones_to_shift; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "judge_speed_state", function() { return judge_speed_state; });
/* harmony import */ var _controller_defs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../controller/defs */ "./node_modules/@cmao/midimao/dist/controller/defs.js");
/* harmony import */ var _config_const__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../config/const */ "./node_modules/@cmao/midimao/dist/config/const.js");
/* harmony import */ var _obb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../obb */ "./node_modules/@cmao/midimao/dist/obb/index.js");
/* harmony import */ var _instrument__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../instrument */ "./node_modules/@cmao/midimao/dist/instrument/index.js");




function get_8n_time_by_bpm(bpm) {
    return Number((_config_const__WEBPACK_IMPORTED_MODULE_1__["ONE_MINUTE_SECONDS"] / bpm / 2).toFixed(5));
}
function parse_raw_midi_to_processed_midi(midi) {
    var _a;
    const bpm = midi.header.tempos[0].bpm, time_8n = get_8n_time_by_bpm(bpm), 
    // tick_8n = (midi.header.ppq || 480) / 2,
    midi_duration = (_a = midi.duration) !== null && _a !== void 0 ? _a : get_midi_duration(midi);
    let midi_length = Math.round(midi_duration / time_8n);
    const remainder = midi_length % 8;
    // 以小节为基础长度，不足一小节补满一小节，一小节有 8 个 8 分音符
    midi_length = remainder > 0 ? midi_length - remainder + 8 : midi_length;
    const parse_tracks = midi.tracks.map((track) => {
        let new_notes = new Array(midi_length), silent_8n_count, duration_8n_count, pad_num;
        track.notes.forEach((note) => {
            // 有效音的位置，静音总数的位置就是有效音的位置（数组从0开始）
            // silent_8n_count = Math.round(note.ticks / tick_8n);
            silent_8n_count = Math.round(note.time / time_8n);
            // 填充音数量，去掉有效音占用的第一个位置
            // duration_8n_count = Math.round(note.durationTicks / tick_8n) - 1;
            duration_8n_count = Math.round(note.duration / time_8n) - 1;
            // 放置有效音
            new_notes[silent_8n_count] = note;
            // 放置填充音
            if (duration_8n_count < 1) {
                return;
            }
            // 标志长音符的首音符
            new_notes[silent_8n_count].start_note = true;
            pad_num = duration_8n_count;
            for (; pad_num > 0; pad_num--) {
                new_notes[silent_8n_count + pad_num] = Object.assign(Object.assign({}, note), { name: note.name, time: note.time, duration: note.duration - pad_num * time_8n, padding_note: true });
            }
            // 标志长音符的尾音符，尾音符同时也是填充音符
            new_notes[silent_8n_count + duration_8n_count].end_note = true;
        });
        new_notes = pad_ary_null(new_notes);
        return Object.assign(Object.assign({}, track), { notes: new_notes });
    });
    const { name, obb, inst } = destruct_midi_name(midi.header.name);
    return {
        header: Object.assign(Object.assign({}, midi.header), { name }),
        duration: midi_length * time_8n,
        length: midi_length,
        tracks: parse_tracks,
        pro: true,
        inst: midi.inst || inst,
        obb: midi.obb || obb,
    };
}
function parse_processed_midi_to_raw_midi(midi) {
    const raw_tracks = midi.tracks.map((track) => {
        const raw_notes = [];
        track.notes.forEach((note) => {
            if (!note || note.padding_note) {
                return;
            }
            raw_notes.push(note);
        });
        return Object.assign(Object.assign({}, track), { notes: raw_notes, inst: midi.inst, obb: midi.obb });
    });
    return {
        header: midi.header,
        tracks: raw_tracks,
        inst: midi.inst,
        obb: midi.obb,
        duration: midi.duration,
    };
}
function pad_ary_null(arr) {
    let i = 0;
    const len = arr.length, ary = [];
    for (; i < len; i++) {
        ary[i] = arr[i] ? arr[i] : null;
    }
    return ary;
}
function get_midi_duration(midi) {
    // 实际的 midi 音乐音轨中的最后一个音符不一定是最后结束的（同一轨道同一时间可以存在多个声音）
    // 但按照需求，在 midi 音乐盒中是。midi 音乐盒创作的 midi 音乐规则性较强。
    const durations = midi.tracks.map((track) => {
        const last_note = track.notes[track.notes.length - 1];
        return last_note ? last_note.time + last_note.duration : 0;
    });
    return Math.max(...durations);
}
function destruct_midi_name(name) {
    const reg = new RegExp(`^${_controller_defs__WEBPACK_IMPORTED_MODULE_0__["MIDI_NAME_PREFIX"]}`);
    if (!reg.test(name)) {
        return {
            name: `${_controller_defs__WEBPACK_IMPORTED_MODULE_0__["MIDI_NAME_PREFIX"]}${name}`,
            obb: _obb__WEBPACK_IMPORTED_MODULE_2__["ObbEnum"].NONE,
            inst: _instrument__WEBPACK_IMPORTED_MODULE_3__["InstrumentEnum"].GAME,
        };
    }
    const [midi_name, query] = name.split('?');
    if (!query) {
        return { name: midi_name, obb: _obb__WEBPACK_IMPORTED_MODULE_2__["ObbEnum"].NONE, inst: _instrument__WEBPACK_IMPORTED_MODULE_3__["InstrumentEnum"].GAME };
    }
    const { obb = _obb__WEBPACK_IMPORTED_MODULE_2__["ObbEnum"].NONE, inst = _instrument__WEBPACK_IMPORTED_MODULE_3__["InstrumentEnum"].GAME } = query
        .split('&') // k=v
        .map((kv) => kv.split('=')) // [[k, v], ...]
        .reduce((acc, cur) => (Object.assign(Object.assign({}, acc), { [cur[0]]: cur[1] })), {}); // {k1: v1, k2: v2, ...}
    return { name: midi_name, obb, inst };
}
/**
 * 倍率到音高变化的数学关系
 * @param {number} shift 播放速率
 * @returns {number} 对应播放速率下音高的变化值（半音）
 */
function shift_to_semitones(shift) {
    return Math.round(-12 * Math.log2(1 / shift));
}
/**
 * 音高到倍率变化的数学关系
 * @param {number} semitones 半音音高值
 * @returns {number} 对应的播放倍率
 */
function semitones_to_shift(semitones) {
    return Math.pow((Math.pow(2, (1 / 12))), semitones);
}
function judge_speed_state(bpm) {
    const level = bpm / 15;
    if (level < 5)
        return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["SpeedStateEnum"].LOW;
    if (level < 7)
        return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["SpeedStateEnum"].MID_LOW;
    if (level < 9)
        return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["SpeedStateEnum"].NORMAL;
    if (level < 11)
        return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["SpeedStateEnum"].MID_HIGH;
    return _controller_defs__WEBPACK_IMPORTED_MODULE_0__["SpeedStateEnum"].HIGH;
}
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/BinarySearch.js":
/*!********************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/BinarySearch.js ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Return the index of the element at or before the given property
 * @hidden
 */
function search(array, value, prop) {
    if (prop === void 0) { prop = "ticks"; }
    var beginning = 0;
    var len = array.length;
    var end = len;
    if (len > 0 && array[len - 1][prop] <= value) {
        return len - 1;
    }
    while (beginning < end) {
        // calculate the midpoint for roughly equal partition
        var midPoint = Math.floor(beginning + (end - beginning) / 2);
        var event_1 = array[midPoint];
        var nextEvent = array[midPoint + 1];
        if (event_1[prop] === value) {
            // choose the last one that has the same value
            for (var i = midPoint; i < array.length; i++) {
                var testEvent = array[i];
                if (testEvent[prop] === value) {
                    midPoint = i;
                }
            }
            return midPoint;
        }
        else if (event_1[prop] < value && nextEvent[prop] > value) {
            return midPoint;
        }
        else if (event_1[prop] > value) {
            // search lower
            end = midPoint;
        }
        else if (event_1[prop] < value) {
            // search upper
            beginning = midPoint + 1;
        }
    }
    return -1;
}
exports.search = search;
/**
 * Does a binary search to insert the note
 * in the correct spot in the array
 * @hidden
 */
function insert(array, event, prop) {
    if (prop === void 0) { prop = "ticks"; }
    if (array.length) {
        var index = search(array, event[prop], prop);
        array.splice(index + 1, 0, event);
    }
    else {
        array.push(event);
    }
}
exports.insert = insert;
//# sourceMappingURL=BinarySearch.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/ControlChange.js":
/*!*********************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/ControlChange.js ***!
  \*********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
/**
 * A map of values to control change names
 * @hidden
 */
exports.controlChangeNames = {
    1: "modulationWheel",
    2: "breath",
    4: "footController",
    5: "portamentoTime",
    7: "volume",
    8: "balance",
    10: "pan",
    64: "sustain",
    65: "portamentoTime",
    66: "sostenuto",
    67: "softPedal",
    68: "legatoFootswitch",
    84: "portamentoControl",
};
/**
 * swap the keys and values
 * @hidden
 */
exports.controlChangeIds = Object.keys(exports.controlChangeNames).reduce(function (obj, key) {
    obj[exports.controlChangeNames[key]] = key;
    return obj;
}, {});
var privateHeaderMap = new WeakMap();
var privateCCNumberMap = new WeakMap();
/**
 * Represents a control change event
 */
var ControlChange = /** @class */ (function () {
    /**
     * @param event
     * @param header
     */
    function ControlChange(event, header) {
        privateHeaderMap.set(this, header);
        privateCCNumberMap.set(this, event.controllerType);
        this.ticks = event.absoluteTime;
        this.value = event.value;
    }
    Object.defineProperty(ControlChange.prototype, "number", {
        /**
         * The controller number
         */
        get: function () {
            return privateCCNumberMap.get(this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ControlChange.prototype, "name", {
        /**
         * return the common name of the control number if it exists
         */
        get: function () {
            if (exports.controlChangeNames[this.number]) {
                return exports.controlChangeNames[this.number];
            }
            else {
                return null;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ControlChange.prototype, "time", {
        /**
         * The time of the event in seconds
         */
        get: function () {
            var header = privateHeaderMap.get(this);
            return header.ticksToSeconds(this.ticks);
        },
        set: function (t) {
            var header = privateHeaderMap.get(this);
            this.ticks = header.secondsToTicks(t);
        },
        enumerable: true,
        configurable: true
    });
    ControlChange.prototype.toJSON = function () {
        return {
            number: this.number,
            ticks: this.ticks,
            time: this.time,
            value: this.value,
        };
    };
    return ControlChange;
}());
exports.ControlChange = ControlChange;
//# sourceMappingURL=ControlChange.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/ControlChanges.js":
/*!**********************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/ControlChanges.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var ControlChange_1 = __webpack_require__(/*! ./ControlChange */ "./node_modules/@tonejs/midi/dist/ControlChange.js");
/**
 * Automatically creates an alias for named control values using Proxies
 * @hidden
 */
function createControlChanges() {
    return new Proxy({}, {
        // tslint:disable-next-line: typedef
        get: function (target, handler) {
            if (target[handler]) {
                return target[handler];
            }
            else if (ControlChange_1.controlChangeIds.hasOwnProperty(handler)) {
                return target[ControlChange_1.controlChangeIds[handler]];
            }
        },
        // tslint:disable-next-line: typedef
        set: function (target, handler, value) {
            if (ControlChange_1.controlChangeIds.hasOwnProperty(handler)) {
                target[ControlChange_1.controlChangeIds[handler]] = value;
            }
            else {
                target[handler] = value;
            }
            return true;
        },
    });
}
exports.createControlChanges = createControlChanges;
//# sourceMappingURL=ControlChanges.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/Encode.js":
/*!**************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/Encode.js ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __spreadArrays = (this && this.__spreadArrays) || function () {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var midi_file_1 = __webpack_require__(/*! midi-file */ "./node_modules/midi-file/index.js");
var Header_1 = __webpack_require__(/*! ./Header */ "./node_modules/@tonejs/midi/dist/Header.js");
var array_flatten_1 = __importDefault(__webpack_require__(/*! array-flatten */ "./node_modules/@tonejs/midi/node_modules/array-flatten/array-flatten.js"));
function encodeNote(note, channel) {
    return [{
            absoluteTime: note.ticks,
            channel: channel,
            deltaTime: 0,
            noteNumber: note.midi,
            type: "noteOn",
            velocity: Math.floor(note.velocity * 127),
        },
        {
            absoluteTime: note.ticks + note.durationTicks,
            channel: channel,
            deltaTime: 0,
            noteNumber: note.midi,
            type: "noteOff",
            velocity: Math.floor(note.noteOffVelocity * 127),
        }];
}
function encodeNotes(track) {
    return array_flatten_1.default(track.notes.map(function (note) { return encodeNote(note, track.channel); }));
}
function encodeControlChange(cc, channel) {
    return {
        absoluteTime: cc.ticks,
        channel: channel,
        controllerType: cc.number,
        deltaTime: 0,
        type: "controller",
        value: cc.value,
    };
}
function encodeControlChanges(track) {
    var controlChanges = [];
    for (var i = 0; i < 127; i++) {
        if (track.controlChanges.hasOwnProperty(i)) {
            track.controlChanges[i].forEach(function (cc) {
                controlChanges.push(encodeControlChange(cc, track.channel));
            });
        }
    }
    return controlChanges;
}
function encodePitchBend(pb, channel) {
    return {
        absoluteTime: pb.ticks,
        channel: channel,
        deltaTime: 0,
        type: "pitchBend",
        value: pb.value,
    };
}
function encodePitchBends(track) {
    var pitchBends = [];
    track.pitchBends.forEach(function (pb) {
        pitchBends.push(encodePitchBend(pb, track.channel));
    });
    return pitchBends;
}
function encodeInstrument(track) {
    return {
        absoluteTime: 0,
        channel: track.channel,
        deltaTime: 0,
        programNumber: track.instrument.number,
        type: "programChange",
    };
}
function encodeTrackName(name) {
    return {
        absoluteTime: 0,
        deltaTime: 0,
        meta: true,
        text: name,
        type: "trackName",
    };
}
function encodeTempo(tempo) {
    return {
        absoluteTime: tempo.ticks,
        deltaTime: 0,
        meta: true,
        microsecondsPerBeat: Math.floor(60000000 / tempo.bpm),
        type: "setTempo",
    };
}
function encodeTimeSignature(timeSig) {
    return {
        absoluteTime: timeSig.ticks,
        deltaTime: 0,
        denominator: timeSig.timeSignature[1],
        meta: true,
        metronome: 24,
        numerator: timeSig.timeSignature[0],
        thirtyseconds: 8,
        type: "timeSignature",
    };
}
// function encodeMeta(event: )
function encodeKeySignature(keySig) {
    var keyIndex = Header_1.keySignatureKeys.indexOf(keySig.key);
    return {
        absoluteTime: keySig.ticks,
        deltaTime: 0,
        key: keyIndex + 7,
        meta: true,
        scale: keySig.scale === "major" ? 0 : 1,
        type: "keySignature",
    };
}
function encodeText(textEvent) {
    return {
        absoluteTime: textEvent.ticks,
        deltaTime: 0,
        meta: true,
        text: textEvent.text,
        type: textEvent.type,
    };
}
/**
 * Convert the midi object to an array
 */
function encode(midi) {
    var midiData = {
        header: {
            format: 1,
            numTracks: midi.tracks.length + 1,
            ticksPerBeat: midi.header.ppq,
        },
        tracks: __spreadArrays([
            __spreadArrays([
                // the name data
                {
                    absoluteTime: 0,
                    deltaTime: 0,
                    meta: true,
                    text: midi.header.name,
                    type: "trackName",
                }
            ], midi.header.keySignatures.map(function (keySig) { return encodeKeySignature(keySig); }), midi.header.meta.map(function (e) { return encodeText(e); }), midi.header.tempos.map(function (tempo) { return encodeTempo(tempo); }), midi.header.timeSignatures.map(function (timeSig) { return encodeTimeSignature(timeSig); }))
        ], midi.tracks.map(function (track) {
            return __spreadArrays([
                // add the name
                encodeTrackName(track.name),
                // the instrument
                encodeInstrument(track)
            ], encodeNotes(track), encodeControlChanges(track), encodePitchBends(track));
        })),
    };
    // sort and set deltaTime of all of the tracks
    midiData.tracks = midiData.tracks.map(function (track) {
        track = track.sort(function (a, b) { return a.absoluteTime - b.absoluteTime; });
        var lastTime = 0;
        track.forEach(function (note) {
            note.deltaTime = note.absoluteTime - lastTime;
            lastTime = note.absoluteTime;
            delete note.absoluteTime;
        });
        // end of track
        track.push({
            deltaTime: 0,
            meta: true,
            type: "endOfTrack",
        });
        return track;
    });
    // return midiData
    return new Uint8Array(midi_file_1.writeMidi(midiData));
}
exports.encode = encode;
//# sourceMappingURL=Encode.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/Header.js":
/*!**************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/Header.js ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var BinarySearch_1 = __webpack_require__(/*! ./BinarySearch */ "./node_modules/@tonejs/midi/dist/BinarySearch.js");
var privatePPQMap = new WeakMap();
/**
 * @hidden
 */
exports.keySignatureKeys = [
    "Cb",
    "Gb",
    "Db",
    "Ab",
    "Eb",
    "Bb",
    "F",
    "C",
    "G",
    "D",
    "A",
    "E",
    "B",
    "F#",
    "C#",
];
/** The parsed midi file header */
var Header = /** @class */ (function () {
    function Header(midiData) {
        // look through all the tracks for tempo changes
        var _this = this;
        /**
         * The array of all the tempo events
         */
        this.tempos = [];
        /**
         * The time signatures
         */
        this.timeSignatures = [];
        /**
         * The time signatures
         */
        this.keySignatures = [];
        /**
         * Additional meta events
         */
        this.meta = [];
        /**
         * The name of the midi file
         */
        this.name = "";
        privatePPQMap.set(this, 480);
        if (midiData) {
            privatePPQMap.set(this, midiData.header.ticksPerBeat);
            // check time signature and tempo events from all of the tracks
            midiData.tracks.forEach(function (track) {
                return track.forEach(function (event) {
                    if (event.meta) {
                        if (event.type === "timeSignature") {
                            _this.timeSignatures.push({
                                ticks: event.absoluteTime,
                                timeSignature: [
                                    event.numerator,
                                    event.denominator,
                                ],
                            });
                        }
                        else if (event.type === "setTempo") {
                            _this.tempos.push({
                                bpm: 60000000 / event.microsecondsPerBeat,
                                ticks: event.absoluteTime,
                            });
                        }
                        else if (event.type === "keySignature") {
                            _this.keySignatures.push({
                                key: exports.keySignatureKeys[event.key + 7],
                                scale: event.scale === 0 ? "major" : "minor",
                                ticks: event.absoluteTime,
                            });
                        }
                    }
                });
            });
            // check the first track for other relevant data
            midiData.tracks[0].forEach(function (event) {
                if (event.meta) {
                    if (event.type === "trackName") {
                        _this.name = event.text;
                    }
                    else if (event.type === "text" ||
                        event.type === "cuePoint" ||
                        event.type === "marker" ||
                        event.type === "lyrics") {
                        _this.meta.push({
                            text: event.text,
                            ticks: event.absoluteTime,
                            type: event.type,
                        });
                    }
                }
            });
            this.update();
        }
    }
    /**
     * This must be invoked after any changes are made to the tempo array
     * or the timeSignature array for the updated values to be reflected.
     */
    Header.prototype.update = function () {
        var _this = this;
        var currentTime = 0;
        var lastEventBeats = 0;
        // make sure it's sorted
        this.tempos.sort(function (a, b) { return a.ticks - b.ticks; });
        this.tempos.forEach(function (event, index) {
            var lastBPM = index > 0 ? _this.tempos[index - 1].bpm : _this.tempos[0].bpm;
            var beats = event.ticks / _this.ppq - lastEventBeats;
            var elapsedSeconds = (60 / lastBPM) * beats;
            event.time = elapsedSeconds + currentTime;
            currentTime = event.time;
            lastEventBeats += beats;
        });
        this.timeSignatures.sort(function (a, b) { return a.ticks - b.ticks; });
        this.timeSignatures.forEach(function (event, index) {
            var lastEvent = index > 0
                ? _this.timeSignatures[index - 1]
                : _this.timeSignatures[0];
            var elapsedBeats = (event.ticks - lastEvent.ticks) / _this.ppq;
            var elapsedMeasures = elapsedBeats /
                lastEvent.timeSignature[0] /
                (lastEvent.timeSignature[1] / 4);
            lastEvent.measures = lastEvent.measures || 0;
            event.measures = elapsedMeasures + lastEvent.measures;
        });
    };
    /**
     * Convert ticks into seconds based on the tempo changes
     */
    Header.prototype.ticksToSeconds = function (ticks) {
        // find the relevant position
        var index = BinarySearch_1.search(this.tempos, ticks);
        if (index !== -1) {
            var tempo = this.tempos[index];
            var tempoTime = tempo.time;
            var elapsedBeats = (ticks - tempo.ticks) / this.ppq;
            return tempoTime + (60 / tempo.bpm) * elapsedBeats;
        }
        else {
            // assume 120
            var beats = ticks / this.ppq;
            return (60 / 120) * beats;
        }
    };
    /**
     * Convert ticks into measures based off of the time signatures
     */
    Header.prototype.ticksToMeasures = function (ticks) {
        var index = BinarySearch_1.search(this.timeSignatures, ticks);
        if (index !== -1) {
            var timeSigEvent = this.timeSignatures[index];
            var elapsedBeats = (ticks - timeSigEvent.ticks) / this.ppq;
            return (timeSigEvent.measures +
                elapsedBeats /
                    (timeSigEvent.timeSignature[0] /
                        timeSigEvent.timeSignature[1]) /
                    4);
        }
        else {
            return ticks / this.ppq / 4;
        }
    };
    Object.defineProperty(Header.prototype, "ppq", {
        /**
         * The number of ticks per quarter note
         */
        get: function () {
            return privatePPQMap.get(this);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Convert seconds to ticks based on the tempo events
     */
    Header.prototype.secondsToTicks = function (seconds) {
        // find the relevant position
        var index = BinarySearch_1.search(this.tempos, seconds, "time");
        if (index !== -1) {
            var tempo = this.tempos[index];
            var tempoTime = tempo.time;
            var elapsedTime = seconds - tempoTime;
            var elapsedBeats = elapsedTime / (60 / tempo.bpm);
            return Math.round(tempo.ticks + elapsedBeats * this.ppq);
        }
        else {
            // assume 120
            var beats = seconds / (60 / 120);
            return Math.round(beats * this.ppq);
        }
    };
    /**
     * Convert the header into an object.
     */
    Header.prototype.toJSON = function () {
        return {
            keySignatures: this.keySignatures,
            meta: this.meta,
            name: this.name,
            ppq: this.ppq,
            tempos: this.tempos.map(function (t) {
                return {
                    bpm: t.bpm,
                    ticks: t.ticks,
                };
            }),
            timeSignatures: this.timeSignatures,
        };
    };
    /**
     * parse a header json object.
     */
    Header.prototype.fromJSON = function (json) {
        this.name = json.name;
        // clone all the attributes
        this.tempos = json.tempos.map(function (t) { return Object.assign({}, t); });
        this.timeSignatures = json.timeSignatures.map(function (t) {
            return Object.assign({}, t);
        });
        this.keySignatures = json.keySignatures.map(function (t) {
            return Object.assign({}, t);
        });
        this.meta = json.meta.map(function (t) { return Object.assign({}, t); });
        privatePPQMap.set(this, json.ppq);
        this.update();
    };
    /**
     * Update the tempo of the midi to a single tempo. Will remove and replace
     * any other tempos currently set and update all of the event timing.
     * @param bpm The tempo in beats per second
     */
    Header.prototype.setTempo = function (bpm) {
        this.tempos = [
            {
                bpm: bpm,
                ticks: 0,
            },
        ];
        this.update();
    };
    return Header;
}());
exports.Header = Header;
//# sourceMappingURL=Header.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/Instrument.js":
/*!******************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/Instrument.js ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var InstrumentMaps_1 = __webpack_require__(/*! ./InstrumentMaps */ "./node_modules/@tonejs/midi/dist/InstrumentMaps.js");
/**
 * @hidden
 */
var privateTrackMap = new WeakMap();
/**
 * Describes the midi instrument of a track
 */
var Instrument = /** @class */ (function () {
    /**
     * @param trackData
     * @param track
     */
    function Instrument(trackData, track) {
        /**
         * The instrument number
         */
        this.number = 0;
        privateTrackMap.set(this, track);
        this.number = 0;
        if (trackData) {
            var programChange = trackData.find(function (e) { return e.type === "programChange"; });
            if (programChange) {
                this.number = programChange.programNumber;
            }
        }
    }
    Object.defineProperty(Instrument.prototype, "name", {
        /**
         * The common name of the instrument
         */
        get: function () {
            if (this.percussion) {
                return InstrumentMaps_1.DrumKitByPatchID[this.number];
            }
            else {
                return InstrumentMaps_1.instrumentByPatchID[this.number];
            }
        },
        set: function (n) {
            var patchNumber = InstrumentMaps_1.instrumentByPatchID.indexOf(n);
            if (patchNumber !== -1) {
                this.number = patchNumber;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Instrument.prototype, "family", {
        /**
         * The instrument family, e.g. "piano".
         */
        get: function () {
            if (this.percussion) {
                return "drums";
            }
            else {
                return InstrumentMaps_1.InstrumentFamilyByID[Math.floor(this.number / 8)];
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Instrument.prototype, "percussion", {
        /**
         * If the instrument is a percussion instrument
         */
        get: function () {
            var track = privateTrackMap.get(this);
            return track.channel === 9;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Convert it to JSON form
     */
    Instrument.prototype.toJSON = function () {
        return {
            family: this.family,
            name: this.name,
            number: this.number,
        };
    };
    /**
     * Convert from JSON form
     */
    Instrument.prototype.fromJSON = function (json) {
        this.number = json.number;
    };
    return Instrument;
}());
exports.Instrument = Instrument;
//# sourceMappingURL=Instrument.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/InstrumentMaps.js":
/*!**********************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/InstrumentMaps.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
exports.instrumentByPatchID = [
    "acoustic grand piano",
    "bright acoustic piano",
    "electric grand piano",
    "honky-tonk piano",
    "electric piano 1",
    "electric piano 2",
    "harpsichord",
    "clavi",
    "celesta",
    "glockenspiel",
    "music box",
    "vibraphone",
    "marimba",
    "xylophone",
    "tubular bells",
    "dulcimer",
    "drawbar organ",
    "percussive organ",
    "rock organ",
    "church organ",
    "reed organ",
    "accordion",
    "harmonica",
    "tango accordion",
    "acoustic guitar (nylon)",
    "acoustic guitar (steel)",
    "electric guitar (jazz)",
    "electric guitar (clean)",
    "electric guitar (muted)",
    "overdriven guitar",
    "distortion guitar",
    "guitar harmonics",
    "acoustic bass",
    "electric bass (finger)",
    "electric bass (pick)",
    "fretless bass",
    "slap bass 1",
    "slap bass 2",
    "synth bass 1",
    "synth bass 2",
    "violin",
    "viola",
    "cello",
    "contrabass",
    "tremolo strings",
    "pizzicato strings",
    "orchestral harp",
    "timpani",
    "string ensemble 1",
    "string ensemble 2",
    "synthstrings 1",
    "synthstrings 2",
    "choir aahs",
    "voice oohs",
    "synth voice",
    "orchestra hit",
    "trumpet",
    "trombone",
    "tuba",
    "muted trumpet",
    "french horn",
    "brass section",
    "synthbrass 1",
    "synthbrass 2",
    "soprano sax",
    "alto sax",
    "tenor sax",
    "baritone sax",
    "oboe",
    "english horn",
    "bassoon",
    "clarinet",
    "piccolo",
    "flute",
    "recorder",
    "pan flute",
    "blown bottle",
    "shakuhachi",
    "whistle",
    "ocarina",
    "lead 1 (square)",
    "lead 2 (sawtooth)",
    "lead 3 (calliope)",
    "lead 4 (chiff)",
    "lead 5 (charang)",
    "lead 6 (voice)",
    "lead 7 (fifths)",
    "lead 8 (bass + lead)",
    "pad 1 (new age)",
    "pad 2 (warm)",
    "pad 3 (polysynth)",
    "pad 4 (choir)",
    "pad 5 (bowed)",
    "pad 6 (metallic)",
    "pad 7 (halo)",
    "pad 8 (sweep)",
    "fx 1 (rain)",
    "fx 2 (soundtrack)",
    "fx 3 (crystal)",
    "fx 4 (atmosphere)",
    "fx 5 (brightness)",
    "fx 6 (goblins)",
    "fx 7 (echoes)",
    "fx 8 (sci-fi)",
    "sitar",
    "banjo",
    "shamisen",
    "koto",
    "kalimba",
    "bag pipe",
    "fiddle",
    "shanai",
    "tinkle bell",
    "agogo",
    "steel drums",
    "woodblock",
    "taiko drum",
    "melodic tom",
    "synth drum",
    "reverse cymbal",
    "guitar fret noise",
    "breath noise",
    "seashore",
    "bird tweet",
    "telephone ring",
    "helicopter",
    "applause",
    "gunshot",
];
exports.InstrumentFamilyByID = [
    "piano",
    "chromatic percussion",
    "organ",
    "guitar",
    "bass",
    "strings",
    "ensemble",
    "brass",
    "reed",
    "pipe",
    "synth lead",
    "synth pad",
    "synth effects",
    "world",
    "percussive",
    "sound effects",
];
exports.DrumKitByPatchID = {
    0: "standard kit",
    8: "room kit",
    16: "power kit",
    24: "electronic kit",
    25: "tr-808 kit",
    32: "jazz kit",
    40: "brush kit",
    48: "orchestra kit",
    56: "sound fx kit",
};
//# sourceMappingURL=InstrumentMaps.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/Midi.js":
/*!************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/Midi.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (this && this.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
Object.defineProperty(exports, "__esModule", { value: true });
var midi_file_1 = __webpack_require__(/*! midi-file */ "./node_modules/midi-file/index.js");
var Encode_1 = __webpack_require__(/*! ./Encode */ "./node_modules/@tonejs/midi/dist/Encode.js");
var Header_1 = __webpack_require__(/*! ./Header */ "./node_modules/@tonejs/midi/dist/Header.js");
var Track_1 = __webpack_require__(/*! ./Track */ "./node_modules/@tonejs/midi/dist/Track.js");
/**
 * The main midi parsing class
 */
var Midi = /** @class */ (function () {
    /**
     * Parse the midi data
     */
    function Midi(midiArray) {
        var _this = this;
        // parse the midi data if there is any
        var midiData = null;
        if (midiArray) {
            if (midiArray instanceof ArrayBuffer) {
                midiArray = new Uint8Array(midiArray);
            }
            midiData = midi_file_1.parseMidi(midiArray);
            // add the absolute times to each of the tracks
            midiData.tracks.forEach(function (track) {
                var currentTicks = 0;
                track.forEach(function (event) {
                    currentTicks += event.deltaTime;
                    event.absoluteTime = currentTicks;
                });
            });
            // ensure at most one instrument per track
            midiData.tracks = splitTracks(midiData.tracks);
        }
        this.header = new Header_1.Header(midiData);
        this.tracks = [];
        // parse the midi data
        if (midiArray) {
            // format 0, everything is on the same track
            this.tracks = midiData.tracks.map(function (trackData) { return new Track_1.Track(trackData, _this.header); });
            // if it's format 1 and there are no notes on the first track, remove it
            if (midiData.header.format === 1 && this.tracks[0].duration === 0) {
                this.tracks.shift();
            }
        }
    }
    /**
     * Download and parse the MIDI file. Returns a promise
     * which resolves to the generated midi file
     * @param url The url to fetch
     */
    Midi.fromUrl = function (url) {
        return __awaiter(this, void 0, void 0, function () {
            var response, arrayBuffer;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, fetch(url)];
                    case 1:
                        response = _a.sent();
                        if (!response.ok) return [3 /*break*/, 3];
                        return [4 /*yield*/, response.arrayBuffer()];
                    case 2:
                        arrayBuffer = _a.sent();
                        return [2 /*return*/, new Midi(arrayBuffer)];
                    case 3: throw new Error("could not load " + url);
                }
            });
        });
    };
    Object.defineProperty(Midi.prototype, "name", {
        /**
         * The name of the midi file, taken from the first track
         */
        get: function () {
            return this.header.name;
        },
        set: function (n) {
            this.header.name = n;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Midi.prototype, "duration", {
        /**
         * The total length of the file in seconds
         */
        get: function () {
            // get the max of the last note of all the tracks
            var durations = this.tracks.map(function (t) { return t.duration; });
            return Math.max.apply(Math, durations);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Midi.prototype, "durationTicks", {
        /**
         * The total length of the file in ticks
         */
        get: function () {
            // get the max of the last note of all the tracks
            var durationTicks = this.tracks.map(function (t) { return t.durationTicks; });
            return Math.max.apply(Math, durationTicks);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Add a track to the midi file
     */
    Midi.prototype.addTrack = function () {
        var track = new Track_1.Track(undefined, this.header);
        this.tracks.push(track);
        return track;
    };
    /**
     * Encode the midi as a Uint8Array.
     */
    Midi.prototype.toArray = function () {
        return Encode_1.encode(this);
    };
    /**
     * Convert the midi object to JSON.
     */
    Midi.prototype.toJSON = function () {
        return {
            header: this.header.toJSON(),
            tracks: this.tracks.map(function (track) { return track.toJSON(); }),
        };
    };
    /**
     * Parse a JSON representation of the object. Will overwrite the current
     * tracks and header.
     */
    Midi.prototype.fromJSON = function (json) {
        var _this = this;
        this.header = new Header_1.Header();
        this.header.fromJSON(json.header);
        this.tracks = json.tracks.map(function (trackJSON) {
            var track = new Track_1.Track(undefined, _this.header);
            track.fromJSON(trackJSON);
            return track;
        });
    };
    /**
     * Clone the entire object midi object
     */
    Midi.prototype.clone = function () {
        var midi = new Midi();
        midi.fromJSON(this.toJSON());
        return midi;
    };
    return Midi;
}());
exports.Midi = Midi;
var Track_2 = __webpack_require__(/*! ./Track */ "./node_modules/@tonejs/midi/dist/Track.js");
exports.Track = Track_2.Track;
var Header_2 = __webpack_require__(/*! ./Header */ "./node_modules/@tonejs/midi/dist/Header.js");
exports.Header = Header_2.Header;
/**
 * Given a list of MIDI tracks, make sure that each channel corresponds to at
 * most one channel and at most one instrument. This means splitting up tracks
 * that contain more than one channel or instrument.
 */
function splitTracks(tracks) {
    var newTracks = [];
    for (var i = 0; i < tracks.length; i++) {
        var defaultTrack = newTracks.length;
        // a map from [program, channel] tuples to new track numbers
        var trackMap = new Map();
        // a map from channel numbers to current program numbers
        var currentProgram = Array(16).fill(0);
        for (var _i = 0, _a = tracks[i]; _i < _a.length; _i++) {
            var event_1 = _a[_i];
            var targetTrack = defaultTrack;
            // If the event has a channel, we need to find that channel's current
            // program number and the appropriate track for this [program, channel]
            // pair.
            var channel = event_1.channel;
            if (channel !== undefined) {
                if (event_1.type === "programChange") {
                    currentProgram[channel] = event_1.programNumber;
                }
                var program = currentProgram[channel];
                var trackKey = program + " " + channel;
                if (trackMap.has(trackKey)) {
                    targetTrack = trackMap.get(trackKey);
                }
                else {
                    targetTrack = defaultTrack + trackMap.size;
                    trackMap.set(trackKey, targetTrack);
                }
            }
            if (!newTracks[targetTrack]) {
                newTracks.push([]);
            }
            newTracks[targetTrack].push(event_1);
        }
    }
    return newTracks;
}
//# sourceMappingURL=Midi.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/Note.js":
/*!************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/Note.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Convert a midi note into a pitch
 */
function midiToPitch(midi) {
    var octave = Math.floor(midi / 12) - 1;
    return midiToPitchClass(midi) + octave.toString();
}
/**
 * Convert a midi note to a pitch class (just the pitch no octave)
 */
function midiToPitchClass(midi) {
    var scaleIndexToNote = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
    var note = midi % 12;
    return scaleIndexToNote[note];
}
/**
 * Convert a pitch class to a MIDI note
 */
function pitchClassToMidi(pitch) {
    var scaleIndexToNote = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
    return scaleIndexToNote.indexOf(pitch);
}
/**
 * Convert a pitch to a midi number
 */
// tslint:disable-next-line: only-arrow-functions typedef
var pitchToMidi = (function () {
    var regexp = /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i;
    var noteToScaleIndex = {
        // tslint:disable-next-line: object-literal-sort-keys
        cbb: -2, cb: -1, c: 0, "c#": 1, cx: 2,
        dbb: 0, db: 1, d: 2, "d#": 3, dx: 4,
        ebb: 2, eb: 3, e: 4, "e#": 5, ex: 6,
        fbb: 3, fb: 4, f: 5, "f#": 6, fx: 7,
        gbb: 5, gb: 6, g: 7, "g#": 8, gx: 9,
        abb: 7, ab: 8, a: 9, "a#": 10, ax: 11,
        bbb: 9, bb: 10, b: 11, "b#": 12, bx: 13,
    };
    return function (note) {
        var split = regexp.exec(note);
        var pitch = split[1];
        var octave = split[2];
        var index = noteToScaleIndex[pitch.toLowerCase()];
        return index + (parseInt(octave, 10) + 1) * 12;
    };
}());
var privateHeaderMap = new WeakMap();
/**
 * A Note consists of a noteOn and noteOff event
 */
var Note = /** @class */ (function () {
    function Note(noteOn, noteOff, header) {
        privateHeaderMap.set(this, header);
        this.midi = noteOn.midi;
        this.velocity = noteOn.velocity;
        this.noteOffVelocity = noteOff.velocity;
        this.ticks = noteOn.ticks;
        this.durationTicks = noteOff.ticks - noteOn.ticks;
    }
    Object.defineProperty(Note.prototype, "name", {
        /**
         * The note name and octave in scientific pitch notation, e.g. "C4"
         */
        get: function () {
            return midiToPitch(this.midi);
        },
        set: function (n) {
            this.midi = pitchToMidi(n);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Note.prototype, "octave", {
        /**
         * The notes octave number
         */
        get: function () {
            return Math.floor(this.midi / 12) - 1;
        },
        set: function (o) {
            var diff = o - this.octave;
            this.midi += diff * 12;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Note.prototype, "pitch", {
        /**
         * The pitch class name. e.g. "A"
         */
        get: function () {
            return midiToPitchClass(this.midi);
        },
        set: function (p) {
            this.midi = 12 * (this.octave + 1) + pitchClassToMidi(p);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Note.prototype, "duration", {
        /**
         * The duration of the segment in seconds
         */
        get: function () {
            var header = privateHeaderMap.get(this);
            return header.ticksToSeconds(this.ticks + this.durationTicks) - header.ticksToSeconds(this.ticks);
        },
        set: function (d) {
            var header = privateHeaderMap.get(this);
            var noteEndTicks = header.secondsToTicks(this.time + d);
            this.durationTicks = noteEndTicks - this.ticks;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Note.prototype, "time", {
        /**
         * The time of the event in seconds
         */
        get: function () {
            var header = privateHeaderMap.get(this);
            return header.ticksToSeconds(this.ticks);
        },
        set: function (t) {
            var header = privateHeaderMap.get(this);
            this.ticks = header.secondsToTicks(t);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Note.prototype, "bars", {
        /**
         * The number of measures (and partial measures) to this beat.
         * Takes into account time signature changes
         * @readonly
         */
        get: function () {
            var header = privateHeaderMap.get(this);
            return header.ticksToMeasures(this.ticks);
        },
        enumerable: true,
        configurable: true
    });
    Note.prototype.toJSON = function () {
        return {
            duration: this.duration,
            durationTicks: this.durationTicks,
            midi: this.midi,
            name: this.name,
            ticks: this.ticks,
            time: this.time,
            velocity: this.velocity,
        };
    };
    return Note;
}());
exports.Note = Note;
//# sourceMappingURL=Note.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/PitchBend.js":
/*!*****************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/PitchBend.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var privateHeaderMap = new WeakMap();
/**
 * Represents a pitch bend event
 */
var PitchBend = /** @class */ (function () {
    /**
     * @param event
     * @param header
     */
    function PitchBend(event, header) {
        privateHeaderMap.set(this, header);
        this.ticks = event.absoluteTime;
        this.value = event.value;
    }
    Object.defineProperty(PitchBend.prototype, "time", {
        /**
         * The time of the event in seconds
         */
        get: function () {
            var header = privateHeaderMap.get(this);
            return header.ticksToSeconds(this.ticks);
        },
        set: function (t) {
            var header = privateHeaderMap.get(this);
            this.ticks = header.secondsToTicks(t);
        },
        enumerable: true,
        configurable: true
    });
    PitchBend.prototype.toJSON = function () {
        return {
            ticks: this.ticks,
            time: this.time,
            value: this.value,
        };
    };
    return PitchBend;
}());
exports.PitchBend = PitchBend;
//# sourceMappingURL=PitchBend.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/dist/Track.js":
/*!*************************************************!*\
  !*** ./node_modules/@tonejs/midi/dist/Track.js ***!
  \*************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var BinarySearch_1 = __webpack_require__(/*! ./BinarySearch */ "./node_modules/@tonejs/midi/dist/BinarySearch.js");
var ControlChange_1 = __webpack_require__(/*! ./ControlChange */ "./node_modules/@tonejs/midi/dist/ControlChange.js");
var ControlChanges_1 = __webpack_require__(/*! ./ControlChanges */ "./node_modules/@tonejs/midi/dist/ControlChanges.js");
var PitchBend_1 = __webpack_require__(/*! ./PitchBend */ "./node_modules/@tonejs/midi/dist/PitchBend.js");
var Instrument_1 = __webpack_require__(/*! ./Instrument */ "./node_modules/@tonejs/midi/dist/Instrument.js");
var Note_1 = __webpack_require__(/*! ./Note */ "./node_modules/@tonejs/midi/dist/Note.js");
var privateHeaderMap = new WeakMap();
/**
 * A Track is a collection of notes and controlChanges
 */
var Track = /** @class */ (function () {
    function Track(trackData, header) {
        var _this = this;
        /**
         * The name of the track
         */
        this.name = "";
        /**
         * The track's note events
         */
        this.notes = [];
        /**
         * The control change events
         */
        this.controlChanges = ControlChanges_1.createControlChanges();
        /**
         * The pitch bend events
         */
        this.pitchBends = [];
        privateHeaderMap.set(this, header);
        if (trackData) {
            var nameEvent = trackData.find(function (e) { return e.type === "trackName"; });
            this.name = nameEvent ? nameEvent.text : "";
        }
        this.instrument = new Instrument_1.Instrument(trackData, this);
        // defaults to 0
        this.channel = 0;
        if (trackData) {
            var noteOns = trackData.filter(function (event) { return event.type === "noteOn"; });
            var noteOffs = trackData.filter(function (event) { return event.type === "noteOff"; });
            var _loop_1 = function () {
                var currentNote = noteOns.shift();
                // set the channel based on the note
                this_1.channel = currentNote.channel;
                // find the corresponding note off
                var offIndex = noteOffs.findIndex(function (note) { return note.noteNumber === currentNote.noteNumber && note.absoluteTime >= currentNote.absoluteTime; });
                if (offIndex !== -1) {
                    // once it's got the note off, add it
                    var noteOff = noteOffs.splice(offIndex, 1)[0];
                    this_1.addNote({
                        durationTicks: noteOff.absoluteTime - currentNote.absoluteTime,
                        midi: currentNote.noteNumber,
                        noteOffVelocity: noteOff.velocity / 127,
                        ticks: currentNote.absoluteTime,
                        velocity: currentNote.velocity / 127,
                    });
                }
            };
            var this_1 = this;
            while (noteOns.length) {
                _loop_1();
            }
            var controlChanges = trackData.filter(function (event) { return event.type === "controller"; });
            controlChanges.forEach(function (event) {
                _this.addCC({
                    number: event.controllerType,
                    ticks: event.absoluteTime,
                    value: event.value / 127,
                });
            });
            var pitchBends = trackData.filter(function (event) { return event.type === "pitchBend"; });
            pitchBends.forEach(function (event) {
                _this.addPitchBend({
                    ticks: event.absoluteTime,
                    // scale the value between -2^13 to 2^13 to -2 to 2
                    value: event.value / Math.pow(2, 13),
                });
            });
            // const endOfTrack = trackData.find(event => event.type === "endOfTrack");
        }
    }
    /**
     * Add a note to the notes array
     * @param props The note properties to add
     */
    Track.prototype.addNote = function (props) {
        var header = privateHeaderMap.get(this);
        var note = new Note_1.Note({
            midi: 0,
            ticks: 0,
            velocity: 1,
        }, {
            ticks: 0,
            velocity: 0,
        }, header);
        Object.assign(note, props);
        BinarySearch_1.insert(this.notes, note, "ticks");
        return this;
    };
    /**
     * Add a control change to the track
     * @param props
     */
    Track.prototype.addCC = function (props) {
        var header = privateHeaderMap.get(this);
        var cc = new ControlChange_1.ControlChange({
            controllerType: props.number,
        }, header);
        delete props.number;
        Object.assign(cc, props);
        if (!Array.isArray(this.controlChanges[cc.number])) {
            this.controlChanges[cc.number] = [];
        }
        BinarySearch_1.insert(this.controlChanges[cc.number], cc, "ticks");
        return this;
    };
    /**
     * Add a control change to the track
     */
    Track.prototype.addPitchBend = function (props) {
        var header = privateHeaderMap.get(this);
        var pb = new PitchBend_1.PitchBend({}, header);
        Object.assign(pb, props);
        BinarySearch_1.insert(this.pitchBends, pb, "ticks");
        return this;
    };
    Object.defineProperty(Track.prototype, "duration", {
        /**
         * The end time of the last event in the track
         */
        get: function () {
            if (!this.notes.length) {
                return 0;
            }
            var maxDuration = this.notes[this.notes.length - 1].time + this.notes[this.notes.length - 1].duration;
            for (var i = 0; i < this.notes.length - 1; i++) {
                var duration = this.notes[i].time + this.notes[i].duration;
                if (maxDuration < duration) {
                    maxDuration = duration;
                }
            }
            return maxDuration;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Track.prototype, "durationTicks", {
        /**
         * The end time of the last event in the track in ticks
         */
        get: function () {
            if (!this.notes.length) {
                return 0;
            }
            var maxDuration = this.notes[this.notes.length - 1].ticks + this.notes[this.notes.length - 1].durationTicks;
            for (var i = 0; i < this.notes.length - 1; i++) {
                var duration = this.notes[i].ticks + this.notes[i].durationTicks;
                if (maxDuration < duration) {
                    maxDuration = duration;
                }
            }
            return maxDuration;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Assign the json values to this track
     */
    Track.prototype.fromJSON = function (json) {
        var _this = this;
        this.name = json.name;
        this.channel = json.channel;
        this.instrument = new Instrument_1.Instrument(undefined, this);
        this.instrument.fromJSON(json.instrument);
        for (var number in json.controlChanges) {
            if (json.controlChanges[number]) {
                json.controlChanges[number].forEach(function (cc) {
                    _this.addCC({
                        number: cc.number,
                        ticks: cc.ticks,
                        value: cc.value,
                    });
                });
            }
        }
        json.notes.forEach(function (n) {
            _this.addNote({
                durationTicks: n.durationTicks,
                midi: n.midi,
                ticks: n.ticks,
                velocity: n.velocity,
            });
        });
    };
    /**
     * Convert the track into a JSON format
     */
    Track.prototype.toJSON = function () {
        // convert all the CCs to JSON
        var controlChanges = {};
        for (var i = 0; i < 127; i++) {
            if (this.controlChanges.hasOwnProperty(i)) {
                controlChanges[i] = this.controlChanges[i].map(function (c) { return c.toJSON(); });
            }
        }
        return {
            channel: this.channel,
            controlChanges: controlChanges,
            pitchBends: this.pitchBends.map(function (pb) { return pb.toJSON(); }),
            instrument: this.instrument.toJSON(),
            name: this.name,
            notes: this.notes.map(function (n) { return n.toJSON(); }),
        };
    };
    return Track;
}());
exports.Track = Track;
//# sourceMappingURL=Track.js.map

/***/ }),

/***/ "./node_modules/@tonejs/midi/node_modules/array-flatten/array-flatten.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/@tonejs/midi/node_modules/array-flatten/array-flatten.js ***!
  \*******************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * Expose `arrayFlatten`.
 */
module.exports = flatten
module.exports.from = flattenFrom
module.exports.depth = flattenDepth
module.exports.fromDepth = flattenFromDepth

/**
 * Flatten an array.
 *
 * @param  {Array} array
 * @return {Array}
 */
function flatten (array) {
  if (!Array.isArray(array)) {
    throw new TypeError('Expected value to be an array')
  }

  return flattenFrom(array)
}

/**
 * Flatten an array-like structure.
 *
 * @param  {Array} array
 * @return {Array}
 */
function flattenFrom (array) {
  return flattenDown(array, [])
}

/**
 * Flatten an array-like structure with depth.
 *
 * @param  {Array}  array
 * @param  {number} depth
 * @return {Array}
 */
function flattenDepth (array, depth) {
  if (!Array.isArray(array)) {
    throw new TypeError('Expected value to be an array')
  }

  return flattenFromDepth(array, depth)
}

/**
 * Flatten an array-like structure with depth.
 *
 * @param  {Array}  array
 * @param  {number} depth
 * @return {Array}
 */
function flattenFromDepth (array, depth) {
  if (typeof depth !== 'number') {
    throw new TypeError('Expected the depth to be a number')
  }

  return flattenDownDepth(array, [], depth)
}

/**
 * Flatten an array indefinitely.
 *
 * @param  {Array} array
 * @param  {Array} result
 * @return {Array}
 */
function flattenDown (array, result) {
  for (var i = 0; i < array.length; i++) {
    var value = array[i]

    if (Array.isArray(value)) {
      flattenDown(value, result)
    } else {
      result.push(value)
    }
  }

  return result
}

/**
 * Flatten an array with depth.
 *
 * @param  {Array}  array
 * @param  {Array}  result
 * @param  {number} depth
 * @return {Array}
 */
function flattenDownDepth (array, result, depth) {
  depth--

  for (var i = 0; i < array.length; i++) {
    var value = array[i]

    if (depth > -1 && Array.isArray(value)) {
      flattenDownDepth(value, result, depth)
    } else {
      result.push(value)
    }
  }

  return result
}


/***/ }),

/***/ "./node_modules/midi-file/index.js":
/*!*****************************************!*\
  !*** ./node_modules/midi-file/index.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

exports.parseMidi = __webpack_require__(/*! ./lib/midi-parser */ "./node_modules/midi-file/lib/midi-parser.js")
exports.writeMidi = __webpack_require__(/*! ./lib/midi-writer */ "./node_modules/midi-file/lib/midi-writer.js")


/***/ }),

/***/ "./node_modules/midi-file/lib/midi-parser.js":
/*!***************************************************!*\
  !*** ./node_modules/midi-file/lib/midi-parser.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// data can be any array-like object.  It just needs to support .length, .slice, and an element getter []

function parseMidi(data) {
  var p = new Parser(data)

  var headerChunk = p.readChunk()
  if (headerChunk.id != 'MThd')
    throw "Bad MIDI file.  Expected 'MHdr', got: '" + headerChunk.id + "'"
  var header = parseHeader(headerChunk.data)

  var tracks = []
  for (var i=0; !p.eof() && i < header.numTracks; i++) {
    var trackChunk = p.readChunk()
    if (trackChunk.id != 'MTrk')
      throw "Bad MIDI file.  Expected 'MTrk', got: '" + trackChunk.id + "'"
    var track = parseTrack(trackChunk.data)
    tracks.push(track)
  }

  return {
    header: header,
    tracks: tracks
  }
}


function parseHeader(data) {
  var p = new Parser(data)

  var format = p.readUInt16()
  var numTracks = p.readUInt16()

  var result = {
    format: format,
    numTracks: numTracks
  }

  var timeDivision = p.readUInt16()
  if (timeDivision & 0x8000) {
    result.framesPerSecond = 0x100 - (timeDivision >> 8)
    result.ticksPerFrame = timeDivision & 0xFF
  } else {
    result.ticksPerBeat = timeDivision
  }

  return result
}

function parseTrack(data) {
  var p = new Parser(data)

  var events = []
  while (!p.eof()) {
    var event = readEvent()
    events.push(event)
  }

  return events

  var lastEventTypeByte = null

  function readEvent() {
    var event = {}
    event.deltaTime = p.readVarInt()

    var eventTypeByte = p.readUInt8()

    if ((eventTypeByte & 0xf0) === 0xf0) {
      // system / meta event
      if (eventTypeByte === 0xff) {
        // meta event
        event.meta = true
        var metatypeByte = p.readUInt8()
        var length = p.readVarInt()
        switch (metatypeByte) {
          case 0x00:
            event.type = 'sequenceNumber'
            if (length !== 2) throw "Expected length for sequenceNumber event is 2, got " + length
            event.number = p.readUInt16()
            return event
          case 0x01:
            event.type = 'text'
            event.text = p.readString(length)
            return event
          case 0x02:
            event.type = 'copyrightNotice'
            event.text = p.readString(length)
            return event
          case 0x03:
            event.type = 'trackName'
            event.text = p.readString(length)
            return event
          case 0x04:
            event.type = 'instrumentName'
            event.text = p.readString(length)
            return event
          case 0x05:
            event.type = 'lyrics'
            event.text = p.readString(length)
            return event
          case 0x06:
            event.type = 'marker'
            event.text = p.readString(length)
            return event
          case 0x07:
            event.type = 'cuePoint'
            event.text = p.readString(length)
            return event
          case 0x20:
            event.type = 'channelPrefix'
            if (length != 1) throw "Expected length for channelPrefix event is 1, got " + length
            event.channel = p.readUInt8()
            return event
          case 0x21:
            event.type = 'portPrefix'
            if (length != 1) throw "Expected length for portPrefix event is 1, got " + length
            event.port = p.readUInt8()
            return event
          case 0x2f:
            event.type = 'endOfTrack'
            if (length != 0) throw "Expected length for endOfTrack event is 0, got " + length
            return event
          case 0x51:
            event.type = 'setTempo';
            if (length != 3) throw "Expected length for setTempo event is 3, got " + length
            event.microsecondsPerBeat = p.readUInt24()
            return event
          case 0x54:
            event.type = 'smpteOffset';
            if (length != 5) throw "Expected length for smpteOffset event is 5, got " + length
            var hourByte = p.readUInt8()
            var FRAME_RATES = { 0x00: 24, 0x20: 25, 0x40: 29, 0x60: 30 }
            event.frameRate = FRAME_RATES[hourByte & 0x60]
            event.hour = hourByte & 0x1f
            event.min = p.readUInt8()
            event.sec = p.readUInt8()
            event.frame = p.readUInt8()
            event.subFrame = p.readUInt8()
            return event
          case 0x58:
            event.type = 'timeSignature'
            if (length != 4) throw "Expected length for timeSignature event is 4, got " + length
            event.numerator = p.readUInt8()
            event.denominator = (1 << p.readUInt8())
            event.metronome = p.readUInt8()
            event.thirtyseconds = p.readUInt8()
            return event
          case 0x59:
            event.type = 'keySignature'
            if (length != 2) throw "Expected length for keySignature event is 2, got " + length
            event.key = p.readInt8()
            event.scale = p.readUInt8()
            return event
          case 0x7f:
            event.type = 'sequencerSpecific'
            event.data = p.readBytes(length)
            return event
          default:
            event.type = 'unknownMeta'
            event.data = p.readBytes(length)
            event.metatypeByte = metatypeByte
            return event
        }
      } else if (eventTypeByte == 0xf0) {
        event.type = 'sysEx'
        var length = p.readVarInt()
        event.data = p.readBytes(length)
        return event
      } else if (eventTypeByte == 0xf7) {
        event.type = 'endSysEx'
        var length = p.readVarInt()
        event.data = p.readBytes(length)
        return event
      } else {
        throw "Unrecognised MIDI event type byte: " + eventTypeByte
      }
    } else {
      // channel event
      var param1
      if ((eventTypeByte & 0x80) === 0) {
        // running status - reuse lastEventTypeByte as the event type.
        // eventTypeByte is actually the first parameter
        if (lastEventTypeByte === null)
          throw "Running status byte encountered before status byte"
        param1 = eventTypeByte
        eventTypeByte = lastEventTypeByte
        event.running = true
      } else {
        param1 = p.readUInt8()
        lastEventTypeByte = eventTypeByte
      }
      var eventType = eventTypeByte >> 4
      event.channel = eventTypeByte & 0x0f
      switch (eventType) {
        case 0x08:
          event.type = 'noteOff'
          event.noteNumber = param1
          event.velocity = p.readUInt8()
          return event
        case 0x09:
          var velocity = p.readUInt8()
          event.type = velocity === 0 ? 'noteOff' : 'noteOn'
          event.noteNumber = param1
          event.velocity = velocity
          if (velocity === 0) event.byte9 = true
          return event
        case 0x0a:
          event.type = 'noteAftertouch'
          event.noteNumber = param1
          event.amount = p.readUInt8()
          return event
        case 0x0b:
          event.type = 'controller'
          event.controllerType = param1
          event.value = p.readUInt8()
          return event
        case 0x0c:
          event.type = 'programChange'
          event.programNumber = param1
          return event
        case 0x0d:
          event.type = 'channelAftertouch'
          event.amount = param1
          return event
        case 0x0e:
          event.type = 'pitchBend'
          event.value = (param1 + (p.readUInt8() << 7)) - 0x2000
          return event
        default:
          throw "Unrecognised MIDI event type: " + eventType
      }
    }
  }
}

function Parser(data) {
  this.buffer = data
  this.bufferLen = this.buffer.length
  this.pos = 0
}

Parser.prototype.eof = function() {
  return this.pos >= this.bufferLen
}

Parser.prototype.readUInt8 = function() {
  var result = this.buffer[this.pos]
  this.pos += 1
  return result
}

Parser.prototype.readInt8 = function() {
  var u = this.readUInt8()
  if (u & 0x80)
    return u - 0x100
  else
    return u
}

Parser.prototype.readUInt16 = function() {
  var b0 = this.readUInt8(),
      b1 = this.readUInt8()

    return (b0 << 8) + b1
}

Parser.prototype.readInt16 = function() {
  var u = this.readUInt16()
  if (u & 0x8000)
    return u - 0x10000
  else
    return u
}

Parser.prototype.readUInt24 = function() {
  var b0 = this.readUInt8(),
      b1 = this.readUInt8(),
      b2 = this.readUInt8()

    return (b0 << 16) + (b1 << 8) + b2
}

Parser.prototype.readInt24 = function() {
  var u = this.readUInt24()
  if (u & 0x800000)
    return u - 0x1000000
  else
    return u
}

Parser.prototype.readUInt32 = function() {
  var b0 = this.readUInt8(),
      b1 = this.readUInt8(),
      b2 = this.readUInt8(),
      b3 = this.readUInt8()

    return (b0 << 24) + (b1 << 16) + (b2 << 8) + b3
}

Parser.prototype.readBytes = function(len) {
  var bytes = this.buffer.slice(this.pos, this.pos + len)
  this.pos += len
  return bytes
}

Parser.prototype.readString = function(len) {
  var bytes = this.readBytes(len)
  return String.fromCharCode.apply(null, bytes)
}

Parser.prototype.readVarInt = function() {
  var result = 0
  while (!this.eof()) {
    var b = this.readUInt8()
    if (b & 0x80) {
      result += (b & 0x7f)
      result <<= 7
    } else {
      // b is last byte
      return result + b
    }
  }
  // premature eof
  return result
}

Parser.prototype.readChunk = function() {
  var id = this.readString(4)
  var length = this.readUInt32()
  var data = this.readBytes(length)
  return {
    id: id,
    length: length,
    data: data
  }
}

module.exports = parseMidi


/***/ }),

/***/ "./node_modules/midi-file/lib/midi-writer.js":
/*!***************************************************!*\
  !*** ./node_modules/midi-file/lib/midi-writer.js ***!
  \***************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

// data should be the same type of format returned by parseMidi
// for maximum compatibililty, returns an array of byte values, suitable for conversion to Buffer, Uint8Array, etc.

// opts:
// - running              reuse previous eventTypeByte when possible, to compress file
// - useByte9ForNoteOff   use 0x09 for noteOff when velocity is zero

function writeMidi(data, opts) {
  if (typeof data !== 'object')
    throw 'Invalid MIDI data'

  opts = opts || {}

  var header = data.header || {}
  var tracks = data.tracks || []
  var i, len = tracks.length

  var w = new Writer()
  writeHeader(w, header, len)

  for (i=0; i < len; i++) {
    writeTrack(w, tracks[i], opts)
  }

  return w.buffer
}

function writeHeader(w, header, numTracks) {
  var format = header.format == null ? 1 : header.format

  var timeDivision = 128
  if (header.timeDivision) {
    timeDivision = header.timeDivision
  } else if (header.ticksPerFrame && header.framesPerSecond) {
    timeDivision = (-(header.framesPerSecond & 0xFF) << 8) | (header.ticksPerFrame & 0xFF)
  } else if (header.ticksPerBeat) {
    timeDivision = header.ticksPerBeat & 0x7FFF
  }

  var h = new Writer()
  h.writeUInt16(format)
  h.writeUInt16(numTracks)
  h.writeUInt16(timeDivision)

  w.writeChunk('MThd', h.buffer)
}

function writeTrack(w, track, opts) {
  var t = new Writer()
  var i, len = track.length
  var eventTypeByte = null
  for (i=0; i < len; i++) {
    // Reuse last eventTypeByte when opts.running is set, or event.running is explicitly set on it.
    // parseMidi will set event.running for each event, so that we can get an exact copy by default.
    // Explicitly set opts.running to false, to override event.running and never reuse last eventTypeByte.
    if (opts.running === false || !opts.running && !track[i].running) eventTypeByte = null

    eventTypeByte = writeEvent(t, track[i], eventTypeByte, opts.useByte9ForNoteOff)
  }
  w.writeChunk('MTrk', t.buffer)
}

function writeEvent(w, event, lastEventTypeByte, useByte9ForNoteOff) {
  var type = event.type
  var deltaTime = event.deltaTime
  var text = event.text || ''
  var data = event.data || []
  var eventTypeByte = null
  w.writeVarInt(deltaTime)

  switch (type) {
    // meta events
    case 'sequenceNumber':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x00)
      w.writeVarInt(2)
      w.writeUInt16(event.number)
      break;

    case 'text':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x01)
      w.writeVarInt(text.length)
      w.writeString(text)
      break;

    case 'copyrightNotice':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x02)
      w.writeVarInt(text.length)
      w.writeString(text)
      break;

    case 'trackName':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x03)
      w.writeVarInt(text.length)
      w.writeString(text)
      break;

    case 'instrumentName':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x04)
      w.writeVarInt(text.length)
      w.writeString(text)
      break;

    case 'lyrics':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x05)
      w.writeVarInt(text.length)
      w.writeString(text)
      break;

    case 'marker':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x06)
      w.writeVarInt(text.length)
      w.writeString(text)
      break;

    case 'cuePoint':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x07)
      w.writeVarInt(text.length)
      w.writeString(text)
      break;

    case 'channelPrefix':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x20)
      w.writeVarInt(1)
      w.writeUInt8(event.channel)
      break;

    case 'portPrefix':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x21)
      w.writeVarInt(1)
      w.writeUInt8(event.port)
      break;

    case 'endOfTrack':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x2F)
      w.writeVarInt(0)
      break;

    case 'setTempo':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x51)
      w.writeVarInt(3)
      w.writeUInt24(event.microsecondsPerBeat)
      break;

    case 'smpteOffset':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x54)
      w.writeVarInt(5)
      var FRAME_RATES = { 24: 0x00, 25: 0x20, 29: 0x40, 30: 0x60 }
      var hourByte = (event.hour & 0x1F) | FRAME_RATES[event.frameRate]
      w.writeUInt8(hourByte)
      w.writeUInt8(event.min)
      w.writeUInt8(event.sec)
      w.writeUInt8(event.frame)
      w.writeUInt8(event.subFrame)
      break;

    case 'timeSignature':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x58)
      w.writeVarInt(4)
      w.writeUInt8(event.numerator)
      var denominator = Math.floor((Math.log(event.denominator) / Math.LN2)) & 0xFF
      w.writeUInt8(denominator)
      w.writeUInt8(event.metronome)
      w.writeUInt8(event.thirtyseconds || 8)
      break;

    case 'keySignature':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x59)
      w.writeVarInt(2)
      w.writeInt8(event.key)
      w.writeUInt8(event.scale)
      break;

    case 'sequencerSpecific':
      w.writeUInt8(0xFF)
      w.writeUInt8(0x7F)
      w.writeVarInt(data.length)
      w.writeBytes(data)
      break;

    case 'unknownMeta':
      if (event.metatypeByte != null) {
        w.writeUInt8(0xFF)
        w.writeUInt8(event.metatypeByte)
        w.writeVarInt(data.length)
        w.writeBytes(data)
      }
      break;

    // system-exclusive
    case 'sysEx':
      w.writeUInt8(0xF0)
      w.writeVarInt(data.length)
      w.writeBytes(data)
      break;

    case 'endSysEx':
      w.writeUInt8(0xF7)
      w.writeVarInt(data.length)
      w.writeBytes(data)
      break;

    // channel events
    case 'noteOff':
      // Use 0x90 when opts.useByte9ForNoteOff is set and velocity is zero, or when event.byte9 is explicitly set on it.
      // parseMidi will set event.byte9 for each event, so that we can get an exact copy by default.
      // Explicitly set opts.useByte9ForNoteOff to false, to override event.byte9 and always use 0x80 for noteOff events.
      var noteByte = ((useByte9ForNoteOff !== false && event.byte9) || (useByte9ForNoteOff && event.velocity == 0)) ? 0x90 : 0x80

      eventTypeByte = noteByte | event.channel
      if (eventTypeByte !== lastEventTypeByte) w.writeUInt8(eventTypeByte)
      w.writeUInt8(event.noteNumber)
      w.writeUInt8(event.velocity)
      break;

    case 'noteOn':
      eventTypeByte = 0x90 | event.channel
      if (eventTypeByte !== lastEventTypeByte) w.writeUInt8(eventTypeByte)
      w.writeUInt8(event.noteNumber)
      w.writeUInt8(event.velocity)
      break;

    case 'noteAftertouch':
      eventTypeByte = 0xA0 | event.channel
      if (eventTypeByte !== lastEventTypeByte) w.writeUInt8(eventTypeByte)
      w.writeUInt8(event.noteNumber)
      w.writeUInt8(event.amount)
      break;

    case 'controller':
      eventTypeByte = 0xB0 | event.channel
      if (eventTypeByte !== lastEventTypeByte) w.writeUInt8(eventTypeByte)
      w.writeUInt8(event.controllerType)
      w.writeUInt8(event.value)
      break;

    case 'programChange':
      eventTypeByte = 0xC0 | event.channel
      if (eventTypeByte !== lastEventTypeByte) w.writeUInt8(eventTypeByte)
      w.writeUInt8(event.programNumber)
      break;

    case 'channelAftertouch':
      eventTypeByte = 0xD0 | event.channel
      if (eventTypeByte !== lastEventTypeByte) w.writeUInt8(eventTypeByte)
      w.writeUInt8(event.amount)
      break;

    case 'pitchBend':
      eventTypeByte = 0xE0 | event.channel
      if (eventTypeByte !== lastEventTypeByte) w.writeUInt8(eventTypeByte)
      var value14 = 0x2000 + event.value
      var lsb14 = (value14 & 0x7F)
      var msb14 = (value14 >> 7) & 0x7F
      w.writeUInt8(lsb14)
      w.writeUInt8(msb14)
    break;

    default:
      throw 'Unrecognized event type: ' + type
  }
  return eventTypeByte
}


function Writer() {
  this.buffer = []
}

Writer.prototype.writeUInt8 = function(v) {
  this.buffer.push(v & 0xFF)
}
Writer.prototype.writeInt8 = Writer.prototype.writeUInt8

Writer.prototype.writeUInt16 = function(v) {
  var b0 = (v >> 8) & 0xFF,
      b1 = v & 0xFF

  this.writeUInt8(b0)
  this.writeUInt8(b1)
}
Writer.prototype.writeInt16 = Writer.prototype.writeUInt16

Writer.prototype.writeUInt24 = function(v) {
  var b0 = (v >> 16) & 0xFF,
      b1 = (v >> 8) & 0xFF,
      b2 = v & 0xFF

  this.writeUInt8(b0)
  this.writeUInt8(b1)
  this.writeUInt8(b2)
}
Writer.prototype.writeInt24 = Writer.prototype.writeUInt24

Writer.prototype.writeUInt32 = function(v) {
  var b0 = (v >> 24) & 0xFF,
      b1 = (v >> 16) & 0xFF,
      b2 = (v >> 8) & 0xFF,
      b3 = v & 0xFF

  this.writeUInt8(b0)
  this.writeUInt8(b1)
  this.writeUInt8(b2)
  this.writeUInt8(b3)
}
Writer.prototype.writeInt32 = Writer.prototype.writeUInt32


Writer.prototype.writeBytes = function(arr) {
  this.buffer = this.buffer.concat(Array.prototype.slice.call(arr, 0))
}

Writer.prototype.writeString = function(str) {
  var i, len = str.length, arr = []
  for (i=0; i < len; i++) {
    arr.push(str.codePointAt(i))
  }
  this.writeBytes(arr)
}

Writer.prototype.writeVarInt = function(v) {
  if (v < 0) throw "Cannot write negative variable-length integer"

  if (v <= 0x7F) {
    this.writeUInt8(v)
  } else {
    var i = v
    var bytes = []
    bytes.push(i & 0x7F)
    i >>= 7
    while (i) {
      var b = i & 0x7F | 0x80
      bytes.push(b)
      i >>= 7
    }
    this.writeBytes(bytes.reverse())
  }
}

Writer.prototype.writeChunk = function(id, data) {
  this.writeString(id)
  this.writeUInt32(data.length)
  this.writeBytes(data)
}

module.exports = writeMidi


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AY21hby9jb2RlbWFvLXRvbmUvYnVpbGQvVG9uZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGNtYW8vbWlkaW1hby9kaXN0L19fZGVidWdnZXJfXy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGNtYW8vbWlkaW1hby9kaXN0L2NvbmZpZy9jb25zdC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGNtYW8vbWlkaW1hby9kaXN0L2NvbnRyb2xsZXIvTWlkaU1hby5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGNtYW8vbWlkaW1hby9kaXN0L2NvbnRyb2xsZXIvT2JiTWFvLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AY21hby9taWRpbWFvL2Rpc3QvY29udHJvbGxlci9kZWZzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AY21hby9taWRpbWFvL2Rpc3QvY29udHJvbGxlci9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGNtYW8vbWlkaW1hby9kaXN0L2RlZnMuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BjbWFvL21pZGltYW8vZGlzdC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGNtYW8vbWlkaW1hby9kaXN0L2luc3RydW1lbnQvZGVmcy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQGNtYW8vbWlkaW1hby9kaXN0L2luc3RydW1lbnQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BjbWFvL21pZGltYW8vZGlzdC9vYmIvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0BjbWFvL21pZGltYW8vZGlzdC91dGlscy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHRvbmVqcy9taWRpL2Rpc3QvQmluYXJ5U2VhcmNoLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AdG9uZWpzL21pZGkvZGlzdC9Db250cm9sQ2hhbmdlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AdG9uZWpzL21pZGkvZGlzdC9Db250cm9sQ2hhbmdlcy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvQHRvbmVqcy9taWRpL2Rpc3QvRW5jb2RlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AdG9uZWpzL21pZGkvZGlzdC9IZWFkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0B0b25lanMvbWlkaS9kaXN0L0luc3RydW1lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0B0b25lanMvbWlkaS9kaXN0L0luc3RydW1lbnRNYXBzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AdG9uZWpzL21pZGkvZGlzdC9NaWRpLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AdG9uZWpzL21pZGkvZGlzdC9Ob3RlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AdG9uZWpzL21pZGkvZGlzdC9QaXRjaEJlbmQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL0B0b25lanMvbWlkaS9kaXN0L1RyYWNrLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9AdG9uZWpzL21pZGkvbm9kZV9tb2R1bGVzL2FycmF5LWZsYXR0ZW4vYXJyYXktZmxhdHRlbi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbWlkaS1maWxlL2luZGV4LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9taWRpLWZpbGUvbGliL21pZGktcGFyc2VyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9taWRpLWZpbGUvbGliL21pZGktd3JpdGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIiFmdW5jdGlvbih0LGUpe1wib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzJiZcIm9iamVjdFwiPT10eXBlb2YgbW9kdWxlP21vZHVsZS5leHBvcnRzPWUoKTpcImZ1bmN0aW9uXCI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLGUpOlwib2JqZWN0XCI9PXR5cGVvZiBleHBvcnRzP2V4cG9ydHMuVG9uZT1lKCk6dC5Ub25lPWUoKX0oXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHNlbGY/c2VsZjp0aGlzLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKHQpe3ZhciBlPXt9O2Z1bmN0aW9uIGkocyl7aWYoZVtzXSlyZXR1cm4gZVtzXS5leHBvcnRzO3ZhciBuPWVbc109e2k6cyxsOiExLGV4cG9ydHM6e319O3JldHVybiB0W3NdLmNhbGwobi5leHBvcnRzLG4sbi5leHBvcnRzLGkpLG4ubD0hMCxuLmV4cG9ydHN9cmV0dXJuIGkubT10LGkuYz1lLGkuZD1mdW5jdGlvbih0LGUscyl7aS5vKHQsZSl8fE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LGUse2NvbmZpZ3VyYWJsZTohMSxlbnVtZXJhYmxlOiEwLGdldDpzfSl9LGkucj1mdW5jdGlvbih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KX0saS5uPWZ1bmN0aW9uKHQpe3ZhciBlPXQmJnQuX19lc01vZHVsZT9mdW5jdGlvbigpe3JldHVybiB0LmRlZmF1bHR9OmZ1bmN0aW9uKCl7cmV0dXJuIHR9O3JldHVybiBpLmQoZSxcImFcIixlKSxlfSxpLm89ZnVuY3Rpb24odCxlKXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSl9LGkucD1cIlwiLGkoaS5zPTE0OCl9KFtmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpLGZ1bmN0aW9uKHQpe3ZhciBzPWkoOTMpLG49ZnVuY3Rpb24oKXtpZighKHRoaXMgaW5zdGFuY2VvZiBuKSl0aHJvdyBuZXcgRXJyb3IoXCJjb25zdHJ1Y3RvciBuZWVkcyB0byBiZSBjYWxsZWQgd2l0aCB0aGUgJ25ldycga2V5d29yZFwiKX07XG4vKipcbiAqICBUb25lLmpzXG4gKiAgQGF1dGhvciBZb3RhbSBNYW5uXG4gKiAgQGxpY2Vuc2UgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVCBNSVQgTGljZW5zZVxuICogIEBjb3B5cmlnaHQgMjAxNC0yMDE5IFlvdGFtIE1hbm5cbiAqL24ucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciB0IGluIG4pe3ZhciBlPXRbMF0ubWF0Y2goL15bQS1aXSQvKSxpPW5bdF09PT10aGlzLmNvbnN0cnVjdG9yO2lmKG4uaXNGdW5jdGlvbihuW3RdKSYmZSYmaSlyZXR1cm4gdH1yZXR1cm5cIlRvbmVcIn0sbi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxuLnByb3RvdHlwZS5zZXQ9ZnVuY3Rpb24odCxlKXtpZihuLmlzU3RyaW5nKHQpKXt2YXIgaT17fTtpW3RdPWUsdD1pfXQ6Zm9yKHZhciBzIGluIHQpe2U9dFtzXTt2YXIgbz10aGlzO2lmKC0xIT09cy5pbmRleE9mKFwiLlwiKSl7Zm9yKHZhciBhPXMuc3BsaXQoXCIuXCIpLHI9MDtyPGEubGVuZ3RoLTE7cisrKWlmKChvPW9bYVtyXV0paW5zdGFuY2VvZiBuKXthLnNwbGljZSgwLHIrMSk7dmFyIGw9YS5qb2luKFwiLlwiKTtvLnNldChsLGUpO2NvbnRpbnVlIHR9cz1hW2EubGVuZ3RoLTFdfXZhciB1PW9bc107bi5pc1VuZGVmKHUpfHwobi5TaWduYWwmJnUgaW5zdGFuY2VvZiBuLlNpZ25hbHx8bi5QYXJhbSYmdSBpbnN0YW5jZW9mIG4uUGFyYW0/dS52YWx1ZSE9PWUmJih1LnZhbHVlPWUpOnUgaW5zdGFuY2VvZiBBdWRpb1BhcmFtP3UudmFsdWUhPT1lJiYodS52YWx1ZT1lKTpuLlRpbWVCYXNlJiZ1IGluc3RhbmNlb2Ygbi5UaW1lQmFzZT9vW3NdPWU6dSBpbnN0YW5jZW9mIG4/dS5zZXQoZSk6dSE9PWUmJihvW3NdPWUpKX1yZXR1cm4gdGhpc30sbi5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHQpe24uaXNVbmRlZih0KT90PXRoaXMuX2NvbGxlY3REZWZhdWx0cyh0aGlzLmNvbnN0cnVjdG9yKTpuLmlzU3RyaW5nKHQpJiYodD1bdF0pO2Zvcih2YXIgZT17fSxpPTA7aTx0Lmxlbmd0aDtpKyspe3ZhciBzPXRbaV0sbz10aGlzLGE9ZTtpZigtMSE9PXMuaW5kZXhPZihcIi5cIikpe2Zvcih2YXIgcj1zLnNwbGl0KFwiLlwiKSxsPTA7bDxyLmxlbmd0aC0xO2wrKyl7dmFyIHU9cltsXTthW3VdPWFbdV18fHt9LGE9YVt1XSxvPW9bdV19cz1yW3IubGVuZ3RoLTFdfXZhciBmPW9bc107bi5pc09iamVjdCh0W3NdKT9hW3NdPWYuZ2V0KCk6bi5TaWduYWwmJmYgaW5zdGFuY2VvZiBuLlNpZ25hbD9hW3NdPWYudmFsdWU6bi5QYXJhbSYmZiBpbnN0YW5jZW9mIG4uUGFyYW0/YVtzXT1mLnZhbHVlOmYgaW5zdGFuY2VvZiBBdWRpb1BhcmFtP2Fbc109Zi52YWx1ZTpmIGluc3RhbmNlb2Ygbj9hW3NdPWYuZ2V0KCk6IW4uaXNGdW5jdGlvbihmKSYmbi5pc0RlZmluZWQoZikmJihhW3NdPWYpfXJldHVybiBlfSxuLnByb3RvdHlwZS5fY29sbGVjdERlZmF1bHRzPWZ1bmN0aW9uKHQpe3ZhciBlPVtdO2lmKG4uaXNEZWZpbmVkKHQuZGVmYXVsdHMpJiYoZT1PYmplY3Qua2V5cyh0LmRlZmF1bHRzKSksbi5pc0RlZmluZWQodC5fc3VwZXIpKWZvcih2YXIgaT10aGlzLl9jb2xsZWN0RGVmYXVsdHModC5fc3VwZXIpLHM9MDtzPGkubGVuZ3RoO3MrKyktMT09PWUuaW5kZXhPZihpW3NdKSYmZS5wdXNoKGlbc10pO3JldHVybiBlfSxuLmRlZmF1bHRzPWZ1bmN0aW9uKHQsZSxpKXt2YXIgcz17fTtpZigxPT09dC5sZW5ndGgmJm4uaXNPYmplY3QodFswXSkpcz10WzBdO2Vsc2UgZm9yKHZhciBvPTA7bzxlLmxlbmd0aDtvKyspc1tlW29dXT10W29dO3JldHVybiBuLmlzRGVmaW5lZChpLmRlZmF1bHRzKT9uLmRlZmF1bHRBcmcocyxpLmRlZmF1bHRzKTpuLmlzT2JqZWN0KGkpP24uZGVmYXVsdEFyZyhzLGkpOnN9LG4uZGVmYXVsdEFyZz1mdW5jdGlvbih0LGUpe2lmKG4uaXNPYmplY3QodCkmJm4uaXNPYmplY3QoZSkpe3ZhciBpPXt9O2Zvcih2YXIgcyBpbiB0KWlbc109bi5kZWZhdWx0QXJnKGVbc10sdFtzXSk7Zm9yKHZhciBvIGluIGUpaVtvXT1uLmRlZmF1bHRBcmcodFtvXSxlW29dKTtyZXR1cm4gaX1yZXR1cm4gbi5pc1VuZGVmKHQpP2U6dH0sbi5wcm90b3R5cGUubG9nPWZ1bmN0aW9uKCl7aWYodGhpcy5kZWJ1Z3x8dGhpcy50b1N0cmluZygpPT09bi5nbG9iYWwuVE9ORV9ERUJVR19DTEFTUyl7dmFyIHQ9QXJyYXkuZnJvbShhcmd1bWVudHMpO3QudW5zaGlmdCh0aGlzLnRvU3RyaW5nKCkrXCI6XCIpLGNvbnNvbGUubG9nLmFwcGx5KHZvaWQgMCx0KX19LG4ucHJvdG90eXBlLmFzc2VydD1mdW5jdGlvbih0LGUpe2lmKCF0KXRocm93IG5ldyBFcnJvcihlKX0sbi5jb25uZWN0U2VyaWVzPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PWFyZ3VtZW50c1swXSxlPTE7ZTxhcmd1bWVudHMubGVuZ3RoO2UrKyl7dmFyIGk9YXJndW1lbnRzW2VdO24uY29ubmVjdCh0LGkpLHQ9aX1yZXR1cm4gbn0sbi5jb25uZWN0PWZ1bmN0aW9uKHQsZSxpLHMpe2Zvcig7bi5pc0RlZmluZWQoZS5pbnB1dCk7KW4uaXNBcnJheShlLmlucHV0KT8ocz1uLmRlZmF1bHRBcmcocywwKSxlPWUuaW5wdXRbc10scz0wKTplLmlucHV0JiYoZT1lLmlucHV0KTtyZXR1cm4gZSBpbnN0YW5jZW9mIEF1ZGlvUGFyYW0/dC5jb25uZWN0KGUsaSk6ZSBpbnN0YW5jZW9mIEF1ZGlvTm9kZSYmdC5jb25uZWN0KGUsaSxzKSxufSxuLmRpc2Nvbm5lY3Q9ZnVuY3Rpb24odCxlLGkscyl7aWYoZSl7Zm9yKHZhciBvPSExOyFvOyluLmlzQXJyYXkoZS5pbnB1dCk/KG4uaXNEZWZpbmVkKHMpP24uZGlzY29ubmVjdCh0LGUuaW5wdXRbc10saSk6ZS5pbnB1dC5mb3JFYWNoKGZ1bmN0aW9uKGUpe3RyeXtuLmRpc2Nvbm5lY3QodCxlLGkpfWNhdGNoKHQpe319KSxvPSEwKTplLmlucHV0P2U9ZS5pbnB1dDpvPSEwO2UgaW5zdGFuY2VvZiBBdWRpb1BhcmFtP3QuZGlzY29ubmVjdChlLGkpOmUgaW5zdGFuY2VvZiBBdWRpb05vZGUmJnQuZGlzY29ubmVjdChlLGkscyl9ZWxzZSB0LmRpc2Nvbm5lY3QoKTtyZXR1cm4gbn0sbi5pc1VuZGVmPWZ1bmN0aW9uKHQpe3JldHVybiB2b2lkIDA9PT10fSxuLmlzRGVmaW5lZD1mdW5jdGlvbih0KXtyZXR1cm4hbi5pc1VuZGVmKHQpfSxuLmlzRnVuY3Rpb249ZnVuY3Rpb24odCl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgdH0sbi5pc051bWJlcj1mdW5jdGlvbih0KXtyZXR1cm5cIm51bWJlclwiPT10eXBlb2YgdH0sbi5pc09iamVjdD1mdW5jdGlvbih0KXtyZXR1cm5cIltvYmplY3QgT2JqZWN0XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpJiZ0LmNvbnN0cnVjdG9yPT09T2JqZWN0fSxuLmlzQm9vbGVhbj1mdW5jdGlvbih0KXtyZXR1cm5cImJvb2xlYW5cIj09dHlwZW9mIHR9LG4uaXNBcnJheT1mdW5jdGlvbih0KXtyZXR1cm4gQXJyYXkuaXNBcnJheSh0KX0sbi5pc1N0cmluZz1mdW5jdGlvbih0KXtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgdH0sbi5pc05vdGU9ZnVuY3Rpb24odCl7cmV0dXJuIG4uaXNTdHJpbmcodCkmJi9eKFthLWddezF9KD86YnwjfHh8YmIpPykoLT9bMC05XSspL2kudGVzdCh0KX0sbi5ub09wPWZ1bmN0aW9uKCl7fSxuLnByb3RvdHlwZS5fcmVhZE9ubHk9ZnVuY3Rpb24odCl7aWYoQXJyYXkuaXNBcnJheSh0KSlmb3IodmFyIGU9MDtlPHQubGVuZ3RoO2UrKyl0aGlzLl9yZWFkT25seSh0W2VdKTtlbHNlIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLHQse3dyaXRhYmxlOiExLGVudW1lcmFibGU6ITB9KX0sbi5wcm90b3R5cGUuX3dyaXRhYmxlPWZ1bmN0aW9uKHQpe2lmKEFycmF5LmlzQXJyYXkodCkpZm9yKHZhciBlPTA7ZTx0Lmxlbmd0aDtlKyspdGhpcy5fd3JpdGFibGUodFtlXSk7ZWxzZSBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyx0LHt3cml0YWJsZTohMH0pfSxuLlN0YXRlPXtTdGFydGVkOlwic3RhcnRlZFwiLFN0b3BwZWQ6XCJzdG9wcGVkXCIsUGF1c2VkOlwicGF1c2VkXCJ9LG4uZ2xvYmFsPW4uaXNVbmRlZih0KT93aW5kb3c6dCxuLmVxdWFsUG93ZXJTY2FsZT1mdW5jdGlvbih0KXt2YXIgZT0uNSpNYXRoLlBJO3JldHVybiBNYXRoLnNpbih0KmUpfSxuLmRiVG9HYWluPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLnBvdygxMCx0LzIwKX0sbi5nYWluVG9EYj1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5sb2codCkvTWF0aC5MTjEwKjIwfSxuLmludGVydmFsVG9GcmVxdWVuY3lSYXRpbz1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5wb3coMix0LzEyKX0sbi5wcm90b3R5cGUubm93PWZ1bmN0aW9uKCl7cmV0dXJuIG4uY29udGV4dC5ub3coKX0sbi5ub3c9ZnVuY3Rpb24oKXtyZXR1cm4gbi5jb250ZXh0Lm5vdygpfSxuLnByb3RvdHlwZS5pbW1lZGlhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbi5jb250ZXh0LmN1cnJlbnRUaW1lfSxuLmltbWVkaWF0ZT1mdW5jdGlvbigpe3JldHVybiBuLmNvbnRleHQuY3VycmVudFRpbWV9LG4uZXh0ZW5kPWZ1bmN0aW9uKHQsZSl7ZnVuY3Rpb24gaSgpe31uLmlzVW5kZWYoZSkmJihlPW4pLGkucHJvdG90eXBlPWUucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBpLHQucHJvdG90eXBlLmNvbnN0cnVjdG9yPXQsdC5fc3VwZXI9ZX0sbi5fYXVkaW9Db250ZXh0PW51bGwsbi5zdGFydD1mdW5jdGlvbigpe3JldHVybiBuLmNvbnRleHQucmVzdW1lKCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLFwiY29udGV4dFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gbi5fYXVkaW9Db250ZXh0fSxzZXQ6ZnVuY3Rpb24odCl7dC5pc0NvbnRleHQ/bi5fYXVkaW9Db250ZXh0PXQ6bi5fYXVkaW9Db250ZXh0PW5ldyBuLkNvbnRleHQodCksbi5Db250ZXh0LmVtaXQoXCJpbml0XCIsbi5fYXVkaW9Db250ZXh0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJjb250ZXh0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiBuLmNvbnRleHR9fSksbi5zZXRDb250ZXh0PWZ1bmN0aW9uKHQpe24uY29udGV4dD10fSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJibG9ja1RpbWVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDEyOC90aGlzLmNvbnRleHQuc2FtcGxlUmF0ZX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJzYW1wbGVUaW1lXCIse2dldDpmdW5jdGlvbigpe3JldHVybiAxL3RoaXMuY29udGV4dC5zYW1wbGVSYXRlfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLFwic3VwcG9ydGVkXCIse2dldDpmdW5jdGlvbigpe3ZhciB0PW4uZ2xvYmFsLmhhc093blByb3BlcnR5KFwiQXVkaW9Db250ZXh0XCIpfHxuLmdsb2JhbC5oYXNPd25Qcm9wZXJ0eShcIndlYmtpdEF1ZGlvQ29udGV4dFwiKSxlPW4uZ2xvYmFsLmhhc093blByb3BlcnR5KFwiUHJvbWlzZVwiKTtyZXR1cm4gdCYmZX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobixcImluaXRpYWxpemVkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBCb29sZWFuKG4uY29udGV4dCl9fSksbi5nZXRDb250ZXh0PWZ1bmN0aW9uKHQpe2lmKG4uaW5pdGlhbGl6ZWQpdChuLmNvbnRleHQpO2Vsc2V7dmFyIGU9ZnVuY3Rpb24oKXt0KG4uY29udGV4dCksbi5Db250ZXh0Lm9mZihcImluaXRcIixlKX07bi5Db250ZXh0Lm9uKFwiaW5pdFwiLGUpfXJldHVybiBufSxuLnZlcnNpb249cy5hLGUuZGVmYXVsdD1ufS5jYWxsKHRoaXMsaSgxNDcpKX0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMjApO2lmKHMuZGVmYXVsdC5zdXBwb3J0ZWQpe3ZhciBuPW5ldyBPZmZsaW5lQXVkaW9Db250ZXh0KDIsMSw0NDEwMCksbz1uLmNyZWF0ZUdhaW4oKSxhPW4uY3JlYXRlR2FpbigpO2lmKG8uY29ubmVjdChhKSE9PWEpe3ZhciByPUF1ZGlvTm9kZS5wcm90b3R5cGUuY29ubmVjdDtBdWRpb05vZGUucHJvdG90eXBlLmNvbm5lY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gci5hcHBseSh0aGlzLGFyZ3VtZW50cyksYXJndW1lbnRzWzBdfX19cy5kZWZhdWx0LkF1ZGlvTm9kZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5jYWxsKHRoaXMpO3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiY29udGV4dFwiXSx7Y29udGV4dDpzLmRlZmF1bHQuY29udGV4dH0pO3RoaXMuX2NvbnRleHQ9dC5jb250ZXh0fSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5BdWRpb05vZGUpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZSxcImNvbnRleHRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnRleHR9fSkscy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuY3JlYXRlSW5zT3V0cz1mdW5jdGlvbih0LGUpezE9PT10P3RoaXMuaW5wdXQ9dGhpcy5jb250ZXh0LmNyZWF0ZUdhaW4oKTp0PjEmJih0aGlzLmlucHV0PW5ldyBBcnJheSh0KSksMT09PWU/dGhpcy5vdXRwdXQ9dGhpcy5jb250ZXh0LmNyZWF0ZUdhaW4oKTplPjEmJih0aGlzLm91dHB1dD1uZXcgQXJyYXkoZSkpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUsXCJjaGFubmVsQ291bnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3V0cHV0LmNoYW5uZWxDb3VudH0sc2V0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm91dHB1dC5jaGFubmVsQ291bnQ9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUsXCJjaGFubmVsQ291bnRNb2RlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm91dHB1dC5jaGFubmVsQ291bnRNb2RlfSxzZXQ6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMub3V0cHV0LmNoYW5uZWxDb3VudE1vZGU9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUsXCJjaGFubmVsSW50ZXJwcmV0YXRpb25cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3V0cHV0LmNoYW5uZWxJbnRlcnByZXRhdGlvbn0sc2V0OmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm91dHB1dC5jaGFubmVsSW50ZXJwcmV0YXRpb249dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUsXCJudW1iZXJPZklucHV0c1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnB1dD9zLmRlZmF1bHQuaXNBcnJheSh0aGlzLmlucHV0KT90aGlzLmlucHV0Lmxlbmd0aDoxOjB9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLFwibnVtYmVyT2ZPdXRwdXRzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm91dHB1dD9zLmRlZmF1bHQuaXNBcnJheSh0aGlzLm91dHB1dCk/dGhpcy5vdXRwdXQubGVuZ3RoOjE6MH19KSxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5jb25uZWN0PWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gcy5kZWZhdWx0LmlzQXJyYXkodGhpcy5vdXRwdXQpPyhlPXMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsMCksdGhpcy5vdXRwdXRbZV0uY29ubmVjdCh0LDAsaSkpOnMuZGVmYXVsdC5jb25uZWN0KHRoaXMub3V0cHV0LHQsZSxpKSx0aGlzfSxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNjb25uZWN0PWZ1bmN0aW9uKHQsZSxpKXtyZXR1cm4gcy5kZWZhdWx0LmlzQXJyYXkodGhpcy5vdXRwdXQpPyhlPXMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsMCksdGhpcy5vdXRwdXRbZV0uZGlzY29ubmVjdCh0LDAsaSkpOnMuZGVmYXVsdC5kaXNjb25uZWN0KHRoaXMub3V0cHV0LHQsZSxpKSx0aGlzfSxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5jaGFpbj1mdW5jdGlvbigpe3ZhciB0PUFycmF5LmZyb20oYXJndW1lbnRzKTtyZXR1cm4gdC51bnNoaWZ0KHRoaXMpLHMuZGVmYXVsdC5jb25uZWN0U2VyaWVzLmFwcGx5KHZvaWQgMCx0KSx0aGlzfSxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5mYW49ZnVuY3Rpb24oKXtmb3IodmFyIHQ9MDt0PGFyZ3VtZW50cy5sZW5ndGg7dCsrKXRoaXMuY29ubmVjdChhcmd1bWVudHNbdF0pO3JldHVybiB0aGlzfSxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5pc0RlZmluZWQodGhpcy5pbnB1dCkmJih0aGlzLmlucHV0IGluc3RhbmNlb2YgQXVkaW9Ob2RlJiZ0aGlzLmlucHV0LmRpc2Nvbm5lY3QoKSx0aGlzLmlucHV0PW51bGwpLHMuZGVmYXVsdC5pc0RlZmluZWQodGhpcy5vdXRwdXQpJiYodGhpcy5vdXRwdXQgaW5zdGFuY2VvZiBBdWRpb05vZGUmJnRoaXMub3V0cHV0LmRpc2Nvbm5lY3QoKSx0aGlzLm91dHB1dD1udWxsKSx0aGlzLl9jb250ZXh0PW51bGwsdGhpc307ZS5kZWZhdWx0PXMuZGVmYXVsdC5BdWRpb05vZGV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDQpLGkoMTQpLGkoMzApLGkoNDQpLGkoMjApLGkoMyk7aWYocy5kZWZhdWx0LnN1cHBvcnRlZCYmIXMuZGVmYXVsdC5nbG9iYWwuQXVkaW9Db250ZXh0LnByb3RvdHlwZS5jcmVhdGVDb25zdGFudFNvdXJjZSl7dmFyIG49ZnVuY3Rpb24odCl7dGhpcy5jb250ZXh0PXQ7Zm9yKHZhciBlPXQuY3JlYXRlQnVmZmVyKDEsMTI4LHQuc2FtcGxlUmF0ZSksaT1lLmdldENoYW5uZWxEYXRhKDApLHM9MDtzPGkubGVuZ3RoO3MrKylpW3NdPTE7dGhpcy5fYnVmZmVyU291cmNlPXQuY3JlYXRlQnVmZmVyU291cmNlKCksdGhpcy5fYnVmZmVyU291cmNlLmNoYW5uZWxDb3VudD0xLHRoaXMuX2J1ZmZlclNvdXJjZS5jaGFubmVsQ291bnRNb2RlPVwiZXhwbGljaXRcIix0aGlzLl9idWZmZXJTb3VyY2UuYnVmZmVyPWUsdGhpcy5fYnVmZmVyU291cmNlLmxvb3A9ITA7dmFyIG49dGhpcy5fb3V0cHV0PXQuY3JlYXRlR2FpbigpO3RoaXMub2Zmc2V0PW4uZ2Fpbix0aGlzLl9idWZmZXJTb3VyY2UuY29ubmVjdChuKX07bi5wcm90b3R5cGUuc3RhcnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2J1ZmZlclNvdXJjZS5zdGFydCh0KSx0aGlzfSxuLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9idWZmZXJTb3VyY2Uuc3RvcCh0KSx0aGlzfSxuLnByb3RvdHlwZS5jb25uZWN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX291dHB1dC5jb25uZWN0LmFwcGx5KHRoaXMuX291dHB1dCxhcmd1bWVudHMpLHRoaXN9LG4ucHJvdG90eXBlLmRpc2Nvbm5lY3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3V0cHV0LmRpc2Nvbm5lY3QuYXBwbHkodGhpcy5fb3V0cHV0LGFyZ3VtZW50cyksdGhpc30sQXVkaW9Db250ZXh0LnByb3RvdHlwZS5jcmVhdGVDb25zdGFudFNvdXJjZT1mdW5jdGlvbigpe3JldHVybiBuZXcgbih0aGlzKX0scy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLmNyZWF0ZUNvbnN0YW50U291cmNlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKHRoaXMpfX1zLmRlZmF1bHQuU2lnbmFsPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJ2YWx1ZVwiLFwidW5pdHNcIl0scy5kZWZhdWx0LlNpZ25hbCk7cy5kZWZhdWx0LlBhcmFtLmNhbGwodGhpcyx0KSx0aGlzLl9jb25zdGFudFNvdXJjZT10aGlzLmNvbnRleHQuY3JlYXRlQ29uc3RhbnRTb3VyY2UoKSx0aGlzLl9jb25zdGFudFNvdXJjZS5zdGFydCgwKSx0aGlzLl9wYXJhbT10aGlzLl9jb25zdGFudFNvdXJjZS5vZmZzZXQsdGhpcy52YWx1ZT10LnZhbHVlLHRoaXMub3V0cHV0PXRoaXMuX2NvbnN0YW50U291cmNlLHRoaXMuaW5wdXQ9dGhpcy5fcGFyYW09dGhpcy5vdXRwdXQub2Zmc2V0fSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TaWduYWwscy5kZWZhdWx0LlBhcmFtKSxzLmRlZmF1bHQuU2lnbmFsLmRlZmF1bHRzPXt2YWx1ZTowLHVuaXRzOnMuZGVmYXVsdC5UeXBlLkRlZmF1bHQsY29udmVydDohMH0scy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUuY29ubmVjdD1zLmRlZmF1bHQuU2lnbmFsQmFzZS5wcm90b3R5cGUuY29ubmVjdCxzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5kaXNjb25uZWN0PXMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNjb25uZWN0LHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmdldFZhbHVlQXRUaW1lPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9wYXJhbS5nZXRWYWx1ZUF0VGltZT90aGlzLl9wYXJhbS5nZXRWYWx1ZUF0VGltZSh0KTpzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmdldFZhbHVlQXRUaW1lLmNhbGwodGhpcyx0KX0scy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9jb25zdGFudFNvdXJjZS5zdG9wKCksdGhpcy5fY29uc3RhbnRTb3VyY2UuZGlzY29ubmVjdCgpLHRoaXMuX2NvbnN0YW50U291cmNlPW51bGwsdGhpc307ZS5kZWZhdWx0PXMuZGVmYXVsdC5TaWduYWx9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDE0KSxpKDQpLGkoMSk7cy5kZWZhdWx0LkdhaW49ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImdhaW5cIixcInVuaXRzXCJdLHMuZGVmYXVsdC5HYWluKTtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyx0KSx0aGlzLmlucHV0PXRoaXMub3V0cHV0PXRoaXMuX2dhaW5Ob2RlPXRoaXMuY29udGV4dC5jcmVhdGVHYWluKCksdGhpcy5nYWluPW5ldyBzLmRlZmF1bHQuUGFyYW0oe3BhcmFtOnRoaXMuX2dhaW5Ob2RlLmdhaW4sdW5pdHM6dC51bml0cyx2YWx1ZTp0LmdhaW4sY29udmVydDp0LmNvbnZlcnR9KSx0aGlzLl9yZWFkT25seShcImdhaW5cIil9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkdhaW4scy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LkdhaW4uZGVmYXVsdHM9e2dhaW46MSxjb252ZXJ0OiEwfSxzLmRlZmF1bHQuR2Fpbi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9nYWluTm9kZS5kaXNjb25uZWN0KCksdGhpcy5fZ2Fpbk5vZGU9bnVsbCx0aGlzLl93cml0YWJsZShcImdhaW5cIiksdGhpcy5nYWluLmRpc3Bvc2UoKSx0aGlzLmdhaW49bnVsbH0sZS5kZWZhdWx0PXMuZGVmYXVsdC5HYWlufSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg2MyksaSg0NiksaSg0NSksaSgyMCk7cy5kZWZhdWx0LlR5cGU9e0RlZmF1bHQ6XCJudW1iZXJcIixUaW1lOlwidGltZVwiLEZyZXF1ZW5jeTpcImZyZXF1ZW5jeVwiLFRyYW5zcG9ydFRpbWU6XCJ0cmFuc3BvcnRUaW1lXCIsVGlja3M6XCJ0aWNrc1wiLE5vcm1hbFJhbmdlOlwibm9ybWFsUmFuZ2VcIixBdWRpb1JhbmdlOlwiYXVkaW9SYW5nZVwiLERlY2liZWxzOlwiZGJcIixJbnRlcnZhbDpcImludGVydmFsXCIsQlBNOlwiYnBtXCIsUG9zaXRpdmU6XCJwb3NpdGl2ZVwiLEdhaW46XCJnYWluXCIsQ2VudHM6XCJjZW50c1wiLERlZ3JlZXM6XCJkZWdyZWVzXCIsTUlESTpcIm1pZGlcIixCYXJzQmVhdHNTaXh0ZWVudGhzOlwiYmFyc0JlYXRzU2l4dGVlbnRoc1wiLFNhbXBsZXM6XCJzYW1wbGVzXCIsSGVydHo6XCJoZXJ0elwiLE5vdGU6XCJub3RlXCIsTWlsbGlzZWNvbmRzOlwibWlsbGlzZWNvbmRzXCIsU2Vjb25kczpcInNlY29uZHNcIixOb3RhdGlvbjpcIm5vdGF0aW9uXCJ9LHMuZGVmYXVsdC5wcm90b3R5cGUudG9TZWNvbmRzPWZ1bmN0aW9uKHQpe3JldHVybiBzLmRlZmF1bHQuaXNOdW1iZXIodCk/dDpzLmRlZmF1bHQuaXNVbmRlZih0KT90aGlzLm5vdygpOnMuZGVmYXVsdC5pc1N0cmluZyh0KXx8cy5kZWZhdWx0LmlzT2JqZWN0KHQpP25ldyBzLmRlZmF1bHQuVGltZSh0KS50b1NlY29uZHMoKTp0IGluc3RhbmNlb2Ygcy5kZWZhdWx0LlRpbWVCYXNlP3QudG9TZWNvbmRzKCk6dm9pZCAwfSxzLmRlZmF1bHQucHJvdG90eXBlLnRvRnJlcXVlbmN5PWZ1bmN0aW9uKHQpe3JldHVybiBzLmRlZmF1bHQuaXNOdW1iZXIodCk/dDpzLmRlZmF1bHQuaXNTdHJpbmcodCl8fHMuZGVmYXVsdC5pc1VuZGVmKHQpfHxzLmRlZmF1bHQuaXNPYmplY3QodCk/bmV3IHMuZGVmYXVsdC5GcmVxdWVuY3kodCkudmFsdWVPZigpOnQgaW5zdGFuY2VvZiBzLmRlZmF1bHQuVGltZUJhc2U/dC50b0ZyZXF1ZW5jeSgpOnZvaWQgMH0scy5kZWZhdWx0LnByb3RvdHlwZS50b1RpY2tzPWZ1bmN0aW9uKHQpe3JldHVybiBzLmRlZmF1bHQuaXNOdW1iZXIodCl8fHMuZGVmYXVsdC5pc1N0cmluZyh0KXx8cy5kZWZhdWx0LmlzT2JqZWN0KHQpP25ldyBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZSh0KS50b1RpY2tzKCk6cy5kZWZhdWx0LmlzVW5kZWYodCk/cy5kZWZhdWx0LlRyYW5zcG9ydC50aWNrczp0IGluc3RhbmNlb2Ygcy5kZWZhdWx0LlRpbWVCYXNlP3QudG9UaWNrcygpOnZvaWQgMH0sZS5kZWZhdWx0PXMuZGVmYXVsdH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTQpLGkoMyksaSgzMCk7cy5kZWZhdWx0Lk11bHRpcGx5PWZ1bmN0aW9uKHQpe3MuZGVmYXVsdC5TaWduYWwuY2FsbCh0aGlzKSx0aGlzLmNyZWF0ZUluc091dHMoMiwwKSx0aGlzLl9tdWx0PXRoaXMuaW5wdXRbMF09dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5HYWluLHRoaXMuX3BhcmFtPXRoaXMuaW5wdXRbMV09dGhpcy5vdXRwdXQuZ2Fpbix0aGlzLnZhbHVlPXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsMCl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk11bHRpcGx5LHMuZGVmYXVsdC5TaWduYWwpLHMuZGVmYXVsdC5NdWx0aXBseS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fbXVsdC5kaXNwb3NlKCksdGhpcy5fbXVsdD1udWxsLHRoaXMuX3BhcmFtPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5NdWx0aXBseX0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTYpLGkoMjcpLGkoNDApLGkoNCksaSgzNCksaSgyKSxpKDEpO3MuZGVmYXVsdC5Tb3VyY2U9ZnVuY3Rpb24odCl7dD1zLmRlZmF1bHQuZGVmYXVsdEFyZyh0LHMuZGVmYXVsdC5Tb3VyY2UuZGVmYXVsdHMpLHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSx0aGlzLl92b2x1bWU9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5Wb2x1bWUodC52b2x1bWUpLHRoaXMudm9sdW1lPXRoaXMuX3ZvbHVtZS52b2x1bWUsdGhpcy5fcmVhZE9ubHkoXCJ2b2x1bWVcIiksdGhpcy5fc3RhdGU9bmV3IHMuZGVmYXVsdC5UaW1lbGluZVN0YXRlKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkKSx0aGlzLl9zdGF0ZS5tZW1vcnk9MTAwLHRoaXMuX3N5bmNlZD0hMSx0aGlzLl9zY2hlZHVsZWQ9W10sdGhpcy5fdm9sdW1lLm91dHB1dC5vdXRwdXQuY2hhbm5lbENvdW50PTIsdGhpcy5fdm9sdW1lLm91dHB1dC5vdXRwdXQuY2hhbm5lbENvdW50TW9kZT1cImV4cGxpY2l0XCIsdGhpcy5tdXRlPXQubXV0ZX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU291cmNlLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5Tb3VyY2UuZGVmYXVsdHM9e3ZvbHVtZTowLG11dGU6ITF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZSxcInN0YXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zeW5jZWQ/cy5kZWZhdWx0LlRyYW5zcG9ydC5zdGF0ZT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkP3RoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHMuZGVmYXVsdC5UcmFuc3BvcnQuc2Vjb25kcyk6cy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQ6dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodGhpcy5ub3coKSl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLFwibXV0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdm9sdW1lLm11dGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl92b2x1bWUubXV0ZT10fX0pLHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLl9zdGFydD1zLmRlZmF1bHQubm9PcCxzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZS5yZXN0YXJ0PXMuZGVmYXVsdC5ub09wLHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLl9zdG9wPXMuZGVmYXVsdC5ub09wLHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKHQsZSxpKXtpZihzLmRlZmF1bHQuaXNVbmRlZih0KSYmdGhpcy5fc3luY2VkP3Q9cy5kZWZhdWx0LlRyYW5zcG9ydC5zZWNvbmRzOih0PXRoaXMudG9TZWNvbmRzKHQpLHQ9TWF0aC5tYXgodCx0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpKSx0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZSh0KT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkKXRoaXMuX3N0YXRlLmNhbmNlbCh0KSx0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCx0KSx0aGlzLnJlc3RhcnQodCxlLGkpO2Vsc2UgaWYodGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQsdCksdGhpcy5fc3luY2VkKXt2YXIgbj10aGlzLl9zdGF0ZS5nZXQodCk7bi5vZmZzZXQ9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwwKSxuLmR1cmF0aW9uPWk7dmFyIG89cy5kZWZhdWx0LlRyYW5zcG9ydC5zY2hlZHVsZShmdW5jdGlvbih0KXt0aGlzLl9zdGFydCh0LGUsaSl9LmJpbmQodGhpcyksdCk7dGhpcy5fc2NoZWR1bGVkLnB1c2gobykscy5kZWZhdWx0LlRyYW5zcG9ydC5zdGF0ZT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkJiZ0aGlzLl9zeW5jZWRTdGFydCh0aGlzLm5vdygpLHMuZGVmYXVsdC5UcmFuc3BvcnQuc2Vjb25kcyl9ZWxzZSB0aGlzLl9zdGFydC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLnN0b3A9ZnVuY3Rpb24odCl7aWYocy5kZWZhdWx0LmlzVW5kZWYodCkmJnRoaXMuX3N5bmNlZD90PXMuZGVmYXVsdC5UcmFuc3BvcnQuc2Vjb25kczoodD10aGlzLnRvU2Vjb25kcyh0KSx0PU1hdGgubWF4KHQsdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lKSksdGhpcy5fc3luY2VkKXt2YXIgZT1zLmRlZmF1bHQuVHJhbnNwb3J0LnNjaGVkdWxlKHRoaXMuX3N0b3AuYmluZCh0aGlzKSx0KTt0aGlzLl9zY2hlZHVsZWQucHVzaChlKX1lbHNlIHRoaXMuX3N0b3AuYXBwbHkodGhpcyxhcmd1bWVudHMpO3JldHVybiB0aGlzLl9zdGF0ZS5jYW5jZWwodCksdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQsdCksdGhpc30scy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuc3luYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zeW5jZWQ9ITAsdGhpcy5fc3luY2VkU3RhcnQ9ZnVuY3Rpb24odCxlKXtpZihlPjApe3ZhciBpPXRoaXMuX3N0YXRlLmdldChlKTtpZihpJiZpLnN0YXRlPT09cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQmJmkudGltZSE9PWUpe3ZhciBuLG89ZS10aGlzLnRvU2Vjb25kcyhpLnRpbWUpO2kuZHVyYXRpb24mJihuPXRoaXMudG9TZWNvbmRzKGkuZHVyYXRpb24pLW8pLHRoaXMuX3N0YXJ0KHQsdGhpcy50b1NlY29uZHMoaS5vZmZzZXQpK28sbil9fX0uYmluZCh0aGlzKSx0aGlzLl9zeW5jZWRTdG9wPWZ1bmN0aW9uKHQpe3ZhciBlPXMuZGVmYXVsdC5UcmFuc3BvcnQuZ2V0U2Vjb25kc0F0VGltZShNYXRoLm1heCh0LXRoaXMuc2FtcGxlVGltZSwwKSk7dGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUoZSk9PT1zLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCYmdGhpcy5fc3RvcCh0KX0uYmluZCh0aGlzKSxzLmRlZmF1bHQuVHJhbnNwb3J0Lm9uKFwic3RhcnQgbG9vcFN0YXJ0XCIsdGhpcy5fc3luY2VkU3RhcnQpLHMuZGVmYXVsdC5UcmFuc3BvcnQub24oXCJzdG9wIHBhdXNlIGxvb3BFbmRcIix0aGlzLl9zeW5jZWRTdG9wKSx0aGlzfSxzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZS51bnN5bmM9ZnVuY3Rpb24oKXt0aGlzLl9zeW5jZWQmJihzLmRlZmF1bHQuVHJhbnNwb3J0Lm9mZihcInN0b3AgcGF1c2UgbG9vcEVuZFwiLHRoaXMuX3N5bmNlZFN0b3ApLHMuZGVmYXVsdC5UcmFuc3BvcnQub2ZmKFwic3RhcnQgbG9vcFN0YXJ0XCIsdGhpcy5fc3luY2VkU3RhcnQpKSx0aGlzLl9zeW5jZWQ9ITE7Zm9yKHZhciB0PTA7dDx0aGlzLl9zY2hlZHVsZWQubGVuZ3RoO3QrKyl7dmFyIGU9dGhpcy5fc2NoZWR1bGVkW3RdO3MuZGVmYXVsdC5UcmFuc3BvcnQuY2xlYXIoZSl9cmV0dXJuIHRoaXMuX3NjaGVkdWxlZD1bXSx0aGlzLl9zdGF0ZS5jYW5jZWwoMCksdGhpc30scy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLnVuc3luYygpLHRoaXMuX3NjaGVkdWxlZD1udWxsLHRoaXMuX3dyaXRhYmxlKFwidm9sdW1lXCIpLHRoaXMuX3ZvbHVtZS5kaXNwb3NlKCksdGhpcy5fdm9sdW1lPW51bGwsdGhpcy52b2x1bWU9bnVsbCx0aGlzLl9zdGF0ZS5kaXNwb3NlKCksdGhpcy5fc3RhdGU9bnVsbH0sZS5kZWZhdWx0PXMuZGVmYXVsdC5Tb3VyY2V9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDMwKSxpKDQ0KTtpZihzLmRlZmF1bHQuc3VwcG9ydGVkJiYhcy5kZWZhdWx0Lmdsb2JhbC5BdWRpb0NvbnRleHQucHJvdG90eXBlLl9uYXRpdmVfY3JlYXRlV2F2ZVNoYXBlcil7dmFyIG49bmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO2lmKG4uaW5jbHVkZXMoXCJzYWZhcmlcIikmJiFuLmluY2x1ZGVzKFwiY2hyb21lXCIpKXt2YXIgbz1mdW5jdGlvbih0KXtmb3IodmFyIGUgaW4gdGhpcy5faW50ZXJuYWxOb2RlPXRoaXMuaW5wdXQ9dGhpcy5vdXRwdXQ9dC5fbmF0aXZlX2NyZWF0ZVdhdmVTaGFwZXIoKSx0aGlzLl9jdXJ2ZT1udWxsLHRoaXMuX2ludGVybmFsTm9kZSl0aGlzLl9kZWZpbmVQcm9wZXJ0eSh0aGlzLl9pbnRlcm5hbE5vZGUsZSl9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShvLnByb3RvdHlwZSxcImN1cnZlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jdXJ2ZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2N1cnZlPXQ7dmFyIGU9bmV3IEZsb2F0MzJBcnJheSh0Lmxlbmd0aCsxKTtlLnNldCh0LDEpLGVbMF09dFswXSx0aGlzLl9pbnRlcm5hbE5vZGUuY3VydmU9ZX19KSxvLnByb3RvdHlwZS5fZGVmaW5lUHJvcGVydHk9ZnVuY3Rpb24odCxlKXtzLmRlZmF1bHQuaXNVbmRlZih0aGlzW2VdKSYmT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsZSx7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgdFtlXT90W2VdLmJpbmQodCk6dFtlXX0sc2V0OmZ1bmN0aW9uKGkpe3RbZV09aX19KX0scy5kZWZhdWx0Lmdsb2JhbC5BdWRpb0NvbnRleHQucHJvdG90eXBlLl9uYXRpdmVfY3JlYXRlV2F2ZVNoYXBlcj1zLmRlZmF1bHQuZ2xvYmFsLkF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlV2F2ZVNoYXBlcixzLmRlZmF1bHQuZ2xvYmFsLkF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlV2F2ZVNoYXBlcj1mdW5jdGlvbigpe3JldHVybiBuZXcgbyh0aGlzKX19fXMuZGVmYXVsdC5XYXZlU2hhcGVyPWZ1bmN0aW9uKHQsZSl7cy5kZWZhdWx0LlNpZ25hbEJhc2UuY2FsbCh0aGlzKSx0aGlzLl9zaGFwZXI9dGhpcy5pbnB1dD10aGlzLm91dHB1dD10aGlzLmNvbnRleHQuY3JlYXRlV2F2ZVNoYXBlcigpLHRoaXMuX2N1cnZlPW51bGwsQXJyYXkuaXNBcnJheSh0KT90aGlzLmN1cnZlPXQ6aXNGaW5pdGUodCl8fHMuZGVmYXVsdC5pc1VuZGVmKHQpP3RoaXMuX2N1cnZlPW5ldyBGbG9hdDMyQXJyYXkocy5kZWZhdWx0LmRlZmF1bHRBcmcodCwxMDI0KSk6cy5kZWZhdWx0LmlzRnVuY3Rpb24odCkmJih0aGlzLl9jdXJ2ZT1uZXcgRmxvYXQzMkFycmF5KHMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsMTAyNCkpLHRoaXMuc2V0TWFwKHQpKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuV2F2ZVNoYXBlcixzLmRlZmF1bHQuU2lnbmFsQmFzZSkscy5kZWZhdWx0LldhdmVTaGFwZXIucHJvdG90eXBlLnNldE1hcD1mdW5jdGlvbih0KXtmb3IodmFyIGU9bmV3IEFycmF5KHRoaXMuX2N1cnZlLmxlbmd0aCksaT0wLHM9dGhpcy5fY3VydmUubGVuZ3RoO2k8cztpKyspe3ZhciBuPWkvKHMtMSkqMi0xO2VbaV09dChuLGkpfXJldHVybiB0aGlzLmN1cnZlPWUsdGhpc30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5XYXZlU2hhcGVyLnByb3RvdHlwZSxcImN1cnZlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zaGFwZXIuY3VydmV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9jdXJ2ZT1uZXcgRmxvYXQzMkFycmF5KHQpLHRoaXMuX3NoYXBlci5jdXJ2ZT10aGlzLl9jdXJ2ZX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LldhdmVTaGFwZXIucHJvdG90eXBlLFwib3ZlcnNhbXBsZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2hhcGVyLm92ZXJzYW1wbGV9LHNldDpmdW5jdGlvbih0KXtpZighW1wibm9uZVwiLFwiMnhcIixcIjR4XCJdLmluY2x1ZGVzKHQpKXRocm93IG5ldyBSYW5nZUVycm9yKFwiVG9uZS5XYXZlU2hhcGVyOiBvdmVyc2FtcGxpbmcgbXVzdCBiZSBlaXRoZXIgJ25vbmUnLCAnMngnLCBvciAnNHgnXCIpO3RoaXMuX3NoYXBlci5vdmVyc2FtcGxlPXR9fSkscy5kZWZhdWx0LldhdmVTaGFwZXIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9zaGFwZXIuZGlzY29ubmVjdCgpLHRoaXMuX3NoYXBlcj1udWxsLHRoaXMuX2N1cnZlPW51bGwsdGhpc307ZS5kZWZhdWx0PXMuZGVmYXVsdC5XYXZlU2hhcGVyfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyMyksaSgxKTtzLmRlZmF1bHQuRWZmZWN0PWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJ3ZXRcIl0scy5kZWZhdWx0LkVmZmVjdCk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuY3JlYXRlSW5zT3V0cygxLDEpLHRoaXMuX2RyeVdldD1uZXcgcy5kZWZhdWx0LkNyb3NzRmFkZSh0LndldCksdGhpcy53ZXQ9dGhpcy5fZHJ5V2V0LmZhZGUsdGhpcy5lZmZlY3RTZW5kPW5ldyBzLmRlZmF1bHQuR2Fpbix0aGlzLmVmZmVjdFJldHVybj1uZXcgcy5kZWZhdWx0LkdhaW4scy5kZWZhdWx0LmNvbm5lY3QodGhpcy5pbnB1dCx0aGlzLl9kcnlXZXQuYSkscy5kZWZhdWx0LmNvbm5lY3QodGhpcy5pbnB1dCx0aGlzLmVmZmVjdFNlbmQpLHRoaXMuZWZmZWN0UmV0dXJuLmNvbm5lY3QodGhpcy5fZHJ5V2V0LmIpLHRoaXMuX2RyeVdldC5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLl9yZWFkT25seShbXCJ3ZXRcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5FZmZlY3Qscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LkVmZmVjdC5kZWZhdWx0cz17d2V0OjF9LHMuZGVmYXVsdC5FZmZlY3QucHJvdG90eXBlLmNvbm5lY3RFZmZlY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuZWZmZWN0U2VuZC5jaGFpbih0LHRoaXMuZWZmZWN0UmV0dXJuKSx0aGlzfSxzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9kcnlXZXQuZGlzcG9zZSgpLHRoaXMuX2RyeVdldD1udWxsLHRoaXMuZWZmZWN0U2VuZC5kaXNwb3NlKCksdGhpcy5lZmZlY3RTZW5kPW51bGwsdGhpcy5lZmZlY3RSZXR1cm4uZGlzcG9zZSgpLHRoaXMuZWZmZWN0UmV0dXJuPW51bGwsdGhpcy5fd3JpdGFibGUoW1wid2V0XCJdKSx0aGlzLndldD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRWZmZWN0fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyKSxpKDEpO3MuZGVmYXVsdC5GaWx0ZXI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiLFwicm9sbG9mZlwiXSxzLmRlZmF1bHQuRmlsdGVyKTtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5jcmVhdGVJbnNPdXRzKDEsMSksdGhpcy5fZmlsdGVycz1bXSx0aGlzLmZyZXF1ZW5jeT1uZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmZyZXF1ZW5jeSxzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kpLHRoaXMuZGV0dW5lPW5ldyBzLmRlZmF1bHQuU2lnbmFsKDAscy5kZWZhdWx0LlR5cGUuQ2VudHMpLHRoaXMuZ2Fpbj1uZXcgcy5kZWZhdWx0LlNpZ25hbCh7dmFsdWU6dC5nYWluLGNvbnZlcnQ6ITAsdHlwZTpzLmRlZmF1bHQuVHlwZS5EZWNpYmVsc30pLHRoaXMuUT1uZXcgcy5kZWZhdWx0LlNpZ25hbCh0LlEpLHRoaXMuX3R5cGU9dC50eXBlLHRoaXMuX3JvbGxvZmY9dC5yb2xsb2ZmLHRoaXMucm9sbG9mZj10LnJvbGxvZmYsdGhpcy5fcmVhZE9ubHkoW1wiZGV0dW5lXCIsXCJmcmVxdWVuY3lcIixcImdhaW5cIixcIlFcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5GaWx0ZXIscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LkZpbHRlci5kZWZhdWx0cz17dHlwZTpcImxvd3Bhc3NcIixmcmVxdWVuY3k6MzUwLHJvbGxvZmY6LTEyLFE6MSxnYWluOjB9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRmlsdGVyLnByb3RvdHlwZSxcInR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3R5cGV9LHNldDpmdW5jdGlvbih0KXtpZigtMT09PVtcImxvd3Bhc3NcIixcImhpZ2hwYXNzXCIsXCJiYW5kcGFzc1wiLFwibG93c2hlbGZcIixcImhpZ2hzaGVsZlwiLFwibm90Y2hcIixcImFsbHBhc3NcIixcInBlYWtpbmdcIl0uaW5kZXhPZih0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiVG9uZS5GaWx0ZXI6IGludmFsaWQgdHlwZSBcIit0KTt0aGlzLl90eXBlPXQ7Zm9yKHZhciBlPTA7ZTx0aGlzLl9maWx0ZXJzLmxlbmd0aDtlKyspdGhpcy5fZmlsdGVyc1tlXS50eXBlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GaWx0ZXIucHJvdG90eXBlLFwicm9sbG9mZlwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcm9sbG9mZn0sc2V0OmZ1bmN0aW9uKHQpe3Q9cGFyc2VJbnQodCwxMCk7dmFyIGU9Wy0xMiwtMjQsLTQ4LC05Nl0uaW5kZXhPZih0KTtpZigtMT09PWUpdGhyb3cgbmV3IFJhbmdlRXJyb3IoXCJUb25lLkZpbHRlcjogcm9sbG9mZiBjYW4gb25seSBiZSAtMTIsIC0yNCwgLTQ4IG9yIC05NlwiKTtlKz0xLHRoaXMuX3JvbGxvZmY9dCx0aGlzLmlucHV0LmRpc2Nvbm5lY3QoKTtmb3IodmFyIGk9MDtpPHRoaXMuX2ZpbHRlcnMubGVuZ3RoO2krKyl0aGlzLl9maWx0ZXJzW2ldLmRpc2Nvbm5lY3QoKSx0aGlzLl9maWx0ZXJzW2ldPW51bGw7dGhpcy5fZmlsdGVycz1uZXcgQXJyYXkoZSk7Zm9yKHZhciBuPTA7bjxlO24rKyl7dmFyIG89dGhpcy5jb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO28udHlwZT10aGlzLl90eXBlLHRoaXMuZnJlcXVlbmN5LmNvbm5lY3Qoby5mcmVxdWVuY3kpLHRoaXMuZGV0dW5lLmNvbm5lY3Qoby5kZXR1bmUpLHRoaXMuUS5jb25uZWN0KG8uUSksdGhpcy5nYWluLmNvbm5lY3Qoby5nYWluKSx0aGlzLl9maWx0ZXJzW25dPW99dmFyIGE9W3RoaXMuaW5wdXRdLmNvbmNhdCh0aGlzLl9maWx0ZXJzKS5jb25jYXQoW3RoaXMub3V0cHV0XSk7cy5kZWZhdWx0LmNvbm5lY3RTZXJpZXMuYXBwbHkocy5kZWZhdWx0LGEpfX0pLHMuZGVmYXVsdC5GaWx0ZXIucHJvdG90eXBlLmdldEZyZXF1ZW5jeVJlc3BvbnNlPWZ1bmN0aW9uKHQpe3Q9cy5kZWZhdWx0LmRlZmF1bHRBcmcodCwxMjgpO2Zvcih2YXIgZT1uZXcgRmxvYXQzMkFycmF5KHQpLm1hcChmdW5jdGlvbigpe3JldHVybiAxfSksaT1uZXcgRmxvYXQzMkFycmF5KHQpLG49MDtuPHQ7bisrKXt2YXIgbz0xOTk4MCpNYXRoLnBvdyhuL3QsMikrMjA7aVtuXT1vfXZhciBhPW5ldyBGbG9hdDMyQXJyYXkodCkscj1uZXcgRmxvYXQzMkFycmF5KHQpO3JldHVybiB0aGlzLl9maWx0ZXJzLmZvckVhY2goZnVuY3Rpb24oKXt2YXIgdD10aGlzLmNvbnRleHQuY3JlYXRlQmlxdWFkRmlsdGVyKCk7dC50eXBlPXRoaXMuX3R5cGUsdC5RLnZhbHVlPXRoaXMuUS52YWx1ZSx0LmZyZXF1ZW5jeS52YWx1ZT10aGlzLmZyZXF1ZW5jeS52YWx1ZSx0LmdhaW4udmFsdWU9dGhpcy5nYWluLnZhbHVlLHQuZ2V0RnJlcXVlbmN5UmVzcG9uc2UoaSxhLHIpLGEuZm9yRWFjaChmdW5jdGlvbih0LGkpe2VbaV0qPXR9KX0uYmluZCh0aGlzKSksZX0scy5kZWZhdWx0LkZpbHRlci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKTtmb3IodmFyIHQ9MDt0PHRoaXMuX2ZpbHRlcnMubGVuZ3RoO3QrKyl0aGlzLl9maWx0ZXJzW3RdLmRpc2Nvbm5lY3QoKSx0aGlzLl9maWx0ZXJzW3RdPW51bGw7cmV0dXJuIHRoaXMuX2ZpbHRlcnM9bnVsbCx0aGlzLl93cml0YWJsZShbXCJkZXR1bmVcIixcImZyZXF1ZW5jeVwiLFwiZ2FpblwiLFwiUVwiXSksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuUS5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3k9bnVsbCx0aGlzLlE9bnVsbCx0aGlzLmRldHVuZS5kaXNwb3NlKCksdGhpcy5kZXR1bmU9bnVsbCx0aGlzLmdhaW4uZGlzcG9zZSgpLHRoaXMuZ2Fpbj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRmlsdGVyfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgxKTtzLmRlZmF1bHQuTWVyZ2U9ZnVuY3Rpb24odCl7dD1zLmRlZmF1bHQuZGVmYXVsdEFyZyh0LDIpLHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSx0aGlzLmNyZWF0ZUluc091dHModCwwKSx0aGlzLl9tZXJnZXI9dGhpcy5vdXRwdXQ9dGhpcy5jb250ZXh0LmNyZWF0ZUNoYW5uZWxNZXJnZXIodCk7Zm9yKHZhciBlPTA7ZTx0O2UrKyl0aGlzLmlucHV0W2VdPW5ldyBzLmRlZmF1bHQuR2Fpbix0aGlzLmlucHV0W2VdLmNvbm5lY3QodGhpcy5fbWVyZ2VyLDAsZSksdGhpcy5pbnB1dFtlXS5jaGFubmVsQ291bnQ9MSx0aGlzLmlucHV0W2VdLmNoYW5uZWxDb3VudE1vZGU9XCJleHBsaWNpdFwiO3RoaXMubGVmdD10aGlzLmlucHV0WzBdLHRoaXMucmlnaHQ9dGhpcy5pbnB1dFsxXX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTWVyZ2Uscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0Lk1lcmdlLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5wdXQuZm9yRWFjaChmdW5jdGlvbih0KXt0LmRpc3Bvc2UoKX0pLHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLmxlZnQ9bnVsbCx0aGlzLnJpZ2h0PW51bGwsdGhpcy5fbWVyZ2VyLmRpc2Nvbm5lY3QoKSx0aGlzLl9tZXJnZXI9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lk1lcmdlfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgzNSksaSg0KTtzLmRlZmF1bHQuc3VwcG9ydGVkJiYoQXVkaW9CdWZmZXIucHJvdG90eXBlLmNvcHlUb0NoYW5uZWx8fChBdWRpb0J1ZmZlci5wcm90b3R5cGUuY29weVRvQ2hhbm5lbD1mdW5jdGlvbih0LGUsaSl7dmFyIHM9dGhpcy5nZXRDaGFubmVsRGF0YShlKTtpPWl8fDA7Zm9yKHZhciBuPTA7bjxzLmxlbmd0aDtuKyspc1tuK2ldPXRbbl19LEF1ZGlvQnVmZmVyLnByb3RvdHlwZS5jb3B5RnJvbUNoYW5uZWw9ZnVuY3Rpb24odCxlLGkpe3ZhciBzPXRoaXMuZ2V0Q2hhbm5lbERhdGEoZSk7aT1pfHwwO2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKXRbbl09c1tuK2ldfSkpLHMuZGVmYXVsdC5CdWZmZXI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInVybFwiLFwib25sb2FkXCIsXCJvbmVycm9yXCJdLHMuZGVmYXVsdC5CdWZmZXIpO3MuZGVmYXVsdC5jYWxsKHRoaXMpLHRoaXMuX2J1ZmZlcj1udWxsLHRoaXMuX3JldmVyc2VkPXQucmV2ZXJzZSx0aGlzLl94aHI9bnVsbCx0aGlzLm9ubG9hZD1zLmRlZmF1bHQubm9PcCx0LnVybCBpbnN0YW5jZW9mIEF1ZGlvQnVmZmVyfHx0LnVybCBpbnN0YW5jZW9mIHMuZGVmYXVsdC5CdWZmZXI/KHRoaXMuc2V0KHQudXJsKSx0aGlzLmxvYWRlZHx8KHRoaXMub25sb2FkPXQub25sb2FkKSk6cy5kZWZhdWx0LmlzU3RyaW5nKHQudXJsKSYmdGhpcy5sb2FkKHQudXJsKS50aGVuKHQub25sb2FkKS5jYXRjaCh0Lm9uZXJyb3IpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5CdWZmZXIpLHMuZGVmYXVsdC5CdWZmZXIuZGVmYXVsdHM9e3VybDp2b2lkIDAscmV2ZXJzZTohMSxvbmxvYWQ6cy5kZWZhdWx0Lm5vT3Asb25lcnJvcjpzLmRlZmF1bHQubm9PcH0scy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUuc2V0PWZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2Ygcy5kZWZhdWx0LkJ1ZmZlcj90LmxvYWRlZD90aGlzLl9idWZmZXI9dC5nZXQoKTp0Lm9ubG9hZD1mdW5jdGlvbigpe3RoaXMuc2V0KHQpLHRoaXMub25sb2FkKHRoaXMpfS5iaW5kKHRoaXMpOnRoaXMuX2J1ZmZlcj10LHRoaXMuX3JldmVyc2VkJiZ0aGlzLl9yZXZlcnNlKCksdGhpc30scy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlcn0scy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUubG9hZD1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKG4sbyl7dGhpcy5feGhyPXMuZGVmYXVsdC5CdWZmZXIubG9hZCh0LGZ1bmN0aW9uKHQpe3RoaXMuX3hocj1udWxsLHRoaXMuc2V0KHQpLG4odGhpcyksdGhpcy5vbmxvYWQodGhpcyksZSYmZSh0aGlzKX0uYmluZCh0aGlzKSxmdW5jdGlvbih0KXtpZih0aGlzLl94aHI9bnVsbCxvKHQpLCFpKXRocm93IHQ7aSh0KX0uYmluZCh0aGlzKSl9LmJpbmQodGhpcykpfSxzLmRlZmF1bHQuQnVmZmVyLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX2J1ZmZlcj1udWxsLHRoaXMuX3hociYmKHMuZGVmYXVsdC5CdWZmZXIuX3JlbW92ZUZyb21Eb3dubG9hZFF1ZXVlKHRoaXMuX3hociksdGhpcy5feGhyLmFib3J0KCksdGhpcy5feGhyPW51bGwpLHRoaXN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQnVmZmVyLnByb3RvdHlwZSxcImxvYWRlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sZW5ndGg+MH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUsXCJkdXJhdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYnVmZmVyP3RoaXMuX2J1ZmZlci5kdXJhdGlvbjowfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQnVmZmVyLnByb3RvdHlwZSxcImxlbmd0aFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYnVmZmVyP3RoaXMuX2J1ZmZlci5sZW5ndGg6MH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUsXCJudW1iZXJPZkNoYW5uZWxzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9idWZmZXI/dGhpcy5fYnVmZmVyLm51bWJlck9mQ2hhbm5lbHM6MH19KSxzLmRlZmF1bHQuQnVmZmVyLnByb3RvdHlwZS5mcm9tQXJyYXk9ZnVuY3Rpb24odCl7dmFyIGU9dFswXS5sZW5ndGg+MCxpPWU/dC5sZW5ndGg6MSxzPWU/dFswXS5sZW5ndGg6dC5sZW5ndGgsbj10aGlzLmNvbnRleHQuY3JlYXRlQnVmZmVyKGkscyx0aGlzLmNvbnRleHQuc2FtcGxlUmF0ZSk7ZXx8MSE9PWl8fCh0PVt0XSk7Zm9yKHZhciBvPTA7bzxpO28rKyluLmNvcHlUb0NoYW5uZWwodFtvXSxvKTtyZXR1cm4gdGhpcy5fYnVmZmVyPW4sdGhpc30scy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUudG9Nb25vPWZ1bmN0aW9uKHQpe2lmKHMuZGVmYXVsdC5pc051bWJlcih0KSl0aGlzLmZyb21BcnJheSh0aGlzLnRvQXJyYXkodCkpO2Vsc2V7Zm9yKHZhciBlPW5ldyBGbG9hdDMyQXJyYXkodGhpcy5sZW5ndGgpLGk9dGhpcy5udW1iZXJPZkNoYW5uZWxzLG49MDtuPGk7bisrKWZvcih2YXIgbz10aGlzLnRvQXJyYXkobiksYT0wO2E8by5sZW5ndGg7YSsrKWVbYV0rPW9bYV07ZT1lLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdC9pfSksdGhpcy5mcm9tQXJyYXkoZSl9cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLnRvQXJyYXk9ZnVuY3Rpb24odCl7aWYocy5kZWZhdWx0LmlzTnVtYmVyKHQpKXJldHVybiB0aGlzLmdldENoYW5uZWxEYXRhKHQpO2lmKDE9PT10aGlzLm51bWJlck9mQ2hhbm5lbHMpcmV0dXJuIHRoaXMudG9BcnJheSgwKTtmb3IodmFyIGU9W10saT0wO2k8dGhpcy5udW1iZXJPZkNoYW5uZWxzO2krKyllW2ldPXRoaXMuZ2V0Q2hhbm5lbERhdGEoaSk7cmV0dXJuIGV9LHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLmdldENoYW5uZWxEYXRhPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9idWZmZXIuZ2V0Q2hhbm5lbERhdGEodCl9LHMuZGVmYXVsdC5CdWZmZXIucHJvdG90eXBlLnNsaWNlPWZ1bmN0aW9uKHQsZSl7ZT1zLmRlZmF1bHQuZGVmYXVsdEFyZyhlLHRoaXMuZHVyYXRpb24pO2Zvcih2YXIgaT1NYXRoLmZsb29yKHRoaXMuY29udGV4dC5zYW1wbGVSYXRlKnRoaXMudG9TZWNvbmRzKHQpKSxuPU1hdGguZmxvb3IodGhpcy5jb250ZXh0LnNhbXBsZVJhdGUqdGhpcy50b1NlY29uZHMoZSkpLG89W10sYT0wO2E8dGhpcy5udW1iZXJPZkNoYW5uZWxzO2ErKylvW2FdPXRoaXMudG9BcnJheShhKS5zbGljZShpLG4pO3JldHVybihuZXcgcy5kZWZhdWx0LkJ1ZmZlcikuZnJvbUFycmF5KG8pfSxzLmRlZmF1bHQuQnVmZmVyLnByb3RvdHlwZS5fcmV2ZXJzZT1mdW5jdGlvbigpe2lmKHRoaXMubG9hZGVkKWZvcih2YXIgdD0wO3Q8dGhpcy5udW1iZXJPZkNoYW5uZWxzO3QrKylBcnJheS5wcm90b3R5cGUucmV2ZXJzZS5jYWxsKHRoaXMuZ2V0Q2hhbm5lbERhdGEodCkpO3JldHVybiB0aGlzfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkJ1ZmZlci5wcm90b3R5cGUsXCJyZXZlcnNlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yZXZlcnNlZH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3JldmVyc2VkIT09dCYmKHRoaXMuX3JldmVyc2VkPXQsdGhpcy5fcmV2ZXJzZSgpKX19KSxzLmRlZmF1bHQuRW1pdHRlci5taXhpbihzLmRlZmF1bHQuQnVmZmVyKSxzLmRlZmF1bHQuQnVmZmVyLl9kb3dubG9hZFF1ZXVlPVtdLHMuZGVmYXVsdC5CdWZmZXIuYmFzZVVybD1cIlwiLHMuZGVmYXVsdC5CdWZmZXIuZnJvbUFycmF5PWZ1bmN0aW9uKHQpe3JldHVybihuZXcgcy5kZWZhdWx0LkJ1ZmZlcikuZnJvbUFycmF5KHQpfSxzLmRlZmF1bHQuQnVmZmVyLmZyb21Vcmw9ZnVuY3Rpb24odCl7dmFyIGU9bmV3IHMuZGVmYXVsdC5CdWZmZXI7cmV0dXJuIGUubG9hZCh0KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIGV9KX0scy5kZWZhdWx0LkJ1ZmZlci5fcmVtb3ZlRnJvbURvd25sb2FkUXVldWU9ZnVuY3Rpb24odCl7dmFyIGU9cy5kZWZhdWx0LkJ1ZmZlci5fZG93bmxvYWRRdWV1ZS5pbmRleE9mKHQpOy0xIT09ZSYmcy5kZWZhdWx0LkJ1ZmZlci5fZG93bmxvYWRRdWV1ZS5zcGxpY2UoZSwxKX0scy5kZWZhdWx0LkJ1ZmZlci5sb2FkPWZ1bmN0aW9uKHQsZSxpKXtlPXMuZGVmYXVsdC5kZWZhdWx0QXJnKGUscy5kZWZhdWx0Lm5vT3ApO3ZhciBuPXQubWF0Y2goL1xcWyguK1xcfD8pK1xcXSQvKTtpZihuKXtmb3IodmFyIG89blsxXS5zcGxpdChcInxcIiksYT1vWzBdLHI9MDtyPG8ubGVuZ3RoO3IrKylpZihzLmRlZmF1bHQuQnVmZmVyLnN1cHBvcnRzVHlwZShvW3JdKSl7YT1vW3JdO2JyZWFrfXQ9dC5yZXBsYWNlKG5bMF0sYSl9ZnVuY3Rpb24gbCh0KXtpZihzLmRlZmF1bHQuQnVmZmVyLl9yZW1vdmVGcm9tRG93bmxvYWRRdWV1ZShmKSxzLmRlZmF1bHQuQnVmZmVyLmVtaXQoXCJlcnJvclwiLHQpLCFpKXRocm93IHQ7aSh0KX1mdW5jdGlvbiB1KCl7Zm9yKHZhciB0PTAsZT0wO2U8cy5kZWZhdWx0LkJ1ZmZlci5fZG93bmxvYWRRdWV1ZS5sZW5ndGg7ZSsrKXQrPXMuZGVmYXVsdC5CdWZmZXIuX2Rvd25sb2FkUXVldWVbZV0ucHJvZ3Jlc3M7cy5kZWZhdWx0LkJ1ZmZlci5lbWl0KFwicHJvZ3Jlc3NcIix0L3MuZGVmYXVsdC5CdWZmZXIuX2Rvd25sb2FkUXVldWUubGVuZ3RoKX12YXIgZj1uZXcgWE1MSHR0cFJlcXVlc3Q7cmV0dXJuIGYub3BlbihcIkdFVFwiLHMuZGVmYXVsdC5CdWZmZXIuYmFzZVVybCt0LCEwKSxmLnJlc3BvbnNlVHlwZT1cImFycmF5YnVmZmVyXCIsZi5wcm9ncmVzcz0wLHMuZGVmYXVsdC5CdWZmZXIuX2Rvd25sb2FkUXVldWUucHVzaChmKSxmLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsZnVuY3Rpb24oKXsyMDA9PT1mLnN0YXR1cz9zLmRlZmF1bHQuY29udGV4dC5kZWNvZGVBdWRpb0RhdGEoZi5yZXNwb25zZSkudGhlbihmdW5jdGlvbih0KXtmLnByb2dyZXNzPTEsdSgpLGUodCkscy5kZWZhdWx0LkJ1ZmZlci5fcmVtb3ZlRnJvbURvd25sb2FkUXVldWUoZiksMD09PXMuZGVmYXVsdC5CdWZmZXIuX2Rvd25sb2FkUXVldWUubGVuZ3RoJiZzLmRlZmF1bHQuQnVmZmVyLmVtaXQoXCJsb2FkXCIpfSkuY2F0Y2goZnVuY3Rpb24oKXtzLmRlZmF1bHQuQnVmZmVyLl9yZW1vdmVGcm9tRG93bmxvYWRRdWV1ZShmKSxsKFwiVG9uZS5CdWZmZXI6IGNvdWxkIG5vdCBkZWNvZGUgYXVkaW8gZGF0YTogXCIrdCl9KTpsKFwiVG9uZS5CdWZmZXI6IGNvdWxkIG5vdCBsb2NhdGUgZmlsZTogXCIrdCl9KSxmLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLGwpLGYuYWRkRXZlbnRMaXN0ZW5lcihcInByb2dyZXNzXCIsZnVuY3Rpb24odCl7dC5sZW5ndGhDb21wdXRhYmxlJiYoZi5wcm9ncmVzcz10LmxvYWRlZC90LnRvdGFsKi45NSx1KCkpfSksZi5zZW5kKCksZn0scy5kZWZhdWx0LkJ1ZmZlci5jYW5jZWxEb3dubG9hZHM9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkJ1ZmZlci5fZG93bmxvYWRRdWV1ZS5zbGljZSgpLmZvckVhY2goZnVuY3Rpb24odCl7cy5kZWZhdWx0LkJ1ZmZlci5fcmVtb3ZlRnJvbURvd25sb2FkUXVldWUodCksdC5hYm9ydCgpfSkscy5kZWZhdWx0LkJ1ZmZlcn0scy5kZWZhdWx0LkJ1ZmZlci5zdXBwb3J0c1R5cGU9ZnVuY3Rpb24odCl7dmFyIGU9dC5zcGxpdChcIi5cIik7cmV0dXJuIGU9ZVtlLmxlbmd0aC0xXSxcIlwiIT09ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImF1ZGlvXCIpLmNhblBsYXlUeXBlKFwiYXVkaW8vXCIrZSl9LHMuZGVmYXVsdC5sb2FkZWQ9ZnVuY3Rpb24oKXt2YXIgdCxlO2Z1bmN0aW9uIGkoKXtzLmRlZmF1bHQuQnVmZmVyLm9mZihcImxvYWRcIix0KSxzLmRlZmF1bHQuQnVmZmVyLm9mZihcImVycm9yXCIsZSl9cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGksbil7dD1mdW5jdGlvbigpe2koKX0sZT1mdW5jdGlvbigpe24oKX0scy5kZWZhdWx0LkJ1ZmZlci5vbihcImxvYWRcIix0KSxzLmRlZmF1bHQuQnVmZmVyLm9uKFwiZXJyb3JcIixlKX0pLnRoZW4oaSkuY2F0Y2goZnVuY3Rpb24odCl7dGhyb3cgaSgpLG5ldyBFcnJvcih0KX0pfTtlLmRlZmF1bHQ9cy5kZWZhdWx0LkJ1ZmZlcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTcpLGkoMjYpLGkoMSksaSgyKSxpKDIyKSxpKDQpLGkoMjgpO3MuZGVmYXVsdC5MRk89ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwibWluXCIsXCJtYXhcIl0scy5kZWZhdWx0LkxGTyk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuX29zY2lsbGF0b3I9bmV3IHMuZGVmYXVsdC5Pc2NpbGxhdG9yKHtmcmVxdWVuY3k6dC5mcmVxdWVuY3ksdHlwZTp0LnR5cGV9KSx0aGlzLmZyZXF1ZW5jeT10aGlzLl9vc2NpbGxhdG9yLmZyZXF1ZW5jeSx0aGlzLmFtcGxpdHVkZT10aGlzLl9vc2NpbGxhdG9yLnZvbHVtZSx0aGlzLmFtcGxpdHVkZS51bml0cz1zLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSx0aGlzLmFtcGxpdHVkZS52YWx1ZT10LmFtcGxpdHVkZSx0aGlzLl9zdG9wcGVkU2lnbmFsPW5ldyBzLmRlZmF1bHQuU2lnbmFsKDAscy5kZWZhdWx0LlR5cGUuQXVkaW9SYW5nZSksdGhpcy5femVyb3M9bmV3IHMuZGVmYXVsdC5aZXJvLHRoaXMuX3N0b3BwZWRWYWx1ZT0wLHRoaXMuX2EyZz1uZXcgcy5kZWZhdWx0LkF1ZGlvVG9HYWluLHRoaXMuX3NjYWxlcj10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LlNjYWxlKHQubWluLHQubWF4KSx0aGlzLl91bml0cz1zLmRlZmF1bHQuVHlwZS5EZWZhdWx0LHRoaXMudW5pdHM9dC51bml0cyx0aGlzLl9vc2NpbGxhdG9yLmNoYWluKHRoaXMuX2EyZyx0aGlzLl9zY2FsZXIpLHRoaXMuX3plcm9zLmNvbm5lY3QodGhpcy5fYTJnKSx0aGlzLl9zdG9wcGVkU2lnbmFsLmNvbm5lY3QodGhpcy5fYTJnKSx0aGlzLl9yZWFkT25seShbXCJhbXBsaXR1ZGVcIixcImZyZXF1ZW5jeVwiXSksdGhpcy5waGFzZT10LnBoYXNlfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5MRk8scy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LkxGTy5kZWZhdWx0cz17dHlwZTpcInNpbmVcIixtaW46MCxtYXg6MSxwaGFzZTowLGZyZXF1ZW5jeTpcIjRuXCIsYW1wbGl0dWRlOjEsdW5pdHM6cy5kZWZhdWx0LlR5cGUuRGVmYXVsdH0scy5kZWZhdWx0LkxGTy5wcm90b3R5cGUuc3RhcnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5fc3RvcHBlZFNpZ25hbC5zZXRWYWx1ZUF0VGltZSgwLHQpLHRoaXMuX29zY2lsbGF0b3Iuc3RhcnQodCksdGhpc30scy5kZWZhdWx0LkxGTy5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbih0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9zdG9wcGVkU2lnbmFsLnNldFZhbHVlQXRUaW1lKHRoaXMuX3N0b3BwZWRWYWx1ZSx0KSx0aGlzLl9vc2NpbGxhdG9yLnN0b3AodCksdGhpc30scy5kZWZhdWx0LkxGTy5wcm90b3R5cGUuc3luYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yLnN5bmMoKSx0aGlzLl9vc2NpbGxhdG9yLnN5bmNGcmVxdWVuY3koKSx0aGlzfSxzLmRlZmF1bHQuTEZPLnByb3RvdHlwZS51bnN5bmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvci51bnN5bmMoKSx0aGlzLl9vc2NpbGxhdG9yLnVuc3luY0ZyZXF1ZW5jeSgpLHRoaXN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTEZPLnByb3RvdHlwZSxcIm1pblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdG9Vbml0cyh0aGlzLl9zY2FsZXIubWluKX0sc2V0OmZ1bmN0aW9uKHQpe3Q9dGhpcy5fZnJvbVVuaXRzKHQpLHRoaXMuX3NjYWxlci5taW49dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkxGTy5wcm90b3R5cGUsXCJtYXhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RvVW5pdHModGhpcy5fc2NhbGVyLm1heCl9LHNldDpmdW5jdGlvbih0KXt0PXRoaXMuX2Zyb21Vbml0cyh0KSx0aGlzLl9zY2FsZXIubWF4PXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MRk8ucHJvdG90eXBlLFwidHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvci50eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3NjaWxsYXRvci50eXBlPXQsdGhpcy5fc3RvcHBlZFZhbHVlPXRoaXMuX29zY2lsbGF0b3IuX2dldEluaXRpYWxWYWx1ZSgpLHRoaXMuX3N0b3BwZWRTaWduYWwudmFsdWU9dGhpcy5fc3RvcHBlZFZhbHVlfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTEZPLnByb3RvdHlwZSxcInBoYXNlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yLnBoYXNlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3NjaWxsYXRvci5waGFzZT10LHRoaXMuX3N0b3BwZWRWYWx1ZT10aGlzLl9vc2NpbGxhdG9yLl9nZXRJbml0aWFsVmFsdWUoKSx0aGlzLl9zdG9wcGVkU2lnbmFsLnZhbHVlPXRoaXMuX3N0b3BwZWRWYWx1ZX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkxGTy5wcm90b3R5cGUsXCJ1bml0c1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdW5pdHN9LHNldDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLm1pbixpPXRoaXMubWF4O3RoaXMuX3VuaXRzPXQsdGhpcy5taW49ZSx0aGlzLm1heD1pfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTEZPLnByb3RvdHlwZSxcInN0YXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yLnN0YXRlfX0pLHMuZGVmYXVsdC5MRk8ucHJvdG90eXBlLmNvbm5lY3Q9ZnVuY3Rpb24odCl7cmV0dXJuIHQuY29uc3RydWN0b3IhPT1zLmRlZmF1bHQuU2lnbmFsJiZ0LmNvbnN0cnVjdG9yIT09cy5kZWZhdWx0LlBhcmFtfHwodGhpcy5jb252ZXJ0PXQuY29udmVydCx0aGlzLnVuaXRzPXQudW5pdHMpLHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5jb25uZWN0LmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzfSxzLmRlZmF1bHQuTEZPLnByb3RvdHlwZS5fZnJvbVVuaXRzPXMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuX2Zyb21Vbml0cyxzLmRlZmF1bHQuTEZPLnByb3RvdHlwZS5fdG9Vbml0cz1zLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLl90b1VuaXRzLHMuZGVmYXVsdC5MRk8ucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3dyaXRhYmxlKFtcImFtcGxpdHVkZVwiLFwiZnJlcXVlbmN5XCJdKSx0aGlzLl9vc2NpbGxhdG9yLmRpc3Bvc2UoKSx0aGlzLl9vc2NpbGxhdG9yPW51bGwsdGhpcy5fc3RvcHBlZFNpZ25hbC5kaXNwb3NlKCksdGhpcy5fc3RvcHBlZFNpZ25hbD1udWxsLHRoaXMuX3plcm9zLmRpc3Bvc2UoKSx0aGlzLl96ZXJvcz1udWxsLHRoaXMuX3NjYWxlci5kaXNwb3NlKCksdGhpcy5fc2NhbGVyPW51bGwsdGhpcy5fYTJnLmRpc3Bvc2UoKSx0aGlzLl9hMmc9bnVsbCx0aGlzLmZyZXF1ZW5jeT1udWxsLHRoaXMuYW1wbGl0dWRlPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5MRk99LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDI5KSxpKDkwKSxpKDIpLGkoMyk7cy5kZWZhdWx0LlN1YnRyYWN0PWZ1bmN0aW9uKHQpe3MuZGVmYXVsdC5TaWduYWwuY2FsbCh0aGlzKSx0aGlzLmNyZWF0ZUluc091dHMoMiwwKSx0aGlzLl9zdW09dGhpcy5pbnB1dFswXT10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LkdhaW4sdGhpcy5fbmVnPW5ldyBzLmRlZmF1bHQuTmVnYXRlLHRoaXMuX3BhcmFtPXRoaXMuaW5wdXRbMV09bmV3IHMuZGVmYXVsdC5TaWduYWwodCksdGhpcy5fcGFyYW0uY2hhaW4odGhpcy5fbmVnLHRoaXMuX3N1bSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlN1YnRyYWN0LHMuZGVmYXVsdC5TaWduYWwpLHMuZGVmYXVsdC5TdWJ0cmFjdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fbmVnLmRpc3Bvc2UoKSx0aGlzLl9uZWc9bnVsbCx0aGlzLl9zdW0uZGlzY29ubmVjdCgpLHRoaXMuX3N1bT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuU3VidHJhY3R9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDQpLGkoMSksaSgyNCk7cy5kZWZhdWx0LlBhcmFtPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJwYXJhbVwiLFwidW5pdHNcIixcImNvbnZlcnRcIl0scy5kZWZhdWx0LlBhcmFtKTtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyx0KSx0aGlzLl9wYXJhbT10aGlzLmlucHV0PXQucGFyYW0sdGhpcy51bml0cz10LnVuaXRzLHRoaXMuY29udmVydD10LmNvbnZlcnQsdGhpcy5vdmVycmlkZGVuPSExLHRoaXMuX2V2ZW50cz1uZXcgcy5kZWZhdWx0LlRpbWVsaW5lKDFlMykscy5kZWZhdWx0LmlzRGVmaW5lZCh0LnZhbHVlKSYmdGhpcy5fcGFyYW0mJnRoaXMuc2V0VmFsdWVBdFRpbWUodC52YWx1ZSwwKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUGFyYW0scy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LlBhcmFtLmRlZmF1bHRzPXt1bml0czpzLmRlZmF1bHQuVHlwZS5EZWZhdWx0LGNvbnZlcnQ6ITAscGFyYW06dm9pZCAwfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZSxcInZhbHVlXCIse2dldDpmdW5jdGlvbigpe3ZhciB0PXRoaXMubm93KCk7cmV0dXJuIHRoaXMuX3RvVW5pdHModGhpcy5nZXRWYWx1ZUF0VGltZSh0KSl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9pbml0aWFsVmFsdWU9dGhpcy5fZnJvbVVuaXRzKHQpLHRoaXMuY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHRoaXMubm93KCkpLHRoaXMuc2V0VmFsdWVBdFRpbWUodCx0aGlzLm5vdygpKX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZSxcIm1pblZhbHVlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnVuaXRzPT09cy5kZWZhdWx0LlR5cGUuVGltZXx8dGhpcy51bml0cz09PXMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeXx8dGhpcy51bml0cz09PXMuZGVmYXVsdC5UeXBlLk5vcm1hbFJhbmdlfHx0aGlzLnVuaXRzPT09cy5kZWZhdWx0LlR5cGUuUG9zaXRpdmV8fHRoaXMudW5pdHM9PT1zLmRlZmF1bHQuVHlwZS5CUE0/MDp0aGlzLnVuaXRzPT09cy5kZWZhdWx0LlR5cGUuQXVkaW9SYW5nZT8tMTp0aGlzLnVuaXRzPT09cy5kZWZhdWx0LlR5cGUuRGVjaWJlbHM/LTEvMDp0aGlzLl9wYXJhbS5taW5WYWx1ZX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZSxcIm1heFZhbHVlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnVuaXRzPT09cy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2V8fHRoaXMudW5pdHM9PT1zLmRlZmF1bHQuVHlwZS5BdWRpb1JhbmdlPzE6dGhpcy5fcGFyYW0ubWF4VmFsdWV9fSkscy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5fZnJvbVVuaXRzPWZ1bmN0aW9uKHQpe2lmKCF0aGlzLmNvbnZlcnQmJiFzLmRlZmF1bHQuaXNVbmRlZih0aGlzLmNvbnZlcnQpfHx0aGlzLm92ZXJyaWRkZW4pcmV0dXJuIHQ7c3dpdGNoKHRoaXMudW5pdHMpe2Nhc2Ugcy5kZWZhdWx0LlR5cGUuVGltZTpyZXR1cm4gdGhpcy50b1NlY29uZHModCk7Y2FzZSBzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3k6cmV0dXJuIHRoaXMudG9GcmVxdWVuY3kodCk7Y2FzZSBzLmRlZmF1bHQuVHlwZS5EZWNpYmVsczpyZXR1cm4gcy5kZWZhdWx0LmRiVG9HYWluKHQpO2Nhc2Ugcy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2U6cmV0dXJuIE1hdGgubWluKE1hdGgubWF4KHQsMCksMSk7Y2FzZSBzLmRlZmF1bHQuVHlwZS5BdWRpb1JhbmdlOnJldHVybiBNYXRoLm1pbihNYXRoLm1heCh0LC0xKSwxKTtjYXNlIHMuZGVmYXVsdC5UeXBlLlBvc2l0aXZlOnJldHVybiBNYXRoLm1heCh0LDApO2RlZmF1bHQ6cmV0dXJuIHR9fSxzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLl90b1VuaXRzPWZ1bmN0aW9uKHQpe2lmKCF0aGlzLmNvbnZlcnQmJiFzLmRlZmF1bHQuaXNVbmRlZih0aGlzLmNvbnZlcnQpKXJldHVybiB0O3N3aXRjaCh0aGlzLnVuaXRzKXtjYXNlIHMuZGVmYXVsdC5UeXBlLkRlY2liZWxzOnJldHVybiBzLmRlZmF1bHQuZ2FpblRvRGIodCk7ZGVmYXVsdDpyZXR1cm4gdH19LHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuX21pbk91dHB1dD0xZS01LHMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZT17TGluZWFyOlwibGluZWFyUmFtcFRvVmFsdWVBdFRpbWVcIixFeHBvbmVudGlhbDpcImV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWVcIixUYXJnZXQ6XCJzZXRUYXJnZXRBdFRpbWVcIixTZXRWYWx1ZTpcInNldFZhbHVlQXRUaW1lXCIsQ2FuY2VsOlwiY2FuY2VsU2NoZWR1bGVkVmFsdWVzXCJ9LHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuc2V0VmFsdWVBdFRpbWU9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZT10aGlzLnRvU2Vjb25kcyhlKSx0PXRoaXMuX2Zyb21Vbml0cyh0KSx0aGlzLl9ldmVudHMuYWRkKHt0eXBlOnMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5TZXRWYWx1ZSx2YWx1ZTp0LHRpbWU6ZX0pLHRoaXMubG9nKHMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5TZXRWYWx1ZSx0LGUpLHRoaXMuX3BhcmFtLnNldFZhbHVlQXRUaW1lKHQsZSksdGhpc30scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5nZXRWYWx1ZUF0VGltZT1mdW5jdGlvbih0KXt0PXRoaXMudG9TZWNvbmRzKHQpO3ZhciBlPXRoaXMuX2V2ZW50cy5nZXRBZnRlcih0KSxpPXRoaXMuX2V2ZW50cy5nZXQodCksbj1zLmRlZmF1bHQuZGVmYXVsdEFyZyh0aGlzLl9pbml0aWFsVmFsdWUsdGhpcy5fcGFyYW0uZGVmYXVsdFZhbHVlKSxvPW47aWYobnVsbD09PWkpbz1uO2Vsc2UgaWYoaS50eXBlPT09cy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLlRhcmdldCl7dmFyIGEscj10aGlzLl9ldmVudHMuZ2V0QmVmb3JlKGkudGltZSk7YT1udWxsPT09cj9uOnIudmFsdWUsbz10aGlzLl9leHBvbmVudGlhbEFwcHJvYWNoKGkudGltZSxhLGkudmFsdWUsaS5jb25zdGFudCx0KX1lbHNlIG89bnVsbD09PWU/aS52YWx1ZTplLnR5cGU9PT1zLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuTGluZWFyP3RoaXMuX2xpbmVhckludGVycG9sYXRlKGkudGltZSxpLnZhbHVlLGUudGltZSxlLnZhbHVlLHQpOmUudHlwZT09PXMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5FeHBvbmVudGlhbD90aGlzLl9leHBvbmVudGlhbEludGVycG9sYXRlKGkudGltZSxpLnZhbHVlLGUudGltZSxlLnZhbHVlLHQpOmkudmFsdWU7cmV0dXJuIG99LHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuc2V0UmFtcFBvaW50PWZ1bmN0aW9uKHQpe3Q9dGhpcy50b1NlY29uZHModCk7dmFyIGU9dGhpcy5nZXRWYWx1ZUF0VGltZSh0KTtyZXR1cm4gdGhpcy5jYW5jZWxBbmRIb2xkQXRUaW1lKHQpLDA9PT1lJiYoZT10aGlzLl9taW5PdXRwdXQpLHRoaXMuc2V0VmFsdWVBdFRpbWUodGhpcy5fdG9Vbml0cyhlKSx0KSx0aGlzfSxzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ9dGhpcy5fZnJvbVVuaXRzKHQpLGU9dGhpcy50b1NlY29uZHMoZSksdGhpcy5fZXZlbnRzLmFkZCh7dHlwZTpzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuTGluZWFyLHZhbHVlOnQsdGltZTplfSksdGhpcy5sb2cocy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLkxpbmVhcix0LGUpLHRoaXMuX3BhcmFtLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHQsZSksdGhpc30scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ9dGhpcy5fZnJvbVVuaXRzKHQpLHQ9TWF0aC5tYXgodGhpcy5fbWluT3V0cHV0LHQpLGU9dGhpcy50b1NlY29uZHMoZSksdGhpcy5fZXZlbnRzLmFkZCh7dHlwZTpzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuRXhwb25lbnRpYWwsdGltZTplLHZhbHVlOnR9KSx0aGlzLmxvZyhzLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuRXhwb25lbnRpYWwsdCxlKSx0aGlzLl9wYXJhbS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKHQsZSksdGhpc30scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5leHBvbmVudGlhbFJhbXBUbz1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIGk9dGhpcy50b1NlY29uZHMoaSksdGhpcy5zZXRSYW1wUG9pbnQoaSksdGhpcy5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lKHQsaSt0aGlzLnRvU2Vjb25kcyhlKSksdGhpc30scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5saW5lYXJSYW1wVG89ZnVuY3Rpb24odCxlLGkpe3JldHVybiBpPXRoaXMudG9TZWNvbmRzKGkpLHRoaXMuc2V0UmFtcFBvaW50KGkpLHRoaXMubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUodCxpK3RoaXMudG9TZWNvbmRzKGUpKSx0aGlzfSxzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLnRhcmdldFJhbXBUbz1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIGk9dGhpcy50b1NlY29uZHMoaSksdGhpcy5zZXRSYW1wUG9pbnQoaSksdGhpcy5leHBvbmVudGlhbEFwcHJvYWNoVmFsdWVBdFRpbWUodCxpLGUpLHRoaXN9LHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuZXhwb25lbnRpYWxBcHByb2FjaFZhbHVlQXRUaW1lPWZ1bmN0aW9uKHQsZSxpKXt2YXIgcz1NYXRoLmxvZyh0aGlzLnRvU2Vjb25kcyhpKSsxKS9NYXRoLmxvZygyMDApO3JldHVybiBlPXRoaXMudG9TZWNvbmRzKGUpLHRoaXMuc2V0VGFyZ2V0QXRUaW1lKHQsZSxzKSx0aGlzLmNhbmNlbEFuZEhvbGRBdFRpbWUoZSsuOSppKSx0aGlzLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHQsZStpKSx0aGlzfSxzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLnNldFRhcmdldEF0VGltZT1mdW5jdGlvbih0LGUsaSl7aWYodD10aGlzLl9mcm9tVW5pdHModCksaTw9MCl0aHJvdyBuZXcgRXJyb3IoXCJ0aW1lQ29uc3RhbnQgbXVzdCBiZSBncmVhdGVyIHRoYW4gMFwiKTtyZXR1cm4gZT10aGlzLnRvU2Vjb25kcyhlKSx0aGlzLl9ldmVudHMuYWRkKHt0eXBlOnMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5UYXJnZXQsdmFsdWU6dCx0aW1lOmUsY29uc3RhbnQ6aX0pLHRoaXMubG9nKHMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5UYXJnZXQsdCxlLGkpLHRoaXMuX3BhcmFtLnNldFRhcmdldEF0VGltZSh0LGUsaSksdGhpc30scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5zZXRWYWx1ZUN1cnZlQXRUaW1lPWZ1bmN0aW9uKHQsZSxpLG4pe249cy5kZWZhdWx0LmRlZmF1bHRBcmcobiwxKSxpPXRoaXMudG9TZWNvbmRzKGkpLGU9dGhpcy50b1NlY29uZHMoZSksdGhpcy5zZXRWYWx1ZUF0VGltZSh0WzBdKm4sZSk7Zm9yKHZhciBvPWkvKHQubGVuZ3RoLTEpLGE9MTthPHQubGVuZ3RoO2ErKyl0aGlzLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHRbYV0qbixlK2Eqbyk7cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuY2FuY2VsU2NoZWR1bGVkVmFsdWVzPWZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX2V2ZW50cy5jYW5jZWwodCksdGhpcy5fcGFyYW0uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpLHRoaXMubG9nKHMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5DYW5jZWwsdCksdGhpc30scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5jYW5jZWxBbmRIb2xkQXRUaW1lPWZ1bmN0aW9uKHQpe3Q9dGhpcy50b1NlY29uZHModCk7dmFyIGU9dGhpcy5nZXRWYWx1ZUF0VGltZSh0KTt0aGlzLmxvZyhcImNhbmNlbEFuZEhvbGRBdFRpbWVcIix0LFwidmFsdWU9XCIrZSksdGhpcy5fcGFyYW0uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpO3ZhciBpPXRoaXMuX2V2ZW50cy5nZXQodCksbj10aGlzLl9ldmVudHMuZ2V0QWZ0ZXIodCk7cmV0dXJuIGkmJmkudGltZT09PXQ/bj90aGlzLl9ldmVudHMuY2FuY2VsKG4udGltZSk6dGhpcy5fZXZlbnRzLmNhbmNlbCh0K3RoaXMuc2FtcGxlVGltZSk6biYmKHRoaXMuX2V2ZW50cy5jYW5jZWwobi50aW1lKSxuLnR5cGU9PT1zLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuTGluZWFyP3RoaXMubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUoZSx0KTpuLnR5cGU9PT1zLmRlZmF1bHQuUGFyYW0uQXV0b21hdGlvblR5cGUuRXhwb25lbnRpYWwmJnRoaXMuZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZShlLHQpKSx0aGlzLl9ldmVudHMuYWRkKHt0eXBlOnMuZGVmYXVsdC5QYXJhbS5BdXRvbWF0aW9uVHlwZS5TZXRWYWx1ZSx2YWx1ZTplLHRpbWU6dH0pLHRoaXMuX3BhcmFtLnNldFZhbHVlQXRUaW1lKGUsdCksdGhpc30scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5yYW1wVG89ZnVuY3Rpb24odCxlLGkpe3JldHVybiBlPXMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsLjEpLHRoaXMudW5pdHM9PT1zLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3l8fHRoaXMudW5pdHM9PT1zLmRlZmF1bHQuVHlwZS5CUE18fHRoaXMudW5pdHM9PT1zLmRlZmF1bHQuVHlwZS5EZWNpYmVscz90aGlzLmV4cG9uZW50aWFsUmFtcFRvKHQsZSxpKTp0aGlzLmxpbmVhclJhbXBUbyh0LGUsaSksdGhpc30scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5fZXhwb25lbnRpYWxBcHByb2FjaD1mdW5jdGlvbih0LGUsaSxzLG4pe3JldHVybiBpKyhlLWkpKk1hdGguZXhwKC0obi10KS9zKX0scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5fbGluZWFySW50ZXJwb2xhdGU9ZnVuY3Rpb24odCxlLGkscyxuKXtyZXR1cm4gZSsobi10KS8oaS10KSoocy1lKX0scy5kZWZhdWx0LlBhcmFtLnByb3RvdHlwZS5fZXhwb25lbnRpYWxJbnRlcnBvbGF0ZT1mdW5jdGlvbih0LGUsaSxzLG4pe3JldHVybiBlKk1hdGgucG93KHMvZSwobi10KS8oaS10KSl9LHMuZGVmYXVsdC5QYXJhbS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fcGFyYW09bnVsbCx0aGlzLl9ldmVudHM9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlBhcmFtfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg4KSxpKDE5KSxpKDEwKSxpKDIzKTtzLmRlZmF1bHQuU3RlcmVvRWZmZWN0PWZ1bmN0aW9uKCl7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpO3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wid2V0XCJdLHMuZGVmYXVsdC5FZmZlY3QpO3RoaXMuY3JlYXRlSW5zT3V0cygxLDEpLHRoaXMuX2RyeVdldD1uZXcgcy5kZWZhdWx0LkNyb3NzRmFkZSh0LndldCksdGhpcy53ZXQ9dGhpcy5fZHJ5V2V0LmZhZGUsdGhpcy5fc3BsaXQ9bmV3IHMuZGVmYXVsdC5TcGxpdCx0aGlzLmVmZmVjdFNlbmRMPXRoaXMuX3NwbGl0LmxlZnQsdGhpcy5lZmZlY3RTZW5kUj10aGlzLl9zcGxpdC5yaWdodCx0aGlzLl9tZXJnZT1uZXcgcy5kZWZhdWx0Lk1lcmdlLHRoaXMuZWZmZWN0UmV0dXJuTD10aGlzLl9tZXJnZS5sZWZ0LHRoaXMuZWZmZWN0UmV0dXJuUj10aGlzLl9tZXJnZS5yaWdodCxzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LHRoaXMuX3NwbGl0KSxzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LHRoaXMuX2RyeVdldCwwLDApLHRoaXMuX21lcmdlLmNvbm5lY3QodGhpcy5fZHJ5V2V0LDAsMSksdGhpcy5fZHJ5V2V0LmNvbm5lY3QodGhpcy5vdXRwdXQpLHRoaXMuX3JlYWRPbmx5KFtcIndldFwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlN0ZXJlb0VmZmVjdCxzLmRlZmF1bHQuRWZmZWN0KSxzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9kcnlXZXQuZGlzcG9zZSgpLHRoaXMuX2RyeVdldD1udWxsLHRoaXMuX3NwbGl0LmRpc3Bvc2UoKSx0aGlzLl9zcGxpdD1udWxsLHRoaXMuX21lcmdlLmRpc3Bvc2UoKSx0aGlzLl9tZXJnZT1udWxsLHRoaXMuZWZmZWN0U2VuZEw9bnVsbCx0aGlzLmVmZmVjdFNlbmRSPW51bGwsdGhpcy5lZmZlY3RSZXR1cm5MPW51bGwsdGhpcy5lZmZlY3RSZXR1cm5SPW51bGwsdGhpcy5fd3JpdGFibGUoW1wid2V0XCJdKSx0aGlzLndldD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuU3RlcmVvRWZmZWN0fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg4MyksaSg0KSxpKDI0KSxpKDM1KSxpKDMpLGkoODEpLGkoODApLGkoNTYpO3MuZGVmYXVsdC5UcmFuc3BvcnQ9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuRW1pdHRlci5jYWxsKHRoaXMpLHMuZGVmYXVsdC5nZXRDb250ZXh0KGZ1bmN0aW9uKCl7dGhpcy5sb29wPSExLHRoaXMuX2xvb3BTdGFydD0wLHRoaXMuX2xvb3BFbmQ9MCx0aGlzLl9wcHE9bi5kZWZhdWx0cy5QUFEsdGhpcy5fY2xvY2s9bmV3IHMuZGVmYXVsdC5DbG9jayh7Y2FsbGJhY2s6dGhpcy5fcHJvY2Vzc1RpY2suYmluZCh0aGlzKSxmcmVxdWVuY3k6MH0pLHRoaXMuX2JpbmRDbG9ja0V2ZW50cygpLHRoaXMuYnBtPXRoaXMuX2Nsb2NrLmZyZXF1ZW5jeSx0aGlzLmJwbS5fdG9Vbml0cz10aGlzLl90b1VuaXRzLmJpbmQodGhpcyksdGhpcy5icG0uX2Zyb21Vbml0cz10aGlzLl9mcm9tVW5pdHMuYmluZCh0aGlzKSx0aGlzLmJwbS51bml0cz1zLmRlZmF1bHQuVHlwZS5CUE0sdGhpcy5icG0udmFsdWU9bi5kZWZhdWx0cy5icG0sdGhpcy5fcmVhZE9ubHkoXCJicG1cIiksdGhpcy5fdGltZVNpZ25hdHVyZT1uLmRlZmF1bHRzLnRpbWVTaWduYXR1cmUsdGhpcy5fc2NoZWR1bGVkRXZlbnRzPXt9LHRoaXMuX3RpbWVsaW5lPW5ldyBzLmRlZmF1bHQuVGltZWxpbmUsdGhpcy5fcmVwZWF0ZWRFdmVudHM9bmV3IHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLHRoaXMuX3N5bmNlZFNpZ25hbHM9W10sdGhpcy5fc3dpbmdUaWNrcz1uLmRlZmF1bHRzLlBQUS8yLHRoaXMuX3N3aW5nQW1vdW50PTAsdGhpcy5jb250ZXh0LnRyYW5zcG9ydD10aGlzfS5iaW5kKHRoaXMpKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVHJhbnNwb3J0LHMuZGVmYXVsdC5FbWl0dGVyKSxzLmRlZmF1bHQuVHJhbnNwb3J0LmRlZmF1bHRzPXticG06MTIwLHN3aW5nOjAsc3dpbmdTdWJkaXZpc2lvbjpcIjhuXCIsdGltZVNpZ25hdHVyZTo0LGxvb3BTdGFydDowLGxvb3BFbmQ6XCI0bVwiLFBQUToxOTJ9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLmlzVHJhbnNwb3J0PSEwLHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLl9wcm9jZXNzVGljaz1mdW5jdGlvbih0LGUpe2lmKHRoaXMuX3N3aW5nQW1vdW50PjAmJmUldGhpcy5fcHBxIT0wJiZlJSgyKnRoaXMuX3N3aW5nVGlja3MpIT0wKXt2YXIgaT1lJSgyKnRoaXMuX3N3aW5nVGlja3MpLygyKnRoaXMuX3N3aW5nVGlja3MpLG49TWF0aC5zaW4oaSpNYXRoLlBJKSp0aGlzLl9zd2luZ0Ftb3VudDt0Kz1zLmRlZmF1bHQuVGlja3MoMip0aGlzLl9zd2luZ1RpY2tzLzMpLnRvU2Vjb25kcygpKm59dGhpcy5sb29wJiZlPj10aGlzLl9sb29wRW5kJiYodGhpcy5lbWl0KFwibG9vcEVuZFwiLHQpLHRoaXMuX2Nsb2NrLnNldFRpY2tzQXRUaW1lKHRoaXMuX2xvb3BTdGFydCx0KSxlPXRoaXMuX2xvb3BTdGFydCx0aGlzLmVtaXQoXCJsb29wU3RhcnRcIix0LHRoaXMuX2Nsb2NrLmdldFNlY29uZHNBdFRpbWUodCkpLHRoaXMuZW1pdChcImxvb3BcIix0KSksdGhpcy5fdGltZWxpbmUuZm9yRWFjaEF0VGltZShlLGZ1bmN0aW9uKGUpe2UuaW52b2tlKHQpfSl9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLnNjaGVkdWxlPWZ1bmN0aW9uKHQsZSl7dmFyIGk9bmV3IHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudCh0aGlzLHt0aW1lOnMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKGUpLGNhbGxiYWNrOnR9KTtyZXR1cm4gdGhpcy5fYWRkRXZlbnQoaSx0aGlzLl90aW1lbGluZSl9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLnNjaGVkdWxlUmVwZWF0PWZ1bmN0aW9uKHQsZSxpLG4pe3ZhciBvPW5ldyBzLmRlZmF1bHQuVHJhbnNwb3J0UmVwZWF0RXZlbnQodGhpcyx7Y2FsbGJhY2s6dCxpbnRlcnZhbDpzLmRlZmF1bHQuVGltZShlKSx0aW1lOnMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKGkpLGR1cmF0aW9uOnMuZGVmYXVsdC5UaW1lKHMuZGVmYXVsdC5kZWZhdWx0QXJnKG4sMS8wKSl9KTtyZXR1cm4gdGhpcy5fYWRkRXZlbnQobyx0aGlzLl9yZXBlYXRlZEV2ZW50cyl9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLnNjaGVkdWxlT25jZT1mdW5jdGlvbih0LGUpe3ZhciBpPW5ldyBzLmRlZmF1bHQuVHJhbnNwb3J0RXZlbnQodGhpcyx7dGltZTpzLmRlZmF1bHQuVHJhbnNwb3J0VGltZShlKSxjYWxsYmFjazp0LG9uY2U6ITB9KTtyZXR1cm4gdGhpcy5fYWRkRXZlbnQoaSx0aGlzLl90aW1lbGluZSl9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKHQpe2lmKHRoaXMuX3NjaGVkdWxlZEV2ZW50cy5oYXNPd25Qcm9wZXJ0eSh0KSl7dmFyIGU9dGhpcy5fc2NoZWR1bGVkRXZlbnRzW3QudG9TdHJpbmcoKV07ZS50aW1lbGluZS5yZW1vdmUoZS5ldmVudCksZS5ldmVudC5kaXNwb3NlKCksZGVsZXRlIHRoaXMuX3NjaGVkdWxlZEV2ZW50c1t0LnRvU3RyaW5nKCldfXJldHVybiB0aGlzfSxzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5fYWRkRXZlbnQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fc2NoZWR1bGVkRXZlbnRzW3QuaWQudG9TdHJpbmcoKV09e2V2ZW50OnQsdGltZWxpbmU6ZX0sZS5hZGQodCksdC5pZH0scy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKHQpe3JldHVybiB0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsMCksdD10aGlzLnRvVGlja3ModCksdGhpcy5fdGltZWxpbmUuZm9yRWFjaEZyb20odCxmdW5jdGlvbih0KXt0aGlzLmNsZWFyKHQuaWQpfS5iaW5kKHRoaXMpKSx0aGlzLl9yZXBlYXRlZEV2ZW50cy5mb3JFYWNoRnJvbSh0LGZ1bmN0aW9uKHQpe3RoaXMuY2xlYXIodC5pZCl9LmJpbmQodGhpcykpLHRoaXN9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLl9iaW5kQ2xvY2tFdmVudHM9ZnVuY3Rpb24oKXt0aGlzLl9jbG9jay5vbihcInN0YXJ0XCIsZnVuY3Rpb24odCxlKXtlPXMuZGVmYXVsdC5UaWNrcyhlKS50b1NlY29uZHMoKSx0aGlzLmVtaXQoXCJzdGFydFwiLHQsZSl9LmJpbmQodGhpcykpLHRoaXMuX2Nsb2NrLm9uKFwic3RvcFwiLGZ1bmN0aW9uKHQpe3RoaXMuZW1pdChcInN0b3BcIix0KX0uYmluZCh0aGlzKSksdGhpcy5fY2xvY2sub24oXCJwYXVzZVwiLGZ1bmN0aW9uKHQpe3RoaXMuZW1pdChcInBhdXNlXCIsdCl9LmJpbmQodGhpcykpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUsXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2xvY2suZ2V0U3RhdGVBdFRpbWUodGhpcy5ub3coKSl9fSkscy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUuc3RhcnQ9ZnVuY3Rpb24odCxlKXtyZXR1cm4gcy5kZWZhdWx0LmlzRGVmaW5lZChlKSYmKGU9dGhpcy50b1RpY2tzKGUpKSx0aGlzLl9jbG9jay5zdGFydCh0LGUpLHRoaXN9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLnN0b3A9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2Nsb2NrLnN0b3AodCksdGhpc30scy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUucGF1c2U9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2Nsb2NrLnBhdXNlKHQpLHRoaXN9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLnRvZ2dsZT1mdW5jdGlvbih0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9jbG9jay5nZXRTdGF0ZUF0VGltZSh0KSE9PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkP3RoaXMuc3RhcnQodCk6dGhpcy5zdG9wKHQpLHRoaXN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZSxcInRpbWVTaWduYXR1cmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RpbWVTaWduYXR1cmV9LHNldDpmdW5jdGlvbih0KXtzLmRlZmF1bHQuaXNBcnJheSh0KSYmKHQ9dFswXS90WzFdKjQpLHRoaXMuX3RpbWVTaWduYXR1cmU9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUsXCJsb29wU3RhcnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5UaWNrcyh0aGlzLl9sb29wU3RhcnQpLnRvU2Vjb25kcygpfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fbG9vcFN0YXJ0PXRoaXMudG9UaWNrcyh0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUsXCJsb29wRW5kXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuVGlja3ModGhpcy5fbG9vcEVuZCkudG9TZWNvbmRzKCl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9sb29wRW5kPXRoaXMudG9UaWNrcyh0KX19KSxzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5zZXRMb29wUG9pbnRzPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHRoaXMubG9vcFN0YXJ0PXQsdGhpcy5sb29wRW5kPWUsdGhpc30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLFwic3dpbmdcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N3aW5nQW1vdW50fSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fc3dpbmdBbW91bnQ9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUsXCJzd2luZ1N1YmRpdmlzaW9uXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuVGlja3ModGhpcy5fc3dpbmdUaWNrcykudG9Ob3RhdGlvbigpfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fc3dpbmdUaWNrcz10aGlzLnRvVGlja3ModCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLFwicG9zaXRpb25cIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5ub3coKSxlPXRoaXMuX2Nsb2NrLmdldFRpY2tzQXRUaW1lKHQpO3JldHVybiBzLmRlZmF1bHQuVGlja3MoZSkudG9CYXJzQmVhdHNTaXh0ZWVudGhzKCl9LHNldDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLnRvVGlja3ModCk7dGhpcy50aWNrcz1lfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZSxcInNlY29uZHNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Nsb2NrLnNlY29uZHN9LHNldDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLm5vdygpLGk9dGhpcy5icG0udGltZVRvVGlja3ModCxlKTt0aGlzLnRpY2tzPWl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLFwicHJvZ3Jlc3NcIix7Z2V0OmZ1bmN0aW9uKCl7aWYodGhpcy5sb29wKXt2YXIgdD10aGlzLm5vdygpO3JldHVybih0aGlzLl9jbG9jay5nZXRUaWNrc0F0VGltZSh0KS10aGlzLl9sb29wU3RhcnQpLyh0aGlzLl9sb29wRW5kLXRoaXMuX2xvb3BTdGFydCl9cmV0dXJuIDB9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLFwidGlja3NcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2Nsb2NrLnRpY2tzfSxzZXQ6ZnVuY3Rpb24odCl7aWYodGhpcy5fY2xvY2sudGlja3MhPT10KXt2YXIgZT10aGlzLm5vdygpO3RoaXMuc3RhdGU9PT1zLmRlZmF1bHQuU3RhdGUuU3RhcnRlZD8odGhpcy5lbWl0KFwic3RvcFwiLGUpLHRoaXMuX2Nsb2NrLnNldFRpY2tzQXRUaW1lKHQsZSksdGhpcy5lbWl0KFwic3RhcnRcIixlLHRoaXMuc2Vjb25kcykpOnRoaXMuX2Nsb2NrLnNldFRpY2tzQXRUaW1lKHQsZSl9fX0pLHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLmdldFRpY2tzQXRUaW1lPWZ1bmN0aW9uKHQpe3JldHVybiBNYXRoLnJvdW5kKHRoaXMuX2Nsb2NrLmdldFRpY2tzQXRUaW1lKHQpKX0scy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUuZ2V0U2Vjb25kc0F0VGltZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fY2xvY2suZ2V0U2Vjb25kc0F0VGltZSh0KX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLFwiUFBRXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wcHF9LHNldDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLmJwbS52YWx1ZTt0aGlzLl9wcHE9dCx0aGlzLmJwbS52YWx1ZT1lfX0pLHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLl9mcm9tVW5pdHM9ZnVuY3Rpb24odCl7cmV0dXJuIDEvKDYwL3QvdGhpcy5QUFEpfSxzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5fdG9Vbml0cz1mdW5jdGlvbih0KXtyZXR1cm4gdC90aGlzLlBQUSo2MH0scy5kZWZhdWx0LlRyYW5zcG9ydC5wcm90b3R5cGUubmV4dFN1YmRpdmlzaW9uPWZ1bmN0aW9uKHQpe2lmKHQ9dGhpcy50b1RpY2tzKHQpLHRoaXMuc3RhdGUhPT1zLmRlZmF1bHQuU3RhdGUuU3RhcnRlZClyZXR1cm4gMDt2YXIgZT10aGlzLm5vdygpLGk9dC10aGlzLmdldFRpY2tzQXRUaW1lKGUpJXQ7cmV0dXJuIHRoaXMuX2Nsb2NrLm5leHRUaWNrVGltZShpLGUpfSxzLmRlZmF1bHQuVHJhbnNwb3J0LnByb3RvdHlwZS5zeW5jU2lnbmFsPWZ1bmN0aW9uKHQsZSl7aWYoIWUpe3ZhciBpPXRoaXMubm93KCk7ZT0wIT09dC5nZXRWYWx1ZUF0VGltZShpKT90LmdldFZhbHVlQXRUaW1lKGkpL3RoaXMuYnBtLmdldFZhbHVlQXRUaW1lKGkpOjB9dmFyIG49bmV3IHMuZGVmYXVsdC5HYWluKGUpO3JldHVybiB0aGlzLmJwbS5jaGFpbihuLHQuX3BhcmFtKSx0aGlzLl9zeW5jZWRTaWduYWxzLnB1c2goe3JhdGlvOm4sc2lnbmFsOnQsaW5pdGlhbDp0LnZhbHVlfSksdC52YWx1ZT0wLHRoaXN9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLnVuc3luY1NpZ25hbD1mdW5jdGlvbih0KXtmb3IodmFyIGU9dGhpcy5fc3luY2VkU2lnbmFscy5sZW5ndGgtMTtlPj0wO2UtLSl7dmFyIGk9dGhpcy5fc3luY2VkU2lnbmFsc1tlXTtpLnNpZ25hbD09PXQmJihpLnJhdGlvLmRpc3Bvc2UoKSxpLnNpZ25hbC52YWx1ZT1pLmluaXRpYWwsdGhpcy5fc3luY2VkU2lnbmFscy5zcGxpY2UoZSwxKSl9cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5UcmFuc3BvcnQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkVtaXR0ZXIucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9jbG9jay5kaXNwb3NlKCksdGhpcy5fY2xvY2s9bnVsbCx0aGlzLl93cml0YWJsZShcImJwbVwiKSx0aGlzLmJwbT1udWxsLHRoaXMuX3RpbWVsaW5lLmRpc3Bvc2UoKSx0aGlzLl90aW1lbGluZT1udWxsLHRoaXMuX3JlcGVhdGVkRXZlbnRzLmRpc3Bvc2UoKSx0aGlzLl9yZXBlYXRlZEV2ZW50cz1udWxsLHRoaXN9O3ZhciBuPXMuZGVmYXVsdC5UcmFuc3BvcnQ7cy5kZWZhdWx0LlRyYW5zcG9ydD1uZXcgbixzLmRlZmF1bHQuQ29udGV4dC5vbihcImluaXRcIixmdW5jdGlvbih0KXt0LnRyYW5zcG9ydCYmdC50cmFuc3BvcnQuaXNUcmFuc3BvcnQ/cy5kZWZhdWx0LlRyYW5zcG9ydD10LnRyYW5zcG9ydDpzLmRlZmF1bHQuVHJhbnNwb3J0PW5ldyBufSkscy5kZWZhdWx0LkNvbnRleHQub24oXCJjbG9zZVwiLGZ1bmN0aW9uKHQpe3QudHJhbnNwb3J0JiZ0LnRyYW5zcG9ydC5pc1RyYW5zcG9ydCYmdC50cmFuc3BvcnQuZGlzcG9zZSgpfSksZS5kZWZhdWx0PXMuZGVmYXVsdC5UcmFuc3BvcnR9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDIpLGkoNiksaSgxNiksaSg3OSk7cy5kZWZhdWx0Lk9zY2lsbGF0b3I9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiXSxzLmRlZmF1bHQuT3NjaWxsYXRvcik7cy5kZWZhdWx0LlNvdXJjZS5jYWxsKHRoaXMsdCksdGhpcy5fb3NjaWxsYXRvcj1udWxsLHRoaXMuZnJlcXVlbmN5PW5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZnJlcXVlbmN5LHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksdGhpcy5kZXR1bmU9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5kZXR1bmUscy5kZWZhdWx0LlR5cGUuQ2VudHMpLHRoaXMuX3dhdmU9bnVsbCx0aGlzLl9wYXJ0aWFscz10LnBhcnRpYWxzLHRoaXMuX3BhcnRpYWxDb3VudD10LnBhcnRpYWxDb3VudCx0aGlzLl9waGFzZT10LnBoYXNlLHRoaXMuX3R5cGU9dC50eXBlLHQucGFydGlhbENvdW50JiZ0LnR5cGUhPT1zLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLkN1c3RvbSYmKHRoaXMuX3R5cGU9dGhpcy5iYXNlVHlwZSt0LnBhcnRpYWxDb3VudC50b1N0cmluZygpKSx0aGlzLnBoYXNlPXRoaXMuX3BoYXNlLHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCJdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuT3NjaWxsYXRvcixzLmRlZmF1bHQuU291cmNlKSxzLmRlZmF1bHQuT3NjaWxsYXRvci5kZWZhdWx0cz17dHlwZTpcInNpbmVcIixmcmVxdWVuY3k6NDQwLGRldHVuZTowLHBoYXNlOjAscGFydGlhbHM6W10scGFydGlhbENvdW50OjB9LHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGU9e1NpbmU6XCJzaW5lXCIsVHJpYW5nbGU6XCJ0cmlhbmdsZVwiLFNhd3Rvb3RoOlwic2F3dG9vdGhcIixTcXVhcmU6XCJzcXVhcmVcIixDdXN0b206XCJjdXN0b21cIn0scy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLl9zdGFydD1mdW5jdGlvbih0KXt0aGlzLmxvZyhcInN0YXJ0XCIsdCk7dmFyIGU9bmV3IHMuZGVmYXVsdC5Pc2NpbGxhdG9yTm9kZTt0aGlzLl9vc2NpbGxhdG9yPWUsdGhpcy5fd2F2ZT90aGlzLl9vc2NpbGxhdG9yLnNldFBlcmlvZGljV2F2ZSh0aGlzLl93YXZlKTp0aGlzLl9vc2NpbGxhdG9yLnR5cGU9dGhpcy5fdHlwZSx0aGlzLl9vc2NpbGxhdG9yLmNvbm5lY3QodGhpcy5vdXRwdXQpLHRoaXMuZnJlcXVlbmN5LmNvbm5lY3QodGhpcy5fb3NjaWxsYXRvci5mcmVxdWVuY3kpLHRoaXMuZGV0dW5lLmNvbm5lY3QodGhpcy5fb3NjaWxsYXRvci5kZXR1bmUpLHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5fb3NjaWxsYXRvci5zdGFydCh0KX0scy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLl9zdG9wPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmxvZyhcInN0b3BcIix0KSx0aGlzLl9vc2NpbGxhdG9yJiYodD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9vc2NpbGxhdG9yLnN0b3AodCkpLHRoaXN9LHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZS5yZXN0YXJ0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yJiZ0aGlzLl9vc2NpbGxhdG9yLmNhbmNlbFN0b3AoKSx0aGlzLl9zdGF0ZS5jYW5jZWwodGhpcy50b1NlY29uZHModCkpLHRoaXN9LHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZS5zeW5jRnJlcXVlbmN5PWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5UcmFuc3BvcnQuc3luY1NpZ25hbCh0aGlzLmZyZXF1ZW5jeSksdGhpc30scy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLnVuc3luY0ZyZXF1ZW5jeT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuVHJhbnNwb3J0LnVuc3luY1NpZ25hbCh0aGlzLmZyZXF1ZW5jeSksdGhpc30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZSxcInR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3R5cGV9LHNldDpmdW5jdGlvbih0KXt2YXIgZT1bcy5kZWZhdWx0Lk9zY2lsbGF0b3IuVHlwZS5TaW5lLHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuU3F1YXJlLHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuVHJpYW5nbGUscy5kZWZhdWx0Lk9zY2lsbGF0b3IuVHlwZS5TYXd0b290aF0uaW5jbHVkZXModCk7aWYoMD09PXRoaXMuX3BoYXNlJiZlKXRoaXMuX3dhdmU9bnVsbCx0aGlzLl9wYXJ0aWFsQ291bnQ9MCxudWxsIT09dGhpcy5fb3NjaWxsYXRvciYmKHRoaXMuX29zY2lsbGF0b3IudHlwZT10KTtlbHNle3ZhciBpPXRoaXMuX2dldFJlYWxJbWFnaW5hcnkodCx0aGlzLl9waGFzZSksbj10aGlzLmNvbnRleHQuY3JlYXRlUGVyaW9kaWNXYXZlKGlbMF0saVsxXSk7dGhpcy5fd2F2ZT1uLG51bGwhPT10aGlzLl9vc2NpbGxhdG9yJiZ0aGlzLl9vc2NpbGxhdG9yLnNldFBlcmlvZGljV2F2ZSh0aGlzLl93YXZlKX10aGlzLl90eXBlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZSxcImJhc2VUeXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90eXBlLnJlcGxhY2UodGhpcy5wYXJ0aWFsQ291bnQsXCJcIil9LHNldDpmdW5jdGlvbih0KXt0aGlzLnBhcnRpYWxDb3VudCYmdGhpcy5fdHlwZSE9PXMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuQ3VzdG9tJiZ0IT09cy5kZWZhdWx0Lk9zY2lsbGF0b3IuVHlwZS5DdXN0b20/dGhpcy50eXBlPXQrdGhpcy5wYXJ0aWFsQ291bnQ6dGhpcy50eXBlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZSxcInBhcnRpYWxDb3VudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFydGlhbENvdW50fSxzZXQ6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fdHlwZSxpPS9eKHNpbmV8dHJpYW5nbGV8c3F1YXJlfHNhd3Rvb3RoKShcXGQrKSQvLmV4ZWModGhpcy5fdHlwZSk7aSYmKGU9aVsxXSksdGhpcy5fdHlwZSE9PXMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuQ3VzdG9tJiYodGhpcy50eXBlPTA9PT10P2U6ZSt0LnRvU3RyaW5nKCkpfX0pLHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQucHJvdG90eXBlLmdldC5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHQudHlwZSE9PXMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuQ3VzdG9tJiZkZWxldGUgdC5wYXJ0aWFscyx0fSxzLmRlZmF1bHQuT3NjaWxsYXRvci5wcm90b3R5cGUuX2dldFJlYWxJbWFnaW5hcnk9ZnVuY3Rpb24odCxlKXt2YXIgaT0yMDQ4LG49bmV3IEZsb2F0MzJBcnJheShpKSxvPW5ldyBGbG9hdDMyQXJyYXkoaSksYT0xO2lmKHQ9PT1zLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLkN1c3RvbSlhPXRoaXMuX3BhcnRpYWxzLmxlbmd0aCsxLHRoaXMuX3BhcnRpYWxDb3VudD10aGlzLl9wYXJ0aWFscy5sZW5ndGgsaT1hO2Vsc2V7dmFyIHI9L14oc2luZXx0cmlhbmdsZXxzcXVhcmV8c2F3dG9vdGgpKFxcZCspJC8uZXhlYyh0KTtyPyhhPXBhcnNlSW50KHJbMl0pKzEsdGhpcy5fcGFydGlhbENvdW50PXBhcnNlSW50KHJbMl0pLHQ9clsxXSxpPWE9TWF0aC5tYXgoYSwyKSk6dGhpcy5fcGFydGlhbENvdW50PTAsdGhpcy5fcGFydGlhbHM9W119Zm9yKHZhciBsPTE7bDxpOysrbCl7dmFyIHUsZj0yLyhsKk1hdGguUEkpO3N3aXRjaCh0KXtjYXNlIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuU2luZTp1PWw8PWE/MTowLHRoaXMuX3BhcnRpYWxzW2wtMV09dTticmVhaztjYXNlIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuU3F1YXJlOnU9MSZsPzIqZjowLHRoaXMuX3BhcnRpYWxzW2wtMV09dTticmVhaztjYXNlIHMuZGVmYXVsdC5Pc2NpbGxhdG9yLlR5cGUuU2F3dG9vdGg6dT1mKigxJmw/MTotMSksdGhpcy5fcGFydGlhbHNbbC0xXT11O2JyZWFrO2Nhc2Ugcy5kZWZhdWx0Lk9zY2lsbGF0b3IuVHlwZS5UcmlhbmdsZTp1PTEmbD9mKmYqMioobC0xPj4xJjE/LTE6MSk6MCx0aGlzLl9wYXJ0aWFsc1tsLTFdPXU7YnJlYWs7Y2FzZSBzLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLkN1c3RvbTp1PXRoaXMuX3BhcnRpYWxzW2wtMV07YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgVHlwZUVycm9yKFwiVG9uZS5Pc2NpbGxhdG9yOiBpbnZhbGlkIHR5cGU6IFwiK3QpfTAhPT11PyhuW2xdPS11Kk1hdGguc2luKGUqbCksb1tsXT11Kk1hdGguY29zKGUqbCkpOihuW2xdPTAsb1tsXT0wKX1yZXR1cm5bbixvXX0scy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLl9pbnZlcnNlRkZUPWZ1bmN0aW9uKHQsZSxpKXtmb3IodmFyIHM9MCxuPXQubGVuZ3RoLG89MDtvPG47bysrKXMrPXRbb10qTWF0aC5jb3MobyppKStlW29dKk1hdGguc2luKG8qaSk7cmV0dXJuIHN9LHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZS5fZ2V0SW5pdGlhbFZhbHVlPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMuX2dldFJlYWxJbWFnaW5hcnkodGhpcy5fdHlwZSwwKSxlPXRbMF0saT10WzFdLHM9MCxuPTIqTWF0aC5QSSxvPTA7bzw4O28rKylzPU1hdGgubWF4KHRoaXMuX2ludmVyc2VGRlQoZSxpLG8vOCpuKSxzKTtyZXR1cm4tdGhpcy5faW52ZXJzZUZGVChlLGksdGhpcy5fcGhhc2UpL3N9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT3NjaWxsYXRvci5wcm90b3R5cGUsXCJwYXJ0aWFsc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFydGlhbHN9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9wYXJ0aWFscz10LHRoaXMudHlwZT1zLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLkN1c3RvbX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9zY2lsbGF0b3IucHJvdG90eXBlLFwicGhhc2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BoYXNlKigxODAvTWF0aC5QSSl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9waGFzZT10Kk1hdGguUEkvMTgwLHRoaXMudHlwZT10aGlzLl90eXBlfX0pLHMuZGVmYXVsdC5Pc2NpbGxhdG9yLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSxudWxsIT09dGhpcy5fb3NjaWxsYXRvciYmKHRoaXMuX29zY2lsbGF0b3IuZGlzcG9zZSgpLHRoaXMuX29zY2lsbGF0b3I9bnVsbCksdGhpcy5fd2F2ZT1udWxsLHRoaXMuX3dyaXRhYmxlKFtcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCJdKSx0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3k9bnVsbCx0aGlzLmRldHVuZS5kaXNwb3NlKCksdGhpcy5kZXR1bmU9bnVsbCx0aGlzLl9wYXJ0aWFscz1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuT3NjaWxsYXRvcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTQpLGkoMSk7cy5kZWZhdWx0LkRlbGF5PWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJkZWxheVRpbWVcIixcIm1heERlbGF5XCJdLHMuZGVmYXVsdC5EZWxheSk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMsdCksdGhpcy5fbWF4RGVsYXk9TWF0aC5tYXgodGhpcy50b1NlY29uZHModC5tYXhEZWxheSksdGhpcy50b1NlY29uZHModC5kZWxheVRpbWUpKSx0aGlzLl9kZWxheU5vZGU9dGhpcy5pbnB1dD10aGlzLm91dHB1dD10aGlzLmNvbnRleHQuY3JlYXRlRGVsYXkodGhpcy5fbWF4RGVsYXkpLHRoaXMuZGVsYXlUaW1lPW5ldyBzLmRlZmF1bHQuUGFyYW0oe3BhcmFtOnRoaXMuX2RlbGF5Tm9kZS5kZWxheVRpbWUsdW5pdHM6cy5kZWZhdWx0LlR5cGUuVGltZSx2YWx1ZTp0LmRlbGF5VGltZX0pLHRoaXMuX3JlYWRPbmx5KFwiZGVsYXlUaW1lXCIpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5EZWxheSxzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuRGVsYXkuZGVmYXVsdHM9e21heERlbGF5OjEsZGVsYXlUaW1lOjB9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRGVsYXkucHJvdG90eXBlLFwibWF4RGVsYXlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21heERlbGF5fX0pLHMuZGVmYXVsdC5EZWxheS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fZGVsYXlOb2RlLmRpc2Nvbm5lY3QoKSx0aGlzLl9kZWxheU5vZGU9bnVsbCx0aGlzLl93cml0YWJsZShcImRlbGF5VGltZVwiKSx0aGlzLmRlbGF5VGltZT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRGVsYXl9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDMpLGkoMSk7cy5kZWZhdWx0LlNwbGl0PWZ1bmN0aW9uKHQpe3Q9cy5kZWZhdWx0LmRlZmF1bHRBcmcodCwyKSxzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5jcmVhdGVJbnNPdXRzKDAsdCksdGhpcy5fc3BsaXR0ZXI9dGhpcy5pbnB1dD10aGlzLmNvbnRleHQuY3JlYXRlQ2hhbm5lbFNwbGl0dGVyKHQpO2Zvcih2YXIgZT0wO2U8dDtlKyspdGhpcy5vdXRwdXRbZV09bmV3IHMuZGVmYXVsdC5HYWluLHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuX3NwbGl0dGVyLHRoaXMub3V0cHV0W2VdLGUsMCksdGhpcy5vdXRwdXRbZV0uY2hhbm5lbENvdW50PTEsdGhpcy5vdXRwdXRbZV0uY2hhbm5lbENvdW50TW9kZT1cImV4cGxpY2l0XCI7dGhpcy5sZWZ0PXRoaXMub3V0cHV0WzBdLHRoaXMucmlnaHQ9dGhpcy5vdXRwdXRbMV19LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlNwbGl0LHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5TcGxpdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm91dHB1dC5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuZGlzcG9zZSgpfSkscy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3NwbGl0dGVyLmRpc2Nvbm5lY3QoKSx0aGlzLmxlZnQ9bnVsbCx0aGlzLnJpZ2h0PW51bGwsdGhpcy5fc3BsaXR0ZXI9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlNwbGl0fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCksbj0oaSgzNSksaSgyNCksaSg0NCksW1wiYmFzZUxhdGVuY3lcIixcImRlc3RpbmF0aW9uXCIsXCJjdXJyZW50VGltZVwiLFwic2FtcGxlUmF0ZVwiLFwibGlzdGVuZXJcIixcInN0YXRlXCJdKSxvPVtcInN1c3BlbmRcIixcImNsb3NlXCIsXCJyZXN1bWVcIixcImdldE91dHB1dFRpbWVzdGFtcFwiLFwiY3JlYXRlTWVkaWFFbGVtZW50U291cmNlXCIsXCJjcmVhdGVNZWRpYVN0cmVhbVNvdXJjZVwiLFwiY3JlYXRlTWVkaWFTdHJlYW1EZXN0aW5hdGlvblwiLFwiY3JlYXRlQnVmZmVyXCIsXCJkZWNvZGVBdWRpb0RhdGFcIixcImNyZWF0ZUJ1ZmZlclNvdXJjZVwiLFwiY3JlYXRlQ29uc3RhbnRTb3VyY2VcIixcImNyZWF0ZUdhaW5cIixcImNyZWF0ZURlbGF5XCIsXCJjcmVhdGVCaXF1YWRGaWx0ZXJcIixcImNyZWF0ZUlJUkZpbHRlclwiLFwiY3JlYXRlV2F2ZVNoYXBlclwiLFwiY3JlYXRlUGFubmVyXCIsXCJjcmVhdGVDb252b2x2ZXJcIixcImNyZWF0ZUR5bmFtaWNzQ29tcHJlc3NvclwiLFwiY3JlYXRlQW5hbHlzZXJcIixcImNyZWF0ZVNjcmlwdFByb2Nlc3NvclwiLFwiY3JlYXRlU3RlcmVvUGFubmVyXCIsXCJjcmVhdGVPc2NpbGxhdG9yXCIsXCJjcmVhdGVQZXJpb2RpY1dhdmVcIixcImNyZWF0ZUNoYW5uZWxTcGxpdHRlclwiLFwiY3JlYXRlQ2hhbm5lbE1lcmdlclwiLFwiYXVkaW9Xb3JrbGV0XCJdO3MuZGVmYXVsdC5Db250ZXh0PWZ1bmN0aW9uKCl7cy5kZWZhdWx0LkVtaXR0ZXIuY2FsbCh0aGlzKTt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImNvbnRleHRcIl0scy5kZWZhdWx0LkNvbnRleHQpO2lmKCF0LmNvbnRleHQmJih0LmNvbnRleHQ9bmV3IHMuZGVmYXVsdC5nbG9iYWwuQXVkaW9Db250ZXh0LCF0LmNvbnRleHQpKXRocm93IG5ldyBFcnJvcihcImNvdWxkIG5vdCBjcmVhdGUgQXVkaW9Db250ZXh0LiBQb3NzaWJseSB0b28gbWFueSBBdWRpb0NvbnRleHRzIHJ1bm5pbmcgYWxyZWFkeS5cIik7Zm9yKHRoaXMuX2NvbnRleHQ9dC5jb250ZXh0O3RoaXMuX2NvbnRleHQucmF3Q29udGV4dDspdGhpcy5fY29udGV4dD10aGlzLl9jb250ZXh0LnJhd0NvbnRleHQ7bi5mb3JFYWNoKGZ1bmN0aW9uKHQpe3RoaXMuX2RlZmluZVByb3BlcnR5KHRoaXMuX2NvbnRleHQsdCl9LmJpbmQodGhpcykpLG8uZm9yRWFjaChmdW5jdGlvbih0KXt0aGlzLl9kZWZpbmVNZXRob2QodGhpcy5fY29udGV4dCx0KX0uYmluZCh0aGlzKSksdGhpcy5fbGF0ZW5jeUhpbnQ9dC5sYXRlbmN5SGludCx0aGlzLl9jb25zdGFudHM9e30sdGhpcy5sb29rQWhlYWQ9dC5sb29rQWhlYWQsdGhpcy5fY29tcHV0ZWRVcGRhdGVJbnRlcnZhbD0wLHRoaXMuX3RpY2tlcj1uZXcgYSh0aGlzLmVtaXQuYmluZCh0aGlzLFwidGlja1wiKSx0LmNsb2NrU291cmNlLHQudXBkYXRlSW50ZXJ2YWwpLHRoaXMuX3RpbWVvdXRzPW5ldyBzLmRlZmF1bHQuVGltZWxpbmUsdGhpcy5fdGltZW91dElkcz0wLHRoaXMub24oXCJ0aWNrXCIsdGhpcy5fdGltZW91dExvb3AuYmluZCh0aGlzKSksdGhpcy5fY29udGV4dC5vbnN0YXRlY2hhbmdlPWZ1bmN0aW9uKHQpe3RoaXMuZW1pdChcInN0YXRlY2hhbmdlXCIsdCl9LmJpbmQodGhpcyl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkNvbnRleHQscy5kZWZhdWx0LkVtaXR0ZXIpLHMuZGVmYXVsdC5FbWl0dGVyLm1peGluKHMuZGVmYXVsdC5Db250ZXh0KSxzLmRlZmF1bHQuQ29udGV4dC5kZWZhdWx0cz17Y2xvY2tTb3VyY2U6XCJ3b3JrZXJcIixsYXRlbmN5SGludDpcImludGVyYWN0aXZlXCIsbG9va0FoZWFkOi4xLHVwZGF0ZUludGVydmFsOi4wM30scy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLmlzQ29udGV4dD0hMCxzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUuX2RlZmluZVByb3BlcnR5PWZ1bmN0aW9uKHQsZSl7cy5kZWZhdWx0LmlzVW5kZWYodGhpc1tlXSkmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLGUse2dldDpmdW5jdGlvbigpe3JldHVybiB0W2VdfSxzZXQ6ZnVuY3Rpb24oaSl7dFtlXT1pfX0pfSxzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUuX2RlZmluZU1ldGhvZD1mdW5jdGlvbih0LGUpe3MuZGVmYXVsdC5pc1VuZGVmKHRoaXNbZV0pJiZPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxlLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdFtlXS5iaW5kKHQpfX0pfSxzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUubm93PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnRleHQuY3VycmVudFRpbWUrdGhpcy5sb29rQWhlYWR9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUsXCJkZXN0aW5hdGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXN0ZXI/dGhpcy5tYXN0ZXI6dGhpcy5fY29udGV4dC5kZXN0aW5hdGlvbn19KSxzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUucmVzdW1lPWZ1bmN0aW9uKCl7cmV0dXJuXCJzdXNwZW5kZWRcIj09PXRoaXMuX2NvbnRleHQuc3RhdGUmJnRoaXMuX2NvbnRleHQgaW5zdGFuY2VvZiBBdWRpb0NvbnRleHQ/dGhpcy5fY29udGV4dC5yZXN1bWUoKTpQcm9taXNlLnJlc29sdmUoKX0scy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKCl7dmFyIHQ9UHJvbWlzZS5yZXNvbHZlKCk7cmV0dXJuIHRoaXMhPT1zLmRlZmF1bHQuZ2xvYmFsLlRPTkVfQVVESU9fQ09OVEVYVCYmKHQ9dGhpcy5yYXdDb250ZXh0LmNsb3NlKCkpLHQudGhlbihmdW5jdGlvbigpe3MuZGVmYXVsdC5Db250ZXh0LmVtaXQoXCJjbG9zZVwiLHRoaXMpfS5iaW5kKHRoaXMpKX0scy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLmdldENvbnN0YW50PWZ1bmN0aW9uKHQpe2lmKHRoaXMuX2NvbnN0YW50c1t0XSlyZXR1cm4gdGhpcy5fY29uc3RhbnRzW3RdO2Zvcih2YXIgZT10aGlzLl9jb250ZXh0LmNyZWF0ZUJ1ZmZlcigxLDEyOCx0aGlzLl9jb250ZXh0LnNhbXBsZVJhdGUpLGk9ZS5nZXRDaGFubmVsRGF0YSgwKSxzPTA7czxpLmxlbmd0aDtzKyspaVtzXT10O3ZhciBuPXRoaXMuX2NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7cmV0dXJuIG4uY2hhbm5lbENvdW50PTEsbi5jaGFubmVsQ291bnRNb2RlPVwiZXhwbGljaXRcIixuLmJ1ZmZlcj1lLG4ubG9vcD0hMCxuLnN0YXJ0KDApLHRoaXMuX2NvbnN0YW50c1t0XT1uLG59LHMuZGVmYXVsdC5Db250ZXh0LnByb3RvdHlwZS5fdGltZW91dExvb3A9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9dGhpcy5ub3coKTt0aGlzLl90aW1lb3V0cyYmdGhpcy5fdGltZW91dHMubGVuZ3RoJiZ0aGlzLl90aW1lb3V0cy5wZWVrKCkudGltZTw9dDspdGhpcy5fdGltZW91dHMuc2hpZnQoKS5jYWxsYmFjaygpfSxzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUuc2V0VGltZW91dD1mdW5jdGlvbih0LGUpe3RoaXMuX3RpbWVvdXRJZHMrKzt2YXIgaT10aGlzLm5vdygpO3JldHVybiB0aGlzLl90aW1lb3V0cy5hZGQoe2NhbGxiYWNrOnQsdGltZTppK2UsaWQ6dGhpcy5fdGltZW91dElkc30pLHRoaXMuX3RpbWVvdXRJZHN9LHMuZGVmYXVsdC5Db250ZXh0LnByb3RvdHlwZS5jbGVhclRpbWVvdXQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3RpbWVvdXRzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5pZD09PXQmJnRoaXMucmVtb3ZlKGUpfSksdGhpc30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Db250ZXh0LnByb3RvdHlwZSxcInVwZGF0ZUludGVydmFsXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90aWNrZXIudXBkYXRlSW50ZXJ2YWx9LHNldDpmdW5jdGlvbih0KXt0aGlzLl90aWNrZXIudXBkYXRlSW50ZXJ2YWw9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLFwicmF3Q29udGV4dFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29udGV4dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLFwiY2xvY2tTb3VyY2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RpY2tlci50eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fdGlja2VyLnR5cGU9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNvbnRleHQucHJvdG90eXBlLFwibGF0ZW5jeUhpbnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xhdGVuY3lIaW50fSxzZXQ6ZnVuY3Rpb24odCl7dmFyIGU9dDtpZih0aGlzLl9sYXRlbmN5SGludD10LHMuZGVmYXVsdC5pc1N0cmluZyh0KSlzd2l0Y2godCl7Y2FzZVwiaW50ZXJhY3RpdmVcIjplPS4xLHRoaXMuX2NvbnRleHQubGF0ZW5jeUhpbnQ9dDticmVhaztjYXNlXCJwbGF5YmFja1wiOmU9LjgsdGhpcy5fY29udGV4dC5sYXRlbmN5SGludD10O2JyZWFrO2Nhc2VcImJhbGFuY2VkXCI6ZT0uMjUsdGhpcy5fY29udGV4dC5sYXRlbmN5SGludD10O2JyZWFrO2Nhc2VcImZhc3Rlc3RcIjp0aGlzLl9jb250ZXh0LmxhdGVuY3lIaW50PVwiaW50ZXJhY3RpdmVcIixlPS4wMX10aGlzLmxvb2tBaGVhZD1lLHRoaXMudXBkYXRlSW50ZXJ2YWw9ZS8zfX0pLHMuZGVmYXVsdC5Db250ZXh0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY2xvc2UoKS50aGVuKGZ1bmN0aW9uKCl7Zm9yKHZhciB0IGluIHMuZGVmYXVsdC5FbWl0dGVyLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fdGlja2VyLmRpc3Bvc2UoKSx0aGlzLl90aWNrZXI9bnVsbCx0aGlzLl90aW1lb3V0cy5kaXNwb3NlKCksdGhpcy5fdGltZW91dHM9bnVsbCx0aGlzLl9jb25zdGFudHMpdGhpcy5fY29uc3RhbnRzW3RdLmRpc2Nvbm5lY3QoKTt0aGlzLl9jb25zdGFudHM9bnVsbH0uYmluZCh0aGlzKSl9O3ZhciBhPWZ1bmN0aW9uKHQsZSxpKXt0aGlzLl90eXBlPWUsdGhpcy5fdXBkYXRlSW50ZXJ2YWw9aSx0aGlzLl9jYWxsYmFjaz1zLmRlZmF1bHQuZGVmYXVsdEFyZyh0LHMuZGVmYXVsdC5ub09wKSx0aGlzLl9jcmVhdGVDbG9jaygpfTthLlR5cGU9e1dvcmtlcjpcIndvcmtlclwiLFRpbWVvdXQ6XCJ0aW1lb3V0XCIsT2ZmbGluZTpcIm9mZmxpbmVcIn0sYS5wcm90b3R5cGUuX2NyZWF0ZVdvcmtlcj1mdW5jdGlvbigpe3MuZGVmYXVsdC5nbG9iYWwuVVJMPXMuZGVmYXVsdC5nbG9iYWwuVVJMfHxzLmRlZmF1bHQuZ2xvYmFsLndlYmtpdFVSTDt2YXIgdD1uZXcgQmxvYihbXCJ2YXIgdGltZW91dFRpbWUgPSBcIisoMWUzKnRoaXMuX3VwZGF0ZUludGVydmFsKS50b0ZpeGVkKDEpK1wiO3NlbGYub25tZXNzYWdlID0gZnVuY3Rpb24obXNnKXtcXHR0aW1lb3V0VGltZSA9IHBhcnNlSW50KG1zZy5kYXRhKTt9O2Z1bmN0aW9uIHRpY2soKXtcXHRzZXRUaW1lb3V0KHRpY2ssIHRpbWVvdXRUaW1lKTtcXHRzZWxmLnBvc3RNZXNzYWdlKCd0aWNrJyk7fXRpY2soKTtcIl0pLGU9VVJMLmNyZWF0ZU9iamVjdFVSTCh0KSxpPW5ldyBXb3JrZXIoZSk7aS5vbm1lc3NhZ2U9dGhpcy5fY2FsbGJhY2suYmluZCh0aGlzKSx0aGlzLl93b3JrZXI9aX0sYS5wcm90b3R5cGUuX2NyZWF0ZVRpbWVvdXQ9ZnVuY3Rpb24oKXt0aGlzLl90aW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aGlzLl9jcmVhdGVUaW1lb3V0KCksdGhpcy5fY2FsbGJhY2soKX0uYmluZCh0aGlzKSwxZTMqdGhpcy5fdXBkYXRlSW50ZXJ2YWwpfSxhLnByb3RvdHlwZS5fY3JlYXRlQ2xvY2s9ZnVuY3Rpb24oKXtpZih0aGlzLl90eXBlPT09YS5UeXBlLldvcmtlcil0cnl7dGhpcy5fY3JlYXRlV29ya2VyKCl9Y2F0Y2godCl7dGhpcy5fdHlwZT1hLlR5cGUuVGltZW91dCx0aGlzLl9jcmVhdGVDbG9jaygpfWVsc2UgdGhpcy5fdHlwZT09PWEuVHlwZS5UaW1lb3V0JiZ0aGlzLl9jcmVhdGVUaW1lb3V0KCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLnByb3RvdHlwZSxcInVwZGF0ZUludGVydmFsXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl91cGRhdGVJbnRlcnZhbH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3VwZGF0ZUludGVydmFsPU1hdGgubWF4KHQsMTI4LzQ0MTAwKSx0aGlzLl90eXBlPT09YS5UeXBlLldvcmtlciYmdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKE1hdGgubWF4KDFlMyp0LDEpKX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJ0eXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fZGlzcG9zZUNsb2NrKCksdGhpcy5fdHlwZT10LHRoaXMuX2NyZWF0ZUNsb2NrKCl9fSksYS5wcm90b3R5cGUuX2Rpc3Bvc2VDbG9jaz1mdW5jdGlvbigpe3RoaXMuX3RpbWVvdXQmJihjbGVhclRpbWVvdXQodGhpcy5fdGltZW91dCksdGhpcy5fdGltZW91dD1udWxsKSx0aGlzLl93b3JrZXImJih0aGlzLl93b3JrZXIudGVybWluYXRlKCksdGhpcy5fd29ya2VyLm9ubWVzc2FnZT1udWxsLHRoaXMuX3dvcmtlcj1udWxsKX0sYS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3RoaXMuX2Rpc3Bvc2VDbG9jaygpLHRoaXMuX2NhbGxiYWNrPW51bGx9LHMuZGVmYXVsdC5zdXBwb3J0ZWQmJiFzLmRlZmF1bHQuaW5pdGlhbGl6ZWQ/KHMuZGVmYXVsdC5nbG9iYWwuVE9ORV9BVURJT19DT05URVhUfHwocy5kZWZhdWx0Lmdsb2JhbC5UT05FX0FVRElPX0NPTlRFWFQ9bmV3IHMuZGVmYXVsdC5Db250ZXh0KSxzLmRlZmF1bHQuY29udGV4dD1zLmRlZmF1bHQuZ2xvYmFsLlRPTkVfQVVESU9fQ09OVEVYVCk6cy5kZWZhdWx0LnN1cHBvcnRlZHx8cy5kZWZhdWx0Lmdsb2JhbC5UT05FX1NJTEVOQ0VfTE9HR0lOR3x8Y29uc29sZS53YXJuKFwiVGhpcyBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgVG9uZS5qc1wiKSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkNvbnRleHR9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDQpLGkoNDApO3MuZGVmYXVsdC5JbnN0cnVtZW50PWZ1bmN0aW9uKHQpe3Q9cy5kZWZhdWx0LmRlZmF1bHRBcmcodCxzLmRlZmF1bHQuSW5zdHJ1bWVudC5kZWZhdWx0cykscy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuX3ZvbHVtZT10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LlZvbHVtZSh0LnZvbHVtZSksdGhpcy52b2x1bWU9dGhpcy5fdm9sdW1lLnZvbHVtZSx0aGlzLl9yZWFkT25seShcInZvbHVtZVwiKSx0aGlzLl9zY2hlZHVsZWRFdmVudHM9W119LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lkluc3RydW1lbnQscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0Lkluc3RydW1lbnQuZGVmYXVsdHM9e3ZvbHVtZTowfSxzLmRlZmF1bHQuSW5zdHJ1bWVudC5wcm90b3R5cGUudHJpZ2dlckF0dGFjaz1zLmRlZmF1bHQubm9PcCxzLmRlZmF1bHQuSW5zdHJ1bWVudC5wcm90b3R5cGUudHJpZ2dlclJlbGVhc2U9cy5kZWZhdWx0Lm5vT3Ascy5kZWZhdWx0Lkluc3RydW1lbnQucHJvdG90eXBlLnN5bmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJBdHRhY2tcIiwxKSx0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlclJlbGVhc2VcIiwwKSx0aGlzfSxzLmRlZmF1bHQuSW5zdHJ1bWVudC5wcm90b3R5cGUuX3N5bmNNZXRob2Q9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzW1wiX29yaWdpbmFsX1wiK3RdPXRoaXNbdF07dGhpc1t0XT1mdW5jdGlvbigpe3ZhciB0PUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyksbj10W2VdLG89cy5kZWZhdWx0LlRyYW5zcG9ydC5zY2hlZHVsZShmdW5jdGlvbihzKXt0W2VdPXMsaS5hcHBseSh0aGlzLHQpfS5iaW5kKHRoaXMpLG4pO3RoaXMuX3NjaGVkdWxlZEV2ZW50cy5wdXNoKG8pfS5iaW5kKHRoaXMpfSxzLmRlZmF1bHQuSW5zdHJ1bWVudC5wcm90b3R5cGUudW5zeW5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NjaGVkdWxlZEV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3MuZGVmYXVsdC5UcmFuc3BvcnQuY2xlYXIodCl9KSx0aGlzLl9zY2hlZHVsZWRFdmVudHM9W10sdGhpcy5fb3JpZ2luYWxfdHJpZ2dlckF0dGFjayYmKHRoaXMudHJpZ2dlckF0dGFjaz10aGlzLl9vcmlnaW5hbF90cmlnZ2VyQXR0YWNrLHRoaXMudHJpZ2dlclJlbGVhc2U9dGhpcy5fb3JpZ2luYWxfdHJpZ2dlclJlbGVhc2UpLHRoaXN9LHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrUmVsZWFzZT1mdW5jdGlvbih0LGUsaSxzKXtyZXR1cm4gaT10aGlzLnRvU2Vjb25kcyhpKSxlPXRoaXMudG9TZWNvbmRzKGUpLHRoaXMudHJpZ2dlckF0dGFjayh0LGkscyksdGhpcy50cmlnZ2VyUmVsZWFzZShpK2UpLHRoaXN9LHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl92b2x1bWUuZGlzcG9zZSgpLHRoaXMuX3ZvbHVtZT1udWxsLHRoaXMuX3dyaXRhYmxlKFtcInZvbHVtZVwiXSksdGhpcy52b2x1bWU9bnVsbCx0aGlzLnVuc3luYygpLHRoaXMuX3NjaGVkdWxlZEV2ZW50cz1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuSW5zdHJ1bWVudH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNyksaSgyKTtzLmRlZmF1bHQuQXVkaW9Ub0dhaW49ZnVuY3Rpb24oKXtzLmRlZmF1bHQuU2lnbmFsQmFzZS5jYWxsKHRoaXMpLHRoaXMuX25vcm09dGhpcy5pbnB1dD10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LldhdmVTaGFwZXIoZnVuY3Rpb24odCl7cmV0dXJuKHQrMSkvMn0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5BdWRpb1RvR2FpbixzLmRlZmF1bHQuU2lnbmFsQmFzZSkscy5kZWZhdWx0LkF1ZGlvVG9HYWluLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fbm9ybS5kaXNwb3NlKCksdGhpcy5fbm9ybT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuQXVkaW9Ub0dhaW59LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDIpLGkoMTMpLGkoODkpLGkoMyksaSgxKTtzLmRlZmF1bHQuQ3Jvc3NGYWRlPWZ1bmN0aW9uKHQpe3MuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSx0aGlzLmNyZWF0ZUluc091dHMoMiwxKSx0aGlzLmE9dGhpcy5pbnB1dFswXT1uZXcgcy5kZWZhdWx0LkdhaW4sdGhpcy5iPXRoaXMuaW5wdXRbMV09bmV3IHMuZGVmYXVsdC5HYWluLHRoaXMuZmFkZT1uZXcgcy5kZWZhdWx0LlNpZ25hbChzLmRlZmF1bHQuZGVmYXVsdEFyZyh0LC41KSxzLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSksdGhpcy5fZXF1YWxQb3dlckE9bmV3IHMuZGVmYXVsdC5FcXVhbFBvd2VyR2Fpbix0aGlzLl9lcXVhbFBvd2VyQj1uZXcgcy5kZWZhdWx0LkVxdWFsUG93ZXJHYWluLHRoaXMuX29uZT10aGlzLmNvbnRleHQuZ2V0Q29uc3RhbnQoMSksdGhpcy5faW52ZXJ0PW5ldyBzLmRlZmF1bHQuU3VidHJhY3QsdGhpcy5hLmNvbm5lY3QodGhpcy5vdXRwdXQpLHRoaXMuYi5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLmZhZGUuY2hhaW4odGhpcy5fZXF1YWxQb3dlckIsdGhpcy5iLmdhaW4pLHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuX29uZSx0aGlzLl9pbnZlcnQsMCwwKSx0aGlzLmZhZGUuY29ubmVjdCh0aGlzLl9pbnZlcnQsMCwxKSx0aGlzLl9pbnZlcnQuY2hhaW4odGhpcy5fZXF1YWxQb3dlckEsdGhpcy5hLmdhaW4pLHRoaXMuX3JlYWRPbmx5KFwiZmFkZVwiKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ3Jvc3NGYWRlLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5Dcm9zc0ZhZGUucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3dyaXRhYmxlKFwiZmFkZVwiKSx0aGlzLl9lcXVhbFBvd2VyQS5kaXNwb3NlKCksdGhpcy5fZXF1YWxQb3dlckE9bnVsbCx0aGlzLl9lcXVhbFBvd2VyQi5kaXNwb3NlKCksdGhpcy5fZXF1YWxQb3dlckI9bnVsbCx0aGlzLmZhZGUuZGlzcG9zZSgpLHRoaXMuZmFkZT1udWxsLHRoaXMuX2ludmVydC5kaXNwb3NlKCksdGhpcy5faW52ZXJ0PW51bGwsdGhpcy5fb25lPW51bGwsdGhpcy5hLmRpc3Bvc2UoKSx0aGlzLmE9bnVsbCx0aGlzLmIuZGlzcG9zZSgpLHRoaXMuYj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuQ3Jvc3NGYWRlfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7cy5kZWZhdWx0LlRpbWVsaW5lPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJtZW1vcnlcIl0scy5kZWZhdWx0LlRpbWVsaW5lKTtzLmRlZmF1bHQuY2FsbCh0aGlzKSx0aGlzLl90aW1lbGluZT1bXSx0aGlzLm1lbW9yeT10Lm1lbW9yeX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVGltZWxpbmUpLHMuZGVmYXVsdC5UaW1lbGluZS5kZWZhdWx0cz17bWVtb3J5OjEvMH0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUsXCJsZW5ndGhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3RpbWVsaW5lLmxlbmd0aH19KSxzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0KXtpZihzLmRlZmF1bHQuaXNVbmRlZih0LnRpbWUpKXRocm93IG5ldyBFcnJvcihcIlRvbmUuVGltZWxpbmU6IGV2ZW50cyBtdXN0IGhhdmUgYSB0aW1lIGF0dHJpYnV0ZVwiKTt0LnRpbWU9dC50aW1lLnZhbHVlT2YoKTt2YXIgZT10aGlzLl9zZWFyY2godC50aW1lKTtpZih0aGlzLl90aW1lbGluZS5zcGxpY2UoZSsxLDAsdCksdGhpcy5sZW5ndGg+dGhpcy5tZW1vcnkpe3ZhciBpPXRoaXMubGVuZ3RoLXRoaXMubWVtb3J5O3RoaXMuX3RpbWVsaW5lLnNwbGljZSgwLGkpfXJldHVybiB0aGlzfSxzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzLl90aW1lbGluZS5pbmRleE9mKHQpO3JldHVybi0xIT09ZSYmdGhpcy5fdGltZWxpbmUuc3BsaWNlKGUsMSksdGhpc30scy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24odCxlKXtlPXMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsXCJ0aW1lXCIpO3ZhciBpPXRoaXMuX3NlYXJjaCh0LGUpO3JldHVybi0xIT09aT90aGlzLl90aW1lbGluZVtpXTpudWxsfSxzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLnBlZWs9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGltZWxpbmVbMF19LHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuc2hpZnQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdGltZWxpbmUuc2hpZnQoKX0scy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5nZXRBZnRlcj1mdW5jdGlvbih0LGUpe2U9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSxcInRpbWVcIik7dmFyIGk9dGhpcy5fc2VhcmNoKHQsZSk7cmV0dXJuIGkrMTx0aGlzLl90aW1lbGluZS5sZW5ndGg/dGhpcy5fdGltZWxpbmVbaSsxXTpudWxsfSxzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLmdldEJlZm9yZT1mdW5jdGlvbih0LGUpe2U9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSxcInRpbWVcIik7dmFyIGk9dGhpcy5fdGltZWxpbmUubGVuZ3RoO2lmKGk+MCYmdGhpcy5fdGltZWxpbmVbaS0xXVtlXTx0KXJldHVybiB0aGlzLl90aW1lbGluZVtpLTFdO3ZhciBuPXRoaXMuX3NlYXJjaCh0LGUpO3JldHVybiBuLTE+PTA/dGhpcy5fdGltZWxpbmVbbi0xXTpudWxsfSxzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLmNhbmNlbD1mdW5jdGlvbih0KXtpZih0aGlzLl90aW1lbGluZS5sZW5ndGg+MSl7dmFyIGU9dGhpcy5fc2VhcmNoKHQpO2lmKGU+PTApaWYodGhpcy5fdGltZWxpbmVbZV0udGltZT09PXQpe2Zvcih2YXIgaT1lO2k+PTAmJnRoaXMuX3RpbWVsaW5lW2ldLnRpbWU9PT10O2ktLSllPWk7dGhpcy5fdGltZWxpbmU9dGhpcy5fdGltZWxpbmUuc2xpY2UoMCxlKX1lbHNlIHRoaXMuX3RpbWVsaW5lPXRoaXMuX3RpbWVsaW5lLnNsaWNlKDAsZSsxKTtlbHNlIHRoaXMuX3RpbWVsaW5lPVtdfWVsc2UgMT09PXRoaXMuX3RpbWVsaW5lLmxlbmd0aCYmdGhpcy5fdGltZWxpbmVbMF0udGltZT49dCYmKHRoaXMuX3RpbWVsaW5lPVtdKTtyZXR1cm4gdGhpc30scy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5jYW5jZWxCZWZvcmU9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fc2VhcmNoKHQpO3JldHVybiBlPj0wJiYodGhpcy5fdGltZWxpbmU9dGhpcy5fdGltZWxpbmUuc2xpY2UoZSsxKSksdGhpc30scy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5wcmV2aW91c0V2ZW50PWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX3RpbWVsaW5lLmluZGV4T2YodCk7cmV0dXJuIGU+MD90aGlzLl90aW1lbGluZVtlLTFdOm51bGx9LHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuX3NlYXJjaD1mdW5jdGlvbih0LGUpe2lmKDA9PT10aGlzLl90aW1lbGluZS5sZW5ndGgpcmV0dXJuLTE7ZT1zLmRlZmF1bHQuZGVmYXVsdEFyZyhlLFwidGltZVwiKTt2YXIgaT0wLG49dGhpcy5fdGltZWxpbmUubGVuZ3RoLG89bjtpZihuPjAmJnRoaXMuX3RpbWVsaW5lW24tMV1bZV08PXQpcmV0dXJuIG4tMTtmb3IoO2k8bzspe3ZhciBhPU1hdGguZmxvb3IoaSsoby1pKS8yKSxyPXRoaXMuX3RpbWVsaW5lW2FdLGw9dGhpcy5fdGltZWxpbmVbYSsxXTtpZihyW2VdPT09dCl7Zm9yKHZhciB1PWE7dTx0aGlzLl90aW1lbGluZS5sZW5ndGg7dSsrKXt0aGlzLl90aW1lbGluZVt1XVtlXT09PXQmJihhPXUpfXJldHVybiBhfWlmKHJbZV08dCYmbFtlXT50KXJldHVybiBhO3JbZV0+dD9vPWE6aT1hKzF9cmV0dXJuLTF9LHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuX2l0ZXJhdGU9ZnVuY3Rpb24odCxlLGkpe2U9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwwKSxpPXMuZGVmYXVsdC5kZWZhdWx0QXJnKGksdGhpcy5fdGltZWxpbmUubGVuZ3RoLTEpLHRoaXMuX3RpbWVsaW5lLnNsaWNlKGUsaSsxKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3QuY2FsbCh0aGlzLGUpfS5iaW5kKHRoaXMpKX0scy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5mb3JFYWNoPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9pdGVyYXRlKHQpLHRoaXN9LHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuZm9yRWFjaEJlZm9yZT1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX3NlYXJjaCh0KTtyZXR1cm4tMSE9PWkmJnRoaXMuX2l0ZXJhdGUoZSwwLGkpLHRoaXN9LHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuZm9yRWFjaEFmdGVyPWZ1bmN0aW9uKHQsZSl7dmFyIGk9dGhpcy5fc2VhcmNoKHQpO3JldHVybiB0aGlzLl9pdGVyYXRlKGUsaSsxKSx0aGlzfSxzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLmZvckVhY2hCZXR3ZWVuPWZ1bmN0aW9uKHQsZSxpKXt2YXIgcz10aGlzLl9zZWFyY2godCksbj10aGlzLl9zZWFyY2goZSk7cmV0dXJuLTEhPT1zJiYtMSE9PW4/KHRoaXMuX3RpbWVsaW5lW3NdLnRpbWUhPT10JiYocys9MSksdGhpcy5fdGltZWxpbmVbbl0udGltZT09PWUmJihuLT0xKSx0aGlzLl9pdGVyYXRlKGkscyxuKSk6LTE9PT1zJiZ0aGlzLl9pdGVyYXRlKGksMCxuKSx0aGlzfSxzLmRlZmF1bHQuVGltZWxpbmUucHJvdG90eXBlLmZvckVhY2hGcm9tPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPXRoaXMuX3NlYXJjaCh0KTtpPj0wJiZ0aGlzLl90aW1lbGluZVtpXS50aW1lPj10OylpLS07cmV0dXJuIHRoaXMuX2l0ZXJhdGUoZSxpKzEpLHRoaXN9LHMuZGVmYXVsdC5UaW1lbGluZS5wcm90b3R5cGUuZm9yRWFjaEF0VGltZT1mdW5jdGlvbih0LGUpe3ZhciBpPXRoaXMuX3NlYXJjaCh0KTtyZXR1cm4tMSE9PWkmJnRoaXMuX2l0ZXJhdGUoZnVuY3Rpb24oaSl7aS50aW1lPT09dCYmZS5jYWxsKHRoaXMsaSl9LDAsaSksdGhpc30scy5kZWZhdWx0LlRpbWVsaW5lLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3RpbWVsaW5lPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5UaW1lbGluZX0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMjEpLGkoMik7cy5kZWZhdWx0Lk1vbm9waG9uaWM9ZnVuY3Rpb24odCl7dD1zLmRlZmF1bHQuZGVmYXVsdEFyZyh0LHMuZGVmYXVsdC5Nb25vcGhvbmljLmRlZmF1bHRzKSxzLmRlZmF1bHQuSW5zdHJ1bWVudC5jYWxsKHRoaXMsdCksdGhpcy5wb3J0YW1lbnRvPXQucG9ydGFtZW50b30scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTW9ub3Bob25pYyxzLmRlZmF1bHQuSW5zdHJ1bWVudCkscy5kZWZhdWx0Lk1vbm9waG9uaWMuZGVmYXVsdHM9e3BvcnRhbWVudG86MH0scy5kZWZhdWx0Lk1vbm9waG9uaWMucHJvdG90eXBlLnRyaWdnZXJBdHRhY2s9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0aGlzLmxvZyhcInRyaWdnZXJBdHRhY2tcIix0LGUsaSksZT10aGlzLnRvU2Vjb25kcyhlKSx0aGlzLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2soZSxpKSx0aGlzLnNldE5vdGUodCxlKSx0aGlzfSxzLmRlZmF1bHQuTW9ub3Bob25pYy5wcm90b3R5cGUudHJpZ2dlclJlbGVhc2U9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMubG9nKFwidHJpZ2dlclJlbGVhc2VcIix0KSx0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UodCksdGhpc30scy5kZWZhdWx0Lk1vbm9waG9uaWMucHJvdG90eXBlLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2s9ZnVuY3Rpb24oKXt9LHMuZGVmYXVsdC5Nb25vcGhvbmljLnByb3RvdHlwZS5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZT1mdW5jdGlvbigpe30scy5kZWZhdWx0Lk1vbm9waG9uaWMucHJvdG90eXBlLmdldExldmVsQXRUaW1lPWZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuZW52ZWxvcGUuZ2V0VmFsdWVBdFRpbWUodCl9LHMuZGVmYXVsdC5Nb25vcGhvbmljLnByb3RvdHlwZS5zZXROb3RlPWZ1bmN0aW9uKHQsZSl7aWYoZT10aGlzLnRvU2Vjb25kcyhlKSx0aGlzLnBvcnRhbWVudG8+MCYmdGhpcy5nZXRMZXZlbEF0VGltZShlKT4uMDUpe3ZhciBpPXRoaXMudG9TZWNvbmRzKHRoaXMucG9ydGFtZW50byk7dGhpcy5mcmVxdWVuY3kuZXhwb25lbnRpYWxSYW1wVG8odCxpLGUpfWVsc2UgdGhpcy5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUodCxlKTtyZXR1cm4gdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5Nb25vcGhvbmljfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyOSksaSg1KSxpKDIpO3MuZGVmYXVsdC5TY2FsZT1mdW5jdGlvbih0LGUpe3MuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksdGhpcy5fb3V0cHV0TWluPXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsMCksdGhpcy5fb3V0cHV0TWF4PXMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsMSksdGhpcy5fc2NhbGU9dGhpcy5pbnB1dD1uZXcgcy5kZWZhdWx0Lk11bHRpcGx5KDEpLHRoaXMuX2FkZD10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LkFkZCgwKSx0aGlzLl9zY2FsZS5jb25uZWN0KHRoaXMuX2FkZCksdGhpcy5fc2V0UmFuZ2UoKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU2NhbGUscy5kZWZhdWx0LlNpZ25hbEJhc2UpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU2NhbGUucHJvdG90eXBlLFwibWluXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vdXRwdXRNaW59LHNldDpmdW5jdGlvbih0KXt0aGlzLl9vdXRwdXRNaW49dCx0aGlzLl9zZXRSYW5nZSgpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU2NhbGUucHJvdG90eXBlLFwibWF4XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vdXRwdXRNYXh9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9vdXRwdXRNYXg9dCx0aGlzLl9zZXRSYW5nZSgpfX0pLHMuZGVmYXVsdC5TY2FsZS5wcm90b3R5cGUuX3NldFJhbmdlPWZ1bmN0aW9uKCl7dGhpcy5fYWRkLnZhbHVlPXRoaXMuX291dHB1dE1pbix0aGlzLl9zY2FsZS52YWx1ZT10aGlzLl9vdXRwdXRNYXgtdGhpcy5fb3V0cHV0TWlufSxzLmRlZmF1bHQuU2NhbGUucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9hZGQuZGlzcG9zZSgpLHRoaXMuX2FkZD1udWxsLHRoaXMuX3NjYWxlLmRpc3Bvc2UoKSx0aGlzLl9zY2FsZT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuU2NhbGV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDIpLGkoMyksaSgxKTtzLmRlZmF1bHQuVm9sdW1lPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJ2b2x1bWVcIl0scy5kZWZhdWx0LlZvbHVtZSk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMsdCksdGhpcy5vdXRwdXQ9dGhpcy5pbnB1dD1uZXcgcy5kZWZhdWx0LkdhaW4odC52b2x1bWUscy5kZWZhdWx0LlR5cGUuRGVjaWJlbHMpLHRoaXMuX3VubXV0ZWRWb2x1bWU9dC52b2x1bWUsdGhpcy52b2x1bWU9dGhpcy5vdXRwdXQuZ2Fpbix0aGlzLl9yZWFkT25seShcInZvbHVtZVwiKSx0aGlzLm11dGU9dC5tdXRlfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Wb2x1bWUscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LlZvbHVtZS5kZWZhdWx0cz17dm9sdW1lOjAsbXV0ZTohMX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Wb2x1bWUucHJvdG90eXBlLFwibXV0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52b2x1bWUudmFsdWU9PT0tMS8wfSxzZXQ6ZnVuY3Rpb24odCl7IXRoaXMubXV0ZSYmdD8odGhpcy5fdW5tdXRlZFZvbHVtZT10aGlzLnZvbHVtZS52YWx1ZSx0aGlzLnZvbHVtZS52YWx1ZT0tMS8wKTp0aGlzLm11dGUmJiF0JiYodGhpcy52b2x1bWUudmFsdWU9dGhpcy5fdW5tdXRlZFZvbHVtZSl9fSkscy5kZWZhdWx0LlZvbHVtZS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlucHV0LmRpc3Bvc2UoKSxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoXCJ2b2x1bWVcIiksdGhpcy52b2x1bWUuZGlzcG9zZSgpLHRoaXMudm9sdW1lPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5Wb2x1bWV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDMpLGkoMzApO3MuZGVmYXVsdC5aZXJvPWZ1bmN0aW9uKCl7cy5kZWZhdWx0LlNpZ25hbEJhc2UuY2FsbCh0aGlzKSx0aGlzLl9nYWluPXRoaXMuaW5wdXQ9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5HYWluLHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuY29udGV4dC5nZXRDb25zdGFudCgwKSx0aGlzLl9nYWluKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuWmVybyxzLmRlZmF1bHQuU2lnbmFsQmFzZSkscy5kZWZhdWx0Llplcm8ucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9nYWluLmRpc3Bvc2UoKSx0aGlzLl9nYWluPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5aZXJvfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyKSxpKDMpO3MuZGVmYXVsdC5BZGQ9ZnVuY3Rpb24odCl7cy5kZWZhdWx0LlNpZ25hbC5jYWxsKHRoaXMpLHRoaXMuY3JlYXRlSW5zT3V0cygyLDApLHRoaXMuX3N1bT10aGlzLmlucHV0WzBdPXRoaXMuaW5wdXRbMV09dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5HYWluLHRoaXMuX3BhcmFtPXRoaXMuaW5wdXRbMV09bmV3IHMuZGVmYXVsdC5TaWduYWwodCksdGhpcy5fcGFyYW0uY29ubmVjdCh0aGlzLl9zdW0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5BZGQscy5kZWZhdWx0LlNpZ25hbCkscy5kZWZhdWx0LkFkZC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fc3VtLmRpc3Bvc2UoKSx0aGlzLl9zdW09bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkFkZH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMSk7cy5kZWZhdWx0LlNpZ25hbEJhc2U9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlNpZ25hbEJhc2Uscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmNvbm5lY3Q9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBzLmRlZmF1bHQuU2lnbmFsJiZzLmRlZmF1bHQuU2lnbmFsPT09dC5jb25zdHJ1Y3Rvcnx8cy5kZWZhdWx0LlBhcmFtJiZzLmRlZmF1bHQuUGFyYW09PT10LmNvbnN0cnVjdG9yPyh0Ll9wYXJhbS5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMoMCksdC5fcGFyYW0uc2V0VmFsdWVBdFRpbWUoMCwwKSx0Lm92ZXJyaWRkZW49ITApOnQgaW5zdGFuY2VvZiBBdWRpb1BhcmFtJiYodC5jYW5jZWxTY2hlZHVsZWRWYWx1ZXMoMCksdC5zZXRWYWx1ZUF0VGltZSgwLDApKSxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5jb25uZWN0LmNhbGwodGhpcyx0LGUsaSksdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5TaWduYWxCYXNlfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg0NyksaSgzKTtzLmRlZmF1bHQuQW1wbGl0dWRlRW52ZWxvcGU9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuRW52ZWxvcGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuaW5wdXQ9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5HYWluLHRoaXMuX3NpZy5jb25uZWN0KHRoaXMub3V0cHV0LmdhaW4pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5BbXBsaXR1ZGVFbnZlbG9wZSxzLmRlZmF1bHQuRW52ZWxvcGUpLHMuZGVmYXVsdC5BbXBsaXR1ZGVFbnZlbG9wZS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkFtcGxpdHVkZUVudmVsb3BlfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgxMSksaSg2KSxpKDMpLGkoMSk7cy5kZWZhdWx0LkJ1ZmZlclNvdXJjZT1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiYnVmZmVyXCIsXCJvbmxvYWRcIl0scy5kZWZhdWx0LkJ1ZmZlclNvdXJjZSk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMsdCksdGhpcy5vbmVuZGVkPXQub25lbmRlZCx0aGlzLl9zdGFydFRpbWU9LTEsdGhpcy5fc291cmNlU3RhcnRlZD0hMSx0aGlzLl9zb3VyY2VTdG9wcGVkPSExLHRoaXMuX3N0b3BUaW1lPS0xLHRoaXMuX2dhaW5Ob2RlPXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuR2FpbigwKSx0aGlzLl9zb3VyY2U9dGhpcy5jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpLHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuX3NvdXJjZSx0aGlzLl9nYWluTm9kZSksdGhpcy5fc291cmNlLm9uZW5kZWQ9dGhpcy5fb25lbmRlZC5iaW5kKHRoaXMpLHRoaXMuX2J1ZmZlcj1uZXcgcy5kZWZhdWx0LkJ1ZmZlcih0LmJ1ZmZlcix0Lm9ubG9hZCksdGhpcy5wbGF5YmFja1JhdGU9bmV3IHMuZGVmYXVsdC5QYXJhbSh7cGFyYW06dGhpcy5fc291cmNlLnBsYXliYWNrUmF0ZSx1bml0czpzLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSx2YWx1ZTp0LnBsYXliYWNrUmF0ZX0pLHRoaXMuZmFkZUluPXQuZmFkZUluLHRoaXMuZmFkZU91dD10LmZhZGVPdXQsdGhpcy5jdXJ2ZT10LmN1cnZlLHRoaXMuX29uZW5kZWRUaW1lb3V0PS0xLHRoaXMubG9vcD10Lmxvb3AsdGhpcy5sb29wU3RhcnQ9dC5sb29wU3RhcnQsdGhpcy5sb29wRW5kPXQubG9vcEVuZH0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQnVmZmVyU291cmNlLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UuZGVmYXVsdHM9e29uZW5kZWQ6cy5kZWZhdWx0Lm5vT3Asb25sb2FkOnMuZGVmYXVsdC5ub09wLGxvb3A6ITEsbG9vcFN0YXJ0OjAsbG9vcEVuZDowLGZhZGVJbjowLGZhZGVPdXQ6MCxjdXJ2ZTpcImxpbmVhclwiLHBsYXliYWNrUmF0ZToxfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkJ1ZmZlclNvdXJjZS5wcm90b3R5cGUsXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTdGF0ZUF0VGltZSh0aGlzLm5vdygpKX19KSxzLmRlZmF1bHQuQnVmZmVyU291cmNlLnByb3RvdHlwZS5nZXRTdGF0ZUF0VGltZT1mdW5jdGlvbih0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSwtMSE9PXRoaXMuX3N0YXJ0VGltZSYmdGhpcy5fc3RhcnRUaW1lPD10JiYoLTE9PT10aGlzLl9zdG9wVGltZXx8dDx0aGlzLl9zdG9wVGltZSkmJiF0aGlzLl9zb3VyY2VTdG9wcGVkP3MuZGVmYXVsdC5TdGF0ZS5TdGFydGVkOnMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkfSxzLmRlZmF1bHQuQnVmZmVyU291cmNlLnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbih0LGUsaSxuKXt0aGlzLmxvZyhcInN0YXJ0XCIsdCxlLGksbiksdGhpcy5hc3NlcnQoLTE9PT10aGlzLl9zdGFydFRpbWUsXCJjYW4gb25seSBiZSBzdGFydGVkIG9uY2VcIiksdGhpcy5hc3NlcnQodGhpcy5idWZmZXIubG9hZGVkLFwiYnVmZmVyIGlzIGVpdGhlciBub3Qgc2V0IG9yIG5vdCBsb2FkZWRcIiksdGhpcy5hc3NlcnQoIXRoaXMuX3NvdXJjZVN0b3BwZWQsXCJzb3VyY2UgaXMgYWxyZWFkeSBzdG9wcGVkXCIpLHQ9dGhpcy50b1NlY29uZHModCksZT10aGlzLmxvb3A/cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSx0aGlzLmxvb3BTdGFydCk6cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwwKSxlPXRoaXMudG9TZWNvbmRzKGUpLGU9TWF0aC5tYXgoZSwwKSxuPXMuZGVmYXVsdC5kZWZhdWx0QXJnKG4sMSk7dmFyIG89dGhpcy50b1NlY29uZHModGhpcy5mYWRlSW4pO2lmKG8+MD8odGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLHQpLFwibGluZWFyXCI9PT10aGlzLmN1cnZlP3RoaXMuX2dhaW5Ob2RlLmdhaW4ubGluZWFyUmFtcFRvVmFsdWVBdFRpbWUobix0K28pOnRoaXMuX2dhaW5Ob2RlLmdhaW4uZXhwb25lbnRpYWxBcHByb2FjaFZhbHVlQXRUaW1lKG4sdCxvKSk6dGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZShuLHQpLHRoaXMuX3N0YXJ0VGltZT10LHMuZGVmYXVsdC5pc0RlZmluZWQoaSkpe3ZhciBhPXRoaXMudG9TZWNvbmRzKGkpO2E9TWF0aC5tYXgoYSwwKSx0aGlzLnN0b3AodCthKX1pZih0aGlzLmxvb3Ape3ZhciByPXRoaXMubG9vcEVuZHx8dGhpcy5idWZmZXIuZHVyYXRpb24sbD10aGlzLmxvb3BTdGFydDtlPj1yJiYoZT0oZS1sKSUoci1sKStsKX1yZXR1cm4gdGhpcy5fc291cmNlLmJ1ZmZlcj10aGlzLmJ1ZmZlci5nZXQoKSx0aGlzLl9zb3VyY2UubG9vcEVuZD10aGlzLmxvb3BFbmR8fHRoaXMuYnVmZmVyLmR1cmF0aW9uLGU8dGhpcy5idWZmZXIuZHVyYXRpb24mJih0aGlzLl9zb3VyY2VTdGFydGVkPSEwLHRoaXMuX3NvdXJjZS5zdGFydCh0LGUpKSx0aGlzfSxzLmRlZmF1bHQuQnVmZmVyU291cmNlLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKHQpe3RoaXMubG9nKFwic3RvcFwiLHQpLHRoaXMuYXNzZXJ0KHRoaXMuYnVmZmVyLmxvYWRlZCxcImJ1ZmZlciBpcyBlaXRoZXIgbm90IHNldCBvciBub3QgbG9hZGVkXCIpLHRoaXMuYXNzZXJ0KCF0aGlzLl9zb3VyY2VTdG9wcGVkLFwic291cmNlIGlzIGFscmVhZHkgc3RvcHBlZFwiKSx0PXRoaXMudG9TZWNvbmRzKHQpLC0xIT09dGhpcy5fc3RvcFRpbWUmJnRoaXMuY2FuY2VsU3RvcCgpO3ZhciBlPXRoaXMudG9TZWNvbmRzKHRoaXMuZmFkZU91dCk7cmV0dXJuIHRoaXMuX3N0b3BUaW1lPXQrZSxlPjA/XCJsaW5lYXJcIj09PXRoaXMuY3VydmU/dGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5saW5lYXJSYW1wVG8oMCxlLHQpOnRoaXMuX2dhaW5Ob2RlLmdhaW4udGFyZ2V0UmFtcFRvKDAsZSx0KToodGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5jYW5jZWxBbmRIb2xkQXRUaW1lKHQpLHRoaXMuX2dhaW5Ob2RlLmdhaW4uc2V0VmFsdWVBdFRpbWUoMCx0KSkscy5kZWZhdWx0LmNvbnRleHQuY2xlYXJUaW1lb3V0KHRoaXMuX29uZW5kZWRUaW1lb3V0KSx0aGlzLl9vbmVuZGVkVGltZW91dD1zLmRlZmF1bHQuY29udGV4dC5zZXRUaW1lb3V0KHRoaXMuX29uZW5kZWQuYmluZCh0aGlzKSx0aGlzLl9zdG9wVGltZS10aGlzLm5vdygpKSx0aGlzfSxzLmRlZmF1bHQuQnVmZmVyU291cmNlLnByb3RvdHlwZS5jYW5jZWxTdG9wPWZ1bmN0aW9uKCl7aWYoLTEhPT10aGlzLl9zdGFydFRpbWUmJiF0aGlzLl9zb3VyY2VTdG9wcGVkKXt2YXIgdD10aGlzLnRvU2Vjb25kcyh0aGlzLmZhZGVJbik7dGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModGhpcy5fc3RhcnRUaW1lK3QrdGhpcy5zYW1wbGVUaW1lKSx0aGlzLmNvbnRleHQuY2xlYXJUaW1lb3V0KHRoaXMuX29uZW5kZWRUaW1lb3V0KSx0aGlzLl9zdG9wVGltZT0tMX1yZXR1cm4gdGhpc30scy5kZWZhdWx0LkJ1ZmZlclNvdXJjZS5wcm90b3R5cGUuX29uZW5kZWQ9ZnVuY3Rpb24oKXtpZighdGhpcy5fc291cmNlU3RvcHBlZCl7dGhpcy5fc291cmNlU3RvcHBlZD0hMDt2YXIgdD1cImV4cG9uZW50aWFsXCI9PT10aGlzLmN1cnZlPzIqdGhpcy5mYWRlT3V0OjA7dGhpcy5fc291cmNlU3RhcnRlZCYmLTEhPT10aGlzLl9zdG9wVGltZSYmdGhpcy5fc291cmNlLnN0b3AodGhpcy5fc3RvcFRpbWUrdCksdGhpcy5vbmVuZGVkKHRoaXMpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aGlzLl9zb3VyY2UmJih0aGlzLl9zb3VyY2UuZGlzY29ubmVjdCgpLHRoaXMuX2dhaW5Ob2RlLmRpc2Nvbm5lY3QoKSl9LmJpbmQodGhpcyksMWUzKnQrMTAwKX19LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQnVmZmVyU291cmNlLnByb3RvdHlwZSxcImxvb3BTdGFydFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlLmxvb3BTdGFydH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3NvdXJjZS5sb29wU3RhcnQ9dGhpcy50b1NlY29uZHModCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UucHJvdG90eXBlLFwibG9vcEVuZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlLmxvb3BFbmR9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zb3VyY2UubG9vcEVuZD10aGlzLnRvU2Vjb25kcyh0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkJ1ZmZlclNvdXJjZS5wcm90b3R5cGUsXCJidWZmZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlcn0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2J1ZmZlci5zZXQodCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UucHJvdG90eXBlLFwibG9vcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlLmxvb3B9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zb3VyY2UubG9vcD10LHRoaXMuY2FuY2VsU3RvcCgpfX0pLHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fd2FzRGlzcG9zZWR8fCh0aGlzLl93YXNEaXNwb3NlZD0hMCxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5vbmVuZGVkPW51bGwsdGhpcy5fc291cmNlLm9uZW5kZWQ9bnVsbCx0aGlzLl9zb3VyY2UuZGlzY29ubmVjdCgpLHRoaXMuX3NvdXJjZT1udWxsLHRoaXMuX2dhaW5Ob2RlLmRpc3Bvc2UoKSx0aGlzLl9nYWluTm9kZT1udWxsLHRoaXMuX2J1ZmZlci5kaXNwb3NlKCksdGhpcy5fYnVmZmVyPW51bGwsdGhpcy5fc3RhcnRUaW1lPS0xLHRoaXMucGxheWJhY2tSYXRlPW51bGwscy5kZWZhdWx0LmNvbnRleHQuY2xlYXJUaW1lb3V0KHRoaXMuX29uZW5kZWRUaW1lb3V0KSksdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5CdWZmZXJTb3VyY2V9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDgpLGkoMiksaSg1KSxpKDMpO3MuZGVmYXVsdC5GZWVkYmFja0VmZmVjdD1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiZmVlZGJhY2tcIl0scy5kZWZhdWx0LkZlZWRiYWNrRWZmZWN0KTtzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcyx0KSx0aGlzLl9mZWVkYmFja0dhaW49bmV3IHMuZGVmYXVsdC5HYWluKHQuZmVlZGJhY2sscy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UpLHRoaXMuZmVlZGJhY2s9dGhpcy5fZmVlZGJhY2tHYWluLmdhaW4sdGhpcy5lZmZlY3RSZXR1cm4uY2hhaW4odGhpcy5fZmVlZGJhY2tHYWluLHRoaXMuZWZmZWN0U2VuZCksdGhpcy5fcmVhZE9ubHkoW1wiZmVlZGJhY2tcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdCxzLmRlZmF1bHQuRWZmZWN0KSxzLmRlZmF1bHQuRmVlZGJhY2tFZmZlY3QuZGVmYXVsdHM9e2ZlZWRiYWNrOi4xMjV9LHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoW1wiZmVlZGJhY2tcIl0pLHRoaXMuX2ZlZWRiYWNrR2Fpbi5kaXNwb3NlKCksdGhpcy5fZmVlZGJhY2tHYWluPW51bGwsdGhpcy5mZWVkYmFjaz1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRmVlZGJhY2tFZmZlY3R9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDI0KSxpKDQpO3MuZGVmYXVsdC5UaW1lbGluZVN0YXRlPWZ1bmN0aW9uKHQpe3MuZGVmYXVsdC5UaW1lbGluZS5jYWxsKHRoaXMpLHRoaXMuX2luaXRpYWw9dH0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVGltZWxpbmVTdGF0ZSxzLmRlZmF1bHQuVGltZWxpbmUpLHMuZGVmYXVsdC5UaW1lbGluZVN0YXRlLnByb3RvdHlwZS5nZXRWYWx1ZUF0VGltZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldCh0KTtyZXR1cm4gbnVsbCE9PWU/ZS5zdGF0ZTp0aGlzLl9pbml0aWFsfSxzLmRlZmF1bHQuVGltZWxpbmVTdGF0ZS5wcm90b3R5cGUuc2V0U3RhdGVBdFRpbWU9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5hZGQoe3N0YXRlOnQsdGltZTplfSksdGhpc30scy5kZWZhdWx0LlRpbWVsaW5lU3RhdGUucHJvdG90eXBlLmdldExhc3RTdGF0ZT1mdW5jdGlvbih0LGUpe2U9dGhpcy50b1NlY29uZHMoZSk7Zm9yKHZhciBpPXRoaXMuX3NlYXJjaChlKTtpPj0wO2ktLSl7dmFyIHM9dGhpcy5fdGltZWxpbmVbaV07aWYocy5zdGF0ZT09PXQpcmV0dXJuIHN9fSxzLmRlZmF1bHQuVGltZWxpbmVTdGF0ZS5wcm90b3R5cGUuZ2V0TmV4dFN0YXRlPWZ1bmN0aW9uKHQsZSl7ZT10aGlzLnRvU2Vjb25kcyhlKTt2YXIgaT10aGlzLl9zZWFyY2goZSk7aWYoLTEhPT1pKWZvcih2YXIgcz1pO3M8dGhpcy5fdGltZWxpbmUubGVuZ3RoO3MrKyl7dmFyIG49dGhpcy5fdGltZWxpbmVbc107aWYobi5zdGF0ZT09PXQpcmV0dXJuIG59fSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlRpbWVsaW5lU3RhdGV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtzLmRlZmF1bHQuRW1pdHRlcj1mdW5jdGlvbigpe3MuZGVmYXVsdC5jYWxsKHRoaXMpLHRoaXMuX2V2ZW50cz17fX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRW1pdHRlcikscy5kZWZhdWx0LkVtaXR0ZXIucHJvdG90eXBlLm9uPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPXQuc3BsaXQoL1xcVysvKSxzPTA7czxpLmxlbmd0aDtzKyspe3ZhciBuPWlbc107dGhpcy5fZXZlbnRzLmhhc093blByb3BlcnR5KG4pfHwodGhpcy5fZXZlbnRzW25dPVtdKSx0aGlzLl9ldmVudHNbbl0ucHVzaChlKX1yZXR1cm4gdGhpc30scy5kZWZhdWx0LkVtaXR0ZXIucHJvdG90eXBlLm9uY2U9ZnVuY3Rpb24odCxlKXt2YXIgaT1mdW5jdGlvbigpe2UuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMub2ZmKHQsaSl9LmJpbmQodGhpcyk7cmV0dXJuIHRoaXMub24odCxpKSx0aGlzfSxzLmRlZmF1bHQuRW1pdHRlci5wcm90b3R5cGUub2ZmPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBpPXQuc3BsaXQoL1xcVysvKSxuPTA7bjxpLmxlbmd0aDtuKyspaWYodD1pW25dLHRoaXMuX2V2ZW50cy5oYXNPd25Qcm9wZXJ0eSh0KSlpZihzLmRlZmF1bHQuaXNVbmRlZihlKSl0aGlzLl9ldmVudHNbdF09W107ZWxzZSBmb3IodmFyIG89dGhpcy5fZXZlbnRzW3RdLGE9MDthPG8ubGVuZ3RoO2ErKylvW2FdPT09ZSYmby5zcGxpY2UoYSwxKTtyZXR1cm4gdGhpc30scy5kZWZhdWx0LkVtaXR0ZXIucHJvdG90eXBlLmVtaXQ9ZnVuY3Rpb24odCl7aWYodGhpcy5fZXZlbnRzKXt2YXIgZT1BcnJheS5hcHBseShudWxsLGFyZ3VtZW50cykuc2xpY2UoMSk7aWYodGhpcy5fZXZlbnRzLmhhc093blByb3BlcnR5KHQpKWZvcih2YXIgaT10aGlzLl9ldmVudHNbdF0uc2xpY2UoMCkscz0wLG49aS5sZW5ndGg7czxuO3MrKylpW3NdLmFwcGx5KHRoaXMsZSl9cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5FbWl0dGVyLm1peGluPWZ1bmN0aW9uKHQpe3ZhciBlPVtcIm9uXCIsXCJvbmNlXCIsXCJvZmZcIixcImVtaXRcIl07dC5fZXZlbnRzPXt9O2Zvcih2YXIgaT0wO2k8ZS5sZW5ndGg7aSsrKXt2YXIgbj1lW2ldLG89cy5kZWZhdWx0LkVtaXR0ZXIucHJvdG90eXBlW25dO3Rbbl09b31yZXR1cm4gcy5kZWZhdWx0LkVtaXR0ZXJ9LHMuZGVmYXVsdC5FbWl0dGVyLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX2V2ZW50cz1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRW1pdHRlcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMSksaSg0NCk7cy5kZWZhdWx0LnN1cHBvcnRlZCYmKEFuYWx5c2VyTm9kZS5wcm90b3R5cGUuZ2V0RmxvYXRUaW1lRG9tYWluRGF0YXx8KEFuYWx5c2VyTm9kZS5wcm90b3R5cGUuZ2V0RmxvYXRUaW1lRG9tYWluRGF0YT1mdW5jdGlvbih0KXt2YXIgZT1uZXcgVWludDhBcnJheSh0Lmxlbmd0aCk7dGhpcy5nZXRCeXRlVGltZURvbWFpbkRhdGEoZSk7Zm9yKHZhciBpPTA7aTxlLmxlbmd0aDtpKyspdFtpXT0oZVtpXS0xMjgpLzEyOH0pKSxzLmRlZmF1bHQuQW5hbHlzZXI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInR5cGVcIixcInNpemVcIl0scy5kZWZhdWx0LkFuYWx5c2VyKTtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5fYW5hbHlzZXI9dGhpcy5pbnB1dD10aGlzLm91dHB1dD10aGlzLmNvbnRleHQuY3JlYXRlQW5hbHlzZXIoKSx0aGlzLl90eXBlPXQudHlwZSx0aGlzLl9idWZmZXI9bnVsbCx0aGlzLnNpemU9dC5zaXplLHRoaXMudHlwZT10LnR5cGV9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkFuYWx5c2VyLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5BbmFseXNlci5kZWZhdWx0cz17c2l6ZToxMDI0LHR5cGU6XCJmZnRcIixzbW9vdGhpbmc6Ljh9LHMuZGVmYXVsdC5BbmFseXNlci5UeXBlPXtXYXZlZm9ybTpcIndhdmVmb3JtXCIsRkZUOlwiZmZ0XCJ9LHMuZGVmYXVsdC5BbmFseXNlci5wcm90b3R5cGUuZ2V0VmFsdWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdHlwZT09PXMuZGVmYXVsdC5BbmFseXNlci5UeXBlLkZGVD90aGlzLl9hbmFseXNlci5nZXRGbG9hdEZyZXF1ZW5jeURhdGEodGhpcy5fYnVmZmVyKTp0aGlzLl90eXBlPT09cy5kZWZhdWx0LkFuYWx5c2VyLlR5cGUuV2F2ZWZvcm0mJnRoaXMuX2FuYWx5c2VyLmdldEZsb2F0VGltZURvbWFpbkRhdGEodGhpcy5fYnVmZmVyKSx0aGlzLl9idWZmZXJ9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQW5hbHlzZXIucHJvdG90eXBlLFwic2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYW5hbHlzZXIuZnJlcXVlbmN5QmluQ291bnR9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9hbmFseXNlci5mZnRTaXplPTIqdCx0aGlzLl9idWZmZXI9bmV3IEZsb2F0MzJBcnJheSh0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkFuYWx5c2VyLnByb3RvdHlwZSxcInR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3R5cGV9LHNldDpmdW5jdGlvbih0KXtpZih0IT09cy5kZWZhdWx0LkFuYWx5c2VyLlR5cGUuV2F2ZWZvcm0mJnQhPT1zLmRlZmF1bHQuQW5hbHlzZXIuVHlwZS5GRlQpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlRvbmUuQW5hbHlzZXI6IGludmFsaWQgdHlwZTogXCIrdCk7dGhpcy5fdHlwZT10fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQW5hbHlzZXIucHJvdG90eXBlLFwic21vb3RoaW5nXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9hbmFseXNlci5zbW9vdGhpbmdUaW1lQ29uc3RhbnR9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9hbmFseXNlci5zbW9vdGhpbmdUaW1lQ29uc3RhbnQ9dH19KSxzLmRlZmF1bHQuQW5hbHlzZXIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fYW5hbHlzZXIuZGlzY29ubmVjdCgpLHRoaXMuX2FuYWx5c2VyPW51bGwsdGhpcy5fYnVmZmVyPW51bGx9O2UuZGVmYXVsdD1zLmRlZmF1bHQuQW5hbHlzZXJ9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDYpLGkoMTcpLGkoNTApLGkoNjgpLGkoNDkpLGkoNjcpLGkoNjYpO3MuZGVmYXVsdC5PbW5pT3NjaWxsYXRvcj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJ0eXBlXCJdLHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvcik7cy5kZWZhdWx0LlNvdXJjZS5jYWxsKHRoaXMsdCksdGhpcy5mcmVxdWVuY3k9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5mcmVxdWVuY3kscy5kZWZhdWx0LlR5cGUuRnJlcXVlbmN5KSx0aGlzLmRldHVuZT1uZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmRldHVuZSxzLmRlZmF1bHQuVHlwZS5DZW50cyksdGhpcy5fc291cmNlVHlwZT12b2lkIDAsdGhpcy5fb3NjaWxsYXRvcj1udWxsLHRoaXMudHlwZT10LnR5cGUsdGhpcy5fcmVhZE9ubHkoW1wiZnJlcXVlbmN5XCIsXCJkZXR1bmVcIl0pLHRoaXMuc2V0KHQpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvcixzLmRlZmF1bHQuU291cmNlKSxzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IuZGVmYXVsdHM9e2ZyZXF1ZW5jeTo0NDAsZGV0dW5lOjAsdHlwZTpcInNpbmVcIixwaGFzZTowfTt2YXIgbj1cIlB1bHNlT3NjaWxsYXRvclwiLG89XCJQV01Pc2NpbGxhdG9yXCIsYT1cIk9zY2lsbGF0b3JcIixyPVwiRk1Pc2NpbGxhdG9yXCIsbD1cIkFNT3NjaWxsYXRvclwiLHU9XCJGYXRPc2NpbGxhdG9yXCI7cy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZS5fc3RhcnQ9ZnVuY3Rpb24odCl7dGhpcy5fb3NjaWxsYXRvci5zdGFydCh0KX0scy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZS5fc3RvcD1mdW5jdGlvbih0KXt0aGlzLl9vc2NpbGxhdG9yLnN0b3AodCl9LHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUucmVzdGFydD1mdW5jdGlvbih0KXt0aGlzLl9vc2NpbGxhdG9yLnJlc3RhcnQodCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLFwidHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXt2YXIgdD1cIlwiO3JldHVybiB0aGlzLl9zb3VyY2VUeXBlPT09cj90PVwiZm1cIjp0aGlzLl9zb3VyY2VUeXBlPT09bD90PVwiYW1cIjp0aGlzLl9zb3VyY2VUeXBlPT09dSYmKHQ9XCJmYXRcIiksdCt0aGlzLl9vc2NpbGxhdG9yLnR5cGV9LHNldDpmdW5jdGlvbih0KXtcImZtXCI9PT10LnN1YnN0cigwLDIpPyh0aGlzLl9jcmVhdGVOZXdPc2NpbGxhdG9yKHIpLHRoaXMuX29zY2lsbGF0b3IudHlwZT10LnN1YnN0cigyKSk6XCJhbVwiPT09dC5zdWJzdHIoMCwyKT8odGhpcy5fY3JlYXRlTmV3T3NjaWxsYXRvcihsKSx0aGlzLl9vc2NpbGxhdG9yLnR5cGU9dC5zdWJzdHIoMikpOlwiZmF0XCI9PT10LnN1YnN0cigwLDMpPyh0aGlzLl9jcmVhdGVOZXdPc2NpbGxhdG9yKHUpLHRoaXMuX29zY2lsbGF0b3IudHlwZT10LnN1YnN0cigzKSk6XCJwd21cIj09PXQ/dGhpcy5fY3JlYXRlTmV3T3NjaWxsYXRvcihvKTpcInB1bHNlXCI9PT10P3RoaXMuX2NyZWF0ZU5ld09zY2lsbGF0b3Iobik6KHRoaXMuX2NyZWF0ZU5ld09zY2lsbGF0b3IoYSksdGhpcy5fb3NjaWxsYXRvci50eXBlPXQpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLFwicGFydGlhbHNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3IucGFydGlhbHN9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9vc2NpbGxhdG9yLnBhcnRpYWxzPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUsXCJwYXJ0aWFsQ291bnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29zY2lsbGF0b3IucGFydGlhbENvdW50fSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3NjaWxsYXRvci5wYXJ0aWFsQ291bnQ9dH19KSxzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLnNldD1mdW5jdGlvbih0LGUpe3JldHVyblwidHlwZVwiPT09dD90aGlzLnR5cGU9ZTpzLmRlZmF1bHQuaXNPYmplY3QodCkmJnQuaGFzT3duUHJvcGVydHkoXCJ0eXBlXCIpJiYodGhpcy50eXBlPXQudHlwZSkscy5kZWZhdWx0LnByb3RvdHlwZS5zZXQuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXN9LHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX29zY2lsbGF0b3IuZ2V0KHQpO3JldHVybiBlLnR5cGU9dGhpcy50eXBlLGV9LHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUuX2NyZWF0ZU5ld09zY2lsbGF0b3I9ZnVuY3Rpb24odCl7aWYodCE9PXRoaXMuX3NvdXJjZVR5cGUpe3RoaXMuX3NvdXJjZVR5cGU9dDt2YXIgZT1zLmRlZmF1bHRbdF0saT10aGlzLm5vdygpO2lmKG51bGwhPT10aGlzLl9vc2NpbGxhdG9yKXt2YXIgbj10aGlzLl9vc2NpbGxhdG9yO24uc3RvcChpKSx0aGlzLmNvbnRleHQuc2V0VGltZW91dChmdW5jdGlvbigpe24uZGlzcG9zZSgpLG49bnVsbH0sdGhpcy5ibG9ja1RpbWUpfXRoaXMuX29zY2lsbGF0b3I9bmV3IGUsdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9vc2NpbGxhdG9yLmZyZXF1ZW5jeSksdGhpcy5kZXR1bmUuY29ubmVjdCh0aGlzLl9vc2NpbGxhdG9yLmRldHVuZSksdGhpcy5fb3NjaWxsYXRvci5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLnN0YXRlPT09cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQmJnRoaXMuX29zY2lsbGF0b3Iuc3RhcnQoaSl9fSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZSxcInBoYXNlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yLnBoYXNlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3NjaWxsYXRvci5waGFzZT10fX0pO3ZhciBmPXtQdWxzZU9zY2lsbGF0b3I6XCJwdWxzZVwiLFBXTU9zY2lsbGF0b3I6XCJwd21cIixPc2NpbGxhdG9yOlwib3NjaWxsYXRvclwiLEZNT3NjaWxsYXRvcjpcImZtXCIsQU1Pc2NpbGxhdG9yOlwiYW1cIixGYXRPc2NpbGxhdG9yOlwiZmF0XCJ9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLFwic291cmNlVHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZlt0aGlzLl9zb3VyY2VUeXBlXX0sc2V0OmZ1bmN0aW9uKHQpe3ZhciBlPVwic2luZVwiO1wicHdtXCIhPT10aGlzLl9vc2NpbGxhdG9yLnR5cGUmJlwicHVsc2VcIiE9PXRoaXMuX29zY2lsbGF0b3IudHlwZSYmKGU9dGhpcy5fb3NjaWxsYXRvci50eXBlKSx0PT09Zi5GTU9zY2lsbGF0b3I/dGhpcy50eXBlPVwiZm1cIitlOnQ9PT1mLkFNT3NjaWxsYXRvcj90aGlzLnR5cGU9XCJhbVwiK2U6dD09PWYuRmF0T3NjaWxsYXRvcj90aGlzLnR5cGU9XCJmYXRcIitlOnQ9PT1mLk9zY2lsbGF0b3I/dGhpcy50eXBlPWU6dD09PWYuUHVsc2VPc2NpbGxhdG9yP3RoaXMudHlwZT1cInB1bHNlXCI6dD09PWYuUFdNT3NjaWxsYXRvciYmKHRoaXMudHlwZT1cInB3bVwiKX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZSxcImJhc2VUeXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yLmJhc2VUeXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5zb3VyY2VUeXBlIT09Zi5QdWxzZU9zY2lsbGF0b3ImJnRoaXMuc291cmNlVHlwZSE9PWYuUFdNT3NjaWxsYXRvciYmKHRoaXMuX29zY2lsbGF0b3IuYmFzZVR5cGU9dCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUsXCJ3aWR0aFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlVHlwZT09PW4/dGhpcy5fb3NjaWxsYXRvci53aWR0aDp2b2lkIDB9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUsXCJjb3VudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlVHlwZT09PXU/dGhpcy5fb3NjaWxsYXRvci5jb3VudDp2b2lkIDB9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zb3VyY2VUeXBlPT09dSYmKHRoaXMuX29zY2lsbGF0b3IuY291bnQ9dCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUsXCJzcHJlYWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZVR5cGU9PT11P3RoaXMuX29zY2lsbGF0b3Iuc3ByZWFkOnZvaWQgMH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3NvdXJjZVR5cGU9PT11JiYodGhpcy5fb3NjaWxsYXRvci5zcHJlYWQ9dCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvci5wcm90b3R5cGUsXCJtb2R1bGF0aW9uVHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlVHlwZT09PXJ8fHRoaXMuX3NvdXJjZVR5cGU9PT1sP3RoaXMuX29zY2lsbGF0b3IubW9kdWxhdGlvblR5cGU6dm9pZCAwfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fc291cmNlVHlwZSE9PXImJnRoaXMuX3NvdXJjZVR5cGUhPT1sfHwodGhpcy5fb3NjaWxsYXRvci5tb2R1bGF0aW9uVHlwZT10KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZSxcIm1vZHVsYXRpb25JbmRleFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc291cmNlVHlwZT09PXI/dGhpcy5fb3NjaWxsYXRvci5tb2R1bGF0aW9uSW5kZXg6dm9pZCAwfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IucHJvdG90eXBlLFwiaGFybW9uaWNpdHlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZVR5cGU9PT1yfHx0aGlzLl9zb3VyY2VUeXBlPT09bD90aGlzLl9vc2NpbGxhdG9yLmhhcm1vbmljaXR5OnZvaWQgMH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZSxcIm1vZHVsYXRpb25GcmVxdWVuY3lcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvdXJjZVR5cGU9PT1vP3RoaXMuX29zY2lsbGF0b3IubW9kdWxhdGlvbkZyZXF1ZW5jeTp2b2lkIDB9fSkscy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJmcmVxdWVuY3lcIixcImRldHVuZVwiXSksdGhpcy5kZXR1bmUuZGlzcG9zZSgpLHRoaXMuZGV0dW5lPW51bGwsdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuZnJlcXVlbmN5PW51bGwsdGhpcy5fb3NjaWxsYXRvci5kaXNwb3NlKCksdGhpcy5fb3NjaWxsYXRvcj1udWxsLHRoaXMuX3NvdXJjZVR5cGU9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgzMSksaSgzNyksaSgyNSk7cy5kZWZhdWx0LlN5bnRoPWZ1bmN0aW9uKHQpe3Q9cy5kZWZhdWx0LmRlZmF1bHRBcmcodCxzLmRlZmF1bHQuU3ludGguZGVmYXVsdHMpLHMuZGVmYXVsdC5Nb25vcGhvbmljLmNhbGwodGhpcyx0KSx0aGlzLm9zY2lsbGF0b3I9bmV3IHMuZGVmYXVsdC5PbW5pT3NjaWxsYXRvcih0Lm9zY2lsbGF0b3IpLHRoaXMuZnJlcXVlbmN5PXRoaXMub3NjaWxsYXRvci5mcmVxdWVuY3ksdGhpcy5kZXR1bmU9dGhpcy5vc2NpbGxhdG9yLmRldHVuZSx0aGlzLmVudmVsb3BlPW5ldyBzLmRlZmF1bHQuQW1wbGl0dWRlRW52ZWxvcGUodC5lbnZlbG9wZSksdGhpcy5vc2NpbGxhdG9yLmNoYWluKHRoaXMuZW52ZWxvcGUsdGhpcy5vdXRwdXQpLHRoaXMuX3JlYWRPbmx5KFtcIm9zY2lsbGF0b3JcIixcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCIsXCJlbnZlbG9wZVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlN5bnRoLHMuZGVmYXVsdC5Nb25vcGhvbmljKSxzLmRlZmF1bHQuU3ludGguZGVmYXVsdHM9e29zY2lsbGF0b3I6e3R5cGU6XCJ0cmlhbmdsZVwifSxlbnZlbG9wZTp7YXR0YWNrOi4wMDUsZGVjYXk6LjEsc3VzdGFpbjouMyxyZWxlYXNlOjF9fSxzLmRlZmF1bHQuU3ludGgucHJvdG90eXBlLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2s9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5lbnZlbG9wZS50cmlnZ2VyQXR0YWNrKHQsZSksdGhpcy5vc2NpbGxhdG9yLnN0YXJ0KHQpLDA9PT10aGlzLmVudmVsb3BlLnN1c3RhaW4mJnRoaXMub3NjaWxsYXRvci5zdG9wKHQrdGhpcy50b1NlY29uZHModGhpcy5lbnZlbG9wZS5hdHRhY2spK3RoaXMudG9TZWNvbmRzKHRoaXMuZW52ZWxvcGUuZGVjYXkpKSx0aGlzfSxzLmRlZmF1bHQuU3ludGgucHJvdG90eXBlLl90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlPWZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuZW52ZWxvcGUudHJpZ2dlclJlbGVhc2UodCksdGhpcy5vc2NpbGxhdG9yLnN0b3AodCt0aGlzLnRvU2Vjb25kcyh0aGlzLmVudmVsb3BlLnJlbGVhc2UpKSx0aGlzfSxzLmRlZmF1bHQuU3ludGgucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0Lk1vbm9waG9uaWMucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJvc2NpbGxhdG9yXCIsXCJmcmVxdWVuY3lcIixcImRldHVuZVwiLFwiZW52ZWxvcGVcIl0pLHRoaXMub3NjaWxsYXRvci5kaXNwb3NlKCksdGhpcy5vc2NpbGxhdG9yPW51bGwsdGhpcy5lbnZlbG9wZS5kaXNwb3NlKCksdGhpcy5lbnZlbG9wZT1udWxsLHRoaXMuZnJlcXVlbmN5PW51bGwsdGhpcy5kZXR1bmU9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlN5bnRofSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg2KSxpKDExKSxpKDMyKTtzLmRlZmF1bHQuTm9pc2U9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInR5cGVcIl0scy5kZWZhdWx0Lk5vaXNlKTtzLmRlZmF1bHQuU291cmNlLmNhbGwodGhpcyx0KSx0aGlzLl9zb3VyY2U9bnVsbCx0aGlzLl90eXBlPXQudHlwZSx0aGlzLl9wbGF5YmFja1JhdGU9dC5wbGF5YmFja1JhdGV9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk5vaXNlLHMuZGVmYXVsdC5Tb3VyY2UpLHMuZGVmYXVsdC5Ob2lzZS5kZWZhdWx0cz17dHlwZTpcIndoaXRlXCIscGxheWJhY2tSYXRlOjF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTm9pc2UucHJvdG90eXBlLFwidHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdHlwZX0sc2V0OmZ1bmN0aW9uKHQpe2lmKHRoaXMuX3R5cGUhPT10KXtpZighKHQgaW4gbikpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlRvbmUuTm9pc2U6IGludmFsaWQgdHlwZTogXCIrdCk7aWYodGhpcy5fdHlwZT10LHRoaXMuc3RhdGU9PT1zLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCl7dmFyIGU9dGhpcy5ub3coKTt0aGlzLl9zdG9wKGUpLHRoaXMuX3N0YXJ0KGUpfX19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Ob2lzZS5wcm90b3R5cGUsXCJwbGF5YmFja1JhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BsYXliYWNrUmF0ZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3BsYXliYWNrUmF0ZT10LHRoaXMuX3NvdXJjZSYmKHRoaXMuX3NvdXJjZS5wbGF5YmFja1JhdGUudmFsdWU9dCl9fSkscy5kZWZhdWx0Lk5vaXNlLnByb3RvdHlwZS5fc3RhcnQ9ZnVuY3Rpb24odCl7dmFyIGU9blt0aGlzLl90eXBlXTt0aGlzLl9zb3VyY2U9bmV3IHMuZGVmYXVsdC5CdWZmZXJTb3VyY2UoZSkuY29ubmVjdCh0aGlzLm91dHB1dCksdGhpcy5fc291cmNlLmxvb3A9ITAsdGhpcy5fc291cmNlLnBsYXliYWNrUmF0ZS52YWx1ZT10aGlzLl9wbGF5YmFja1JhdGUsdGhpcy5fc291cmNlLnN0YXJ0KHRoaXMudG9TZWNvbmRzKHQpLE1hdGgucmFuZG9tKCkqKGUuZHVyYXRpb24tLjAwMSkpfSxzLmRlZmF1bHQuTm9pc2UucHJvdG90eXBlLl9zdG9wPWZ1bmN0aW9uKHQpe3RoaXMuX3NvdXJjZSYmKHRoaXMuX3NvdXJjZS5zdG9wKHRoaXMudG9TZWNvbmRzKHQpKSx0aGlzLl9zb3VyY2U9bnVsbCl9LHMuZGVmYXVsdC5Ob2lzZS5wcm90b3R5cGUucmVzdGFydD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fc3RvcCh0KSx0aGlzLl9zdGFydCh0KSx0aGlzfSxzLmRlZmF1bHQuTm9pc2UucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLG51bGwhPT10aGlzLl9zb3VyY2UmJih0aGlzLl9zb3VyY2UuZGlzY29ubmVjdCgpLHRoaXMuX3NvdXJjZT1udWxsKSx0aGlzLl9idWZmZXI9bnVsbCx0aGlzfTt2YXIgbj17fSxvPXt9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShuLFwicGlua1wiLHtnZXQ6ZnVuY3Rpb24oKXtpZighby5waW5rKXtmb3IodmFyIHQ9W10sZT0wO2U8MjtlKyspe3ZhciBpLG4sYSxyLGwsdSxmLGQ9bmV3IEZsb2F0MzJBcnJheSgyMjA1MDApO3RbZV09ZCxpPW49YT1yPWw9dT1mPTA7Zm9yKHZhciBoPTA7aDwyMjA1MDA7aCsrKXt2YXIgYz0yKk1hdGgucmFuZG9tKCktMTtpPS45OTg4NippKy4wNTU1MTc5KmMsbj0uOTkzMzIqbisuMDc1MDc1OSpjLGE9Ljk2OSphKy4xNTM4NTIqYyxyPS44NjY1KnIrLjMxMDQ4NTYqYyxsPS41NSpsKy41MzI5NTIyKmMsdT0tLjc2MTYqdS0uMDE2ODk4KmMsZFtoXT1pK24rYStyK2wrdStmKy41MzYyKmMsZFtoXSo9LjExLGY9LjExNTkyNipjfX1vLnBpbms9KG5ldyBzLmRlZmF1bHQuQnVmZmVyKS5mcm9tQXJyYXkodCl9cmV0dXJuIG8ucGlua319KSxPYmplY3QuZGVmaW5lUHJvcGVydHkobixcImJyb3duXCIse2dldDpmdW5jdGlvbigpe2lmKCFvLmJyb3duKXtmb3IodmFyIHQ9W10sZT0wO2U8MjtlKyspe3ZhciBpPW5ldyBGbG9hdDMyQXJyYXkoMjIwNTAwKTt0W2VdPWk7Zm9yKHZhciBuPTAsYT0wO2E8MjIwNTAwO2ErKyl7dmFyIHI9MipNYXRoLnJhbmRvbSgpLTE7aVthXT0obisuMDIqcikvMS4wMixuPWlbYV0saVthXSo9My41fX1vLmJyb3duPShuZXcgcy5kZWZhdWx0LkJ1ZmZlcikuZnJvbUFycmF5KHQpfXJldHVybiBvLmJyb3dufX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLFwid2hpdGVcIix7Z2V0OmZ1bmN0aW9uKCl7aWYoIW8ud2hpdGUpe2Zvcih2YXIgdD1bXSxlPTA7ZTwyO2UrKyl7dmFyIGk9bmV3IEZsb2F0MzJBcnJheSgyMjA1MDApO3RbZV09aTtmb3IodmFyIG49MDtuPDIyMDUwMDtuKyspaVtuXT0yKk1hdGgucmFuZG9tKCktMX1vLndoaXRlPShuZXcgcy5kZWZhdWx0LkJ1ZmZlcikuZnJvbUFycmF5KHQpfXJldHVybiBvLndoaXRlfX0pLGUuZGVmYXVsdD1zLmRlZmF1bHQuTm9pc2V9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDI3KSxpKDIwKSxpKDEpO3MuZGVmYXVsdC5NYXN0ZXI9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcykscy5kZWZhdWx0LmdldENvbnRleHQoZnVuY3Rpb24oKXt0aGlzLmNyZWF0ZUluc091dHMoMSwwKSx0aGlzLl92b2x1bWU9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5Wb2x1bWUsdGhpcy52b2x1bWU9dGhpcy5fdm9sdW1lLnZvbHVtZSx0aGlzLl9yZWFkT25seShcInZvbHVtZVwiKSxzLmRlZmF1bHQuY29ubmVjdFNlcmllcyh0aGlzLmlucHV0LHRoaXMub3V0cHV0LHRoaXMuY29udGV4dC5kZXN0aW5hdGlvbiksdGhpcy5jb250ZXh0Lm1hc3Rlcj10aGlzfS5iaW5kKHRoaXMpKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTWFzdGVyLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5NYXN0ZXIuZGVmYXVsdHM9e3ZvbHVtZTowLG11dGU6ITF9LHMuZGVmYXVsdC5NYXN0ZXIucHJvdG90eXBlLmlzTWFzdGVyPSEwLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTWFzdGVyLnByb3RvdHlwZSxcIm11dGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3ZvbHVtZS5tdXRlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fdm9sdW1lLm11dGU9dH19KSxzLmRlZmF1bHQuTWFzdGVyLnByb3RvdHlwZS5jaGFpbj1mdW5jdGlvbigpe3RoaXMuaW5wdXQuZGlzY29ubmVjdCgpO3ZhciB0PUFycmF5LmZyb20oYXJndW1lbnRzKTt0LnVuc2hpZnQodGhpcy5pbnB1dCksdC5wdXNoKHRoaXMub3V0cHV0KSxzLmRlZmF1bHQuY29ubmVjdFNlcmllcy5hcHBseSh2b2lkIDAsdCl9LHMuZGVmYXVsdC5NYXN0ZXIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoXCJ2b2x1bWVcIiksdGhpcy5fdm9sdW1lLmRpc3Bvc2UoKSx0aGlzLl92b2x1bWU9bnVsbCx0aGlzLnZvbHVtZT1udWxsfSxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS50b01hc3Rlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbm5lY3QodGhpcy5jb250ZXh0Lm1hc3RlciksdGhpc307dmFyIG49cy5kZWZhdWx0Lk1hc3RlcjtzLmRlZmF1bHQuTWFzdGVyPW5ldyBuLHMuZGVmYXVsdC5Db250ZXh0Lm9uKFwiaW5pdFwiLGZ1bmN0aW9uKHQpe3QubWFzdGVyJiZ0Lm1hc3Rlci5pc01hc3Rlcj9zLmRlZmF1bHQuTWFzdGVyPXQubWFzdGVyOnMuZGVmYXVsdC5NYXN0ZXI9bmV3IG59KSxzLmRlZmF1bHQuQ29udGV4dC5vbihcImNsb3NlXCIsZnVuY3Rpb24odCl7dC5tYXN0ZXImJnQubWFzdGVyLmlzTWFzdGVyJiZ0Lm1hc3Rlci5kaXNwb3NlKCl9KSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lk1hc3Rlcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koODYpLGkoNDcpO3MuZGVmYXVsdC5GcmVxdWVuY3lFbnZlbG9wZT1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiYXR0YWNrXCIsXCJkZWNheVwiLFwic3VzdGFpblwiLFwicmVsZWFzZVwiXSxzLmRlZmF1bHQuRW52ZWxvcGUpO3Q9cy5kZWZhdWx0LmRlZmF1bHRBcmcodCxzLmRlZmF1bHQuRnJlcXVlbmN5RW52ZWxvcGUuZGVmYXVsdHMpLHMuZGVmYXVsdC5TY2FsZWRFbnZlbG9wZS5jYWxsKHRoaXMsdCksdGhpcy5fb2N0YXZlcz10Lm9jdGF2ZXMsdGhpcy5iYXNlRnJlcXVlbmN5PXQuYmFzZUZyZXF1ZW5jeSx0aGlzLm9jdGF2ZXM9dC5vY3RhdmVzLHRoaXMuZXhwb25lbnQ9dC5leHBvbmVudH0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRnJlcXVlbmN5RW52ZWxvcGUscy5kZWZhdWx0LkVudmVsb3BlKSxzLmRlZmF1bHQuRnJlcXVlbmN5RW52ZWxvcGUuZGVmYXVsdHM9e2Jhc2VGcmVxdWVuY3k6MjAwLG9jdGF2ZXM6NCxleHBvbmVudDoxfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZyZXF1ZW5jeUVudmVsb3BlLnByb3RvdHlwZSxcImJhc2VGcmVxdWVuY3lcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NjYWxlLm1pbn0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3NjYWxlLm1pbj10aGlzLnRvRnJlcXVlbmN5KHQpLHRoaXMub2N0YXZlcz10aGlzLl9vY3RhdmVzfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRnJlcXVlbmN5RW52ZWxvcGUucHJvdG90eXBlLFwib2N0YXZlc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb2N0YXZlc30sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX29jdGF2ZXM9dCx0aGlzLl9zY2FsZS5tYXg9dGhpcy5iYXNlRnJlcXVlbmN5Kk1hdGgucG93KDIsdCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GcmVxdWVuY3lFbnZlbG9wZS5wcm90b3R5cGUsXCJleHBvbmVudFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZXhwLnZhbHVlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fZXhwLnZhbHVlPXR9fSkscy5kZWZhdWx0LkZyZXF1ZW5jeUVudmVsb3BlLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5TY2FsZWRFbnZlbG9wZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRnJlcXVlbmN5RW52ZWxvcGV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDI2KSxpKDYxKTtzLmRlZmF1bHQuU2NhbGVFeHA9ZnVuY3Rpb24odCxlLGkpe3MuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksdGhpcy5fc2NhbGU9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5TY2FsZSh0LGUpLHRoaXMuX2V4cD10aGlzLmlucHV0PW5ldyBzLmRlZmF1bHQuUG93KHMuZGVmYXVsdC5kZWZhdWx0QXJnKGksMikpLHRoaXMuX2V4cC5jb25uZWN0KHRoaXMuX3NjYWxlKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU2NhbGVFeHAscy5kZWZhdWx0LlNpZ25hbEJhc2UpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU2NhbGVFeHAucHJvdG90eXBlLFwiZXhwb25lbnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2V4cC52YWx1ZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2V4cC52YWx1ZT10fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU2NhbGVFeHAucHJvdG90eXBlLFwibWluXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zY2FsZS5taW59LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zY2FsZS5taW49dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNjYWxlRXhwLnByb3RvdHlwZSxcIm1heFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2NhbGUubWF4fSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fc2NhbGUubWF4PXR9fSkscy5kZWZhdWx0LlNjYWxlRXhwLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fc2NhbGUuZGlzcG9zZSgpLHRoaXMuX3NjYWxlPW51bGwsdGhpcy5fZXhwLmRpc3Bvc2UoKSx0aGlzLl9leHA9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlNjYWxlRXhwfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgxNCksaSgxKTtzLmRlZmF1bHQuQ29tcHJlc3Nvcj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1widGhyZXNob2xkXCIsXCJyYXRpb1wiXSxzLmRlZmF1bHQuQ29tcHJlc3Nvcik7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuX2NvbXByZXNzb3I9dGhpcy5pbnB1dD10aGlzLm91dHB1dD10aGlzLmNvbnRleHQuY3JlYXRlRHluYW1pY3NDb21wcmVzc29yKCksdGhpcy50aHJlc2hvbGQ9bmV3IHMuZGVmYXVsdC5QYXJhbSh7cGFyYW06dGhpcy5fY29tcHJlc3Nvci50aHJlc2hvbGQsdW5pdHM6cy5kZWZhdWx0LlR5cGUuRGVjaWJlbHMsY29udmVydDohMX0pLHRoaXMuYXR0YWNrPW5ldyBzLmRlZmF1bHQuUGFyYW0odGhpcy5fY29tcHJlc3Nvci5hdHRhY2sscy5kZWZhdWx0LlR5cGUuVGltZSksdGhpcy5yZWxlYXNlPW5ldyBzLmRlZmF1bHQuUGFyYW0odGhpcy5fY29tcHJlc3Nvci5yZWxlYXNlLHMuZGVmYXVsdC5UeXBlLlRpbWUpLHRoaXMua25lZT1uZXcgcy5kZWZhdWx0LlBhcmFtKHtwYXJhbTp0aGlzLl9jb21wcmVzc29yLmtuZWUsdW5pdHM6cy5kZWZhdWx0LlR5cGUuRGVjaWJlbHMsY29udmVydDohMX0pLHRoaXMucmF0aW89bmV3IHMuZGVmYXVsdC5QYXJhbSh7cGFyYW06dGhpcy5fY29tcHJlc3Nvci5yYXRpbyxjb252ZXJ0OiExfSksdGhpcy5fcmVhZE9ubHkoW1wia25lZVwiLFwicmVsZWFzZVwiLFwiYXR0YWNrXCIsXCJyYXRpb1wiLFwidGhyZXNob2xkXCJdKSx0aGlzLnNldCh0KX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ29tcHJlc3NvcixzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuQ29tcHJlc3Nvci5kZWZhdWx0cz17cmF0aW86MTIsdGhyZXNob2xkOi0yNCxyZWxlYXNlOi4yNSxhdHRhY2s6LjAwMyxrbmVlOjMwfSxzLmRlZmF1bHQuQ29tcHJlc3Nvci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoW1wia25lZVwiLFwicmVsZWFzZVwiLFwiYXR0YWNrXCIsXCJyYXRpb1wiLFwidGhyZXNob2xkXCJdKSx0aGlzLl9jb21wcmVzc29yLmRpc2Nvbm5lY3QoKSx0aGlzLl9jb21wcmVzc29yPW51bGwsdGhpcy5hdHRhY2suZGlzcG9zZSgpLHRoaXMuYXR0YWNrPW51bGwsdGhpcy5yZWxlYXNlLmRpc3Bvc2UoKSx0aGlzLnJlbGVhc2U9bnVsbCx0aGlzLnRocmVzaG9sZC5kaXNwb3NlKCksdGhpcy50aHJlc2hvbGQ9bnVsbCx0aGlzLnJhdGlvLmRpc3Bvc2UoKSx0aGlzLnJhdGlvPW51bGwsdGhpcy5rbmVlLmRpc3Bvc2UoKSx0aGlzLmtuZWU9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkNvbXByZXNzb3J9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjt2YXIgcz1pKDApO2koOTIpO2lmKHMuZGVmYXVsdC5zdXBwb3J0ZWQpeyFzLmRlZmF1bHQuZ2xvYmFsLmhhc093blByb3BlcnR5KFwiQXVkaW9Db250ZXh0XCIpJiZzLmRlZmF1bHQuZ2xvYmFsLmhhc093blByb3BlcnR5KFwid2Via2l0QXVkaW9Db250ZXh0XCIpJiYocy5kZWZhdWx0Lmdsb2JhbC5BdWRpb0NvbnRleHQ9cy5kZWZhdWx0Lmdsb2JhbC53ZWJraXRBdWRpb0NvbnRleHQpLEF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY2xvc2V8fChBdWRpb0NvbnRleHQucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5pc0Z1bmN0aW9uKHRoaXMuc3VzcGVuZCkmJnRoaXMuc3VzcGVuZCgpLFByb21pc2UucmVzb2x2ZSgpfSksQXVkaW9Db250ZXh0LnByb3RvdHlwZS5yZXN1bWV8fChBdWRpb0NvbnRleHQucHJvdG90eXBlLnJlc3VtZT1mdW5jdGlvbigpe3ZhciB0PXRoaXMuY3JlYXRlQnVmZmVyKDEsMSx0aGlzLnNhbXBsZVJhdGUpLGU9dGhpcy5jcmVhdGVCdWZmZXJTb3VyY2UoKTtyZXR1cm4gZS5idWZmZXI9dCxlLmNvbm5lY3QodGhpcy5kZXN0aW5hdGlvbiksZS5zdGFydCgwKSxQcm9taXNlLnJlc29sdmUoKX0pLCFBdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZUdhaW4mJkF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlR2Fpbk5vZGUmJihBdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZUdhaW49QXVkaW9Db250ZXh0LnByb3RvdHlwZS5jcmVhdGVHYWluTm9kZSksIUF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlRGVsYXkmJkF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlRGVsYXlOb2RlJiYoQXVkaW9Db250ZXh0LnByb3RvdHlwZS5jcmVhdGVEZWxheT1BdWRpb0NvbnRleHQucHJvdG90eXBlLmNyZWF0ZURlbGF5Tm9kZSk7dmFyIG49ITEsbz1uZXcgT2ZmbGluZUF1ZGlvQ29udGV4dCgxLDEsNDQxMDApLGE9bmV3IFVpbnQzMkFycmF5KFsxMTc5MDExNDEwLDQ4LDExNjMyODA3MjcsNTQ0NTAxMDk0LDE2LDEzMTA3Myw0NDEwMCwxNzY0MDAsMTA0ODU4MCwxNjM1MDE3MDYwLDgsMCwwLDAsMF0pLmJ1ZmZlcjt0cnl7dmFyIHI9by5kZWNvZGVBdWRpb0RhdGEoYSk7ciYmcy5kZWZhdWx0LmlzRnVuY3Rpb24oci50aGVuKSYmKG49ITApfWNhdGNoKHQpe249ITF9bnx8KEF1ZGlvQ29udGV4dC5wcm90b3R5cGUuX25hdGl2ZV9kZWNvZGVBdWRpb0RhdGE9QXVkaW9Db250ZXh0LnByb3RvdHlwZS5kZWNvZGVBdWRpb0RhdGEsQXVkaW9Db250ZXh0LnByb3RvdHlwZS5kZWNvZGVBdWRpb0RhdGE9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKGUsaSl7dGhpcy5fbmF0aXZlX2RlY29kZUF1ZGlvRGF0YSh0LGUsaSl9LmJpbmQodGhpcykpfSl9fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg2Myk7cy5kZWZhdWx0LlRyYW5zcG9ydFRpbWU9ZnVuY3Rpb24odCxlKXtpZighKHRoaXMgaW5zdGFuY2VvZiBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZSkpcmV0dXJuIG5ldyBzLmRlZmF1bHQuVHJhbnNwb3J0VGltZSh0LGUpO3MuZGVmYXVsdC5UaW1lLmNhbGwodGhpcyx0LGUpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lLHMuZGVmYXVsdC5UaW1lKSxzLmRlZmF1bHQuVHJhbnNwb3J0VGltZS5wcm90b3R5cGUuX25vdz1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuVHJhbnNwb3J0LnNlY29uZHN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuVHJhbnNwb3J0VGltZX0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNjIpO3MuZGVmYXVsdC5GcmVxdWVuY3k9ZnVuY3Rpb24odCxlKXtpZighKHRoaXMgaW5zdGFuY2VvZiBzLmRlZmF1bHQuRnJlcXVlbmN5KSlyZXR1cm4gbmV3IHMuZGVmYXVsdC5GcmVxdWVuY3kodCxlKTtzLmRlZmF1bHQuVGltZUJhc2UuY2FsbCh0aGlzLHQsZSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkZyZXF1ZW5jeSxzLmRlZmF1bHQuVGltZUJhc2UpLHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLl9leHByZXNzaW9ucz1PYmplY3QuYXNzaWduKHt9LHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX2V4cHJlc3Npb25zLHttaWRpOntyZWdleHA6L14oXFxkKyg/OlxcLlxcZCspP21pZGkpLyxtZXRob2Q6ZnVuY3Rpb24odCl7cmV0dXJuXCJtaWRpXCI9PT10aGlzLl9kZWZhdWx0VW5pdHM/dDpzLmRlZmF1bHQuRnJlcXVlbmN5Lm10b2YodCl9fSxub3RlOntyZWdleHA6L14oW2EtZ117MX0oPzpifCN8eHxiYik/KSgtP1swLTldKykvaSxtZXRob2Q6ZnVuY3Rpb24odCxlKXt2YXIgaT1uW3QudG9Mb3dlckNhc2UoKV0rMTIqKHBhcnNlSW50KGUpKzEpO3JldHVyblwibWlkaVwiPT09dGhpcy5fZGVmYXVsdFVuaXRzP2k6cy5kZWZhdWx0LkZyZXF1ZW5jeS5tdG9mKGkpfX0sdHI6e3JlZ2V4cDovXihcXGQrKD86XFwuXFxkKyk/KTooXFxkKyg/OlxcLlxcZCspPyk6PyhcXGQrKD86XFwuXFxkKyk/KT8vLG1ldGhvZDpmdW5jdGlvbih0LGUsaSl7dmFyIHM9MTtyZXR1cm4gdCYmXCIwXCIhPT10JiYocyo9dGhpcy5fYmVhdHNUb1VuaXRzKHRoaXMuX2dldFRpbWVTaWduYXR1cmUoKSpwYXJzZUZsb2F0KHQpKSksZSYmXCIwXCIhPT1lJiYocyo9dGhpcy5fYmVhdHNUb1VuaXRzKHBhcnNlRmxvYXQoZSkpKSxpJiZcIjBcIiE9PWkmJihzKj10aGlzLl9iZWF0c1RvVW5pdHMocGFyc2VGbG9hdChpKS80KSksc319fSkscy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUudHJhbnNwb3NlPWZ1bmN0aW9uKHQpe3JldHVybiBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLnZhbHVlT2YoKSpzLmRlZmF1bHQuaW50ZXJ2YWxUb0ZyZXF1ZW5jeVJhdGlvKHQpKX0scy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUuaGFybW9uaXplPWZ1bmN0aW9uKHQpe3JldHVybiB0Lm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy50cmFuc3Bvc2UodCl9LmJpbmQodGhpcykpfSxzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS50b01pZGk9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkZyZXF1ZW5jeS5mdG9tKHRoaXMudmFsdWVPZigpKX0scy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUudG9Ob3RlPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy50b0ZyZXF1ZW5jeSgpLGU9TWF0aC5sb2cyKHQvcy5kZWZhdWx0LkZyZXF1ZW5jeS5BNCksaT1NYXRoLnJvdW5kKDEyKmUpKzU3LG49TWF0aC5mbG9vcihpLzEyKTtyZXR1cm4gbjwwJiYoaSs9LTEyKm4pLG9baSUxMl0rbi50b1N0cmluZygpfSxzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS50b1NlY29uZHM9ZnVuY3Rpb24oKXtyZXR1cm4gMS9zLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLnRvU2Vjb25kcy5jYWxsKHRoaXMpfSxzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS50b0ZyZXF1ZW5jeT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLnRvRnJlcXVlbmN5LmNhbGwodGhpcyl9LHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLnRvVGlja3M9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9iZWF0c1RvVW5pdHMoMSksZT10aGlzLnZhbHVlT2YoKS90O3JldHVybiBNYXRoLmZsb29yKGUqcy5kZWZhdWx0LlRyYW5zcG9ydC5QUFEpfSxzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS5fbm9Bcmc9ZnVuY3Rpb24oKXtyZXR1cm4gMH0scy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUuX2ZyZXF1ZW5jeVRvVW5pdHM9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLl90aWNrc1RvVW5pdHM9ZnVuY3Rpb24odCl7cmV0dXJuIDEvKDYwKnQvKHMuZGVmYXVsdC5UcmFuc3BvcnQuYnBtLnZhbHVlKnMuZGVmYXVsdC5UcmFuc3BvcnQuUFBRKSl9LHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLl9iZWF0c1RvVW5pdHM9ZnVuY3Rpb24odCl7cmV0dXJuIDEvcy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5fYmVhdHNUb1VuaXRzLmNhbGwodGhpcyx0KX0scy5kZWZhdWx0LkZyZXF1ZW5jeS5wcm90b3R5cGUuX3NlY29uZHNUb1VuaXRzPWZ1bmN0aW9uKHQpe3JldHVybiAxL3R9LHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLl9kZWZhdWx0VW5pdHM9XCJoelwiO3ZhciBuPXtjYmI6LTIsY2I6LTEsYzowLFwiYyNcIjoxLGN4OjIsZGJiOjAsZGI6MSxkOjIsXCJkI1wiOjMsZHg6NCxlYmI6MixlYjozLGU6NCxcImUjXCI6NSxleDo2LGZiYjozLGZiOjQsZjo1LFwiZiNcIjo2LGZ4OjcsZ2JiOjUsZ2I6NixnOjcsXCJnI1wiOjgsZ3g6OSxhYmI6NyxhYjo4LGE6OSxcImEjXCI6MTAsYXg6MTEsYmJiOjksYmI6MTAsYjoxMSxcImIjXCI6MTIsYng6MTN9LG89W1wiQ1wiLFwiQyNcIixcIkRcIixcIkQjXCIsXCJFXCIsXCJGXCIsXCJGI1wiLFwiR1wiLFwiRyNcIixcIkFcIixcIkEjXCIsXCJCXCJdO3MuZGVmYXVsdC5GcmVxdWVuY3kuQTQ9NDQwLHMuZGVmYXVsdC5GcmVxdWVuY3kubXRvZj1mdW5jdGlvbih0KXtyZXR1cm4gcy5kZWZhdWx0LkZyZXF1ZW5jeS5BNCpNYXRoLnBvdygyLCh0LTY5KS8xMil9LHMuZGVmYXVsdC5GcmVxdWVuY3kuZnRvbT1mdW5jdGlvbih0KXtyZXR1cm4gNjkrTWF0aC5yb3VuZCgxMipNYXRoLmxvZzIodC9zLmRlZmF1bHQuRnJlcXVlbmN5LkE0KSl9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRnJlcXVlbmN5fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyKSxpKDYxKSxpKDQpLGkoMSk7cy5kZWZhdWx0LkVudmVsb3BlPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJhdHRhY2tcIixcImRlY2F5XCIsXCJzdXN0YWluXCIsXCJyZWxlYXNlXCJdLHMuZGVmYXVsdC5FbnZlbG9wZSk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuYXR0YWNrPXQuYXR0YWNrLHRoaXMuZGVjYXk9dC5kZWNheSx0aGlzLnN1c3RhaW49dC5zdXN0YWluLHRoaXMucmVsZWFzZT10LnJlbGVhc2UsdGhpcy5fYXR0YWNrQ3VydmU9XCJsaW5lYXJcIix0aGlzLl9yZWxlYXNlQ3VydmU9XCJleHBvbmVudGlhbFwiLHRoaXMuX3NpZz10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LlNpZ25hbCgwKSx0aGlzLmF0dGFja0N1cnZlPXQuYXR0YWNrQ3VydmUsdGhpcy5yZWxlYXNlQ3VydmU9dC5yZWxlYXNlQ3VydmUsdGhpcy5kZWNheUN1cnZlPXQuZGVjYXlDdXJ2ZX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRW52ZWxvcGUscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LkVudmVsb3BlLmRlZmF1bHRzPXthdHRhY2s6LjAxLGRlY2F5Oi4xLHN1c3RhaW46LjUscmVsZWFzZToxLGF0dGFja0N1cnZlOlwibGluZWFyXCIsZGVjYXlDdXJ2ZTpcImV4cG9uZW50aWFsXCIscmVsZWFzZUN1cnZlOlwiZXhwb25lbnRpYWxcIn0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5FbnZlbG9wZS5wcm90b3R5cGUsXCJ2YWx1ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRWYWx1ZUF0VGltZSh0aGlzLm5vdygpKX19KSxzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLl9nZXRDdXJ2ZT1mdW5jdGlvbih0LGUpe2lmKHMuZGVmYXVsdC5pc1N0cmluZyh0KSlyZXR1cm4gdDtpZihzLmRlZmF1bHQuaXNBcnJheSh0KSlmb3IodmFyIGkgaW4gcy5kZWZhdWx0LkVudmVsb3BlLlR5cGUpaWYocy5kZWZhdWx0LkVudmVsb3BlLlR5cGVbaV1bZV09PT10KXJldHVybiBpfSxzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLl9zZXRDdXJ2ZT1mdW5jdGlvbih0LGUsaSl7aWYocy5kZWZhdWx0LkVudmVsb3BlLlR5cGUuaGFzT3duUHJvcGVydHkoaSkpe3ZhciBuPXMuZGVmYXVsdC5FbnZlbG9wZS5UeXBlW2ldO3MuZGVmYXVsdC5pc09iamVjdChuKT90aGlzW3RdPW5bZV06dGhpc1t0XT1ufWVsc2V7aWYoIXMuZGVmYXVsdC5pc0FycmF5KGkpKXRocm93IG5ldyBFcnJvcihcIlRvbmUuRW52ZWxvcGU6IGludmFsaWQgY3VydmU6IFwiK2kpO3RoaXNbdF09aX19LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLFwiYXR0YWNrQ3VydmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2dldEN1cnZlKHRoaXMuX2F0dGFja0N1cnZlLFwiSW5cIil9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zZXRDdXJ2ZShcIl9hdHRhY2tDdXJ2ZVwiLFwiSW5cIix0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZSxcInJlbGVhc2VDdXJ2ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ2V0Q3VydmUodGhpcy5fcmVsZWFzZUN1cnZlLFwiT3V0XCIpfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fc2V0Q3VydmUoXCJfcmVsZWFzZUN1cnZlXCIsXCJPdXRcIix0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZSxcImRlY2F5Q3VydmVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RlY2F5Q3VydmV9LHNldDpmdW5jdGlvbih0KXtpZighW1wibGluZWFyXCIsXCJleHBvbmVudGlhbFwiXS5pbmNsdWRlcyh0KSl0aHJvdyBuZXcgRXJyb3IoXCJUb25lLkVudmVsb3BlOiBpbnZhbGlkIGN1cnZlOiBcIit0KTt0aGlzLl9kZWNheUN1cnZlPXR9fSkscy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrPWZ1bmN0aW9uKHQsZSl7dGhpcy5sb2coXCJ0cmlnZ2VyQXR0YWNrXCIsdCxlKSx0PXRoaXMudG9TZWNvbmRzKHQpO3ZhciBpPXRoaXMudG9TZWNvbmRzKHRoaXMuYXR0YWNrKSxuPXRoaXMudG9TZWNvbmRzKHRoaXMuZGVjYXkpO2U9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwxKTt2YXIgbz10aGlzLmdldFZhbHVlQXRUaW1lKHQpO28+MCYmKGk9KDEtbykvKDEvaSkpO2lmKDA9PT1pKXRoaXMuX3NpZy5zZXRWYWx1ZUF0VGltZShlLHQpO2Vsc2UgaWYoXCJsaW5lYXJcIj09PXRoaXMuX2F0dGFja0N1cnZlKXRoaXMuX3NpZy5saW5lYXJSYW1wVG8oZSxpLHQpO2Vsc2UgaWYoXCJleHBvbmVudGlhbFwiPT09dGhpcy5fYXR0YWNrQ3VydmUpdGhpcy5fc2lnLnRhcmdldFJhbXBUbyhlLGksdCk7ZWxzZSBpZihpPjApe3RoaXMuX3NpZy5jYW5jZWxBbmRIb2xkQXRUaW1lKHQpO2Zvcih2YXIgYT10aGlzLl9hdHRhY2tDdXJ2ZSxyPTE7cjxhLmxlbmd0aDtyKyspaWYoYVtyLTFdPD1vJiZvPD1hW3JdKXsoYT10aGlzLl9hdHRhY2tDdXJ2ZS5zbGljZShyKSlbMF09bzticmVha310aGlzLl9zaWcuc2V0VmFsdWVDdXJ2ZUF0VGltZShhLHQsaSxlKX1pZihuKXt2YXIgbD1lKnRoaXMuc3VzdGFpbix1PXQraTt0aGlzLmxvZyhcImRlY2F5XCIsdSksXCJsaW5lYXJcIj09PXRoaXMuX2RlY2F5Q3VydmU/dGhpcy5fc2lnLmxpbmVhclJhbXBUbyhsLG4sdSt0aGlzLnNhbXBsZVRpbWUpOlwiZXhwb25lbnRpYWxcIj09PXRoaXMuX2RlY2F5Q3VydmUmJnRoaXMuX3NpZy5leHBvbmVudGlhbEFwcHJvYWNoVmFsdWVBdFRpbWUobCx1LG4pfXJldHVybiB0aGlzfSxzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLnRyaWdnZXJSZWxlYXNlPWZ1bmN0aW9uKHQpe3RoaXMubG9nKFwidHJpZ2dlclJlbGVhc2VcIix0KSx0PXRoaXMudG9TZWNvbmRzKHQpO3ZhciBlPXRoaXMuZ2V0VmFsdWVBdFRpbWUodCk7aWYoZT4wKXt2YXIgaT10aGlzLnRvU2Vjb25kcyh0aGlzLnJlbGVhc2UpO2lmKFwibGluZWFyXCI9PT10aGlzLl9yZWxlYXNlQ3VydmUpdGhpcy5fc2lnLmxpbmVhclJhbXBUbygwLGksdCk7ZWxzZSBpZihcImV4cG9uZW50aWFsXCI9PT10aGlzLl9yZWxlYXNlQ3VydmUpdGhpcy5fc2lnLnRhcmdldFJhbXBUbygwLGksdCk7ZWxzZXt2YXIgbj10aGlzLl9yZWxlYXNlQ3VydmU7cy5kZWZhdWx0LmlzQXJyYXkobikmJih0aGlzLl9zaWcuY2FuY2VsQW5kSG9sZEF0VGltZSh0KSx0aGlzLl9zaWcuc2V0VmFsdWVDdXJ2ZUF0VGltZShuLHQsaSxlKSl9fXJldHVybiB0aGlzfSxzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLmdldFZhbHVlQXRUaW1lPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9zaWcuZ2V0VmFsdWVBdFRpbWUodCl9LHMuZGVmYXVsdC5FbnZlbG9wZS5wcm90b3R5cGUudHJpZ2dlckF0dGFja1JlbGVhc2U9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBlPXRoaXMudG9TZWNvbmRzKGUpLHRoaXMudHJpZ2dlckF0dGFjayhlLGkpLHRoaXMudHJpZ2dlclJlbGVhc2UoZSt0aGlzLnRvU2Vjb25kcyh0KSksdGhpc30scy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZS5jYW5jZWw9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3NpZy5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModCksdGhpc30scy5kZWZhdWx0LkVudmVsb3BlLnByb3RvdHlwZS5jb25uZWN0PXMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5jb25uZWN0LGZ1bmN0aW9uKCl7dmFyIHQsZSxpPVtdO2Zvcih0PTA7dDwxMjg7dCsrKWlbdF09TWF0aC5zaW4odC8xMjcqKE1hdGguUEkvMikpO3ZhciBuPVtdO2Zvcih0PTA7dDwxMjc7dCsrKXtlPXQvMTI3O3ZhciBvPU1hdGguc2luKGUqKDIqTWF0aC5QSSkqNi40LU1hdGguUEkvMikrMTtuW3RdPW8vMTArLjgzKmV9blsxMjddPTE7dmFyIGE9W107Zm9yKHQ9MDt0PDEyODt0KyspYVt0XT1NYXRoLmNlaWwodC8xMjcqNSkvNTt2YXIgcj1bXTtmb3IodD0wO3Q8MTI4O3QrKyllPXQvMTI3LHJbdF09LjUqKDEtTWF0aC5jb3MoTWF0aC5QSSplKSk7dmFyIGwsdT1bXTtmb3IodD0wO3Q8MTI4O3QrKyl7ZT10LzEyNzt2YXIgZj00Kk1hdGgucG93KGUsMykrLjIsZD1NYXRoLmNvcyhmKk1hdGguUEkqMiplKTt1W3RdPU1hdGguYWJzKGQqKDEtZSkpfWZ1bmN0aW9uIGgodCl7Zm9yKHZhciBlPW5ldyBBcnJheSh0Lmxlbmd0aCksaT0wO2k8dC5sZW5ndGg7aSsrKWVbaV09MS10W2ldO3JldHVybiBlfXMuZGVmYXVsdC5FbnZlbG9wZS5UeXBlPXtsaW5lYXI6XCJsaW5lYXJcIixleHBvbmVudGlhbDpcImV4cG9uZW50aWFsXCIsYm91bmNlOntJbjpoKHUpLE91dDp1fSxjb3NpbmU6e0luOmksT3V0OihsPWksbC5zbGljZSgwKS5yZXZlcnNlKCkpfSxzdGVwOntJbjphLE91dDpoKGEpfSxyaXBwbGU6e0luOm4sT3V0Omgobil9LHNpbmU6e0luOnIsT3V0Omgocil9fX0oKSxzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3NpZy5kaXNwb3NlKCksdGhpcy5fc2lnPW51bGwsdGhpcy5fYXR0YWNrQ3VydmU9bnVsbCx0aGlzLl9yZWxlYXNlQ3VydmU9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkVudmVsb3BlfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyMyksaSgxMCksaSgxOSksaSg3KSxpKDI4KSxpKDMpLGkoMiksaSgyMCk7aWYocy5kZWZhdWx0LnN1cHBvcnRlZCYmIXMuZGVmYXVsdC5nbG9iYWwuQXVkaW9Db250ZXh0LnByb3RvdHlwZS5jcmVhdGVTdGVyZW9QYW5uZXIpe3ZhciBuPWZ1bmN0aW9uKHQpe3RoaXMuY29udGV4dD10LHRoaXMucGFuPW5ldyBzLmRlZmF1bHQuU2lnbmFsKDAscy5kZWZhdWx0LlR5cGUuQXVkaW9SYW5nZSk7dmFyIGU9bmV3IHMuZGVmYXVsdC5XYXZlU2hhcGVyKGZ1bmN0aW9uKHQpe3JldHVybiBzLmRlZmF1bHQuZXF1YWxQb3dlclNjYWxlKCh0KzEpLzIpfSw0MDk2KSxpPW5ldyBzLmRlZmF1bHQuV2F2ZVNoYXBlcihmdW5jdGlvbih0KXtyZXR1cm4gcy5kZWZhdWx0LmVxdWFsUG93ZXJTY2FsZSgxLSh0KzEpLzIpfSw0MDk2KSxuPW5ldyBzLmRlZmF1bHQuR2FpbixvPW5ldyBzLmRlZmF1bHQuR2FpbixhPXRoaXMuaW5wdXQ9bmV3IHMuZGVmYXVsdC5TcGxpdDthLl9zcGxpdHRlci5jaGFubmVsQ291bnRNb2RlPVwiZXhwbGljaXRcIiwobmV3IHMuZGVmYXVsdC5aZXJvKS5mYW4oZSxpKTt2YXIgcj10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0Lk1lcmdlO2EubGVmdC5jaGFpbihuLHIubGVmdCksYS5yaWdodC5jaGFpbihvLHIucmlnaHQpLHRoaXMucGFuLmNoYWluKGksbi5nYWluKSx0aGlzLnBhbi5jaGFpbihlLG8uZ2Fpbil9O24ucHJvdG90eXBlLmRpc2Nvbm5lY3Q9ZnVuY3Rpb24oKXt0aGlzLm91dHB1dC5kaXNjb25uZWN0LmFwcGx5KHRoaXMub3V0cHV0LGFyZ3VtZW50cyl9LG4ucHJvdG90eXBlLmNvbm5lY3Q9ZnVuY3Rpb24oKXt0aGlzLm91dHB1dC5jb25uZWN0LmFwcGx5KHRoaXMub3V0cHV0LGFyZ3VtZW50cyl9LEF1ZGlvQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlU3RlcmVvUGFubmVyPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKHRoaXMpfSxzLmRlZmF1bHQuQ29udGV4dC5wcm90b3R5cGUuY3JlYXRlU3RlcmVvUGFubmVyPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBuKHRoaXMpfX1pKDIyKSxpKDEpO3MuZGVmYXVsdC5QYW5uZXI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInBhblwiXSxzLmRlZmF1bHQuUGFubmVyKTtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5fcGFubmVyPXRoaXMuaW5wdXQ9dGhpcy5vdXRwdXQ9dGhpcy5jb250ZXh0LmNyZWF0ZVN0ZXJlb1Bhbm5lcigpLHRoaXMucGFuPXRoaXMuX3Bhbm5lci5wYW4sdGhpcy5wYW4udmFsdWU9dC5wYW4sdGhpcy5fcmVhZE9ubHkoXCJwYW5cIil9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBhbm5lcixzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuUGFubmVyLmRlZmF1bHRzPXtwYW46MH0scy5kZWZhdWx0LlBhbm5lci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoXCJwYW5cIiksdGhpcy5fcGFubmVyLmRpc2Nvbm5lY3QoKSx0aGlzLl9wYW5uZXI9bnVsbCx0aGlzLnBhbj1udWxsLHRoaXN9O2UuZGVmYXVsdD1zLmRlZmF1bHQuUGFubmVyfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg2KSxpKDE3KSxpKDUpLGkoMyk7cy5kZWZhdWx0LkZNT3NjaWxsYXRvcj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJ0eXBlXCIsXCJtb2R1bGF0aW9uVHlwZVwiXSxzLmRlZmF1bHQuRk1Pc2NpbGxhdG9yKTtzLmRlZmF1bHQuU291cmNlLmNhbGwodGhpcyx0KSx0aGlzLl9jYXJyaWVyPW5ldyBzLmRlZmF1bHQuT3NjaWxsYXRvcih0LmZyZXF1ZW5jeSx0LnR5cGUpLHRoaXMuZnJlcXVlbmN5PW5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZnJlcXVlbmN5LHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksdGhpcy5kZXR1bmU9dGhpcy5fY2Fycmllci5kZXR1bmUsdGhpcy5kZXR1bmUudmFsdWU9dC5kZXR1bmUsdGhpcy5tb2R1bGF0aW9uSW5kZXg9bmV3IHMuZGVmYXVsdC5NdWx0aXBseSh0Lm1vZHVsYXRpb25JbmRleCksdGhpcy5tb2R1bGF0aW9uSW5kZXgudW5pdHM9cy5kZWZhdWx0LlR5cGUuUG9zaXRpdmUsdGhpcy5fbW9kdWxhdG9yPW5ldyBzLmRlZmF1bHQuT3NjaWxsYXRvcih0LmZyZXF1ZW5jeSx0Lm1vZHVsYXRpb25UeXBlKSx0aGlzLmhhcm1vbmljaXR5PW5ldyBzLmRlZmF1bHQuTXVsdGlwbHkodC5oYXJtb25pY2l0eSksdGhpcy5oYXJtb25pY2l0eS51bml0cz1zLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSx0aGlzLl9tb2R1bGF0aW9uTm9kZT1uZXcgcy5kZWZhdWx0LkdhaW4oMCksdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9jYXJyaWVyLmZyZXF1ZW5jeSksdGhpcy5mcmVxdWVuY3kuY2hhaW4odGhpcy5oYXJtb25pY2l0eSx0aGlzLl9tb2R1bGF0b3IuZnJlcXVlbmN5KSx0aGlzLmZyZXF1ZW5jeS5jaGFpbih0aGlzLm1vZHVsYXRpb25JbmRleCx0aGlzLl9tb2R1bGF0aW9uTm9kZSksdGhpcy5fbW9kdWxhdG9yLmNvbm5lY3QodGhpcy5fbW9kdWxhdGlvbk5vZGUuZ2FpbiksdGhpcy5fbW9kdWxhdGlvbk5vZGUuY29ubmVjdCh0aGlzLl9jYXJyaWVyLmZyZXF1ZW5jeSksdGhpcy5fY2Fycmllci5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLmRldHVuZS5jb25uZWN0KHRoaXMuX21vZHVsYXRvci5kZXR1bmUpLHRoaXMucGhhc2U9dC5waGFzZSx0aGlzLl9yZWFkT25seShbXCJtb2R1bGF0aW9uSW5kZXhcIixcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCIsXCJoYXJtb25pY2l0eVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkZNT3NjaWxsYXRvcixzLmRlZmF1bHQuU291cmNlKSxzLmRlZmF1bHQuRk1Pc2NpbGxhdG9yLmRlZmF1bHRzPXtmcmVxdWVuY3k6NDQwLGRldHVuZTowLHBoYXNlOjAsdHlwZTpcInNpbmVcIixtb2R1bGF0aW9uSW5kZXg6Mixtb2R1bGF0aW9uVHlwZTpcInNxdWFyZVwiLGhhcm1vbmljaXR5OjF9LHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IucHJvdG90eXBlLl9zdGFydD1mdW5jdGlvbih0KXt0aGlzLl9tb2R1bGF0b3Iuc3RhcnQodCksdGhpcy5fY2Fycmllci5zdGFydCh0KX0scy5kZWZhdWx0LkZNT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0b3A9ZnVuY3Rpb24odCl7dGhpcy5fbW9kdWxhdG9yLnN0b3AodCksdGhpcy5fY2Fycmllci5zdG9wKHQpfSxzLmRlZmF1bHQuRk1Pc2NpbGxhdG9yLnByb3RvdHlwZS5yZXN0YXJ0PWZ1bmN0aW9uKHQpe3RoaXMuX21vZHVsYXRvci5yZXN0YXJ0KHQpLHRoaXMuX2NhcnJpZXIucmVzdGFydCh0KX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IucHJvdG90eXBlLFwidHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2Fycmllci50eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fY2Fycmllci50eXBlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IucHJvdG90eXBlLFwiYmFzZVR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NhcnJpZXIuYmFzZVR5cGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9jYXJyaWVyLmJhc2VUeXBlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IucHJvdG90eXBlLFwicGFydGlhbENvdW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jYXJyaWVyLnBhcnRpYWxDb3VudH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2NhcnJpZXIucGFydGlhbENvdW50PXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GTU9zY2lsbGF0b3IucHJvdG90eXBlLFwibW9kdWxhdGlvblR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21vZHVsYXRvci50eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fbW9kdWxhdG9yLnR5cGU9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZNT3NjaWxsYXRvci5wcm90b3R5cGUsXCJwaGFzZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2Fycmllci5waGFzZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2NhcnJpZXIucGhhc2U9dCx0aGlzLl9tb2R1bGF0b3IucGhhc2U9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZNT3NjaWxsYXRvci5wcm90b3R5cGUsXCJwYXJ0aWFsc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2Fycmllci5wYXJ0aWFsc30sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2NhcnJpZXIucGFydGlhbHM9dH19KSxzLmRlZmF1bHQuRk1Pc2NpbGxhdG9yLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJtb2R1bGF0aW9uSW5kZXhcIixcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCIsXCJoYXJtb25pY2l0eVwiXSksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuZnJlcXVlbmN5PW51bGwsdGhpcy5kZXR1bmU9bnVsbCx0aGlzLmhhcm1vbmljaXR5LmRpc3Bvc2UoKSx0aGlzLmhhcm1vbmljaXR5PW51bGwsdGhpcy5fY2Fycmllci5kaXNwb3NlKCksdGhpcy5fY2Fycmllcj1udWxsLHRoaXMuX21vZHVsYXRvci5kaXNwb3NlKCksdGhpcy5fbW9kdWxhdG9yPW51bGwsdGhpcy5fbW9kdWxhdGlvbk5vZGUuZGlzcG9zZSgpLHRoaXMuX21vZHVsYXRpb25Ob2RlPW51bGwsdGhpcy5tb2R1bGF0aW9uSW5kZXguZGlzcG9zZSgpLHRoaXMubW9kdWxhdGlvbkluZGV4PW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5GTU9zY2lsbGF0b3J9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDYpLGkoMTcpLGkoMiksaSg3KSxpKDMpO3MuZGVmYXVsdC5QdWxzZU9zY2lsbGF0b3I9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwid2lkdGhcIl0scy5kZWZhdWx0Lk9zY2lsbGF0b3IpO3MuZGVmYXVsdC5Tb3VyY2UuY2FsbCh0aGlzLHQpLHRoaXMud2lkdGg9bmV3IHMuZGVmYXVsdC5TaWduYWwodC53aWR0aCxzLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSksdGhpcy5fd2lkdGhHYXRlPW5ldyBzLmRlZmF1bHQuR2FpbigwKSx0aGlzLl9zYXd0b290aD1uZXcgcy5kZWZhdWx0Lk9zY2lsbGF0b3Ioe2ZyZXF1ZW5jeTp0LmZyZXF1ZW5jeSxkZXR1bmU6dC5kZXR1bmUsdHlwZTpcInNhd3Rvb3RoXCIscGhhc2U6dC5waGFzZX0pLHRoaXMuZnJlcXVlbmN5PXRoaXMuX3Nhd3Rvb3RoLmZyZXF1ZW5jeSx0aGlzLmRldHVuZT10aGlzLl9zYXd0b290aC5kZXR1bmUsdGhpcy5fdGhyZXNoPW5ldyBzLmRlZmF1bHQuV2F2ZVNoYXBlcihmdW5jdGlvbih0KXtyZXR1cm4gdDwwPy0xOjF9KSx0aGlzLl9zYXd0b290aC5jaGFpbih0aGlzLl90aHJlc2gsdGhpcy5vdXRwdXQpLHRoaXMud2lkdGguY2hhaW4odGhpcy5fd2lkdGhHYXRlLHRoaXMuX3RocmVzaCksdGhpcy5fcmVhZE9ubHkoW1wid2lkdGhcIixcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCJdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUHVsc2VPc2NpbGxhdG9yLHMuZGVmYXVsdC5Tb3VyY2UpLHMuZGVmYXVsdC5QdWxzZU9zY2lsbGF0b3IuZGVmYXVsdHM9e2ZyZXF1ZW5jeTo0NDAsZGV0dW5lOjAscGhhc2U6MCx3aWR0aDouMn0scy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0YXJ0PWZ1bmN0aW9uKHQpe3Q9dGhpcy50b1NlY29uZHModCksdGhpcy5fc2F3dG9vdGguc3RhcnQodCksdGhpcy5fd2lkdGhHYXRlLmdhaW4uc2V0VmFsdWVBdFRpbWUoMSx0KX0scy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0b3A9ZnVuY3Rpb24odCl7dD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9zYXd0b290aC5zdG9wKHQpLHRoaXMuX3dpZHRoR2F0ZS5nYWluLnNldFZhbHVlQXRUaW1lKDAsdCl9LHMuZGVmYXVsdC5QdWxzZU9zY2lsbGF0b3IucHJvdG90eXBlLnJlc3RhcnQ9ZnVuY3Rpb24odCl7dGhpcy5fc2F3dG9vdGgucmVzdGFydCh0KSx0aGlzLl93aWR0aEdhdGUuZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModCksdGhpcy5fd2lkdGhHYXRlLmdhaW4uc2V0VmFsdWVBdFRpbWUoMSx0KX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QdWxzZU9zY2lsbGF0b3IucHJvdG90eXBlLFwicGhhc2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Nhd3Rvb3RoLnBoYXNlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fc2F3dG9vdGgucGhhc2U9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvci5wcm90b3R5cGUsXCJ0eXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVyblwicHVsc2VcIn19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvci5wcm90b3R5cGUsXCJiYXNlVHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm5cInB1bHNlXCJ9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QdWxzZU9zY2lsbGF0b3IucHJvdG90eXBlLFwicGFydGlhbHNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuW119fSkscy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuU291cmNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fc2F3dG9vdGguZGlzcG9zZSgpLHRoaXMuX3Nhd3Rvb3RoPW51bGwsdGhpcy5fd3JpdGFibGUoW1wid2lkdGhcIixcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCJdKSx0aGlzLndpZHRoLmRpc3Bvc2UoKSx0aGlzLndpZHRoPW51bGwsdGhpcy5fd2lkdGhHYXRlLmRpc3Bvc2UoKSx0aGlzLl93aWR0aEdhdGU9bnVsbCx0aGlzLl90aHJlc2guZGlzcG9zZSgpLHRoaXMuX3RocmVzaD1udWxsLHRoaXMuZnJlcXVlbmN5PW51bGwsdGhpcy5kZXR1bmU9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTYpLGkoNCksaSgzNCk7cy5kZWZhdWx0LkV2ZW50PWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwidmFsdWVcIl0scy5kZWZhdWx0LkV2ZW50KTtzLmRlZmF1bHQuY2FsbCh0aGlzKSx0aGlzLl9sb29wPXQubG9vcCx0aGlzLmNhbGxiYWNrPXQuY2FsbGJhY2ssdGhpcy52YWx1ZT10LnZhbHVlLHRoaXMuX2xvb3BTdGFydD10aGlzLnRvVGlja3ModC5sb29wU3RhcnQpLHRoaXMuX2xvb3BFbmQ9dGhpcy50b1RpY2tzKHQubG9vcEVuZCksdGhpcy5fc3RhdGU9bmV3IHMuZGVmYXVsdC5UaW1lbGluZVN0YXRlKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkKSx0aGlzLl9wbGF5YmFja1JhdGU9MSx0aGlzLl9zdGFydE9mZnNldD0wLHRoaXMuX3Byb2JhYmlsaXR5PXQucHJvYmFiaWxpdHksdGhpcy5faHVtYW5pemU9dC5odW1hbml6ZSx0aGlzLm11dGU9dC5tdXRlLHRoaXMucGxheWJhY2tSYXRlPXQucGxheWJhY2tSYXRlfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5FdmVudCkscy5kZWZhdWx0LkV2ZW50LmRlZmF1bHRzPXtjYWxsYmFjazpzLmRlZmF1bHQubm9PcCxsb29wOiExLGxvb3BFbmQ6XCIxbVwiLGxvb3BTdGFydDowLHBsYXliYWNrUmF0ZToxLHZhbHVlOm51bGwscHJvYmFiaWxpdHk6MSxtdXRlOiExLGh1bWFuaXplOiExfSxzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLl9yZXNjaGVkdWxlRXZlbnRzPWZ1bmN0aW9uKHQpe3JldHVybiB0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsLTEpLHRoaXMuX3N0YXRlLmZvckVhY2hGcm9tKHQsZnVuY3Rpb24odCl7dmFyIGU7aWYodC5zdGF0ZT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkKXtzLmRlZmF1bHQuaXNEZWZpbmVkKHQuaWQpJiZzLmRlZmF1bHQuVHJhbnNwb3J0LmNsZWFyKHQuaWQpO3ZhciBpPXQudGltZStNYXRoLnJvdW5kKHRoaXMuc3RhcnRPZmZzZXQvdGhpcy5fcGxheWJhY2tSYXRlKTtpZighMD09PXRoaXMuX2xvb3B8fHMuZGVmYXVsdC5pc051bWJlcih0aGlzLl9sb29wKSYmdGhpcy5fbG9vcD4xKXtlPTEvMCxzLmRlZmF1bHQuaXNOdW1iZXIodGhpcy5fbG9vcCkmJihlPXRoaXMuX2xvb3AqdGhpcy5fZ2V0TG9vcER1cmF0aW9uKCkpO3ZhciBuPXRoaXMuX3N0YXRlLmdldEFmdGVyKGkpO251bGwhPT1uJiYoZT1NYXRoLm1pbihlLG4udGltZS1pKSksZSE9PTEvMCYmKHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkLGkrZSsxKSxlPXMuZGVmYXVsdC5UaWNrcyhlKSk7dmFyIG89cy5kZWZhdWx0LlRpY2tzKHRoaXMuX2dldExvb3BEdXJhdGlvbigpKTt0LmlkPXMuZGVmYXVsdC5UcmFuc3BvcnQuc2NoZWR1bGVSZXBlYXQodGhpcy5fdGljay5iaW5kKHRoaXMpLG8scy5kZWZhdWx0LlRpY2tzKGkpLGUpfWVsc2UgdC5pZD1zLmRlZmF1bHQuVHJhbnNwb3J0LnNjaGVkdWxlKHRoaXMuX3RpY2suYmluZCh0aGlzKSxzLmRlZmF1bHQuVGlja3MoaSkpfX0uYmluZCh0aGlzKSksdGhpc30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUsXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUocy5kZWZhdWx0LlRyYW5zcG9ydC50aWNrcyl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUsXCJzdGFydE9mZnNldFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhcnRPZmZzZXR9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zdGFydE9mZnNldD10fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLFwicHJvYmFiaWxpdHlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Byb2JhYmlsaXR5fSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fcHJvYmFiaWxpdHk9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZSxcImh1bWFuaXplXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9odW1hbml6ZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2h1bWFuaXplPXR9fSkscy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbih0KXtyZXR1cm4gdD10aGlzLnRvVGlja3ModCksdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCk9PT1zLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCYmKHRoaXMuX3N0YXRlLmFkZCh7c3RhdGU6cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQsdGltZTp0LGlkOnZvaWQgMH0pLHRoaXMuX3Jlc2NoZWR1bGVFdmVudHModCkpLHRoaXN9LHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbih0KXtpZih0aGlzLmNhbmNlbCh0KSx0PXRoaXMudG9UaWNrcyh0KSx0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZSh0KT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkKXt0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCx0KTt2YXIgZT10aGlzLl9zdGF0ZS5nZXRCZWZvcmUodCksaT10O251bGwhPT1lJiYoaT1lLnRpbWUpLHRoaXMuX3Jlc2NoZWR1bGVFdmVudHMoaSl9cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKHQpe3JldHVybiB0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQsLTEvMCksdD10aGlzLnRvVGlja3ModCksdGhpcy5fc3RhdGUuZm9yRWFjaEZyb20odCxmdW5jdGlvbih0KXtzLmRlZmF1bHQuVHJhbnNwb3J0LmNsZWFyKHQuaWQpfSksdGhpcy5fc3RhdGUuY2FuY2VsKHQpLHRoaXN9LHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUuX3RpY2s9ZnVuY3Rpb24odCl7dmFyIGU9cy5kZWZhdWx0LlRyYW5zcG9ydC5nZXRUaWNrc0F0VGltZSh0KTtpZighdGhpcy5tdXRlJiZ0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZShlKT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkKXtpZih0aGlzLnByb2JhYmlsaXR5PDEmJk1hdGgucmFuZG9tKCk+dGhpcy5wcm9iYWJpbGl0eSlyZXR1cm47aWYodGhpcy5odW1hbml6ZSl7dmFyIGk9LjAyO3MuZGVmYXVsdC5pc0Jvb2xlYW4odGhpcy5odW1hbml6ZSl8fChpPXRoaXMudG9TZWNvbmRzKHRoaXMuaHVtYW5pemUpKSx0Kz0oMipNYXRoLnJhbmRvbSgpLTEpKml9dGhpcy5jYWxsYmFjayh0LHRoaXMudmFsdWUpfX0scy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZS5fZ2V0TG9vcER1cmF0aW9uPWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGgucm91bmQoKHRoaXMuX2xvb3BFbmQtdGhpcy5fbG9vcFN0YXJ0KS90aGlzLl9wbGF5YmFja1JhdGUpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZSxcImxvb3BcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xvb3B9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9sb29wPXQsdGhpcy5fcmVzY2hlZHVsZUV2ZW50cygpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRXZlbnQucHJvdG90eXBlLFwicGxheWJhY2tSYXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wbGF5YmFja1JhdGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9wbGF5YmFja1JhdGU9dCx0aGlzLl9yZXNjaGVkdWxlRXZlbnRzKCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUsXCJsb29wRW5kXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuVGlja3ModGhpcy5fbG9vcEVuZCkudG9TZWNvbmRzKCl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9sb29wRW5kPXRoaXMudG9UaWNrcyh0KSx0aGlzLl9sb29wJiZ0aGlzLl9yZXNjaGVkdWxlRXZlbnRzKCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUsXCJsb29wU3RhcnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5UaWNrcyh0aGlzLl9sb29wU3RhcnQpLnRvU2Vjb25kcygpfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fbG9vcFN0YXJ0PXRoaXMudG9UaWNrcyh0KSx0aGlzLl9sb29wJiZ0aGlzLl9yZXNjaGVkdWxlRXZlbnRzKCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUsXCJwcm9ncmVzc1wiLHtnZXQ6ZnVuY3Rpb24oKXtpZih0aGlzLl9sb29wKXt2YXIgdD1zLmRlZmF1bHQuVHJhbnNwb3J0LnRpY2tzLGU9dGhpcy5fc3RhdGUuZ2V0KHQpO2lmKG51bGwhPT1lJiZlLnN0YXRlPT09cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQpe3ZhciBpPXRoaXMuX2dldExvb3BEdXJhdGlvbigpO3JldHVybih0LWUudGltZSklaS9pfXJldHVybiAwfXJldHVybiAwfX0pLHMuZGVmYXVsdC5FdmVudC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3RoaXMuY2FuY2VsKCksdGhpcy5fc3RhdGUuZGlzcG9zZSgpLHRoaXMuX3N0YXRlPW51bGwsdGhpcy5jYWxsYmFjaz1udWxsLHRoaXMudmFsdWU9bnVsbH0sZS5kZWZhdWx0PXMuZGVmYXVsdC5FdmVudH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMiksaSgxMyksaSgyOSksaSgxMCksaSgzKSxpKDEpO3MuZGVmYXVsdC5NaWRTaWRlTWVyZ2U9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5jcmVhdGVJbnNPdXRzKDIsMCksdGhpcy5taWQ9dGhpcy5pbnB1dFswXT1uZXcgcy5kZWZhdWx0LkdhaW4sdGhpcy5fbGVmdD1uZXcgcy5kZWZhdWx0LkFkZCx0aGlzLl90aW1lc1R3b0xlZnQ9bmV3IHMuZGVmYXVsdC5NdWx0aXBseShNYXRoLlNRUlQxXzIpLHRoaXMuc2lkZT10aGlzLmlucHV0WzFdPW5ldyBzLmRlZmF1bHQuR2Fpbix0aGlzLl9yaWdodD1uZXcgcy5kZWZhdWx0LlN1YnRyYWN0LHRoaXMuX3RpbWVzVHdvUmlnaHQ9bmV3IHMuZGVmYXVsdC5NdWx0aXBseShNYXRoLlNRUlQxXzIpLHRoaXMuX21lcmdlPXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuTWVyZ2UsdGhpcy5taWQuY29ubmVjdCh0aGlzLl9sZWZ0LDAsMCksdGhpcy5zaWRlLmNvbm5lY3QodGhpcy5fbGVmdCwwLDEpLHRoaXMubWlkLmNvbm5lY3QodGhpcy5fcmlnaHQsMCwwKSx0aGlzLnNpZGUuY29ubmVjdCh0aGlzLl9yaWdodCwwLDEpLHRoaXMuX2xlZnQuY29ubmVjdCh0aGlzLl90aW1lc1R3b0xlZnQpLHRoaXMuX3JpZ2h0LmNvbm5lY3QodGhpcy5fdGltZXNUd29SaWdodCksdGhpcy5fdGltZXNUd29MZWZ0LmNvbm5lY3QodGhpcy5fbWVyZ2UsMCwwKSx0aGlzLl90aW1lc1R3b1JpZ2h0LmNvbm5lY3QodGhpcy5fbWVyZ2UsMCwxKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTWlkU2lkZU1lcmdlLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5NaWRTaWRlTWVyZ2UucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMubWlkLmRpc3Bvc2UoKSx0aGlzLm1pZD1udWxsLHRoaXMuc2lkZS5kaXNwb3NlKCksdGhpcy5zaWRlPW51bGwsdGhpcy5fbGVmdC5kaXNwb3NlKCksdGhpcy5fbGVmdD1udWxsLHRoaXMuX3RpbWVzVHdvTGVmdC5kaXNwb3NlKCksdGhpcy5fdGltZXNUd29MZWZ0PW51bGwsdGhpcy5fcmlnaHQuZGlzcG9zZSgpLHRoaXMuX3JpZ2h0PW51bGwsdGhpcy5fdGltZXNUd29SaWdodC5kaXNwb3NlKCksdGhpcy5fdGltZXNUd29SaWdodD1udWxsLHRoaXMuX21lcmdlLmRpc3Bvc2UoKSx0aGlzLl9tZXJnZT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuTWlkU2lkZU1lcmdlfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyOSksaSgxMyksaSgyKSxpKDE5KSxpKDEpO3MuZGVmYXVsdC5NaWRTaWRlU3BsaXQ9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5jcmVhdGVJbnNPdXRzKDAsMiksdGhpcy5fc3BsaXQ9dGhpcy5pbnB1dD1uZXcgcy5kZWZhdWx0LlNwbGl0LHRoaXMuX21pZEFkZD1uZXcgcy5kZWZhdWx0LkFkZCx0aGlzLm1pZD10aGlzLm91dHB1dFswXT1uZXcgcy5kZWZhdWx0Lk11bHRpcGx5KE1hdGguU1FSVDFfMiksdGhpcy5fc2lkZVN1YnRyYWN0PW5ldyBzLmRlZmF1bHQuU3VidHJhY3QsdGhpcy5zaWRlPXRoaXMub3V0cHV0WzFdPW5ldyBzLmRlZmF1bHQuTXVsdGlwbHkoTWF0aC5TUVJUMV8yKSx0aGlzLl9zcGxpdC5jb25uZWN0KHRoaXMuX21pZEFkZCwwLDApLHRoaXMuX3NwbGl0LmNvbm5lY3QodGhpcy5fbWlkQWRkLDEsMSksdGhpcy5fc3BsaXQuY29ubmVjdCh0aGlzLl9zaWRlU3VidHJhY3QsMCwwKSx0aGlzLl9zcGxpdC5jb25uZWN0KHRoaXMuX3NpZGVTdWJ0cmFjdCwxLDEpLHRoaXMuX21pZEFkZC5jb25uZWN0KHRoaXMubWlkKSx0aGlzLl9zaWRlU3VidHJhY3QuY29ubmVjdCh0aGlzLnNpZGUpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5NaWRTaWRlU3BsaXQscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0Lk1pZFNpZGVTcGxpdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5taWQuZGlzcG9zZSgpLHRoaXMubWlkPW51bGwsdGhpcy5zaWRlLmRpc3Bvc2UoKSx0aGlzLnNpZGU9bnVsbCx0aGlzLl9taWRBZGQuZGlzcG9zZSgpLHRoaXMuX21pZEFkZD1udWxsLHRoaXMuX3NpZGVTdWJ0cmFjdC5kaXNwb3NlKCksdGhpcy5fc2lkZVN1YnRyYWN0PW51bGwsdGhpcy5fc3BsaXQuZGlzcG9zZSgpLHRoaXMuX3NwbGl0PW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5NaWRTaWRlU3BsaXR9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDIpLGkoOSksaSgxKSxpKDU5KTtzLmRlZmF1bHQuTG93cGFzc0NvbWJGaWx0ZXI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImRlbGF5VGltZVwiLFwicmVzb25hbmNlXCIsXCJkYW1wZW5pbmdcIl0scy5kZWZhdWx0Lkxvd3Bhc3NDb21iRmlsdGVyKTtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5fY29tYkZpbHRlcj10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LkZlZWRiYWNrQ29tYkZpbHRlcih0LmRlbGF5VGltZSx0LnJlc29uYW5jZSksdGhpcy5kZWxheVRpbWU9dGhpcy5fY29tYkZpbHRlci5kZWxheVRpbWUsdGhpcy5fbG93cGFzcz10aGlzLmlucHV0PW5ldyBzLmRlZmF1bHQuRmlsdGVyKHtmcmVxdWVuY3k6dC5kYW1wZW5pbmcsdHlwZTpcImxvd3Bhc3NcIixROjAscm9sbG9mZjotMTJ9KSx0aGlzLmRhbXBlbmluZz10aGlzLl9sb3dwYXNzLmZyZXF1ZW5jeSx0aGlzLnJlc29uYW5jZT10aGlzLl9jb21iRmlsdGVyLnJlc29uYW5jZSx0aGlzLl9sb3dwYXNzLmNvbm5lY3QodGhpcy5fY29tYkZpbHRlciksdGhpcy5fcmVhZE9ubHkoW1wiZGFtcGVuaW5nXCIsXCJyZXNvbmFuY2VcIixcImRlbGF5VGltZVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lkxvd3Bhc3NDb21iRmlsdGVyLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5Mb3dwYXNzQ29tYkZpbHRlci5kZWZhdWx0cz17ZGVsYXlUaW1lOi4xLHJlc29uYW5jZTouNSxkYW1wZW5pbmc6M2UzfSxzLmRlZmF1bHQuTG93cGFzc0NvbWJGaWx0ZXIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3dyaXRhYmxlKFtcImRhbXBlbmluZ1wiLFwicmVzb25hbmNlXCIsXCJkZWxheVRpbWVcIl0pLHRoaXMuX2NvbWJGaWx0ZXIuZGlzcG9zZSgpLHRoaXMuX2NvbWJGaWx0ZXI9bnVsbCx0aGlzLnJlc29uYW5jZT1udWxsLHRoaXMuZGVsYXlUaW1lPW51bGwsdGhpcy5fbG93cGFzcy5kaXNwb3NlKCksdGhpcy5fbG93cGFzcz1udWxsLHRoaXMuZGFtcGVuaW5nPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5Mb3dwYXNzQ29tYkZpbHRlcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNDUpO3MuZGVmYXVsdC5UaWNrcz1mdW5jdGlvbih0LGUpe2lmKCEodGhpcyBpbnN0YW5jZW9mIHMuZGVmYXVsdC5UaWNrcykpcmV0dXJuIG5ldyBzLmRlZmF1bHQuVGlja3ModCxlKTtzLmRlZmF1bHQuVHJhbnNwb3J0VGltZS5jYWxsKHRoaXMsdCxlKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVGlja3Mscy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUpLHMuZGVmYXVsdC5UaWNrcy5wcm90b3R5cGUuX2RlZmF1bHRVbml0cz1cImlcIixzLmRlZmF1bHQuVGlja3MucHJvdG90eXBlLl9ub3c9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlRyYW5zcG9ydC50aWNrc30scy5kZWZhdWx0LlRpY2tzLnByb3RvdHlwZS5fYmVhdHNUb1VuaXRzPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9nZXRQUFEoKSp0fSxzLmRlZmF1bHQuVGlja3MucHJvdG90eXBlLl9zZWNvbmRzVG9Vbml0cz1mdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5mbG9vcih0Lyg2MC90aGlzLl9nZXRCcG0oKSkqdGhpcy5fZ2V0UFBRKCkpfSxzLmRlZmF1bHQuVGlja3MucHJvdG90eXBlLl90aWNrc1RvVW5pdHM9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LHMuZGVmYXVsdC5UaWNrcy5wcm90b3R5cGUudG9UaWNrcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbHVlT2YoKX0scy5kZWZhdWx0LlRpY2tzLnByb3RvdHlwZS50b1NlY29uZHM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy52YWx1ZU9mKCkvdGhpcy5fZ2V0UFBRKCkqKDYwL3RoaXMuX2dldEJwbSgpKX0sZS5kZWZhdWx0PXMuZGVmYXVsdC5UaWNrc30sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNTUpO3MuZGVmYXVsdC5UcmFuc3BvcnRFdmVudD1mdW5jdGlvbih0LGUpe2U9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSxzLmRlZmF1bHQuVHJhbnNwb3J0RXZlbnQuZGVmYXVsdHMpLHMuZGVmYXVsdC5jYWxsKHRoaXMpLHRoaXMuVHJhbnNwb3J0PXQsdGhpcy5pZD1zLmRlZmF1bHQuVHJhbnNwb3J0RXZlbnQuX2V2ZW50SWQrKyx0aGlzLnRpbWU9cy5kZWZhdWx0LlRpY2tzKGUudGltZSksdGhpcy5jYWxsYmFjaz1lLmNhbGxiYWNrLHRoaXMuX29uY2U9ZS5vbmNlfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudCkscy5kZWZhdWx0LlRyYW5zcG9ydEV2ZW50LmRlZmF1bHRzPXtvbmNlOiExLGNhbGxiYWNrOnMuZGVmYXVsdC5ub09wfSxzLmRlZmF1bHQuVHJhbnNwb3J0RXZlbnQuX2V2ZW50SWQ9MCxzLmRlZmF1bHQuVHJhbnNwb3J0RXZlbnQucHJvdG90eXBlLmludm9rZT1mdW5jdGlvbih0KXt0aGlzLmNhbGxiYWNrJiYodGhpcy5jYWxsYmFjayh0KSx0aGlzLl9vbmNlJiZ0aGlzLlRyYW5zcG9ydCYmdGhpcy5UcmFuc3BvcnQuY2xlYXIodGhpcy5pZCkpfSxzLmRlZmF1bHQuVHJhbnNwb3J0RXZlbnQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5UcmFuc3BvcnQ9bnVsbCx0aGlzLmNhbGxiYWNrPW51bGwsdGhpcy50aW1lPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koODIpLGkoMzQpLGkoMjQpLGkoMTQpO3MuZGVmYXVsdC5UaWNrU291cmNlPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIl0scy5kZWZhdWx0LlRpY2tTb3VyY2UpO3RoaXMuZnJlcXVlbmN5PW5ldyBzLmRlZmF1bHQuVGlja1NpZ25hbCh0LmZyZXF1ZW5jeSksdGhpcy5fcmVhZE9ubHkoXCJmcmVxdWVuY3lcIiksdGhpcy5fc3RhdGU9bmV3IHMuZGVmYXVsdC5UaW1lbGluZVN0YXRlKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkKSx0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCwwKSx0aGlzLl90aWNrT2Zmc2V0PW5ldyBzLmRlZmF1bHQuVGltZWxpbmUsdGhpcy5zZXRUaWNrc0F0VGltZSgwLDApfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5UaWNrU291cmNlKSxzLmRlZmF1bHQuVGlja1NvdXJjZS5kZWZhdWx0cz17ZnJlcXVlbmN5OjF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVGlja1NvdXJjZS5wcm90b3R5cGUsXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodGhpcy5ub3coKSl9fSkscy5kZWZhdWx0LlRpY2tTb3VyY2UucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCkhPT1zLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCYmKHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKHMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkLHQpLHMuZGVmYXVsdC5pc0RlZmluZWQoZSkmJnRoaXMuc2V0VGlja3NBdFRpbWUoZSx0KSksdGhpc30scy5kZWZhdWx0LlRpY2tTb3VyY2UucHJvdG90eXBlLnN0b3A9ZnVuY3Rpb24odCl7aWYodD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZSh0KT09PXMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkKXt2YXIgZT10aGlzLl9zdGF0ZS5nZXQodCk7ZS50aW1lPjAmJih0aGlzLl90aWNrT2Zmc2V0LmNhbmNlbChlLnRpbWUpLHRoaXMuX3N0YXRlLmNhbmNlbChlLnRpbWUpKX1yZXR1cm4gdGhpcy5fc3RhdGUuY2FuY2VsKHQpLHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkLHQpLHRoaXMuc2V0VGlja3NBdFRpbWUoMCx0KSx0aGlzfSxzLmRlZmF1bHQuVGlja1NvdXJjZS5wcm90b3R5cGUucGF1c2U9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCk9PT1zLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCYmdGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlBhdXNlZCx0KSx0aGlzfSxzLmRlZmF1bHQuVGlja1NvdXJjZS5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX3N0YXRlLmNhbmNlbCh0KSx0aGlzLl90aWNrT2Zmc2V0LmNhbmNlbCh0KSx0aGlzfSxzLmRlZmF1bHQuVGlja1NvdXJjZS5wcm90b3R5cGUuZ2V0VGlja3NBdFRpbWU9ZnVuY3Rpb24odCl7dD10aGlzLnRvU2Vjb25kcyh0KTt2YXIgZT10aGlzLl9zdGF0ZS5nZXRMYXN0U3RhdGUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQsdCksaT17c3RhdGU6cy5kZWZhdWx0LlN0YXRlLlBhdXNlZCx0aW1lOnR9O3RoaXMuX3N0YXRlLmFkZChpKTt2YXIgbj1lLG89MDtyZXR1cm4gdGhpcy5fc3RhdGUuZm9yRWFjaEJldHdlZW4oZS50aW1lLHQrdGhpcy5zYW1wbGVUaW1lLGZ1bmN0aW9uKHQpe3ZhciBlPW4udGltZSxpPXRoaXMuX3RpY2tPZmZzZXQuZ2V0KHQudGltZSk7aS50aW1lPj1uLnRpbWUmJihvPWkudGlja3MsZT1pLnRpbWUpLG4uc3RhdGU9PT1zLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCYmdC5zdGF0ZSE9PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkJiYobys9dGhpcy5mcmVxdWVuY3kuZ2V0VGlja3NBdFRpbWUodC50aW1lKS10aGlzLmZyZXF1ZW5jeS5nZXRUaWNrc0F0VGltZShlKSksbj10fS5iaW5kKHRoaXMpKSx0aGlzLl9zdGF0ZS5yZW1vdmUoaSksb30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZSxcInRpY2tzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFRpY2tzQXRUaW1lKHRoaXMubm93KCkpfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5zZXRUaWNrc0F0VGltZSh0LHRoaXMubm93KCkpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVGlja1NvdXJjZS5wcm90b3R5cGUsXCJzZWNvbmRzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdldFNlY29uZHNBdFRpbWUodGhpcy5ub3coKSl9LHNldDpmdW5jdGlvbih0KXt2YXIgZT10aGlzLm5vdygpLGk9dGhpcy5mcmVxdWVuY3kudGltZVRvVGlja3ModCxlKTt0aGlzLnNldFRpY2tzQXRUaW1lKGksZSl9fSkscy5kZWZhdWx0LlRpY2tTb3VyY2UucHJvdG90eXBlLmdldFNlY29uZHNBdFRpbWU9ZnVuY3Rpb24odCl7dD10aGlzLnRvU2Vjb25kcyh0KTt2YXIgZT10aGlzLl9zdGF0ZS5nZXRMYXN0U3RhdGUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQsdCksaT17c3RhdGU6cy5kZWZhdWx0LlN0YXRlLlBhdXNlZCx0aW1lOnR9O3RoaXMuX3N0YXRlLmFkZChpKTt2YXIgbj1lLG89MDtyZXR1cm4gdGhpcy5fc3RhdGUuZm9yRWFjaEJldHdlZW4oZS50aW1lLHQrdGhpcy5zYW1wbGVUaW1lLGZ1bmN0aW9uKHQpe3ZhciBlPW4udGltZSxpPXRoaXMuX3RpY2tPZmZzZXQuZ2V0KHQudGltZSk7aS50aW1lPj1uLnRpbWUmJihvPWkuc2Vjb25kcyxlPWkudGltZSksbi5zdGF0ZT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkJiZ0LnN0YXRlIT09cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQmJihvKz10LnRpbWUtZSksbj10fS5iaW5kKHRoaXMpKSx0aGlzLl9zdGF0ZS5yZW1vdmUoaSksb30scy5kZWZhdWx0LlRpY2tTb3VyY2UucHJvdG90eXBlLnNldFRpY2tzQXRUaW1lPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGU9dGhpcy50b1NlY29uZHMoZSksdGhpcy5fdGlja09mZnNldC5jYW5jZWwoZSksdGhpcy5fdGlja09mZnNldC5hZGQoe3RpbWU6ZSx0aWNrczp0LHNlY29uZHM6dGhpcy5mcmVxdWVuY3kuZ2V0RHVyYXRpb25PZlRpY2tzKHQsZSl9KSx0aGlzfSxzLmRlZmF1bHQuVGlja1NvdXJjZS5wcm90b3R5cGUuZ2V0U3RhdGVBdFRpbWU9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodCl9LHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZS5nZXRUaW1lT2ZUaWNrPWZ1bmN0aW9uKHQsZSl7ZT1zLmRlZmF1bHQuZGVmYXVsdEFyZyhlLHRoaXMubm93KCkpO3ZhciBpPXRoaXMuX3RpY2tPZmZzZXQuZ2V0KGUpLG49dGhpcy5fc3RhdGUuZ2V0KGUpLG89TWF0aC5tYXgoaS50aW1lLG4udGltZSksYT10aGlzLmZyZXF1ZW5jeS5nZXRUaWNrc0F0VGltZShvKSt0LWkudGlja3M7cmV0dXJuIHRoaXMuZnJlcXVlbmN5LmdldFRpbWVPZlRpY2soYSl9LHMuZGVmYXVsdC5UaWNrU291cmNlLnByb3RvdHlwZS5mb3JFYWNoVGlja0JldHdlZW49ZnVuY3Rpb24odCxlLGkpe3ZhciBuPXRoaXMuX3N0YXRlLmdldCh0KTtpZih0aGlzLl9zdGF0ZS5mb3JFYWNoQmV0d2Vlbih0LGUsZnVuY3Rpb24oZSl7bi5zdGF0ZT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkJiZlLnN0YXRlIT09cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQmJnRoaXMuZm9yRWFjaFRpY2tCZXR3ZWVuKE1hdGgubWF4KG4udGltZSx0KSxlLnRpbWUtdGhpcy5zYW1wbGVUaW1lLGkpLG49ZX0uYmluZCh0aGlzKSksdD1NYXRoLm1heChuLnRpbWUsdCksbi5zdGF0ZT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkJiZ0aGlzLl9zdGF0ZSl7dmFyIG89dGhpcy5mcmVxdWVuY3kuZ2V0VGlja3NBdFRpbWUodCksYT0oby10aGlzLmZyZXF1ZW5jeS5nZXRUaWNrc0F0VGltZShuLnRpbWUpKSUxOzAhPT1hJiYoYT0xLWEpO2Zvcih2YXIgcj10aGlzLmZyZXF1ZW5jeS5nZXRUaW1lT2ZUaWNrKG8rYSksbD1udWxsO3I8ZSYmdGhpcy5fc3RhdGU7KXt0cnl7aShyLE1hdGgucm91bmQodGhpcy5nZXRUaWNrc0F0VGltZShyKSkpfWNhdGNoKHQpe2w9dDticmVha310aGlzLl9zdGF0ZSYmKHIrPXRoaXMuZnJlcXVlbmN5LmdldER1cmF0aW9uT2ZUaWNrcygxLHIpKX19aWYobCl0aHJvdyBsO3JldHVybiB0aGlzfSxzLmRlZmF1bHQuVGlja1NvdXJjZS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuUGFyYW0ucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9zdGF0ZS5kaXNwb3NlKCksdGhpcy5fc3RhdGU9bnVsbCx0aGlzLl90aWNrT2Zmc2V0LmRpc3Bvc2UoKSx0aGlzLl90aWNrT2Zmc2V0PW51bGwsdGhpcy5fd3JpdGFibGUoXCJmcmVxdWVuY3lcIiksdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuZnJlcXVlbmN5PW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5UaWNrU291cmNlfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg4NyksaSgxMyksaSgyKSxpKDQpLGkoMTgpLGkoMSk7cy5kZWZhdWx0LkZvbGxvd2VyPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJzbW9vdGhpbmdcIl0scy5kZWZhdWx0LkZvbGxvd2VyKTtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5jcmVhdGVJbnNPdXRzKDEsMSksdGhpcy5fYWJzPW5ldyBzLmRlZmF1bHQuQWJzLHRoaXMuX2ZpbHRlcj10aGlzLmNvbnRleHQuY3JlYXRlQmlxdWFkRmlsdGVyKCksdGhpcy5fZmlsdGVyLnR5cGU9XCJsb3dwYXNzXCIsdGhpcy5fZmlsdGVyLmZyZXF1ZW5jeS52YWx1ZT0wLHRoaXMuX2ZpbHRlci5RLnZhbHVlPTAsdGhpcy5fc3ViPW5ldyBzLmRlZmF1bHQuU3VidHJhY3QsdGhpcy5fZGVsYXk9bmV3IHMuZGVmYXVsdC5EZWxheSh0aGlzLmJsb2NrVGltZSksdGhpcy5fc21vb3RoaW5nPXQuc21vb3RoaW5nLHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuaW5wdXQsdGhpcy5fZGVsYXkpLHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuaW5wdXQsdGhpcy5fc3ViLDAsMSksdGhpcy5fc3ViLmNoYWluKHRoaXMuX2Ficyx0aGlzLl9maWx0ZXIsdGhpcy5vdXRwdXQpLHRoaXMuc21vb3RoaW5nPXQuc21vb3RoaW5nfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Gb2xsb3dlcixzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuRm9sbG93ZXIuZGVmYXVsdHM9e3Ntb290aGluZzouMDV9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRm9sbG93ZXIucHJvdG90eXBlLFwic21vb3RoaW5nXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zbW9vdGhpbmd9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zbW9vdGhpbmc9dCx0aGlzLl9maWx0ZXIuZnJlcXVlbmN5LnZhbHVlPS41KnMuZGVmYXVsdC5UaW1lKHQpLnRvRnJlcXVlbmN5KCl9fSkscy5kZWZhdWx0LkZvbGxvd2VyLnByb3RvdHlwZS5jb25uZWN0PXMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5jb25uZWN0LHMuZGVmYXVsdC5Gb2xsb3dlci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fZmlsdGVyLmRpc2Nvbm5lY3QoKSx0aGlzLl9maWx0ZXI9bnVsbCx0aGlzLl9kZWxheS5kaXNwb3NlKCksdGhpcy5fZGVsYXk9bnVsbCx0aGlzLl9zdWIuZGlzY29ubmVjdCgpLHRoaXMuX3N1Yj1udWxsLHRoaXMuX2Ficy5kaXNwb3NlKCksdGhpcy5fYWJzPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5Gb2xsb3dlcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNDIpLGkoMiksaSgxNCksaSgxOCksaSgzKSxpKDEpO3MuZGVmYXVsdC5GZWVkYmFja0NvbWJGaWx0ZXI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImRlbGF5VGltZVwiLFwicmVzb25hbmNlXCJdLHMuZGVmYXVsdC5GZWVkYmFja0NvbWJGaWx0ZXIpO3MuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSx0aGlzLl9kZWxheT10aGlzLmlucHV0PXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuRGVsYXkodC5kZWxheVRpbWUpLHRoaXMuZGVsYXlUaW1lPXRoaXMuX2RlbGF5LmRlbGF5VGltZSx0aGlzLl9mZWVkYmFjaz1uZXcgcy5kZWZhdWx0LkdhaW4odC5yZXNvbmFuY2Uscy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UpLHRoaXMucmVzb25hbmNlPXRoaXMuX2ZlZWRiYWNrLmdhaW4sdGhpcy5fZGVsYXkuY2hhaW4odGhpcy5fZmVlZGJhY2ssdGhpcy5fZGVsYXkpLHRoaXMuX3JlYWRPbmx5KFtcInJlc29uYW5jZVwiLFwiZGVsYXlUaW1lXCJdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRmVlZGJhY2tDb21iRmlsdGVyLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5GZWVkYmFja0NvbWJGaWx0ZXIuZGVmYXVsdHM9e2RlbGF5VGltZTouMSxyZXNvbmFuY2U6LjV9LHMuZGVmYXVsdC5GZWVkYmFja0NvbWJGaWx0ZXIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3dyaXRhYmxlKFtcInJlc29uYW5jZVwiLFwiZGVsYXlUaW1lXCJdKSx0aGlzLl9kZWxheS5kaXNwb3NlKCksdGhpcy5fZGVsYXk9bnVsbCx0aGlzLmRlbGF5VGltZT1udWxsLHRoaXMuX2ZlZWRiYWNrLmRpc3Bvc2UoKSx0aGlzLl9mZWVkYmFjaz1udWxsLHRoaXMucmVzb25hbmNlPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5GZWVkYmFja0NvbWJGaWx0ZXJ9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDkpLGkoMiksaSgzKSxpKDEpO3MuZGVmYXVsdC5NdWx0aWJhbmRTcGxpdD1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wibG93RnJlcXVlbmN5XCIsXCJoaWdoRnJlcXVlbmN5XCJdLHMuZGVmYXVsdC5NdWx0aWJhbmRTcGxpdCk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuaW5wdXQ9bmV3IHMuZGVmYXVsdC5HYWluLHRoaXMub3V0cHV0PW5ldyBBcnJheSgzKSx0aGlzLmxvdz10aGlzLm91dHB1dFswXT1uZXcgcy5kZWZhdWx0LkZpbHRlcigwLFwibG93cGFzc1wiKSx0aGlzLl9sb3dNaWRGaWx0ZXI9bmV3IHMuZGVmYXVsdC5GaWx0ZXIoMCxcImhpZ2hwYXNzXCIpLHRoaXMubWlkPXRoaXMub3V0cHV0WzFdPW5ldyBzLmRlZmF1bHQuRmlsdGVyKDAsXCJsb3dwYXNzXCIpLHRoaXMuaGlnaD10aGlzLm91dHB1dFsyXT1uZXcgcy5kZWZhdWx0LkZpbHRlcigwLFwiaGlnaHBhc3NcIiksdGhpcy5sb3dGcmVxdWVuY3k9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5sb3dGcmVxdWVuY3kscy5kZWZhdWx0LlR5cGUuRnJlcXVlbmN5KSx0aGlzLmhpZ2hGcmVxdWVuY3k9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5oaWdoRnJlcXVlbmN5LHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksdGhpcy5RPW5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuUSksdGhpcy5pbnB1dC5mYW4odGhpcy5sb3csdGhpcy5oaWdoKSx0aGlzLmlucHV0LmNoYWluKHRoaXMuX2xvd01pZEZpbHRlcix0aGlzLm1pZCksdGhpcy5sb3dGcmVxdWVuY3kuY29ubmVjdCh0aGlzLmxvdy5mcmVxdWVuY3kpLHRoaXMubG93RnJlcXVlbmN5LmNvbm5lY3QodGhpcy5fbG93TWlkRmlsdGVyLmZyZXF1ZW5jeSksdGhpcy5oaWdoRnJlcXVlbmN5LmNvbm5lY3QodGhpcy5taWQuZnJlcXVlbmN5KSx0aGlzLmhpZ2hGcmVxdWVuY3kuY29ubmVjdCh0aGlzLmhpZ2guZnJlcXVlbmN5KSx0aGlzLlEuY29ubmVjdCh0aGlzLmxvdy5RKSx0aGlzLlEuY29ubmVjdCh0aGlzLl9sb3dNaWRGaWx0ZXIuUSksdGhpcy5RLmNvbm5lY3QodGhpcy5taWQuUSksdGhpcy5RLmNvbm5lY3QodGhpcy5oaWdoLlEpLHRoaXMuX3JlYWRPbmx5KFtcImhpZ2hcIixcIm1pZFwiLFwibG93XCIsXCJoaWdoRnJlcXVlbmN5XCIsXCJsb3dGcmVxdWVuY3lcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5NdWx0aWJhbmRTcGxpdCxzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuTXVsdGliYW5kU3BsaXQuZGVmYXVsdHM9e2xvd0ZyZXF1ZW5jeTo0MDAsaGlnaEZyZXF1ZW5jeToyNTAwLFE6MX0scy5kZWZhdWx0Lk11bHRpYmFuZFNwbGl0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJoaWdoXCIsXCJtaWRcIixcImxvd1wiLFwiaGlnaEZyZXF1ZW5jeVwiLFwibG93RnJlcXVlbmN5XCJdKSx0aGlzLmxvdy5kaXNwb3NlKCksdGhpcy5sb3c9bnVsbCx0aGlzLl9sb3dNaWRGaWx0ZXIuZGlzcG9zZSgpLHRoaXMuX2xvd01pZEZpbHRlcj1udWxsLHRoaXMubWlkLmRpc3Bvc2UoKSx0aGlzLm1pZD1udWxsLHRoaXMuaGlnaC5kaXNwb3NlKCksdGhpcy5oaWdoPW51bGwsdGhpcy5sb3dGcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMubG93RnJlcXVlbmN5PW51bGwsdGhpcy5oaWdoRnJlcXVlbmN5LmRpc3Bvc2UoKSx0aGlzLmhpZ2hGcmVxdWVuY3k9bnVsbCx0aGlzLlEuZGlzcG9zZSgpLHRoaXMuUT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuTXVsdGliYW5kU3BsaXR9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDcpO3MuZGVmYXVsdC5Qb3c9ZnVuY3Rpb24odCl7cy5kZWZhdWx0LlNpZ25hbEJhc2UuY2FsbCh0aGlzKSx0aGlzLl9leHA9cy5kZWZhdWx0LmRlZmF1bHRBcmcodCwxKSx0aGlzLl9leHBTY2FsZXI9dGhpcy5pbnB1dD10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LldhdmVTaGFwZXIodGhpcy5fZXhwRnVuYyh0aGlzLl9leHApLDgxOTIpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Qb3cscy5kZWZhdWx0LlNpZ25hbEJhc2UpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUG93LnByb3RvdHlwZSxcInZhbHVlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9leHB9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9leHA9dCx0aGlzLl9leHBTY2FsZXIuc2V0TWFwKHRoaXMuX2V4cEZ1bmModGhpcy5fZXhwKSl9fSkscy5kZWZhdWx0LlBvdy5wcm90b3R5cGUuX2V4cEZ1bmM9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBNYXRoLnBvdyhNYXRoLmFicyhlKSx0KX19LHMuZGVmYXVsdC5Qb3cucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9leHBTY2FsZXIuZGlzcG9zZSgpLHRoaXMuX2V4cFNjYWxlcj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuUG93fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7cy5kZWZhdWx0LlRpbWVCYXNlPWZ1bmN0aW9uKHQsZSl7aWYoISh0aGlzIGluc3RhbmNlb2Ygcy5kZWZhdWx0LlRpbWVCYXNlKSlyZXR1cm4gbmV3IHMuZGVmYXVsdC5UaW1lQmFzZSh0LGUpO2lmKHRoaXMuX3ZhbD10LHRoaXMuX3VuaXRzPWUscy5kZWZhdWx0LmlzVW5kZWYodGhpcy5fdW5pdHMpJiZzLmRlZmF1bHQuaXNTdHJpbmcodGhpcy5fdmFsKSYmcGFyc2VGbG9hdCh0aGlzLl92YWwpPT10aGlzLl92YWwmJlwiK1wiIT09dGhpcy5fdmFsLmNoYXJBdCgwKSl0aGlzLl92YWw9cGFyc2VGbG9hdCh0aGlzLl92YWwpLHRoaXMuX3VuaXRzPXRoaXMuX2RlZmF1bHRVbml0cztlbHNlIGlmKHQmJnQuY29uc3RydWN0b3I9PT10aGlzLmNvbnN0cnVjdG9yKXRoaXMuX3ZhbD10Ll92YWwsdGhpcy5fdW5pdHM9dC5fdW5pdHM7ZWxzZSBpZih0IGluc3RhbmNlb2Ygcy5kZWZhdWx0LlRpbWVCYXNlKXN3aXRjaCh0aGlzLl9kZWZhdWx0VW5pdHMpe2Nhc2VcInNcIjp0aGlzLl92YWw9dC50b1NlY29uZHMoKTticmVhaztjYXNlXCJpXCI6dGhpcy5fdmFsPXQudG9UaWNrcygpO2JyZWFrO2Nhc2VcImh6XCI6dGhpcy5fdmFsPXQudG9GcmVxdWVuY3koKTticmVhaztjYXNlXCJtaWRpXCI6dGhpcy5fdmFsPXQudG9NaWRpKCk7YnJlYWs7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoXCJVbnJlY29nbml6ZWQgZGVmYXVsdCB1bml0cyBcIit0aGlzLl9kZWZhdWx0VW5pdHMpfX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuVGltZUJhc2UpLHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX2V4cHJlc3Npb25zPXtuOntyZWdleHA6L14oXFxkKyluKFxcLj8pJC9pLG1ldGhvZDpmdW5jdGlvbih0LGUpe3Q9cGFyc2VJbnQodCk7dmFyIGk9XCIuXCI9PT1lPzEuNToxO3JldHVybiAxPT09dD90aGlzLl9iZWF0c1RvVW5pdHModGhpcy5fZ2V0VGltZVNpZ25hdHVyZSgpKSppOnRoaXMuX2JlYXRzVG9Vbml0cyg0L3QpKml9fSx0OntyZWdleHA6L14oXFxkKyl0JC9pLG1ldGhvZDpmdW5jdGlvbih0KXtyZXR1cm4gdD1wYXJzZUludCh0KSx0aGlzLl9iZWF0c1RvVW5pdHMoOC8oMypwYXJzZUludCh0KSkpfX0sbTp7cmVnZXhwOi9eKFxcZCspbSQvaSxtZXRob2Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2JlYXRzVG9Vbml0cyhwYXJzZUludCh0KSp0aGlzLl9nZXRUaW1lU2lnbmF0dXJlKCkpfX0saTp7cmVnZXhwOi9eKFxcZCspaSQvaSxtZXRob2Q6ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3RpY2tzVG9Vbml0cyhwYXJzZUludCh0KSl9fSxoejp7cmVnZXhwOi9eKFxcZCsoPzpcXC5cXGQrKT8paHokL2ksbWV0aG9kOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9mcmVxdWVuY3lUb1VuaXRzKHBhcnNlRmxvYXQodCkpfX0sdHI6e3JlZ2V4cDovXihcXGQrKD86XFwuXFxkKyk/KTooXFxkKyg/OlxcLlxcZCspPyk6PyhcXGQrKD86XFwuXFxkKyk/KT8kLyxtZXRob2Q6ZnVuY3Rpb24odCxlLGkpe3ZhciBzPTA7cmV0dXJuIHQmJlwiMFwiIT09dCYmKHMrPXRoaXMuX2JlYXRzVG9Vbml0cyh0aGlzLl9nZXRUaW1lU2lnbmF0dXJlKCkqcGFyc2VGbG9hdCh0KSkpLGUmJlwiMFwiIT09ZSYmKHMrPXRoaXMuX2JlYXRzVG9Vbml0cyhwYXJzZUZsb2F0KGUpKSksaSYmXCIwXCIhPT1pJiYocys9dGhpcy5fYmVhdHNUb1VuaXRzKHBhcnNlRmxvYXQoaSkvNCkpLHN9fSxzOntyZWdleHA6L14oXFxkKyg/OlxcLlxcZCspPylzJC8sbWV0aG9kOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9zZWNvbmRzVG9Vbml0cyhwYXJzZUZsb2F0KHQpKX19LHNhbXBsZXM6e3JlZ2V4cDovXihcXGQrKXNhbXBsZXMkLyxtZXRob2Q6ZnVuY3Rpb24odCl7cmV0dXJuIHBhcnNlSW50KHQpL3RoaXMuY29udGV4dC5zYW1wbGVSYXRlfX0sZGVmYXVsdDp7cmVnZXhwOi9eKFxcZCsoPzpcXC5cXGQrKT8pJC8sbWV0aG9kOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9leHByZXNzaW9uc1t0aGlzLl9kZWZhdWx0VW5pdHNdLm1ldGhvZC5jYWxsKHRoaXMsdCl9fX0scy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5fZGVmYXVsdFVuaXRzPVwic1wiLHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX2dldEJwbT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuVHJhbnNwb3J0P3MuZGVmYXVsdC5UcmFuc3BvcnQuYnBtLnZhbHVlOjEyMH0scy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5fZ2V0VGltZVNpZ25hdHVyZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuVHJhbnNwb3J0P3MuZGVmYXVsdC5UcmFuc3BvcnQudGltZVNpZ25hdHVyZTo0fSxzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLl9nZXRQUFE9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlRyYW5zcG9ydD9zLmRlZmF1bHQuVHJhbnNwb3J0LlBQUToxOTJ9LHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX25vdz1mdW5jdGlvbigpe3JldHVybiB0aGlzLm5vdygpfSxzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLl9mcmVxdWVuY3lUb1VuaXRzPWZ1bmN0aW9uKHQpe3JldHVybiAxL3R9LHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX2JlYXRzVG9Vbml0cz1mdW5jdGlvbih0KXtyZXR1cm4gNjAvdGhpcy5fZ2V0QnBtKCkqdH0scy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5fc2Vjb25kc1RvVW5pdHM9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUuX3RpY2tzVG9Vbml0cz1mdW5jdGlvbih0KXtyZXR1cm4gdCoodGhpcy5fYmVhdHNUb1VuaXRzKDEpL3RoaXMuX2dldFBQUSgpKX0scy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5fbm9Bcmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbm93KCl9LHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUudmFsdWVPZj1mdW5jdGlvbigpe2lmKHMuZGVmYXVsdC5pc1VuZGVmKHRoaXMuX3ZhbCkpcmV0dXJuIHRoaXMuX25vQXJnKCk7aWYocy5kZWZhdWx0LmlzU3RyaW5nKHRoaXMuX3ZhbCkmJnMuZGVmYXVsdC5pc1VuZGVmKHRoaXMuX3VuaXRzKSl7Zm9yKHZhciB0IGluIHRoaXMuX2V4cHJlc3Npb25zKWlmKHRoaXMuX2V4cHJlc3Npb25zW3RdLnJlZ2V4cC50ZXN0KHRoaXMuX3ZhbC50cmltKCkpKXt0aGlzLl91bml0cz10O2JyZWFrfX1lbHNlIGlmKHMuZGVmYXVsdC5pc09iamVjdCh0aGlzLl92YWwpKXt2YXIgZT0wO2Zvcih2YXIgaSBpbiB0aGlzLl92YWwpe3ZhciBuPXRoaXMuX3ZhbFtpXTtlKz1uZXcgdGhpcy5jb25zdHJ1Y3RvcihpKS52YWx1ZU9mKCkqbn1yZXR1cm4gZX1pZihzLmRlZmF1bHQuaXNEZWZpbmVkKHRoaXMuX3VuaXRzKSl7dmFyIG89dGhpcy5fZXhwcmVzc2lvbnNbdGhpcy5fdW5pdHNdLGE9dGhpcy5fdmFsLnRvU3RyaW5nKCkudHJpbSgpLm1hdGNoKG8ucmVnZXhwKTtyZXR1cm4gYT9vLm1ldGhvZC5hcHBseSh0aGlzLGEuc2xpY2UoMSkpOm8ubWV0aG9kLmNhbGwodGhpcyxwYXJzZUZsb2F0KHRoaXMuX3ZhbCkpfXJldHVybiB0aGlzLl92YWx9LHMuZGVmYXVsdC5UaW1lQmFzZS5wcm90b3R5cGUudG9TZWNvbmRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWVPZigpfSxzLmRlZmF1bHQuVGltZUJhc2UucHJvdG90eXBlLnRvRnJlcXVlbmN5PWZ1bmN0aW9uKCl7cmV0dXJuIDEvdGhpcy50b1NlY29uZHMoKX0scy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS50b1NhbXBsZXM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b1NlY29uZHMoKSp0aGlzLmNvbnRleHQuc2FtcGxlUmF0ZX0scy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS50b01pbGxpc2Vjb25kcz1mdW5jdGlvbigpe3JldHVybiAxZTMqdGhpcy50b1NlY29uZHMoKX0scy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy5fdmFsPW51bGwsdGhpcy5fdW5pdHM9bnVsbH0sZS5kZWZhdWx0PXMuZGVmYXVsdC5UaW1lQmFzZX0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNjIpLGkoNDYpO3MuZGVmYXVsdC5UaW1lPWZ1bmN0aW9uKHQsZSl7aWYoISh0aGlzIGluc3RhbmNlb2Ygcy5kZWZhdWx0LlRpbWUpKXJldHVybiBuZXcgcy5kZWZhdWx0LlRpbWUodCxlKTtzLmRlZmF1bHQuVGltZUJhc2UuY2FsbCh0aGlzLHQsZSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlRpbWUscy5kZWZhdWx0LlRpbWVCYXNlKSxzLmRlZmF1bHQuVGltZS5wcm90b3R5cGUuX2V4cHJlc3Npb25zPU9iamVjdC5hc3NpZ24oe30scy5kZWZhdWx0LlRpbWVCYXNlLnByb3RvdHlwZS5fZXhwcmVzc2lvbnMse3F1YW50aXplOntyZWdleHA6L15AKC4rKS8sbWV0aG9kOmZ1bmN0aW9uKHQpe2lmKHMuZGVmYXVsdC5UcmFuc3BvcnQpe3ZhciBlPW5ldyB0aGlzLmNvbnN0cnVjdG9yKHQpO3JldHVybiB0aGlzLl9zZWNvbmRzVG9Vbml0cyhzLmRlZmF1bHQuVHJhbnNwb3J0Lm5leHRTdWJkaXZpc2lvbihlKSl9cmV0dXJuIDB9fSxub3c6e3JlZ2V4cDovXlxcKyguKykvLG1ldGhvZDpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbm93KCkrbmV3IHRoaXMuY29uc3RydWN0b3IodCl9fX0pLHMuZGVmYXVsdC5UaW1lLnByb3RvdHlwZS5xdWFudGl6ZT1mdW5jdGlvbih0LGUpe2U9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwxKTt2YXIgaT1uZXcgdGhpcy5jb25zdHJ1Y3Rvcih0KSxuPXRoaXMudmFsdWVPZigpO3JldHVybiBuKyhNYXRoLnJvdW5kKG4vaSkqaS1uKSplfSxzLmRlZmF1bHQuVGltZS5wcm90b3R5cGUudG9Ob3RhdGlvbj1mdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLnRvU2Vjb25kcygpLGU9W1wiMW1cIl0saT0xO2k8ODtpKyspe3ZhciBuPU1hdGgucG93KDIsaSk7ZS5wdXNoKG4rXCJuLlwiKSxlLnB1c2gobitcIm5cIiksZS5wdXNoKG4rXCJ0XCIpfWUucHVzaChcIjBcIik7dmFyIG89ZVswXSxhPXMuZGVmYXVsdC5UaW1lKGVbMF0pLnRvU2Vjb25kcygpO3JldHVybiBlLmZvckVhY2goZnVuY3Rpb24oZSl7dmFyIGk9cy5kZWZhdWx0LlRpbWUoZSkudG9TZWNvbmRzKCk7TWF0aC5hYnMoaS10KTxNYXRoLmFicyhhLXQpJiYobz1lLGE9aSl9KSxvfSxzLmRlZmF1bHQuVGltZS5wcm90b3R5cGUudG9CYXJzQmVhdHNTaXh0ZWVudGhzPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fYmVhdHNUb1VuaXRzKDEpLGU9dGhpcy52YWx1ZU9mKCkvdDtlPXBhcnNlRmxvYXQoZS50b0ZpeGVkKDQpKTt2YXIgaT1NYXRoLmZsb29yKGUvdGhpcy5fZ2V0VGltZVNpZ25hdHVyZSgpKSxzPWUlMSo0O3JldHVybiBlPU1hdGguZmxvb3IoZSkldGhpcy5fZ2V0VGltZVNpZ25hdHVyZSgpLChzPXMudG9TdHJpbmcoKSkubGVuZ3RoPjMmJihzPXBhcnNlRmxvYXQocGFyc2VGbG9hdChzKS50b0ZpeGVkKDMpKSksW2ksZSxzXS5qb2luKFwiOlwiKX0scy5kZWZhdWx0LlRpbWUucHJvdG90eXBlLnRvVGlja3M9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9iZWF0c1RvVW5pdHMoMSksZT10aGlzLnZhbHVlT2YoKS90O3JldHVybiBNYXRoLnJvdW5kKGUqdGhpcy5fZ2V0UFBRKCkpfSxzLmRlZmF1bHQuVGltZS5wcm90b3R5cGUudG9TZWNvbmRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWVPZigpfSxzLmRlZmF1bHQuVGltZS5wcm90b3R5cGUudG9NaWRpPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5GcmVxdWVuY3kuZnRvbSh0aGlzLnRvRnJlcXVlbmN5KCkpfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlRpbWV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDExKSxpKDYpLGkoNTcpLGkoMzIpO3MuZGVmYXVsdC5QbGF5ZXI9ZnVuY3Rpb24odCl7dmFyIGU7dCBpbnN0YW5jZW9mIHMuZGVmYXVsdC5CdWZmZXImJnQubG9hZGVkPyh0PXQuZ2V0KCksZT1zLmRlZmF1bHQuUGxheWVyLmRlZmF1bHRzKTplPXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1widXJsXCIsXCJvbmxvYWRcIl0scy5kZWZhdWx0LlBsYXllcikscy5kZWZhdWx0LlNvdXJjZS5jYWxsKHRoaXMsZSksdGhpcy5hdXRvc3RhcnQ9ZS5hdXRvc3RhcnQsdGhpcy5fYnVmZmVyPW5ldyBzLmRlZmF1bHQuQnVmZmVyKHt1cmw6ZS51cmwsb25sb2FkOnRoaXMuX29ubG9hZC5iaW5kKHRoaXMsZS5vbmxvYWQpLHJldmVyc2U6ZS5yZXZlcnNlfSksdCBpbnN0YW5jZW9mIEF1ZGlvQnVmZmVyJiZ0aGlzLl9idWZmZXIuc2V0KHQpLHRoaXMuX2xvb3A9ZS5sb29wLHRoaXMuX2xvb3BTdGFydD1lLmxvb3BTdGFydCx0aGlzLl9sb29wRW5kPWUubG9vcEVuZCx0aGlzLl9wbGF5YmFja1JhdGU9ZS5wbGF5YmFja1JhdGUsdGhpcy5fYWN0aXZlU291cmNlcz1bXSx0aGlzLmZhZGVJbj1lLmZhZGVJbix0aGlzLmZhZGVPdXQ9ZS5mYWRlT3V0fSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5QbGF5ZXIscy5kZWZhdWx0LlNvdXJjZSkscy5kZWZhdWx0LlBsYXllci5kZWZhdWx0cz17b25sb2FkOnMuZGVmYXVsdC5ub09wLHBsYXliYWNrUmF0ZToxLGxvb3A6ITEsYXV0b3N0YXJ0OiExLGxvb3BTdGFydDowLGxvb3BFbmQ6MCxyZXZlcnNlOiExLGZhZGVJbjowLGZhZGVPdXQ6MH0scy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUubG9hZD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9idWZmZXIubG9hZCh0LHRoaXMuX29ubG9hZC5iaW5kKHRoaXMsZSkpfSxzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZS5fb25sb2FkPWZ1bmN0aW9uKHQpeyh0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQscy5kZWZhdWx0Lm5vT3ApKSh0aGlzKSx0aGlzLmF1dG9zdGFydCYmdGhpcy5zdGFydCgpfSxzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZS5fb25Tb3VyY2VFbmQ9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fYWN0aXZlU291cmNlcy5pbmRleE9mKHQpO3RoaXMuX2FjdGl2ZVNvdXJjZXMuc3BsaWNlKGUsMSksMCE9PXRoaXMuX2FjdGl2ZVNvdXJjZXMubGVuZ3RofHx0aGlzLl9zeW5jZWR8fHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkLHMuZGVmYXVsdC5ub3coKSl9LHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLl9zdGFydD1mdW5jdGlvbih0LGUsaSl7ZT10aGlzLl9sb29wP3MuZGVmYXVsdC5kZWZhdWx0QXJnKGUsdGhpcy5fbG9vcFN0YXJ0KTpzLmRlZmF1bHQuZGVmYXVsdEFyZyhlLDApLGU9dGhpcy50b1NlY29uZHMoZSksdGhpcy5fc3luY2VkJiYoZSo9dGhpcy5fcGxheWJhY2tSYXRlKTt2YXIgbj1zLmRlZmF1bHQuZGVmYXVsdEFyZyhpLE1hdGgubWF4KHRoaXMuX2J1ZmZlci5kdXJhdGlvbi1lLDApKTtuPXRoaXMudG9TZWNvbmRzKG4pLG4vPXRoaXMuX3BsYXliYWNrUmF0ZSx0PXRoaXMudG9TZWNvbmRzKHQpO3ZhciBvPW5ldyBzLmRlZmF1bHQuQnVmZmVyU291cmNlKHtidWZmZXI6dGhpcy5fYnVmZmVyLGxvb3A6dGhpcy5fbG9vcCxsb29wU3RhcnQ6dGhpcy5fbG9vcFN0YXJ0LGxvb3BFbmQ6dGhpcy5fbG9vcEVuZCxvbmVuZGVkOnRoaXMuX29uU291cmNlRW5kLmJpbmQodGhpcykscGxheWJhY2tSYXRlOnRoaXMuX3BsYXliYWNrUmF0ZSxmYWRlSW46dGhpcy5mYWRlSW4sZmFkZU91dDp0aGlzLmZhZGVPdXR9KS5jb25uZWN0KHRoaXMub3V0cHV0KTtyZXR1cm4gdGhpcy5fbG9vcHx8dGhpcy5fc3luY2VkfHx0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCx0K24pLHRoaXMuX2FjdGl2ZVNvdXJjZXMucHVzaChvKSx0aGlzLl9sb29wJiZzLmRlZmF1bHQuaXNVbmRlZihpKT9vLnN0YXJ0KHQsZSk6by5zdGFydCh0LGUsbi10aGlzLnRvU2Vjb25kcyh0aGlzLmZhZGVPdXQpKSx0aGlzfSxzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZS5fc3RvcD1mdW5jdGlvbih0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5zdG9wKHQpfSksdGhpc30scy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUucmVzdGFydD1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIHRoaXMuX3N0b3AodCksdGhpcy5fc3RhcnQodCxlLGkpLHRoaXN9LHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLnNlZWs9ZnVuY3Rpb24odCxlKXtyZXR1cm4gZT10aGlzLnRvU2Vjb25kcyhlKSx0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZShlKT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkJiYodD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9zdG9wKGUpLHRoaXMuX3N0YXJ0KGUsdCkpLHRoaXN9LHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLnNldExvb3BQb2ludHM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5sb29wU3RhcnQ9dCx0aGlzLmxvb3BFbmQ9ZSx0aGlzfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUsXCJsb29wU3RhcnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xvb3BTdGFydH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2xvb3BTdGFydD10LHRoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbihlKXtlLmxvb3BTdGFydD10fSl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLFwibG9vcEVuZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbG9vcEVuZH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2xvb3BFbmQ9dCx0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5sb29wRW5kPXR9KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUsXCJidWZmZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlcn0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2J1ZmZlci5zZXQodCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QbGF5ZXIucHJvdG90eXBlLFwibG9vcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbG9vcH0sc2V0OmZ1bmN0aW9uKHQpe2lmKHRoaXMuX2xvb3AhPT10JiYodGhpcy5fbG9vcD10LHRoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbihlKXtlLmxvb3A9dH0pLHQpKXt2YXIgZT10aGlzLl9zdGF0ZS5nZXROZXh0U3RhdGUocy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQsdGhpcy5ub3coKSk7ZSYmdGhpcy5fc3RhdGUuY2FuY2VsKGUudGltZSl9fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZSxcInBsYXliYWNrUmF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGxheWJhY2tSYXRlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fcGxheWJhY2tSYXRlPXQ7dmFyIGU9dGhpcy5ub3coKSxpPXRoaXMuX3N0YXRlLmdldE5leHRTdGF0ZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCxlKTtpJiZ0aGlzLl9zdGF0ZS5jYW5jZWwoaS50aW1lKSx0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2goZnVuY3Rpb24oaSl7aS5jYW5jZWxTdG9wKCksaS5wbGF5YmFja1JhdGUuc2V0VmFsdWVBdFRpbWUodCxlKX0pfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGxheWVyLnByb3RvdHlwZSxcInJldmVyc2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5yZXZlcnNlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fYnVmZmVyLnJldmVyc2U9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUsXCJsb2FkZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlci5sb2FkZWR9fSkscy5kZWZhdWx0LlBsYXllci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2goZnVuY3Rpb24odCl7dC5kaXNwb3NlKCl9KSx0aGlzLl9hY3RpdmVTb3VyY2VzPW51bGwscy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX2J1ZmZlci5kaXNwb3NlKCksdGhpcy5fYnVmZmVyPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5QbGF5ZXJ9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDMxKSxpKDQxKSxpKDM3KSxpKDIpLGkoOSksaSgyNSk7cy5kZWZhdWx0Lk1vbm9TeW50aD1mdW5jdGlvbih0KXt0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQscy5kZWZhdWx0Lk1vbm9TeW50aC5kZWZhdWx0cykscy5kZWZhdWx0Lk1vbm9waG9uaWMuY2FsbCh0aGlzLHQpLHRoaXMub3NjaWxsYXRvcj1uZXcgcy5kZWZhdWx0Lk9tbmlPc2NpbGxhdG9yKHQub3NjaWxsYXRvciksdGhpcy5mcmVxdWVuY3k9dGhpcy5vc2NpbGxhdG9yLmZyZXF1ZW5jeSx0aGlzLmRldHVuZT10aGlzLm9zY2lsbGF0b3IuZGV0dW5lLHRoaXMuZmlsdGVyPW5ldyBzLmRlZmF1bHQuRmlsdGVyKHQuZmlsdGVyKSx0aGlzLmZpbHRlci5mcmVxdWVuY3kudmFsdWU9NWUzLHRoaXMuZmlsdGVyRW52ZWxvcGU9bmV3IHMuZGVmYXVsdC5GcmVxdWVuY3lFbnZlbG9wZSh0LmZpbHRlckVudmVsb3BlKSx0aGlzLmVudmVsb3BlPW5ldyBzLmRlZmF1bHQuQW1wbGl0dWRlRW52ZWxvcGUodC5lbnZlbG9wZSksdGhpcy5vc2NpbGxhdG9yLmNoYWluKHRoaXMuZmlsdGVyLHRoaXMuZW52ZWxvcGUsdGhpcy5vdXRwdXQpLHRoaXMuZmlsdGVyRW52ZWxvcGUuY29ubmVjdCh0aGlzLmZpbHRlci5mcmVxdWVuY3kpLHRoaXMuX3JlYWRPbmx5KFtcIm9zY2lsbGF0b3JcIixcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCIsXCJmaWx0ZXJcIixcImZpbHRlckVudmVsb3BlXCIsXCJlbnZlbG9wZVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk1vbm9TeW50aCxzLmRlZmF1bHQuTW9ub3Bob25pYykscy5kZWZhdWx0Lk1vbm9TeW50aC5kZWZhdWx0cz17ZnJlcXVlbmN5OlwiQzRcIixkZXR1bmU6MCxvc2NpbGxhdG9yOnt0eXBlOlwic3F1YXJlXCJ9LGZpbHRlcjp7UTo2LHR5cGU6XCJsb3dwYXNzXCIscm9sbG9mZjotMjR9LGVudmVsb3BlOnthdHRhY2s6LjAwNSxkZWNheTouMSxzdXN0YWluOi45LHJlbGVhc2U6MX0sZmlsdGVyRW52ZWxvcGU6e2F0dGFjazouMDYsZGVjYXk6LjIsc3VzdGFpbjouNSxyZWxlYXNlOjIsYmFzZUZyZXF1ZW5jeToyMDAsb2N0YXZlczo3LGV4cG9uZW50OjJ9fSxzLmRlZmF1bHQuTW9ub1N5bnRoLnByb3RvdHlwZS5fdHJpZ2dlckVudmVsb3BlQXR0YWNrPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5lbnZlbG9wZS50cmlnZ2VyQXR0YWNrKHQsZSksdGhpcy5maWx0ZXJFbnZlbG9wZS50cmlnZ2VyQXR0YWNrKHQpLHRoaXMub3NjaWxsYXRvci5zdGFydCh0KSwwPT09dGhpcy5lbnZlbG9wZS5zdXN0YWluJiZ0aGlzLm9zY2lsbGF0b3Iuc3RvcCh0K3RoaXMuZW52ZWxvcGUuYXR0YWNrK3RoaXMuZW52ZWxvcGUuZGVjYXkpLHRoaXN9LHMuZGVmYXVsdC5Nb25vU3ludGgucHJvdG90eXBlLl90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmVudmVsb3BlLnRyaWdnZXJSZWxlYXNlKHQpLHRoaXMuZmlsdGVyRW52ZWxvcGUudHJpZ2dlclJlbGVhc2UodCksdGhpcy5vc2NpbGxhdG9yLnN0b3AodCt0aGlzLmVudmVsb3BlLnJlbGVhc2UpLHRoaXN9LHMuZGVmYXVsdC5Nb25vU3ludGgucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0Lk1vbm9waG9uaWMucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJvc2NpbGxhdG9yXCIsXCJmcmVxdWVuY3lcIixcImRldHVuZVwiLFwiZmlsdGVyXCIsXCJmaWx0ZXJFbnZlbG9wZVwiLFwiZW52ZWxvcGVcIl0pLHRoaXMub3NjaWxsYXRvci5kaXNwb3NlKCksdGhpcy5vc2NpbGxhdG9yPW51bGwsdGhpcy5lbnZlbG9wZS5kaXNwb3NlKCksdGhpcy5lbnZlbG9wZT1udWxsLHRoaXMuZmlsdGVyRW52ZWxvcGUuZGlzcG9zZSgpLHRoaXMuZmlsdGVyRW52ZWxvcGU9bnVsbCx0aGlzLmZpbHRlci5kaXNwb3NlKCksdGhpcy5maWx0ZXI9bnVsbCx0aGlzLmZyZXF1ZW5jeT1udWxsLHRoaXMuZGV0dW5lPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5Nb25vU3ludGh9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDYpLGkoMTcpLGkoNSksaSgzKTtzLmRlZmF1bHQuRmF0T3NjaWxsYXRvcj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJ0eXBlXCIsXCJzcHJlYWRcIl0scy5kZWZhdWx0LkZhdE9zY2lsbGF0b3IpO3MuZGVmYXVsdC5Tb3VyY2UuY2FsbCh0aGlzLHQpLHRoaXMuZnJlcXVlbmN5PW5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZnJlcXVlbmN5LHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksdGhpcy5kZXR1bmU9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5kZXR1bmUscy5kZWZhdWx0LlR5cGUuQ2VudHMpLHRoaXMuX29zY2lsbGF0b3JzPVtdLHRoaXMuX3NwcmVhZD10LnNwcmVhZCx0aGlzLl90eXBlPXQudHlwZSx0aGlzLl9waGFzZT10LnBoYXNlLHRoaXMuX3BhcnRpYWxzPXQucGFydGlhbHMsdGhpcy5fcGFydGlhbENvdW50PXQucGFydGlhbENvdW50LHRoaXMuY291bnQ9dC5jb3VudCx0aGlzLl9yZWFkT25seShbXCJmcmVxdWVuY3lcIixcImRldHVuZVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkZhdE9zY2lsbGF0b3Iscy5kZWZhdWx0LlNvdXJjZSkscy5kZWZhdWx0LkZhdE9zY2lsbGF0b3IuZGVmYXVsdHM9e2ZyZXF1ZW5jeTo0NDAsZGV0dW5lOjAscGhhc2U6MCxzcHJlYWQ6MjAsY291bnQ6Myx0eXBlOlwic2F3dG9vdGhcIixwYXJ0aWFsczpbXSxwYXJ0aWFsQ291bnQ6MH0scy5kZWZhdWx0LkZhdE9zY2lsbGF0b3IucHJvdG90eXBlLl9zdGFydD1mdW5jdGlvbih0KXt0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX2ZvckVhY2goZnVuY3Rpb24oZSl7ZS5zdGFydCh0KX0pfSxzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUuX3N0b3A9ZnVuY3Rpb24odCl7dD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKGUpe2Uuc3RvcCh0KX0pfSxzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUucmVzdGFydD1mdW5jdGlvbih0KXt0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX2ZvckVhY2goZnVuY3Rpb24oZSl7ZS5yZXN0YXJ0KHQpfSl9LHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yLnByb3RvdHlwZS5fZm9yRWFjaD1mdW5jdGlvbih0KXtmb3IodmFyIGU9MDtlPHRoaXMuX29zY2lsbGF0b3JzLmxlbmd0aDtlKyspdC5jYWxsKHRoaXMsdGhpcy5fb3NjaWxsYXRvcnNbZV0sZSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUsXCJ0eXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fdHlwZT10LHRoaXMuX2ZvckVhY2goZnVuY3Rpb24oZSl7ZS50eXBlPXR9KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZhdE9zY2lsbGF0b3IucHJvdG90eXBlLFwic3ByZWFkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zcHJlYWR9LHNldDpmdW5jdGlvbih0KXtpZih0aGlzLl9zcHJlYWQ9dCx0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGg+MSl7dmFyIGU9LXQvMixpPXQvKHRoaXMuX29zY2lsbGF0b3JzLmxlbmd0aC0xKTt0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKHQscyl7dC5kZXR1bmUudmFsdWU9ZStpKnN9KX19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yLnByb3RvdHlwZSxcImNvdW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGh9LHNldDpmdW5jdGlvbih0KXtpZih0PU1hdGgubWF4KHQsMSksdGhpcy5fb3NjaWxsYXRvcnMubGVuZ3RoIT09dCl7dGhpcy5fZm9yRWFjaChmdW5jdGlvbih0KXt0LmRpc3Bvc2UoKX0pLHRoaXMuX29zY2lsbGF0b3JzPVtdO2Zvcih2YXIgZT0wO2U8dDtlKyspe3ZhciBpPW5ldyBzLmRlZmF1bHQuT3NjaWxsYXRvcjt0aGlzLnR5cGU9PT1zLmRlZmF1bHQuT3NjaWxsYXRvci5UeXBlLkN1c3RvbT9pLnBhcnRpYWxzPXRoaXMuX3BhcnRpYWxzOmkudHlwZT10aGlzLl90eXBlLGkucGFydGlhbENvdW50PXRoaXMuX3BhcnRpYWxDb3VudCxpLnBoYXNlPXRoaXMuX3BoYXNlK2UvdCozNjAsaS52b2x1bWUudmFsdWU9LTYtMS4xKnQsdGhpcy5mcmVxdWVuY3kuY29ubmVjdChpLmZyZXF1ZW5jeSksdGhpcy5kZXR1bmUuY29ubmVjdChpLmRldHVuZSksaS5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLl9vc2NpbGxhdG9yc1tlXT1pfXRoaXMuc3ByZWFkPXRoaXMuX3NwcmVhZCx0aGlzLnN0YXRlPT09cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQmJnRoaXMuX2ZvckVhY2goZnVuY3Rpb24odCl7dC5zdGFydCgpfSl9fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUsXCJwaGFzZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGhhc2V9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9waGFzZT10LHRoaXMuX2ZvckVhY2goZnVuY3Rpb24oZSl7ZS5waGFzZT10fSl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5GYXRPc2NpbGxhdG9yLnByb3RvdHlwZSxcImJhc2VUeXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yc1swXS5iYXNlVHlwZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2ZvckVhY2goZnVuY3Rpb24oZSl7ZS5iYXNlVHlwZT10fSksdGhpcy5fdHlwZT10aGlzLl9vc2NpbGxhdG9yc1swXS50eXBlfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRmF0T3NjaWxsYXRvci5wcm90b3R5cGUsXCJwYXJ0aWFsc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvcnNbMF0ucGFydGlhbHN9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9wYXJ0aWFscz10LHRoaXMuX3R5cGU9cy5kZWZhdWx0Lk9zY2lsbGF0b3IuVHlwZS5DdXN0b20sdGhpcy5fZm9yRWFjaChmdW5jdGlvbihlKXtlLnBhcnRpYWxzPXR9KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkZhdE9zY2lsbGF0b3IucHJvdG90eXBlLFwicGFydGlhbENvdW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vc2NpbGxhdG9yc1swXS5wYXJ0aWFsQ291bnR9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9wYXJ0aWFsQ291bnQ9dCx0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKGUpe2UucGFydGlhbENvdW50PXR9KSx0aGlzLl90eXBlPXRoaXMuX29zY2lsbGF0b3JzWzBdLnR5cGV9fSkscy5kZWZhdWx0LkZhdE9zY2lsbGF0b3IucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3dyaXRhYmxlKFtcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCJdKSx0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3k9bnVsbCx0aGlzLmRldHVuZS5kaXNwb3NlKCksdGhpcy5kZXR1bmU9bnVsbCx0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuZGlzcG9zZSgpfSksdGhpcy5fb3NjaWxsYXRvcnM9bnVsbCx0aGlzLl9wYXJ0aWFscz1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRmF0T3NjaWxsYXRvcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNiksaSgxNyksaSg1KSxpKDMpLGkoMjIpO3MuZGVmYXVsdC5BTU9zY2lsbGF0b3I9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiLFwibW9kdWxhdGlvblR5cGVcIl0scy5kZWZhdWx0LkFNT3NjaWxsYXRvcik7cy5kZWZhdWx0LlNvdXJjZS5jYWxsKHRoaXMsdCksdGhpcy5fY2Fycmllcj1uZXcgcy5kZWZhdWx0Lk9zY2lsbGF0b3IodC5mcmVxdWVuY3ksdC50eXBlKSx0aGlzLmZyZXF1ZW5jeT10aGlzLl9jYXJyaWVyLmZyZXF1ZW5jeSx0aGlzLmRldHVuZT10aGlzLl9jYXJyaWVyLmRldHVuZSx0aGlzLmRldHVuZS52YWx1ZT10LmRldHVuZSx0aGlzLl9tb2R1bGF0b3I9bmV3IHMuZGVmYXVsdC5Pc2NpbGxhdG9yKHQuZnJlcXVlbmN5LHQubW9kdWxhdGlvblR5cGUpLHRoaXMuX21vZHVsYXRpb25TY2FsZT1uZXcgcy5kZWZhdWx0LkF1ZGlvVG9HYWluLHRoaXMuaGFybW9uaWNpdHk9bmV3IHMuZGVmYXVsdC5NdWx0aXBseSh0Lmhhcm1vbmljaXR5KSx0aGlzLmhhcm1vbmljaXR5LnVuaXRzPXMuZGVmYXVsdC5UeXBlLlBvc2l0aXZlLHRoaXMuX21vZHVsYXRpb25Ob2RlPW5ldyBzLmRlZmF1bHQuR2FpbigwKSx0aGlzLmZyZXF1ZW5jeS5jaGFpbih0aGlzLmhhcm1vbmljaXR5LHRoaXMuX21vZHVsYXRvci5mcmVxdWVuY3kpLHRoaXMuZGV0dW5lLmNvbm5lY3QodGhpcy5fbW9kdWxhdG9yLmRldHVuZSksdGhpcy5fbW9kdWxhdG9yLmNoYWluKHRoaXMuX21vZHVsYXRpb25TY2FsZSx0aGlzLl9tb2R1bGF0aW9uTm9kZS5nYWluKSx0aGlzLl9jYXJyaWVyLmNoYWluKHRoaXMuX21vZHVsYXRpb25Ob2RlLHRoaXMub3V0cHV0KSx0aGlzLnBoYXNlPXQucGhhc2UsdGhpcy5fcmVhZE9ubHkoW1wiZnJlcXVlbmN5XCIsXCJkZXR1bmVcIixcImhhcm1vbmljaXR5XCJdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQU1Pc2NpbGxhdG9yLHMuZGVmYXVsdC5Pc2NpbGxhdG9yKSxzLmRlZmF1bHQuQU1Pc2NpbGxhdG9yLmRlZmF1bHRzPXtmcmVxdWVuY3k6NDQwLGRldHVuZTowLHBoYXNlOjAsdHlwZTpcInNpbmVcIixtb2R1bGF0aW9uVHlwZTpcInNxdWFyZVwiLGhhcm1vbmljaXR5OjF9LHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IucHJvdG90eXBlLl9zdGFydD1mdW5jdGlvbih0KXt0aGlzLl9tb2R1bGF0b3Iuc3RhcnQodCksdGhpcy5fY2Fycmllci5zdGFydCh0KX0scy5kZWZhdWx0LkFNT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0b3A9ZnVuY3Rpb24odCl7dGhpcy5fbW9kdWxhdG9yLnN0b3AodCksdGhpcy5fY2Fycmllci5zdG9wKHQpfSxzLmRlZmF1bHQuQU1Pc2NpbGxhdG9yLnByb3RvdHlwZS5yZXN0YXJ0PWZ1bmN0aW9uKHQpe3RoaXMuX21vZHVsYXRvci5yZXN0YXJ0KHQpLHRoaXMuX2NhcnJpZXIucmVzdGFydCh0KX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IucHJvdG90eXBlLFwidHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2Fycmllci50eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fY2Fycmllci50eXBlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IucHJvdG90eXBlLFwiYmFzZVR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NhcnJpZXIuYmFzZVR5cGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9jYXJyaWVyLmJhc2VUeXBlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IucHJvdG90eXBlLFwicGFydGlhbENvdW50XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9jYXJyaWVyLnBhcnRpYWxDb3VudH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2NhcnJpZXIucGFydGlhbENvdW50PXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BTU9zY2lsbGF0b3IucHJvdG90eXBlLFwibW9kdWxhdGlvblR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21vZHVsYXRvci50eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fbW9kdWxhdG9yLnR5cGU9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkFNT3NjaWxsYXRvci5wcm90b3R5cGUsXCJwaGFzZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2Fycmllci5waGFzZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2NhcnJpZXIucGhhc2U9dCx0aGlzLl9tb2R1bGF0b3IucGhhc2U9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkFNT3NjaWxsYXRvci5wcm90b3R5cGUsXCJwYXJ0aWFsc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY2Fycmllci5wYXJ0aWFsc30sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2NhcnJpZXIucGFydGlhbHM9dH19KSxzLmRlZmF1bHQuQU1Pc2NpbGxhdG9yLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJmcmVxdWVuY3lcIixcImRldHVuZVwiLFwiaGFybW9uaWNpdHlcIl0pLHRoaXMuZnJlcXVlbmN5PW51bGwsdGhpcy5kZXR1bmU9bnVsbCx0aGlzLmhhcm1vbmljaXR5LmRpc3Bvc2UoKSx0aGlzLmhhcm1vbmljaXR5PW51bGwsdGhpcy5fY2Fycmllci5kaXNwb3NlKCksdGhpcy5fY2Fycmllcj1udWxsLHRoaXMuX21vZHVsYXRvci5kaXNwb3NlKCksdGhpcy5fbW9kdWxhdG9yPW51bGwsdGhpcy5fbW9kdWxhdGlvbk5vZGUuZGlzcG9zZSgpLHRoaXMuX21vZHVsYXRpb25Ob2RlPW51bGwsdGhpcy5fbW9kdWxhdGlvblNjYWxlLmRpc3Bvc2UoKSx0aGlzLl9tb2R1bGF0aW9uU2NhbGU9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkFNT3NjaWxsYXRvcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNiksaSg1MCksaSgxNyksaSg1KTtzLmRlZmF1bHQuUFdNT3NjaWxsYXRvcj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJtb2R1bGF0aW9uRnJlcXVlbmN5XCJdLHMuZGVmYXVsdC5QV01Pc2NpbGxhdG9yKTtzLmRlZmF1bHQuU291cmNlLmNhbGwodGhpcyx0KSx0aGlzLl9wdWxzZT1uZXcgcy5kZWZhdWx0LlB1bHNlT3NjaWxsYXRvcih0Lm1vZHVsYXRpb25GcmVxdWVuY3kpLHRoaXMuX3B1bHNlLl9zYXd0b290aC50eXBlPVwic2luZVwiLHRoaXMuX21vZHVsYXRvcj1uZXcgcy5kZWZhdWx0Lk9zY2lsbGF0b3Ioe2ZyZXF1ZW5jeTp0LmZyZXF1ZW5jeSxkZXR1bmU6dC5kZXR1bmUscGhhc2U6dC5waGFzZX0pLHRoaXMuX3NjYWxlPW5ldyBzLmRlZmF1bHQuTXVsdGlwbHkoMiksdGhpcy5mcmVxdWVuY3k9dGhpcy5fbW9kdWxhdG9yLmZyZXF1ZW5jeSx0aGlzLmRldHVuZT10aGlzLl9tb2R1bGF0b3IuZGV0dW5lLHRoaXMubW9kdWxhdGlvbkZyZXF1ZW5jeT10aGlzLl9wdWxzZS5mcmVxdWVuY3ksdGhpcy5fbW9kdWxhdG9yLmNoYWluKHRoaXMuX3NjYWxlLHRoaXMuX3B1bHNlLndpZHRoKSx0aGlzLl9wdWxzZS5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLl9yZWFkT25seShbXCJtb2R1bGF0aW9uRnJlcXVlbmN5XCIsXCJmcmVxdWVuY3lcIixcImRldHVuZVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBXTU9zY2lsbGF0b3Iscy5kZWZhdWx0LlNvdXJjZSkscy5kZWZhdWx0LlBXTU9zY2lsbGF0b3IuZGVmYXVsdHM9e2ZyZXF1ZW5jeTo0NDAsZGV0dW5lOjAscGhhc2U6MCxtb2R1bGF0aW9uRnJlcXVlbmN5Oi40fSxzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0YXJ0PWZ1bmN0aW9uKHQpe3Q9dGhpcy50b1NlY29uZHModCksdGhpcy5fbW9kdWxhdG9yLnN0YXJ0KHQpLHRoaXMuX3B1bHNlLnN0YXJ0KHQpfSxzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5wcm90b3R5cGUuX3N0b3A9ZnVuY3Rpb24odCl7dD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9tb2R1bGF0b3Iuc3RvcCh0KSx0aGlzLl9wdWxzZS5zdG9wKHQpfSxzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5wcm90b3R5cGUucmVzdGFydD1mdW5jdGlvbih0KXt0aGlzLl9tb2R1bGF0b3IucmVzdGFydCh0KSx0aGlzLl9wdWxzZS5yZXN0YXJ0KHQpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBXTU9zY2lsbGF0b3IucHJvdG90eXBlLFwidHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm5cInB3bVwifX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5wcm90b3R5cGUsXCJiYXNlVHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm5cInB3bVwifX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUFdNT3NjaWxsYXRvci5wcm90b3R5cGUsXCJwYXJ0aWFsc1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm5bXX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBXTU9zY2lsbGF0b3IucHJvdG90eXBlLFwicGhhc2VcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX21vZHVsYXRvci5waGFzZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX21vZHVsYXRvci5waGFzZT10fX0pLHMuZGVmYXVsdC5QV01Pc2NpbGxhdG9yLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5Tb3VyY2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9wdWxzZS5kaXNwb3NlKCksdGhpcy5fcHVsc2U9bnVsbCx0aGlzLl9zY2FsZS5kaXNwb3NlKCksdGhpcy5fc2NhbGU9bnVsbCx0aGlzLl9tb2R1bGF0b3IuZGlzcG9zZSgpLHRoaXMuX21vZHVsYXRvcj1udWxsLHRoaXMuX3dyaXRhYmxlKFtcIm1vZHVsYXRpb25GcmVxdWVuY3lcIixcImZyZXF1ZW5jeVwiLFwiZGV0dW5lXCJdKSx0aGlzLmZyZXF1ZW5jeT1udWxsLHRoaXMuZGV0dW5lPW51bGwsdGhpcy5tb2R1bGF0aW9uRnJlcXVlbmN5PW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5QV01Pc2NpbGxhdG9yfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg1MSksaSg0KSxpKDE2KTtzLmRlZmF1bHQuUGFydD1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiY2FsbGJhY2tcIixcImV2ZW50c1wiXSxzLmRlZmF1bHQuUGFydCk7cy5kZWZhdWx0LkV2ZW50LmNhbGwodGhpcyx0KSx0aGlzLl9ldmVudHM9W107Zm9yKHZhciBlPTA7ZTx0LmV2ZW50cy5sZW5ndGg7ZSsrKUFycmF5LmlzQXJyYXkodC5ldmVudHNbZV0pP3RoaXMuYWRkKHQuZXZlbnRzW2VdWzBdLHQuZXZlbnRzW2VdWzFdKTp0aGlzLmFkZCh0LmV2ZW50c1tlXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBhcnQscy5kZWZhdWx0LkV2ZW50KSxzLmRlZmF1bHQuUGFydC5kZWZhdWx0cz17Y2FsbGJhY2s6cy5kZWZhdWx0Lm5vT3AsbG9vcDohMSxsb29wRW5kOlwiMW1cIixsb29wU3RhcnQ6MCxwbGF5YmFja1JhdGU6MSxwcm9iYWJpbGl0eToxLGh1bWFuaXplOiExLG11dGU6ITEsZXZlbnRzOltdfSxzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuc3RhcnQ9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLnRvVGlja3ModCk7cmV0dXJuIHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKGkpIT09cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQmJihlPXRoaXMuX2xvb3A/cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSx0aGlzLl9sb29wU3RhcnQpOnMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsMCksZT10aGlzLnRvVGlja3MoZSksdGhpcy5fc3RhdGUuYWRkKHtzdGF0ZTpzLmRlZmF1bHQuU3RhdGUuU3RhcnRlZCx0aW1lOmksb2Zmc2V0OmV9KSx0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKHQpe3RoaXMuX3N0YXJ0Tm90ZSh0LGksZSl9KSksdGhpc30scy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLl9zdGFydE5vdGU9ZnVuY3Rpb24odCxlLGkpe2UtPWksdGhpcy5fbG9vcD90LnN0YXJ0T2Zmc2V0Pj10aGlzLl9sb29wU3RhcnQmJnQuc3RhcnRPZmZzZXQ8dGhpcy5fbG9vcEVuZD8odC5zdGFydE9mZnNldDxpJiYoZSs9dGhpcy5fZ2V0TG9vcER1cmF0aW9uKCkpLHQuc3RhcnQocy5kZWZhdWx0LlRpY2tzKGUpKSk6dC5zdGFydE9mZnNldDx0aGlzLl9sb29wU3RhcnQmJnQuc3RhcnRPZmZzZXQ+PWkmJih0Lmxvb3A9ITEsdC5zdGFydChzLmRlZmF1bHQuVGlja3MoZSkpKTp0LnN0YXJ0T2Zmc2V0Pj1pJiZ0LnN0YXJ0KHMuZGVmYXVsdC5UaWNrcyhlKSl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUsXCJzdGFydE9mZnNldFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhcnRPZmZzZXR9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zdGFydE9mZnNldD10LHRoaXMuX2ZvckVhY2goZnVuY3Rpb24odCl7dC5zdGFydE9mZnNldCs9dGhpcy5fc3RhcnRPZmZzZXR9KX19KSxzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbih0KXt2YXIgZT10aGlzLnRvVGlja3ModCk7cmV0dXJuIHRoaXMuX3N0YXRlLmNhbmNlbChlKSx0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCxlKSx0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKGUpe2Uuc3RvcCh0KX0pLHRoaXN9LHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5hdD1mdW5jdGlvbih0LGUpe3Q9cy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUodCk7Zm9yKHZhciBpPXMuZGVmYXVsdC5UaWNrcygxKS50b1NlY29uZHMoKSxuPTA7bjx0aGlzLl9ldmVudHMubGVuZ3RoO24rKyl7dmFyIG89dGhpcy5fZXZlbnRzW25dO2lmKE1hdGguYWJzKHQudG9UaWNrcygpLW8uc3RhcnRPZmZzZXQpPGkpcmV0dXJuIHMuZGVmYXVsdC5pc0RlZmluZWQoZSkmJihvLnZhbHVlPWUpLG99cmV0dXJuIHMuZGVmYXVsdC5pc0RlZmluZWQoZSk/KHRoaXMuYWRkKHQsZSksdGhpcy5fZXZlbnRzW3RoaXMuX2V2ZW50cy5sZW5ndGgtMV0pOm51bGx9LHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCxlKXt2YXIgaTtyZXR1cm4gdC5oYXNPd25Qcm9wZXJ0eShcInRpbWVcIikmJih0PShlPXQpLnRpbWUpLHQ9dGhpcy50b1RpY2tzKHQpLGUgaW5zdGFuY2VvZiBzLmRlZmF1bHQuRXZlbnQ/KGk9ZSkuY2FsbGJhY2s9dGhpcy5fdGljay5iaW5kKHRoaXMpOmk9bmV3IHMuZGVmYXVsdC5FdmVudCh7Y2FsbGJhY2s6dGhpcy5fdGljay5iaW5kKHRoaXMpLHZhbHVlOmV9KSxpLnN0YXJ0T2Zmc2V0PXQsaS5zZXQoe2xvb3BFbmQ6dGhpcy5sb29wRW5kLGxvb3BTdGFydDp0aGlzLmxvb3BTdGFydCxsb29wOnRoaXMubG9vcCxodW1hbml6ZTp0aGlzLmh1bWFuaXplLHBsYXliYWNrUmF0ZTp0aGlzLnBsYXliYWNrUmF0ZSxwcm9iYWJpbGl0eTp0aGlzLnByb2JhYmlsaXR5fSksdGhpcy5fZXZlbnRzLnB1c2goaSksdGhpcy5fcmVzdGFydEV2ZW50KGkpLHRoaXN9LHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5fcmVzdGFydEV2ZW50PWZ1bmN0aW9uKHQpe3RoaXMuX3N0YXRlLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5zdGF0ZT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkP3RoaXMuX3N0YXJ0Tm90ZSh0LGUudGltZSxlLm9mZnNldCk6dC5zdG9wKHMuZGVmYXVsdC5UaWNrcyhlLnRpbWUpKX0uYmluZCh0aGlzKSl9LHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24odCxlKXt0Lmhhc093blByb3BlcnR5KFwidGltZVwiKSYmKHQ9KGU9dCkudGltZSksdD10aGlzLnRvVGlja3ModCk7Zm9yKHZhciBpPXRoaXMuX2V2ZW50cy5sZW5ndGgtMTtpPj0wO2ktLSl7dmFyIG49dGhpcy5fZXZlbnRzW2ldO24uc3RhcnRPZmZzZXQ9PT10JiYocy5kZWZhdWx0LmlzVW5kZWYoZSl8fHMuZGVmYXVsdC5pc0RlZmluZWQoZSkmJm4udmFsdWU9PT1lKSYmKHRoaXMuX2V2ZW50cy5zcGxpY2UoaSwxKSxuLmRpc3Bvc2UoKSl9cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5yZW1vdmVBbGw9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZm9yRWFjaChmdW5jdGlvbih0KXt0LmRpc3Bvc2UoKX0pLHRoaXMuX2V2ZW50cz1bXSx0aGlzfSxzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKGUpe2UuY2FuY2VsKHQpfSksdGhpcy5fc3RhdGUuY2FuY2VsKHRoaXMudG9UaWNrcyh0KSksdGhpc30scy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLl9mb3JFYWNoPWZ1bmN0aW9uKHQsZSl7aWYodGhpcy5fZXZlbnRzKXtlPXMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsdGhpcyk7Zm9yKHZhciBpPXRoaXMuX2V2ZW50cy5sZW5ndGgtMTtpPj0wO2ktLSl7dmFyIG49dGhpcy5fZXZlbnRzW2ldO24gaW5zdGFuY2VvZiBzLmRlZmF1bHQuUGFydD9uLl9mb3JFYWNoKHQsZSk6dC5jYWxsKGUsbil9fXJldHVybiB0aGlzfSxzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuX3NldEFsbD1mdW5jdGlvbih0LGUpe3RoaXMuX2ZvckVhY2goZnVuY3Rpb24oaSl7aVt0XT1lfSl9LHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5fdGljaz1mdW5jdGlvbih0LGUpe3RoaXMubXV0ZXx8dGhpcy5jYWxsYmFjayh0LGUpfSxzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuX3Rlc3RMb29wQm91bmRyaWVzPWZ1bmN0aW9uKHQpe3RoaXMuX2xvb3AmJih0LnN0YXJ0T2Zmc2V0PHRoaXMuX2xvb3BTdGFydHx8dC5zdGFydE9mZnNldD49dGhpcy5fbG9vcEVuZCk/dC5jYW5jZWwoMCk6dC5zdGF0ZT09PXMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkJiZ0aGlzLl9yZXN0YXJ0RXZlbnQodCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUsXCJwcm9iYWJpbGl0eVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcHJvYmFiaWxpdHl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9wcm9iYWJpbGl0eT10LHRoaXMuX3NldEFsbChcInByb2JhYmlsaXR5XCIsdCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZSxcImh1bWFuaXplXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9odW1hbml6ZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2h1bWFuaXplPXQsdGhpcy5fc2V0QWxsKFwiaHVtYW5pemVcIix0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLFwibG9vcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbG9vcH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2xvb3A9dCx0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKGUpe2UuX2xvb3BTdGFydD10aGlzLl9sb29wU3RhcnQsZS5fbG9vcEVuZD10aGlzLl9sb29wRW5kLGUubG9vcD10LHRoaXMuX3Rlc3RMb29wQm91bmRyaWVzKGUpfSl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZSxcImxvb3BFbmRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5UaWNrcyh0aGlzLl9sb29wRW5kKS50b1NlY29uZHMoKX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2xvb3BFbmQ9dGhpcy50b1RpY2tzKHQpLHRoaXMuX2xvb3AmJnRoaXMuX2ZvckVhY2goZnVuY3Rpb24oZSl7ZS5sb29wRW5kPXQsdGhpcy5fdGVzdExvb3BCb3VuZHJpZXMoZSl9KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLFwibG9vcFN0YXJ0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuVGlja3ModGhpcy5fbG9vcFN0YXJ0KS50b1NlY29uZHMoKX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2xvb3BTdGFydD10aGlzLnRvVGlja3ModCksdGhpcy5fbG9vcCYmdGhpcy5fZm9yRWFjaChmdW5jdGlvbih0KXt0Lmxvb3BTdGFydD10aGlzLmxvb3BTdGFydCx0aGlzLl90ZXN0TG9vcEJvdW5kcmllcyh0KX0pfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUsXCJwbGF5YmFja1JhdGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3BsYXliYWNrUmF0ZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3BsYXliYWNrUmF0ZT10LHRoaXMuX3NldEFsbChcInBsYXliYWNrUmF0ZVwiLHQpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUsXCJsZW5ndGhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2V2ZW50cy5sZW5ndGh9fSkscy5kZWZhdWx0LlBhcnQucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkV2ZW50LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5yZW1vdmVBbGwoKSx0aGlzLmNhbGxiYWNrPW51bGwsdGhpcy5fZXZlbnRzPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5QYXJ0fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg1MSk7cy5kZWZhdWx0Lkxvb3A9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImNhbGxiYWNrXCIsXCJpbnRlcnZhbFwiXSxzLmRlZmF1bHQuTG9vcCk7cy5kZWZhdWx0LmNhbGwodGhpcyksdGhpcy5fZXZlbnQ9bmV3IHMuZGVmYXVsdC5FdmVudCh7Y2FsbGJhY2s6dGhpcy5fdGljay5iaW5kKHRoaXMpLGxvb3A6ITAsbG9vcEVuZDp0LmludGVydmFsLHBsYXliYWNrUmF0ZTp0LnBsYXliYWNrUmF0ZSxwcm9iYWJpbGl0eTp0LnByb2JhYmlsaXR5fSksdGhpcy5jYWxsYmFjaz10LmNhbGxiYWNrLHRoaXMuaXRlcmF0aW9ucz10Lml0ZXJhdGlvbnN9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lkxvb3ApLHMuZGVmYXVsdC5Mb29wLmRlZmF1bHRzPXtpbnRlcnZhbDpcIjRuXCIsY2FsbGJhY2s6cy5kZWZhdWx0Lm5vT3AscGxheWJhY2tSYXRlOjEsaXRlcmF0aW9uczoxLzAscHJvYmFiaWxpdHk6ITAsbXV0ZTohMX0scy5kZWZhdWx0Lkxvb3AucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9ldmVudC5zdGFydCh0KSx0aGlzfSxzLmRlZmF1bHQuTG9vcC5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fZXZlbnQuc3RvcCh0KSx0aGlzfSxzLmRlZmF1bHQuTG9vcC5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9ldmVudC5jYW5jZWwodCksdGhpc30scy5kZWZhdWx0Lkxvb3AucHJvdG90eXBlLl90aWNrPWZ1bmN0aW9uKHQpe3RoaXMuY2FsbGJhY2sodCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTG9vcC5wcm90b3R5cGUsXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZXZlbnQuc3RhdGV9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZSxcInByb2dyZXNzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ldmVudC5wcm9ncmVzc319KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lkxvb3AucHJvdG90eXBlLFwiaW50ZXJ2YWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2V2ZW50Lmxvb3BFbmR9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9ldmVudC5sb29wRW5kPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZSxcInBsYXliYWNrUmF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZXZlbnQucGxheWJhY2tSYXRlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fZXZlbnQucGxheWJhY2tSYXRlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZSxcImh1bWFuaXplXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ldmVudC5odW1hbml6ZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2V2ZW50Lmh1bWFuaXplPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZSxcInByb2JhYmlsaXR5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9ldmVudC5wcm9iYWJpbGl0eX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2V2ZW50LnByb2JhYmlsaXR5PXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZSxcIm11dGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2V2ZW50Lm11dGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9ldmVudC5tdXRlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZSxcIml0ZXJhdGlvbnNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuITA9PT10aGlzLl9ldmVudC5sb29wPzEvMDp0aGlzLl9ldmVudC5sb29wfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fZXZlbnQubG9vcD10PT09MS8wfHx0fX0pLHMuZGVmYXVsdC5Mb29wLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy5fZXZlbnQuZGlzcG9zZSgpLHRoaXMuX2V2ZW50PW51bGwsdGhpcy5jYWxsYmFjaz1udWxsfSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lkxvb3B9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDE1KSxpKDMzKTtzLmRlZmF1bHQuU3RlcmVvWEZlZWRiYWNrRWZmZWN0PWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJmZWVkYmFja1wiXSxzLmRlZmF1bHQuRmVlZGJhY2tFZmZlY3QpO3MuZGVmYXVsdC5TdGVyZW9FZmZlY3QuY2FsbCh0aGlzLHQpLHRoaXMuZmVlZGJhY2s9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5mZWVkYmFjayxzLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSksdGhpcy5fZmVlZGJhY2tMUj1uZXcgcy5kZWZhdWx0LkdhaW4sdGhpcy5fZmVlZGJhY2tSTD1uZXcgcy5kZWZhdWx0LkdhaW4sdGhpcy5lZmZlY3RSZXR1cm5MLmNoYWluKHRoaXMuX2ZlZWRiYWNrTFIsdGhpcy5lZmZlY3RTZW5kUiksdGhpcy5lZmZlY3RSZXR1cm5SLmNoYWluKHRoaXMuX2ZlZWRiYWNrUkwsdGhpcy5lZmZlY3RTZW5kTCksdGhpcy5mZWVkYmFjay5mYW4odGhpcy5fZmVlZGJhY2tMUi5nYWluLHRoaXMuX2ZlZWRiYWNrUkwuZ2FpbiksdGhpcy5fcmVhZE9ubHkoW1wiZmVlZGJhY2tcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TdGVyZW9YRmVlZGJhY2tFZmZlY3Qscy5kZWZhdWx0LlN0ZXJlb0VmZmVjdCkscy5kZWZhdWx0LlN0ZXJlb1hGZWVkYmFja0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoW1wiZmVlZGJhY2tcIl0pLHRoaXMuZmVlZGJhY2suZGlzcG9zZSgpLHRoaXMuZmVlZGJhY2s9bnVsbCx0aGlzLl9mZWVkYmFja0xSLmRpc3Bvc2UoKSx0aGlzLl9mZWVkYmFja0xSPW51bGwsdGhpcy5fZmVlZGJhY2tSTC5kaXNwb3NlKCksdGhpcy5fZmVlZGJhY2tSTD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuU3RlcmVvWEZlZWRiYWNrRWZmZWN0fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg4KSxpKDUzKSxpKDUyKTtzLmRlZmF1bHQuTWlkU2lkZUVmZmVjdD1mdW5jdGlvbigpe3MuZGVmYXVsdC5FZmZlY3QuYXBwbHkodGhpcyxhcmd1bWVudHMpLHRoaXMuX21pZFNpZGVTcGxpdD1uZXcgcy5kZWZhdWx0Lk1pZFNpZGVTcGxpdCx0aGlzLl9taWRTaWRlTWVyZ2U9bmV3IHMuZGVmYXVsdC5NaWRTaWRlTWVyZ2UsdGhpcy5taWRTZW5kPXRoaXMuX21pZFNpZGVTcGxpdC5taWQsdGhpcy5zaWRlU2VuZD10aGlzLl9taWRTaWRlU3BsaXQuc2lkZSx0aGlzLm1pZFJldHVybj10aGlzLl9taWRTaWRlTWVyZ2UubWlkLHRoaXMuc2lkZVJldHVybj10aGlzLl9taWRTaWRlTWVyZ2Uuc2lkZSx0aGlzLmVmZmVjdFNlbmQuY29ubmVjdCh0aGlzLl9taWRTaWRlU3BsaXQpLHRoaXMuX21pZFNpZGVNZXJnZS5jb25uZWN0KHRoaXMuZWZmZWN0UmV0dXJuKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTWlkU2lkZUVmZmVjdCxzLmRlZmF1bHQuRWZmZWN0KSxzLmRlZmF1bHQuTWlkU2lkZUVmZmVjdC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fbWlkU2lkZVNwbGl0LmRpc3Bvc2UoKSx0aGlzLl9taWRTaWRlU3BsaXQ9bnVsbCx0aGlzLl9taWRTaWRlTWVyZ2UuZGlzcG9zZSgpLHRoaXMuX21pZFNpZGVNZXJnZT1udWxsLHRoaXMubWlkU2VuZD1udWxsLHRoaXMuc2lkZVNlbmQ9bnVsbCx0aGlzLm1pZFJldHVybj1udWxsLHRoaXMuc2lkZVJldHVybj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuTWlkU2lkZUVmZmVjdH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTEpLGkoOCk7cy5kZWZhdWx0LkNvbnZvbHZlcj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1widXJsXCIsXCJvbmxvYWRcIl0scy5kZWZhdWx0LkNvbnZvbHZlcik7cy5kZWZhdWx0LkVmZmVjdC5jYWxsKHRoaXMsdCksdGhpcy5fY29udm9sdmVyPXRoaXMuY29udGV4dC5jcmVhdGVDb252b2x2ZXIoKSx0aGlzLl9idWZmZXI9bmV3IHMuZGVmYXVsdC5CdWZmZXIodC51cmwsZnVuY3Rpb24oZSl7dGhpcy5idWZmZXI9ZS5nZXQoKSx0Lm9ubG9hZCgpfS5iaW5kKHRoaXMpKSx0aGlzLl9idWZmZXIubG9hZGVkJiYodGhpcy5idWZmZXI9dGhpcy5fYnVmZmVyKSx0aGlzLm5vcm1hbGl6ZT10Lm5vcm1hbGl6ZSx0aGlzLmNvbm5lY3RFZmZlY3QodGhpcy5fY29udm9sdmVyKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ29udm9sdmVyLHMuZGVmYXVsdC5FZmZlY3QpLHMuZGVmYXVsdC5Db252b2x2ZXIuZGVmYXVsdHM9e29ubG9hZDpzLmRlZmF1bHQubm9PcCxub3JtYWxpemU6ITB9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ29udm9sdmVyLnByb3RvdHlwZSxcImJ1ZmZlclwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYnVmZmVyLmxlbmd0aD90aGlzLl9idWZmZXI6bnVsbH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2J1ZmZlci5zZXQodCksdGhpcy5fY29udm9sdmVyLmJ1ZmZlciYmKHRoaXMuZWZmZWN0U2VuZC5kaXNjb25uZWN0KCksdGhpcy5fY29udm9sdmVyLmRpc2Nvbm5lY3QoKSx0aGlzLl9jb252b2x2ZXI9dGhpcy5jb250ZXh0LmNyZWF0ZUNvbnZvbHZlcigpLHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLl9jb252b2x2ZXIpKSx0aGlzLl9jb252b2x2ZXIuYnVmZmVyPXRoaXMuX2J1ZmZlci5nZXQoKX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNvbnZvbHZlci5wcm90b3R5cGUsXCJub3JtYWxpemVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2NvbnZvbHZlci5ub3JtYWxpemV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9jb252b2x2ZXIubm9ybWFsaXplPXR9fSkscy5kZWZhdWx0LkNvbnZvbHZlci5wcm90b3R5cGUubG9hZD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl9idWZmZXIubG9hZCh0LGZ1bmN0aW9uKHQpe3RoaXMuYnVmZmVyPXQsZSYmZSgpfS5iaW5kKHRoaXMpKX0scy5kZWZhdWx0LkNvbnZvbHZlci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fYnVmZmVyLmRpc3Bvc2UoKSx0aGlzLl9idWZmZXI9bnVsbCx0aGlzLl9jb252b2x2ZXIuZGlzY29ubmVjdCgpLHRoaXMuX2NvbnZvbHZlcj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuQ29udm9sdmVyfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg3KSxpKDUpLGkoMTMpO3MuZGVmYXVsdC5Nb2R1bG89ZnVuY3Rpb24odCl7cy5kZWZhdWx0LlNpZ25hbEJhc2UuY2FsbCh0aGlzKSx0aGlzLmNyZWF0ZUluc091dHMoMSwwKSx0aGlzLl9zaGFwZXI9bmV3IHMuZGVmYXVsdC5XYXZlU2hhcGVyKE1hdGgucG93KDIsMTYpKSx0aGlzLl9tdWx0aXBseT1uZXcgcy5kZWZhdWx0Lk11bHRpcGx5LHRoaXMuX3N1YnRyYWN0PXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuU3VidHJhY3QsdGhpcy5fbW9kU2lnbmFsPW5ldyBzLmRlZmF1bHQuU2lnbmFsKHQpLHMuZGVmYXVsdC5jb25uZWN0KHRoaXMuaW5wdXQsdGhpcy5fc2hhcGVyKSxzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LHRoaXMuX3N1YnRyYWN0KSx0aGlzLl9tb2RTaWduYWwuY29ubmVjdCh0aGlzLl9tdWx0aXBseSwwLDApLHRoaXMuX3NoYXBlci5jb25uZWN0KHRoaXMuX211bHRpcGx5LDAsMSksdGhpcy5fbXVsdGlwbHkuY29ubmVjdCh0aGlzLl9zdWJ0cmFjdCwwLDEpLHRoaXMuX3NldFdhdmVTaGFwZXIodCl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk1vZHVsbyxzLmRlZmF1bHQuU2lnbmFsQmFzZSkscy5kZWZhdWx0Lk1vZHVsby5wcm90b3R5cGUuX3NldFdhdmVTaGFwZXI9ZnVuY3Rpb24odCl7dGhpcy5fc2hhcGVyLnNldE1hcChmdW5jdGlvbihlKXtyZXR1cm4gTWF0aC5mbG9vcigoZSsxZS00KS90KX0pfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk1vZHVsby5wcm90b3R5cGUsXCJ2YWx1ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbW9kU2lnbmFsLnZhbHVlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fbW9kU2lnbmFsLnZhbHVlPXQsdGhpcy5fc2V0V2F2ZVNoYXBlcih0KX19KSxzLmRlZmF1bHQuTW9kdWxvLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fc2hhcGVyLmRpc3Bvc2UoKSx0aGlzLl9zaGFwZXI9bnVsbCx0aGlzLl9tdWx0aXBseS5kaXNwb3NlKCksdGhpcy5fbXVsdGlwbHk9bnVsbCx0aGlzLl9zdWJ0cmFjdC5kaXNwb3NlKCksdGhpcy5fc3VidHJhY3Q9bnVsbCx0aGlzLl9tb2RTaWduYWwuZGlzcG9zZSgpLHRoaXMuX21vZFNpZ25hbD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuTW9kdWxvfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyMCksaSg5Mik7cy5kZWZhdWx0Lk9mZmxpbmVDb250ZXh0PWZ1bmN0aW9uKHQsZSxpKXt2YXIgbj1uZXcgT2ZmbGluZUF1ZGlvQ29udGV4dCh0LGUqaSxpKTtzLmRlZmF1bHQuQ29udGV4dC5jYWxsKHRoaXMse2NvbnRleHQ6bixjbG9ja1NvdXJjZTpcIm9mZmxpbmVcIixsb29rQWhlYWQ6MCx1cGRhdGVJbnRlcnZhbDoxMjgvaX0pLHRoaXMuX2R1cmF0aW9uPWUsdGhpcy5fY3VycmVudFRpbWU9MH0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuT2ZmbGluZUNvbnRleHQscy5kZWZhdWx0LkNvbnRleHQpLHMuZGVmYXVsdC5PZmZsaW5lQ29udGV4dC5wcm90b3R5cGUubm93PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2N1cnJlbnRUaW1lfSxzLmRlZmF1bHQuT2ZmbGluZUNvbnRleHQucHJvdG90eXBlLnJlc3VtZT1mdW5jdGlvbigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX0scy5kZWZhdWx0Lk9mZmxpbmVDb250ZXh0LnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtmb3IoO3RoaXMuX2R1cmF0aW9uLXRoaXMuX2N1cnJlbnRUaW1lPj0wOyl0aGlzLmVtaXQoXCJ0aWNrXCIpLHRoaXMuX2N1cnJlbnRUaW1lKz0uMDA1O3JldHVybiB0aGlzLl9jb250ZXh0LnN0YXJ0UmVuZGVyaW5nKCl9LHMuZGVmYXVsdC5PZmZsaW5lQ29udGV4dC5wcm90b3R5cGUuY2xvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fY29udGV4dD1udWxsLFByb21pc2UucmVzb2x2ZSgpfSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lk9mZmxpbmVDb250ZXh0fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgxNiksaSgxMSksaSg3NSksaSg0MCk7cy5kZWZhdWx0Lk9mZmxpbmU9ZnVuY3Rpb24odCxlKXt2YXIgaT1zLmRlZmF1bHQuY29udGV4dC5zYW1wbGVSYXRlLG49cy5kZWZhdWx0LmNvbnRleHQsbz1uZXcgcy5kZWZhdWx0Lk9mZmxpbmVDb250ZXh0KDIsZSxpKTtzLmRlZmF1bHQuY29udGV4dD1vO3ZhciBhPXQocy5kZWZhdWx0LlRyYW5zcG9ydCkscj1udWxsO3JldHVybiByPWEmJnMuZGVmYXVsdC5pc0Z1bmN0aW9uKGEudGhlbik/YS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIG8ucmVuZGVyKCl9KTpvLnJlbmRlcigpLHMuZGVmYXVsdC5jb250ZXh0PW4sci50aGVuKGZ1bmN0aW9uKHQpe3JldHVybiBuZXcgcy5kZWZhdWx0LkJ1ZmZlcih0KX0pfSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lk9mZmxpbmV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDExKTtzLmRlZmF1bHQuQnVmZmVycz1mdW5jdGlvbih0KXt2YXIgZT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO2Uuc2hpZnQoKTt2YXIgaT1zLmRlZmF1bHQuZGVmYXVsdHMoZSxbXCJvbmxvYWRcIixcImJhc2VVcmxcIixcIm9uZXJyb3JcIl0scy5kZWZhdWx0LkJ1ZmZlcnMpO2Zvcih2YXIgbiBpbiBzLmRlZmF1bHQuY2FsbCh0aGlzKSx0aGlzLl9idWZmZXJzPXt9LHRoaXMuYmFzZVVybD1pLmJhc2VVcmwsdGhpcy5fbG9hZGluZ0NvdW50PTAsdCl0aGlzLl9sb2FkaW5nQ291bnQrKyx0aGlzLmFkZChuLHRbbl0sdGhpcy5fYnVmZmVyTG9hZGVkLmJpbmQodGhpcyxpLm9ubG9hZCksaS5vbmVycm9yKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQnVmZmVycykscy5kZWZhdWx0LkJ1ZmZlcnMuZGVmYXVsdHM9e29ubG9hZDpzLmRlZmF1bHQubm9PcCxiYXNlVXJsOlwiXCJ9LHMuZGVmYXVsdC5CdWZmZXJzLnByb3RvdHlwZS5oYXM9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2J1ZmZlcnMuaGFzT3duUHJvcGVydHkodCl9LHMuZGVmYXVsdC5CdWZmZXJzLnByb3RvdHlwZS5nZXQ9ZnVuY3Rpb24odCl7aWYodGhpcy5oYXModCkpcmV0dXJuIHRoaXMuX2J1ZmZlcnNbdF07dGhyb3cgbmV3IEVycm9yKFwiVG9uZS5CdWZmZXJzOiBubyBidWZmZXIgbmFtZWQgXCIrdCl9LHMuZGVmYXVsdC5CdWZmZXJzLnByb3RvdHlwZS5fYnVmZmVyTG9hZGVkPWZ1bmN0aW9uKHQpe3RoaXMuX2xvYWRpbmdDb3VudC0tLDA9PT10aGlzLl9sb2FkaW5nQ291bnQmJnQmJnQodGhpcyl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQnVmZmVycy5wcm90b3R5cGUsXCJsb2FkZWRcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIHQ9ITA7Zm9yKHZhciBlIGluIHRoaXMuX2J1ZmZlcnMpe3ZhciBpPXRoaXMuZ2V0KGUpO3Q9dCYmaS5sb2FkZWR9cmV0dXJuIHR9fSkscy5kZWZhdWx0LkJ1ZmZlcnMucHJvdG90eXBlLmFkZD1mdW5jdGlvbih0LGUsaSxuKXtyZXR1cm4gaT1zLmRlZmF1bHQuZGVmYXVsdEFyZyhpLHMuZGVmYXVsdC5ub09wKSxlIGluc3RhbmNlb2Ygcy5kZWZhdWx0LkJ1ZmZlcj8odGhpcy5fYnVmZmVyc1t0XT1lLGkodGhpcykpOmUgaW5zdGFuY2VvZiBBdWRpb0J1ZmZlcj8odGhpcy5fYnVmZmVyc1t0XT1uZXcgcy5kZWZhdWx0LkJ1ZmZlcihlKSxpKHRoaXMpKTpzLmRlZmF1bHQuaXNTdHJpbmcoZSkmJih0aGlzLl9idWZmZXJzW3RdPW5ldyBzLmRlZmF1bHQuQnVmZmVyKHRoaXMuYmFzZVVybCtlLGksbikpLHRoaXN9LHMuZGVmYXVsdC5CdWZmZXJzLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7Zm9yKHZhciB0IGluIHMuZGVmYXVsdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX2J1ZmZlcnMpdGhpcy5fYnVmZmVyc1t0XS5kaXNwb3NlKCk7cmV0dXJuIHRoaXMuX2J1ZmZlcnM9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkJ1ZmZlcnN9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtzLmRlZmF1bHQuQ3RybFBhdHRlcm49ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInZhbHVlc1wiLFwidHlwZVwiXSxzLmRlZmF1bHQuQ3RybFBhdHRlcm4pO3MuZGVmYXVsdC5jYWxsKHRoaXMpLHRoaXMudmFsdWVzPXQudmFsdWVzLHRoaXMuaW5kZXg9MCx0aGlzLl90eXBlPW51bGwsdGhpcy5fc2h1ZmZsZWQ9bnVsbCx0aGlzLl9kaXJlY3Rpb249bnVsbCx0aGlzLnR5cGU9dC50eXBlfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5DdHJsUGF0dGVybikscy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGU9e1VwOlwidXBcIixEb3duOlwiZG93blwiLFVwRG93bjpcInVwRG93blwiLERvd25VcDpcImRvd25VcFwiLEFsdGVybmF0ZVVwOlwiYWx0ZXJuYXRlVXBcIixBbHRlcm5hdGVEb3duOlwiYWx0ZXJuYXRlRG93blwiLFJhbmRvbTpcInJhbmRvbVwiLFJhbmRvbVdhbGs6XCJyYW5kb21XYWxrXCIsUmFuZG9tT25jZTpcInJhbmRvbU9uY2VcIn0scy5kZWZhdWx0LkN0cmxQYXR0ZXJuLmRlZmF1bHRzPXt0eXBlOnMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwLHZhbHVlczpbXX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DdHJsUGF0dGVybi5wcm90b3R5cGUsXCJ2YWx1ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtpZigwIT09dGhpcy52YWx1ZXMubGVuZ3RoKXtpZigxPT09dGhpcy52YWx1ZXMubGVuZ3RoKXJldHVybiB0aGlzLnZhbHVlc1swXTt0aGlzLmluZGV4PU1hdGgubWluKHRoaXMuaW5kZXgsdGhpcy52YWx1ZXMubGVuZ3RoLTEpO3ZhciB0PXRoaXMudmFsdWVzW3RoaXMuaW5kZXhdO3JldHVybiB0aGlzLnR5cGU9PT1zLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5SYW5kb21PbmNlJiYodGhpcy52YWx1ZXMubGVuZ3RoIT09dGhpcy5fc2h1ZmZsZWQubGVuZ3RoJiZ0aGlzLl9zaHVmZmxlVmFsdWVzKCksdD10aGlzLnZhbHVlc1t0aGlzLl9zaHVmZmxlZFt0aGlzLmluZGV4XV0pLHR9fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ3RybFBhdHRlcm4ucHJvdG90eXBlLFwidHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fdHlwZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3R5cGU9dCx0aGlzLl9zaHVmZmxlZD1udWxsLHRoaXMuX3R5cGU9PT1zLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcHx8dGhpcy5fdHlwZT09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwRG93bnx8dGhpcy5fdHlwZT09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlJhbmRvbU9uY2V8fHRoaXMuX3R5cGU9PT1zLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5BbHRlcm5hdGVVcD90aGlzLmluZGV4PTA6dGhpcy5fdHlwZSE9PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLkRvd24mJnRoaXMuX3R5cGUhPT1zLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5Eb3duVXAmJnRoaXMuX3R5cGUhPT1zLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5BbHRlcm5hdGVEb3dufHwodGhpcy5pbmRleD10aGlzLnZhbHVlcy5sZW5ndGgtMSksdGhpcy5fdHlwZT09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwRG93bnx8dGhpcy5fdHlwZT09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLkFsdGVybmF0ZVVwP3RoaXMuX2RpcmVjdGlvbj1zLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcDp0aGlzLl90eXBlIT09cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuRG93blVwJiZ0aGlzLl90eXBlIT09cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuQWx0ZXJuYXRlRG93bnx8KHRoaXMuX2RpcmVjdGlvbj1zLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5Eb3duKSx0aGlzLl90eXBlPT09cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuUmFuZG9tT25jZT90aGlzLl9zaHVmZmxlVmFsdWVzKCk6dGhpcy5fdHlwZT09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlJhbmRvbSYmKHRoaXMuaW5kZXg9TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnRoaXMudmFsdWVzLmxlbmd0aCkpfX0pLHMuZGVmYXVsdC5DdHJsUGF0dGVybi5wcm90b3R5cGUubmV4dD1mdW5jdGlvbigpe3ZhciB0PXRoaXMudHlwZTtyZXR1cm4gdD09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwPyh0aGlzLmluZGV4KyssdGhpcy5pbmRleD49dGhpcy52YWx1ZXMubGVuZ3RoJiYodGhpcy5pbmRleD0wKSk6dD09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLkRvd24/KHRoaXMuaW5kZXgtLSx0aGlzLmluZGV4PDAmJih0aGlzLmluZGV4PXRoaXMudmFsdWVzLmxlbmd0aC0xKSk6dD09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwRG93bnx8dD09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLkRvd25VcD8odGhpcy5fZGlyZWN0aW9uPT09cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuVXA/dGhpcy5pbmRleCsrOnRoaXMuaW5kZXgtLSx0aGlzLmluZGV4PDA/KHRoaXMuaW5kZXg9MSx0aGlzLl9kaXJlY3Rpb249cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuVXApOnRoaXMuaW5kZXg+PXRoaXMudmFsdWVzLmxlbmd0aCYmKHRoaXMuaW5kZXg9dGhpcy52YWx1ZXMubGVuZ3RoLTIsdGhpcy5fZGlyZWN0aW9uPXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLkRvd24pKTp0PT09cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuUmFuZG9tP3RoaXMuaW5kZXg9TWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnRoaXMudmFsdWVzLmxlbmd0aCk6dD09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlJhbmRvbVdhbGs/TWF0aC5yYW5kb20oKTwuNT8odGhpcy5pbmRleC0tLHRoaXMuaW5kZXg9TWF0aC5tYXgodGhpcy5pbmRleCwwKSk6KHRoaXMuaW5kZXgrKyx0aGlzLmluZGV4PU1hdGgubWluKHRoaXMuaW5kZXgsdGhpcy52YWx1ZXMubGVuZ3RoLTEpKTp0PT09cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuUmFuZG9tT25jZT8odGhpcy5pbmRleCsrLHRoaXMuaW5kZXg+PXRoaXMudmFsdWVzLmxlbmd0aCYmKHRoaXMuaW5kZXg9MCx0aGlzLl9zaHVmZmxlVmFsdWVzKCkpKTp0PT09cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuQWx0ZXJuYXRlVXA/KHRoaXMuX2RpcmVjdGlvbj09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwPyh0aGlzLmluZGV4Kz0yLHRoaXMuX2RpcmVjdGlvbj1zLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5Eb3duKToodGhpcy5pbmRleC09MSx0aGlzLl9kaXJlY3Rpb249cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuVXApLHRoaXMuaW5kZXg+PXRoaXMudmFsdWVzLmxlbmd0aCYmKHRoaXMuaW5kZXg9MCx0aGlzLl9kaXJlY3Rpb249cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuVXApKTp0PT09cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuQWx0ZXJuYXRlRG93biYmKHRoaXMuX2RpcmVjdGlvbj09PXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLlVwPyh0aGlzLmluZGV4Kz0xLHRoaXMuX2RpcmVjdGlvbj1zLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5Eb3duKToodGhpcy5pbmRleC09Mix0aGlzLl9kaXJlY3Rpb249cy5kZWZhdWx0LkN0cmxQYXR0ZXJuLlR5cGUuVXApLHRoaXMuaW5kZXg8MCYmKHRoaXMuaW5kZXg9dGhpcy52YWx1ZXMubGVuZ3RoLTEsdGhpcy5fZGlyZWN0aW9uPXMuZGVmYXVsdC5DdHJsUGF0dGVybi5UeXBlLkRvd24pKSx0aGlzLnZhbHVlfSxzLmRlZmF1bHQuQ3RybFBhdHRlcm4ucHJvdG90eXBlLl9zaHVmZmxlVmFsdWVzPWZ1bmN0aW9uKCl7dmFyIHQ9W107dGhpcy5fc2h1ZmZsZWQ9W107Zm9yKHZhciBlPTA7ZTx0aGlzLnZhbHVlcy5sZW5ndGg7ZSsrKXRbZV09ZTtmb3IoO3QubGVuZ3RoPjA7KXt2YXIgaT10LnNwbGljZShNYXRoLmZsb29yKHQubGVuZ3RoKk1hdGgucmFuZG9tKCkpLDEpO3RoaXMuX3NodWZmbGVkLnB1c2goaVswXSl9fSxzLmRlZmF1bHQuQ3RybFBhdHRlcm4ucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXt0aGlzLl9zaHVmZmxlZD1udWxsLHRoaXMudmFsdWVzPW51bGx9LGUuZGVmYXVsdD1zLmRlZmF1bHQuQ3RybFBhdHRlcm59LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDExKSxpKDYpLGkoMyksaSgxKTtzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGU9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwidHlwZVwiXSxzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUpO3MuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzLHQpLHRoaXMub25lbmRlZD10Lm9uZW5kZWQsdGhpcy5fc3RhcnRUaW1lPS0xLHRoaXMuX3N0b3BUaW1lPS0xLHRoaXMuX2dhaW5Ob2RlPXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuR2FpbigwKSx0aGlzLl9vc2NpbGxhdG9yPXRoaXMuY29udGV4dC5jcmVhdGVPc2NpbGxhdG9yKCkscy5kZWZhdWx0LmNvbm5lY3QodGhpcy5fb3NjaWxsYXRvcix0aGlzLl9nYWluTm9kZSksdGhpcy50eXBlPXQudHlwZSx0aGlzLmZyZXF1ZW5jeT1uZXcgcy5kZWZhdWx0LlBhcmFtKHtwYXJhbTp0aGlzLl9vc2NpbGxhdG9yLmZyZXF1ZW5jeSx1bml0czpzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3ksdmFsdWU6dC5mcmVxdWVuY3l9KSx0aGlzLmRldHVuZT1uZXcgcy5kZWZhdWx0LlBhcmFtKHtwYXJhbTp0aGlzLl9vc2NpbGxhdG9yLmRldHVuZSx1bml0czpzLmRlZmF1bHQuVHlwZS5DZW50cyx2YWx1ZTp0LmRldHVuZX0pLHRoaXMuX2dhaW49MX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0Lk9zY2lsbGF0b3JOb2RlLmRlZmF1bHRzPXtmcmVxdWVuY3k6NDQwLGRldHVuZTowLHR5cGU6XCJzaW5lXCIsb25lbmRlZDpzLmRlZmF1bHQubm9PcH0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Pc2NpbGxhdG9yTm9kZS5wcm90b3R5cGUsXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5nZXRTdGF0ZUF0VGltZSh0aGlzLm5vdygpKX19KSxzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUucHJvdG90eXBlLmdldFN0YXRlQXRUaW1lPWZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLC0xIT09dGhpcy5fc3RhcnRUaW1lJiZ0Pj10aGlzLl9zdGFydFRpbWUmJigtMT09PXRoaXMuX3N0b3BUaW1lfHx0PD10aGlzLl9zdG9wVGltZSk/cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQ6cy5kZWZhdWx0LlN0YXRlLlN0b3BwZWR9LHMuZGVmYXVsdC5Pc2NpbGxhdG9yTm9kZS5wcm90b3R5cGUuc3RhcnQ9ZnVuY3Rpb24odCl7aWYodGhpcy5sb2coXCJzdGFydFwiLHQpLC0xIT09dGhpcy5fc3RhcnRUaW1lKXRocm93IG5ldyBFcnJvcihcImNhbm5vdCBjYWxsIE9zY2lsbGF0b3JOb2RlLnN0YXJ0IG1vcmUgdGhhbiBvbmNlXCIpO3JldHVybiB0aGlzLl9zdGFydFRpbWU9dGhpcy50b1NlY29uZHModCksdGhpcy5fc3RhcnRUaW1lPU1hdGgubWF4KHRoaXMuX3N0YXJ0VGltZSx0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpLHRoaXMuX29zY2lsbGF0b3Iuc3RhcnQodGhpcy5fc3RhcnRUaW1lKSx0aGlzLl9nYWluTm9kZS5nYWluLnNldFZhbHVlQXRUaW1lKDEsdGhpcy5fc3RhcnRUaW1lKSx0aGlzfSxzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUucHJvdG90eXBlLnNldFBlcmlvZGljV2F2ZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvci5zZXRQZXJpb2RpY1dhdmUodCksdGhpc30scy5kZWZhdWx0Lk9zY2lsbGF0b3JOb2RlLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLmxvZyhcInN0b3BcIix0KSx0aGlzLmFzc2VydCgtMSE9PXRoaXMuX3N0YXJ0VGltZSxcIidzdGFydCcgbXVzdCBiZSBjYWxsZWQgYmVmb3JlICdzdG9wJ1wiKSx0aGlzLmNhbmNlbFN0b3AoKSx0aGlzLl9zdG9wVGltZT10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9zdG9wVGltZT1NYXRoLm1heCh0aGlzLl9zdG9wVGltZSx0aGlzLmNvbnRleHQuY3VycmVudFRpbWUpLHRoaXMuX3N0b3BUaW1lPnRoaXMuX3N0YXJ0VGltZT8odGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5zZXRWYWx1ZUF0VGltZSgwLHRoaXMuX3N0b3BUaW1lKSx0aGlzLmNvbnRleHQuY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXQpLHRoaXMuX3RpbWVvdXQ9dGhpcy5jb250ZXh0LnNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aGlzLl9vc2NpbGxhdG9yLnN0b3AodGhpcy5ub3coKSksdGhpcy5vbmVuZGVkKCksc2V0VGltZW91dChmdW5jdGlvbigpe3RoaXMuX29zY2lsbGF0b3ImJih0aGlzLl9vc2NpbGxhdG9yLmRpc2Nvbm5lY3QoKSx0aGlzLl9nYWluTm9kZS5kaXNjb25uZWN0KCkpfS5iaW5kKHRoaXMpLDEwMCl9LmJpbmQodGhpcyksdGhpcy5fc3RvcFRpbWUtdGhpcy5jb250ZXh0LmN1cnJlbnRUaW1lKSk6dGhpcy5fZ2Fpbk5vZGUuZ2Fpbi5jYW5jZWxTY2hlZHVsZWRWYWx1ZXModGhpcy5fc3RhcnRUaW1lKSx0aGlzfSxzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUucHJvdG90eXBlLmNhbmNlbFN0b3A9ZnVuY3Rpb24oKXtyZXR1cm4tMSE9PXRoaXMuX3N0YXJ0VGltZSYmKHRoaXMuX2dhaW5Ob2RlLmdhaW4uY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHRoaXMuX3N0YXJ0VGltZSt0aGlzLnNhbXBsZVRpbWUpLHRoaXMuY29udGV4dC5jbGVhclRpbWVvdXQodGhpcy5fdGltZW91dCksdGhpcy5fc3RvcFRpbWU9LTEpLHRoaXN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuT3NjaWxsYXRvck5vZGUucHJvdG90eXBlLFwidHlwZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvci50eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3NjaWxsYXRvci50eXBlPXR9fSkscy5kZWZhdWx0Lk9zY2lsbGF0b3JOb2RlLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3dhc0Rpc3Bvc2VkfHwodGhpcy5fd2FzRGlzcG9zZWQ9ITAsdGhpcy5jb250ZXh0LmNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0KSxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5vbmVuZGVkPW51bGwsdGhpcy5fb3NjaWxsYXRvci5kaXNjb25uZWN0KCksdGhpcy5fb3NjaWxsYXRvcj1udWxsLHRoaXMuX2dhaW5Ob2RlLmRpc3Bvc2UoKSx0aGlzLl9nYWluTm9kZT1udWxsLHRoaXMuZnJlcXVlbmN5LmRpc3Bvc2UoKSx0aGlzLmZyZXF1ZW5jeT1udWxsLHRoaXMuZGV0dW5lLmRpc3Bvc2UoKSx0aGlzLmRldHVuZT1udWxsKSx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lk9zY2lsbGF0b3JOb2RlfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg1NiksaSg1NSk7cy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50PWZ1bmN0aW9uKHQsZSl7cy5kZWZhdWx0LlRyYW5zcG9ydEV2ZW50LmNhbGwodGhpcyx0LGUpLGU9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSxzLmRlZmF1bHQuVHJhbnNwb3J0UmVwZWF0RXZlbnQuZGVmYXVsdHMpLHRoaXMuZHVyYXRpb249cy5kZWZhdWx0LlRpY2tzKGUuZHVyYXRpb24pLHRoaXMuX2ludGVydmFsPXMuZGVmYXVsdC5UaWNrcyhlLmludGVydmFsKSx0aGlzLl9jdXJyZW50SWQ9LTEsdGhpcy5fbmV4dElkPS0xLHRoaXMuX25leHRUaWNrPXRoaXMudGltZSx0aGlzLl9ib3VuZFJlc3RhcnQ9dGhpcy5fcmVzdGFydC5iaW5kKHRoaXMpLHRoaXMuVHJhbnNwb3J0Lm9uKFwic3RhcnQgbG9vcFN0YXJ0XCIsdGhpcy5fYm91bmRSZXN0YXJ0KSx0aGlzLl9yZXN0YXJ0KCl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50LHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudCkscy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50LmRlZmF1bHRzPXtkdXJhdGlvbjoxLzAsaW50ZXJ2YWw6MX0scy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50LnByb3RvdHlwZS5pbnZva2U9ZnVuY3Rpb24odCl7dGhpcy5fY3JlYXRlRXZlbnRzKHQpLHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudC5wcm90b3R5cGUuaW52b2tlLmNhbGwodGhpcyx0KX0scy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50LnByb3RvdHlwZS5fY3JlYXRlRXZlbnRzPWZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuVHJhbnNwb3J0LmdldFRpY2tzQXRUaW1lKHQpO2U+PXRoaXMudGltZSYmZT49dGhpcy5fbmV4dFRpY2smJnRoaXMuX25leHRUaWNrK3RoaXMuX2ludGVydmFsPHRoaXMudGltZSt0aGlzLmR1cmF0aW9uJiYodGhpcy5fbmV4dFRpY2srPXRoaXMuX2ludGVydmFsLHRoaXMuX2N1cnJlbnRJZD10aGlzLl9uZXh0SWQsdGhpcy5fbmV4dElkPXRoaXMuVHJhbnNwb3J0LnNjaGVkdWxlT25jZSh0aGlzLmludm9rZS5iaW5kKHRoaXMpLHMuZGVmYXVsdC5UaWNrcyh0aGlzLl9uZXh0VGljaykpKX0scy5kZWZhdWx0LlRyYW5zcG9ydFJlcGVhdEV2ZW50LnByb3RvdHlwZS5fcmVzdGFydD1mdW5jdGlvbih0KXt0aGlzLlRyYW5zcG9ydC5jbGVhcih0aGlzLl9jdXJyZW50SWQpLHRoaXMuVHJhbnNwb3J0LmNsZWFyKHRoaXMuX25leHRJZCksdGhpcy5fbmV4dFRpY2s9dGhpcy50aW1lO3ZhciBlPXRoaXMuVHJhbnNwb3J0LmdldFRpY2tzQXRUaW1lKHQpO2U+dGhpcy50aW1lJiYodGhpcy5fbmV4dFRpY2s9dGhpcy50aW1lK01hdGguY2VpbCgoZS10aGlzLnRpbWUpL3RoaXMuX2ludGVydmFsKSp0aGlzLl9pbnRlcnZhbCksdGhpcy5fY3VycmVudElkPXRoaXMuVHJhbnNwb3J0LnNjaGVkdWxlT25jZSh0aGlzLmludm9rZS5iaW5kKHRoaXMpLHMuZGVmYXVsdC5UaWNrcyh0aGlzLl9uZXh0VGljaykpLHRoaXMuX25leHRUaWNrKz10aGlzLl9pbnRlcnZhbCx0aGlzLl9uZXh0SWQ9dGhpcy5UcmFuc3BvcnQuc2NoZWR1bGVPbmNlKHRoaXMuaW52b2tlLmJpbmQodGhpcykscy5kZWZhdWx0LlRpY2tzKHRoaXMuX25leHRUaWNrKSl9LHMuZGVmYXVsdC5UcmFuc3BvcnRSZXBlYXRFdmVudC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLlRyYW5zcG9ydC5jbGVhcih0aGlzLl9jdXJyZW50SWQpLHRoaXMuVHJhbnNwb3J0LmNsZWFyKHRoaXMuX25leHRJZCksdGhpcy5UcmFuc3BvcnQub2ZmKFwic3RhcnQgbG9vcFN0YXJ0XCIsdGhpcy5fYm91bmRSZXN0YXJ0KSx0aGlzLl9ib3VuZENyZWF0ZUV2ZW50cz1udWxsLHMuZGVmYXVsdC5UcmFuc3BvcnRFdmVudC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuZHVyYXRpb249bnVsbCx0aGlzLl9pbnRlcnZhbD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuVHJhbnNwb3J0UmVwZWF0RXZlbnR9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDQpO3MuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lPWZ1bmN0aW9uKCl7cy5kZWZhdWx0LmNhbGwodGhpcyksdGhpcy5fcm9vdD1udWxsLHRoaXMuX2xlbmd0aD0wfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lKSxzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQpe2lmKHMuZGVmYXVsdC5pc1VuZGVmKHQudGltZSl8fHMuZGVmYXVsdC5pc1VuZGVmKHQuZHVyYXRpb24pKXRocm93IG5ldyBFcnJvcihcIlRvbmUuSW50ZXJ2YWxUaW1lbGluZTogZXZlbnRzIG11c3QgaGF2ZSB0aW1lIGFuZCBkdXJhdGlvbiBwYXJhbWV0ZXJzXCIpO3QudGltZT10LnRpbWUudmFsdWVPZigpO3ZhciBlPW5ldyBuKHQudGltZSx0LnRpbWUrdC5kdXJhdGlvbix0KTtmb3IobnVsbD09PXRoaXMuX3Jvb3Q/dGhpcy5fcm9vdD1lOnRoaXMuX3Jvb3QuaW5zZXJ0KGUpLHRoaXMuX2xlbmd0aCsrO251bGwhPT1lOyllLnVwZGF0ZUhlaWdodCgpLGUudXBkYXRlTWF4KCksdGhpcy5fcmViYWxhbmNlKGUpLGU9ZS5wYXJlbnQ7cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24odCl7aWYobnVsbCE9PXRoaXMuX3Jvb3Qpe3ZhciBlPVtdO3RoaXMuX3Jvb3Quc2VhcmNoKHQudGltZSxlKTtmb3IodmFyIGk9MDtpPGUubGVuZ3RoO2krKyl7dmFyIHM9ZVtpXTtpZihzLmV2ZW50PT09dCl7dGhpcy5fcmVtb3ZlTm9kZShzKSx0aGlzLl9sZW5ndGgtLTticmVha319fXJldHVybiB0aGlzfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLFwibGVuZ3RoXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sZW5ndGh9fSkscy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLmNhbmNlbD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5mb3JFYWNoRnJvbSh0LGZ1bmN0aW9uKHQpe3RoaXMucmVtb3ZlKHQpfS5iaW5kKHRoaXMpKSx0aGlzfSxzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUuX3NldFJvb3Q9ZnVuY3Rpb24odCl7dGhpcy5fcm9vdD10LG51bGwhPT10aGlzLl9yb290JiYodGhpcy5fcm9vdC5wYXJlbnQ9bnVsbCl9LHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLnByb3RvdHlwZS5fcmVwbGFjZU5vZGVJblBhcmVudD1mdW5jdGlvbih0LGUpe251bGwhPT10LnBhcmVudD8odC5pc0xlZnRDaGlsZCgpP3QucGFyZW50LmxlZnQ9ZTp0LnBhcmVudC5yaWdodD1lLHRoaXMuX3JlYmFsYW5jZSh0LnBhcmVudCkpOnRoaXMuX3NldFJvb3QoZSl9LHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLnByb3RvdHlwZS5fcmVtb3ZlTm9kZT1mdW5jdGlvbih0KXtpZihudWxsPT09dC5sZWZ0JiZudWxsPT09dC5yaWdodCl0aGlzLl9yZXBsYWNlTm9kZUluUGFyZW50KHQsbnVsbCk7ZWxzZSBpZihudWxsPT09dC5yaWdodCl0aGlzLl9yZXBsYWNlTm9kZUluUGFyZW50KHQsdC5sZWZ0KTtlbHNlIGlmKG51bGw9PT10LmxlZnQpdGhpcy5fcmVwbGFjZU5vZGVJblBhcmVudCh0LHQucmlnaHQpO2Vsc2V7dmFyIGUsaTtpZih0LmdldEJhbGFuY2UoKT4wKWlmKG51bGw9PT10LmxlZnQucmlnaHQpKGU9dC5sZWZ0KS5yaWdodD10LnJpZ2h0LGk9ZTtlbHNle2ZvcihlPXQubGVmdC5yaWdodDtudWxsIT09ZS5yaWdodDspZT1lLnJpZ2h0O2UucGFyZW50LnJpZ2h0PWUubGVmdCxpPWUucGFyZW50LGUubGVmdD10LmxlZnQsZS5yaWdodD10LnJpZ2h0fWVsc2UgaWYobnVsbD09PXQucmlnaHQubGVmdCkoZT10LnJpZ2h0KS5sZWZ0PXQubGVmdCxpPWU7ZWxzZXtmb3IoZT10LnJpZ2h0LmxlZnQ7bnVsbCE9PWUubGVmdDspZT1lLmxlZnQ7ZS5wYXJlbnQubGVmdD1lLnJpZ2h0LGk9ZS5wYXJlbnQsZS5sZWZ0PXQubGVmdCxlLnJpZ2h0PXQucmlnaHR9bnVsbCE9PXQucGFyZW50P3QuaXNMZWZ0Q2hpbGQoKT90LnBhcmVudC5sZWZ0PWU6dC5wYXJlbnQucmlnaHQ9ZTp0aGlzLl9zZXRSb290KGUpLHRoaXMuX3JlYmFsYW5jZShpKX10LmRpc3Bvc2UoKX0scy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLl9yb3RhdGVMZWZ0PWZ1bmN0aW9uKHQpe3ZhciBlPXQucGFyZW50LGk9dC5pc0xlZnRDaGlsZCgpLHM9dC5yaWdodDt0LnJpZ2h0PXMubGVmdCxzLmxlZnQ9dCxudWxsIT09ZT9pP2UubGVmdD1zOmUucmlnaHQ9czp0aGlzLl9zZXRSb290KHMpfSxzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUuX3JvdGF0ZVJpZ2h0PWZ1bmN0aW9uKHQpe3ZhciBlPXQucGFyZW50LGk9dC5pc0xlZnRDaGlsZCgpLHM9dC5sZWZ0O3QubGVmdD1zLnJpZ2h0LHMucmlnaHQ9dCxudWxsIT09ZT9pP2UubGVmdD1zOmUucmlnaHQ9czp0aGlzLl9zZXRSb290KHMpfSxzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUuX3JlYmFsYW5jZT1mdW5jdGlvbih0KXt2YXIgZT10LmdldEJhbGFuY2UoKTtlPjE/dC5sZWZ0LmdldEJhbGFuY2UoKTwwP3RoaXMuX3JvdGF0ZUxlZnQodC5sZWZ0KTp0aGlzLl9yb3RhdGVSaWdodCh0KTplPC0xJiYodC5yaWdodC5nZXRCYWxhbmNlKCk+MD90aGlzLl9yb3RhdGVSaWdodCh0LnJpZ2h0KTp0aGlzLl9yb3RhdGVMZWZ0KHQpKX0scy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLmdldD1mdW5jdGlvbih0KXtpZihudWxsIT09dGhpcy5fcm9vdCl7dmFyIGU9W107aWYodGhpcy5fcm9vdC5zZWFyY2godCxlKSxlLmxlbmd0aD4wKXtmb3IodmFyIGk9ZVswXSxzPTE7czxlLmxlbmd0aDtzKyspZVtzXS5sb3c+aS5sb3cmJihpPWVbc10pO3JldHVybiBpLmV2ZW50fX1yZXR1cm4gbnVsbH0scy5kZWZhdWx0LkludGVydmFsVGltZWxpbmUucHJvdG90eXBlLmZvckVhY2g9ZnVuY3Rpb24odCl7aWYobnVsbCE9PXRoaXMuX3Jvb3Qpe3ZhciBlPVtdO3RoaXMuX3Jvb3QudHJhdmVyc2UoZnVuY3Rpb24odCl7ZS5wdXNoKHQpfSk7Zm9yKHZhciBpPTA7aTxlLmxlbmd0aDtpKyspe3ZhciBzPWVbaV0uZXZlbnQ7cyYmdChzKX19cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLnByb3RvdHlwZS5mb3JFYWNoQXRUaW1lPWZ1bmN0aW9uKHQsZSl7aWYobnVsbCE9PXRoaXMuX3Jvb3Qpe3ZhciBpPVtdO3RoaXMuX3Jvb3Quc2VhcmNoKHQsaSk7Zm9yKHZhciBzPWkubGVuZ3RoLTE7cz49MDtzLS0pe3ZhciBuPWlbc10uZXZlbnQ7biYmZShuKX19cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5JbnRlcnZhbFRpbWVsaW5lLnByb3RvdHlwZS5mb3JFYWNoRnJvbT1mdW5jdGlvbih0LGUpe2lmKG51bGwhPT10aGlzLl9yb290KXt2YXIgaT1bXTt0aGlzLl9yb290LnNlYXJjaEFmdGVyKHQsaSk7Zm9yKHZhciBzPWkubGVuZ3RoLTE7cz49MDtzLS0pe2UoaVtzXS5ldmVudCl9fXJldHVybiB0aGlzfSxzLmRlZmF1bHQuSW50ZXJ2YWxUaW1lbGluZS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3ZhciB0PVtdO251bGwhPT10aGlzLl9yb290JiZ0aGlzLl9yb290LnRyYXZlcnNlKGZ1bmN0aW9uKGUpe3QucHVzaChlKX0pO2Zvcih2YXIgZT0wO2U8dC5sZW5ndGg7ZSsrKXRbZV0uZGlzcG9zZSgpO3JldHVybiB0PW51bGwsdGhpcy5fcm9vdD1udWxsLHRoaXN9O3ZhciBuPWZ1bmN0aW9uKHQsZSxpKXt0aGlzLmV2ZW50PWksdGhpcy5sb3c9dCx0aGlzLmhpZ2g9ZSx0aGlzLm1heD10aGlzLmhpZ2gsdGhpcy5fbGVmdD1udWxsLHRoaXMuX3JpZ2h0PW51bGwsdGhpcy5wYXJlbnQ9bnVsbCx0aGlzLmhlaWdodD0wfTtuLnByb3RvdHlwZS5pbnNlcnQ9ZnVuY3Rpb24odCl7dC5sb3c8PXRoaXMubG93P251bGw9PT10aGlzLmxlZnQ/dGhpcy5sZWZ0PXQ6dGhpcy5sZWZ0Lmluc2VydCh0KTpudWxsPT09dGhpcy5yaWdodD90aGlzLnJpZ2h0PXQ6dGhpcy5yaWdodC5pbnNlcnQodCl9LG4ucHJvdG90eXBlLnNlYXJjaD1mdW5jdGlvbih0LGUpe3Q+dGhpcy5tYXh8fChudWxsIT09dGhpcy5sZWZ0JiZ0aGlzLmxlZnQuc2VhcmNoKHQsZSksdGhpcy5sb3c8PXQmJnRoaXMuaGlnaD50JiZlLnB1c2godGhpcyksdGhpcy5sb3c+dHx8bnVsbCE9PXRoaXMucmlnaHQmJnRoaXMucmlnaHQuc2VhcmNoKHQsZSkpfSxuLnByb3RvdHlwZS5zZWFyY2hBZnRlcj1mdW5jdGlvbih0LGUpe3RoaXMubG93Pj10JiYoZS5wdXNoKHRoaXMpLG51bGwhPT10aGlzLmxlZnQmJnRoaXMubGVmdC5zZWFyY2hBZnRlcih0LGUpKSxudWxsIT09dGhpcy5yaWdodCYmdGhpcy5yaWdodC5zZWFyY2hBZnRlcih0LGUpfSxuLnByb3RvdHlwZS50cmF2ZXJzZT1mdW5jdGlvbih0KXt0KHRoaXMpLG51bGwhPT10aGlzLmxlZnQmJnRoaXMubGVmdC50cmF2ZXJzZSh0KSxudWxsIT09dGhpcy5yaWdodCYmdGhpcy5yaWdodC50cmF2ZXJzZSh0KX0sbi5wcm90b3R5cGUudXBkYXRlSGVpZ2h0PWZ1bmN0aW9uKCl7bnVsbCE9PXRoaXMubGVmdCYmbnVsbCE9PXRoaXMucmlnaHQ/dGhpcy5oZWlnaHQ9TWF0aC5tYXgodGhpcy5sZWZ0LmhlaWdodCx0aGlzLnJpZ2h0LmhlaWdodCkrMTpudWxsIT09dGhpcy5yaWdodD90aGlzLmhlaWdodD10aGlzLnJpZ2h0LmhlaWdodCsxOm51bGwhPT10aGlzLmxlZnQ/dGhpcy5oZWlnaHQ9dGhpcy5sZWZ0LmhlaWdodCsxOnRoaXMuaGVpZ2h0PTB9LG4ucHJvdG90eXBlLnVwZGF0ZU1heD1mdW5jdGlvbigpe3RoaXMubWF4PXRoaXMuaGlnaCxudWxsIT09dGhpcy5sZWZ0JiYodGhpcy5tYXg9TWF0aC5tYXgodGhpcy5tYXgsdGhpcy5sZWZ0Lm1heCkpLG51bGwhPT10aGlzLnJpZ2h0JiYodGhpcy5tYXg9TWF0aC5tYXgodGhpcy5tYXgsdGhpcy5yaWdodC5tYXgpKX0sbi5wcm90b3R5cGUuZ2V0QmFsYW5jZT1mdW5jdGlvbigpe3ZhciB0PTA7cmV0dXJuIG51bGwhPT10aGlzLmxlZnQmJm51bGwhPT10aGlzLnJpZ2h0P3Q9dGhpcy5sZWZ0LmhlaWdodC10aGlzLnJpZ2h0LmhlaWdodDpudWxsIT09dGhpcy5sZWZ0P3Q9dGhpcy5sZWZ0LmhlaWdodCsxOm51bGwhPT10aGlzLnJpZ2h0JiYodD0tKHRoaXMucmlnaHQuaGVpZ2h0KzEpKSx0fSxuLnByb3RvdHlwZS5pc0xlZnRDaGlsZD1mdW5jdGlvbigpe3JldHVybiBudWxsIT09dGhpcy5wYXJlbnQmJnRoaXMucGFyZW50LmxlZnQ9PT10aGlzfSxPYmplY3QuZGVmaW5lUHJvcGVydHkobi5wcm90b3R5cGUsXCJsZWZ0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sZWZ0fSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fbGVmdD10LG51bGwhPT10JiYodC5wYXJlbnQ9dGhpcyksdGhpcy51cGRhdGVIZWlnaHQoKSx0aGlzLnVwZGF0ZU1heCgpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSxcInJpZ2h0XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9yaWdodH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3JpZ2h0PXQsbnVsbCE9PXQmJih0LnBhcmVudD10aGlzKSx0aGlzLnVwZGF0ZUhlaWdodCgpLHRoaXMudXBkYXRlTWF4KCl9fSksbi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3RoaXMucGFyZW50PW51bGwsdGhpcy5fbGVmdD1udWxsLHRoaXMuX3JpZ2h0PW51bGwsdGhpcy5ldmVudD1udWxsfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkludGVydmFsVGltZWxpbmV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDIpO2Z1bmN0aW9uIG4odCl7cmV0dXJuIGZ1bmN0aW9uKGUsaSl7aT10aGlzLnRvU2Vjb25kcyhpKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgcz10aGlzLl9ldmVudHMuZ2V0KGkpLG49dGhpcy5fZXZlbnRzLnByZXZpb3VzRXZlbnQocyksbz10aGlzLl9nZXRUaWNrc1VudGlsRXZlbnQobixpKTtyZXR1cm4gcy50aWNrcz1NYXRoLm1heChvLDApLHRoaXN9fXMuZGVmYXVsdC5UaWNrU2lnbmFsPWZ1bmN0aW9uKHQpe3Q9cy5kZWZhdWx0LmRlZmF1bHRBcmcodCwxKSxzLmRlZmF1bHQuU2lnbmFsLmNhbGwodGhpcyx7dW5pdHM6cy5kZWZhdWx0LlR5cGUuVGlja3MsdmFsdWU6dH0pLHRoaXMuX2V2ZW50cy5tZW1vcnk9MS8wLHRoaXMuY2FuY2VsU2NoZWR1bGVkVmFsdWVzKDApLHRoaXMuX2V2ZW50cy5hZGQoe3R5cGU6cy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLlNldFZhbHVlLHRpbWU6MCx2YWx1ZTp0fSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlRpY2tTaWduYWwscy5kZWZhdWx0LlNpZ25hbCkscy5kZWZhdWx0LlRpY2tTaWduYWwucHJvdG90eXBlLnNldFZhbHVlQXRUaW1lPW4ocy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUuc2V0VmFsdWVBdFRpbWUpLHMuZGVmYXVsdC5UaWNrU2lnbmFsLnByb3RvdHlwZS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZT1uKHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKSxzLmRlZmF1bHQuVGlja1NpZ25hbC5wcm90b3R5cGUuc2V0VGFyZ2V0QXRUaW1lPWZ1bmN0aW9uKHQsZSxpKXtlPXRoaXMudG9TZWNvbmRzKGUpLHRoaXMuc2V0UmFtcFBvaW50KGUpLHQ9dGhpcy5fZnJvbVVuaXRzKHQpO2Zvcih2YXIgcz10aGlzLl9ldmVudHMuZ2V0KGUpLG49TWF0aC5yb3VuZChNYXRoLm1heCgxL2ksMSkpLG89MDtvPD1uO28rKyl7dmFyIGE9aSpvK2Uscj10aGlzLl9leHBvbmVudGlhbEFwcHJvYWNoKHMudGltZSxzLnZhbHVlLHQsaSxhKTt0aGlzLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKHRoaXMuX3RvVW5pdHMociksYSl9cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5UaWNrU2lnbmFsLnByb3RvdHlwZS5leHBvbmVudGlhbFJhbXBUb1ZhbHVlQXRUaW1lPWZ1bmN0aW9uKHQsZSl7ZT10aGlzLnRvU2Vjb25kcyhlKSx0PXRoaXMuX2Zyb21Vbml0cyh0KTtmb3IodmFyIGk9dGhpcy5fZXZlbnRzLmdldChlKSxzPU1hdGgucm91bmQoTWF0aC5tYXgoMTAqKGUtaS50aW1lKSwxKSksbj0oZS1pLnRpbWUpL3Msbz0wO288PXM7bysrKXt2YXIgYT1uKm8raS50aW1lLHI9dGhpcy5fZXhwb25lbnRpYWxJbnRlcnBvbGF0ZShpLnRpbWUsaS52YWx1ZSxlLHQsYSk7dGhpcy5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZSh0aGlzLl90b1VuaXRzKHIpLGEpfXJldHVybiB0aGlzfSxzLmRlZmF1bHQuVGlja1NpZ25hbC5wcm90b3R5cGUuX2dldFRpY2tzVW50aWxFdmVudD1mdW5jdGlvbih0LGUpe2lmKG51bGw9PT10KXQ9e3RpY2tzOjAsdGltZTowfTtlbHNlIGlmKHMuZGVmYXVsdC5pc1VuZGVmKHQudGlja3MpKXt2YXIgaT10aGlzLl9ldmVudHMucHJldmlvdXNFdmVudCh0KTt0LnRpY2tzPXRoaXMuX2dldFRpY2tzVW50aWxFdmVudChpLHQudGltZSl9dmFyIG49dGhpcy5nZXRWYWx1ZUF0VGltZSh0LnRpbWUpLG89dGhpcy5nZXRWYWx1ZUF0VGltZShlKTtyZXR1cm4gdGhpcy5fZXZlbnRzLmdldChlKS50aW1lPT09ZSYmdGhpcy5fZXZlbnRzLmdldChlKS50eXBlPT09cy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLlNldFZhbHVlJiYobz10aGlzLmdldFZhbHVlQXRUaW1lKGUtdGhpcy5zYW1wbGVUaW1lKSksLjUqKGUtdC50aW1lKSoobitvKSt0LnRpY2tzfSxzLmRlZmF1bHQuVGlja1NpZ25hbC5wcm90b3R5cGUuZ2V0VGlja3NBdFRpbWU9ZnVuY3Rpb24odCl7dD10aGlzLnRvU2Vjb25kcyh0KTt2YXIgZT10aGlzLl9ldmVudHMuZ2V0KHQpO3JldHVybiBNYXRoLm1heCh0aGlzLl9nZXRUaWNrc1VudGlsRXZlbnQoZSx0KSwwKX0scy5kZWZhdWx0LlRpY2tTaWduYWwucHJvdG90eXBlLmdldER1cmF0aW9uT2ZUaWNrcz1mdW5jdGlvbih0LGUpe2U9dGhpcy50b1NlY29uZHMoZSk7dmFyIGk9dGhpcy5nZXRUaWNrc0F0VGltZShlKTtyZXR1cm4gdGhpcy5nZXRUaW1lT2ZUaWNrKGkrdCktZX0scy5kZWZhdWx0LlRpY2tTaWduYWwucHJvdG90eXBlLmdldFRpbWVPZlRpY2s9ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5fZXZlbnRzLmdldCh0LFwidGlja3NcIiksaT10aGlzLl9ldmVudHMuZ2V0QWZ0ZXIodCxcInRpY2tzXCIpO2lmKGUmJmUudGlja3M9PT10KXJldHVybiBlLnRpbWU7aWYoZSYmaSYmaS50eXBlPT09cy5kZWZhdWx0LlBhcmFtLkF1dG9tYXRpb25UeXBlLkxpbmVhciYmZS52YWx1ZSE9PWkudmFsdWUpe3ZhciBuPXRoaXMuZ2V0VmFsdWVBdFRpbWUoZS50aW1lKSxvPSh0aGlzLmdldFZhbHVlQXRUaW1lKGkudGltZSktbikvKGkudGltZS1lLnRpbWUpLGE9TWF0aC5zcXJ0KE1hdGgucG93KG4sMiktMipvKihlLnRpY2tzLXQpKSxyPSgtbithKS9vO3JldHVybihyPjA/cjooLW4tYSkvbykrZS50aW1lfXJldHVybiBlPzA9PT1lLnZhbHVlPzEvMDplLnRpbWUrKHQtZS50aWNrcykvZS52YWx1ZTp0L3RoaXMuX2luaXRpYWxWYWx1ZX0scy5kZWZhdWx0LlRpY2tTaWduYWwucHJvdG90eXBlLnRpY2tzVG9UaW1lPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGU9dGhpcy50b1NlY29uZHMoZSksbmV3IHMuZGVmYXVsdC5UaW1lKHRoaXMuZ2V0RHVyYXRpb25PZlRpY2tzKHQsZSkpfSxzLmRlZmF1bHQuVGlja1NpZ25hbC5wcm90b3R5cGUudGltZVRvVGlja3M9ZnVuY3Rpb24odCxlKXtlPXRoaXMudG9TZWNvbmRzKGUpLHQ9dGhpcy50b1NlY29uZHModCk7dmFyIGk9dGhpcy5nZXRUaWNrc0F0VGltZShlKSxuPXRoaXMuZ2V0VGlja3NBdFRpbWUoZSt0KTtyZXR1cm4gbmV3IHMuZGVmYXVsdC5UaWNrcyhuLWkpfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlRpY2tTaWduYWx9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDU3KSxpKDM0KSxpKDM1KSxpKDIwKTtzLmRlZmF1bHQuQ2xvY2s9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImNhbGxiYWNrXCIsXCJmcmVxdWVuY3lcIl0scy5kZWZhdWx0LkNsb2NrKTtzLmRlZmF1bHQuRW1pdHRlci5jYWxsKHRoaXMpLHRoaXMuY2FsbGJhY2s9dC5jYWxsYmFjayx0aGlzLl9uZXh0VGljaz0wLHRoaXMuX3RpY2tTb3VyY2U9bmV3IHMuZGVmYXVsdC5UaWNrU291cmNlKHQuZnJlcXVlbmN5KSx0aGlzLl9sYXN0VXBkYXRlPTAsdGhpcy5mcmVxdWVuY3k9dGhpcy5fdGlja1NvdXJjZS5mcmVxdWVuY3ksdGhpcy5fcmVhZE9ubHkoXCJmcmVxdWVuY3lcIiksdGhpcy5fc3RhdGU9bmV3IHMuZGVmYXVsdC5UaW1lbGluZVN0YXRlKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkKSx0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZCwwKSx0aGlzLl9ib3VuZExvb3A9dGhpcy5fbG9vcC5iaW5kKHRoaXMpLHRoaXMuY29udGV4dC5vbihcInRpY2tcIix0aGlzLl9ib3VuZExvb3ApfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5DbG9jayxzLmRlZmF1bHQuRW1pdHRlcikscy5kZWZhdWx0LkNsb2NrLmRlZmF1bHRzPXtjYWxsYmFjazpzLmRlZmF1bHQubm9PcCxmcmVxdWVuY3k6MX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DbG9jay5wcm90b3R5cGUsXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RhdGUuZ2V0VmFsdWVBdFRpbWUodGhpcy5ub3coKSl9fSkscy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmNvbnRleHQucmVzdW1lKCksdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9zdGF0ZS5nZXRWYWx1ZUF0VGltZSh0KSE9PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkJiYodGhpcy5fc3RhdGUuc2V0U3RhdGVBdFRpbWUocy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQsdCksdGhpcy5fdGlja1NvdXJjZS5zdGFydCh0LGUpLHQ8dGhpcy5fbGFzdFVwZGF0ZSYmdGhpcy5lbWl0KFwic3RhcnRcIix0LGUpKSx0aGlzfSxzLmRlZmF1bHQuQ2xvY2sucHJvdG90eXBlLnN0b3A9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5fc3RhdGUuY2FuY2VsKHQpLHRoaXMuX3N0YXRlLnNldFN0YXRlQXRUaW1lKHMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkLHQpLHRoaXMuX3RpY2tTb3VyY2Uuc3RvcCh0KSx0PHRoaXMuX2xhc3RVcGRhdGUmJnRoaXMuZW1pdChcInN0b3BcIix0KSx0aGlzfSxzLmRlZmF1bHQuQ2xvY2sucHJvdG90eXBlLnBhdXNlPWZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHQpPT09cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQmJih0aGlzLl9zdGF0ZS5zZXRTdGF0ZUF0VGltZShzLmRlZmF1bHQuU3RhdGUuUGF1c2VkLHQpLHRoaXMuX3RpY2tTb3VyY2UucGF1c2UodCksdDx0aGlzLl9sYXN0VXBkYXRlJiZ0aGlzLmVtaXQoXCJwYXVzZVwiLHQpKSx0aGlzfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZSxcInRpY2tzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiBNYXRoLmNlaWwodGhpcy5nZXRUaWNrc0F0VGltZSh0aGlzLm5vdygpKSl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl90aWNrU291cmNlLnRpY2tzPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DbG9jay5wcm90b3R5cGUsXCJzZWNvbmRzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl90aWNrU291cmNlLnNlY29uZHN9LHNldDpmdW5jdGlvbih0KXt0aGlzLl90aWNrU291cmNlLnNlY29uZHM9dH19KSxzLmRlZmF1bHQuQ2xvY2sucHJvdG90eXBlLmdldFNlY29uZHNBdFRpbWU9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3RpY2tTb3VyY2UuZ2V0U2Vjb25kc0F0VGltZSh0KX0scy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZS5zZXRUaWNrc0F0VGltZT1mdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLl90aWNrU291cmNlLnNldFRpY2tzQXRUaW1lKHQsZSksdGhpc30scy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZS5nZXRUaWNrc0F0VGltZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fdGlja1NvdXJjZS5nZXRUaWNrc0F0VGltZSh0KX0scy5kZWZhdWx0LkNsb2NrLnByb3RvdHlwZS5uZXh0VGlja1RpbWU9ZnVuY3Rpb24odCxlKXtlPXRoaXMudG9TZWNvbmRzKGUpO3ZhciBpPXRoaXMuZ2V0VGlja3NBdFRpbWUoZSk7cmV0dXJuIHRoaXMuX3RpY2tTb3VyY2UuZ2V0VGltZU9mVGljayhpK3QsZSl9LHMuZGVmYXVsdC5DbG9jay5wcm90b3R5cGUuX2xvb3A9ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9sYXN0VXBkYXRlLGU9dGhpcy5ub3coKTt0aGlzLl9sYXN0VXBkYXRlPWUsdCE9PWUmJih0aGlzLl9zdGF0ZS5mb3JFYWNoQmV0d2Vlbih0LGUsZnVuY3Rpb24odCl7c3dpdGNoKHQuc3RhdGUpe2Nhc2Ugcy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQ6dmFyIGU9dGhpcy5fdGlja1NvdXJjZS5nZXRUaWNrc0F0VGltZSh0LnRpbWUpO3RoaXMuZW1pdChcInN0YXJ0XCIsdC50aW1lLGUpO2JyZWFrO2Nhc2Ugcy5kZWZhdWx0LlN0YXRlLlN0b3BwZWQ6MCE9PXQudGltZSYmdGhpcy5lbWl0KFwic3RvcFwiLHQudGltZSk7YnJlYWs7Y2FzZSBzLmRlZmF1bHQuU3RhdGUuUGF1c2VkOnRoaXMuZW1pdChcInBhdXNlXCIsdC50aW1lKX19LmJpbmQodGhpcykpLHRoaXMuX3RpY2tTb3VyY2UuZm9yRWFjaFRpY2tCZXR3ZWVuKHQsZSxmdW5jdGlvbih0LGUpe3RoaXMuY2FsbGJhY2sodCxlKX0uYmluZCh0aGlzKSkpfSxzLmRlZmF1bHQuQ2xvY2sucHJvdG90eXBlLmdldFN0YXRlQXRUaW1lPWZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX3N0YXRlLmdldFZhbHVlQXRUaW1lKHQpfSxzLmRlZmF1bHQuQ2xvY2sucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuRW1pdHRlci5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuY29udGV4dC5vZmYoXCJ0aWNrXCIsdGhpcy5fYm91bmRMb29wKSx0aGlzLl93cml0YWJsZShcImZyZXF1ZW5jeVwiKSx0aGlzLl90aWNrU291cmNlLmRpc3Bvc2UoKSx0aGlzLl90aWNrU291cmNlPW51bGwsdGhpcy5mcmVxdWVuY3k9bnVsbCx0aGlzLl9ib3VuZExvb3A9bnVsbCx0aGlzLl9uZXh0VGljaz0xLzAsdGhpcy5jYWxsYmFjaz1udWxsLHRoaXMuX3N0YXRlLmRpc3Bvc2UoKSx0aGlzLl9zdGF0ZT1udWxsfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkNsb2NrfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyKSxpKDUpLGkoNyk7cy5kZWZhdWx0LkdyZWF0ZXJUaGFuWmVybz1mdW5jdGlvbigpe3MuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksdGhpcy5fdGhyZXNoPXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuV2F2ZVNoYXBlcihmdW5jdGlvbih0KXtyZXR1cm4gdDw9MD8wOjF9LDEyNyksdGhpcy5fc2NhbGU9dGhpcy5pbnB1dD1uZXcgcy5kZWZhdWx0Lk11bHRpcGx5KDFlNCksdGhpcy5fc2NhbGUuY29ubmVjdCh0aGlzLl90aHJlc2gpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5HcmVhdGVyVGhhblplcm8scy5kZWZhdWx0LlNpZ25hbEJhc2UpLHMuZGVmYXVsdC5HcmVhdGVyVGhhblplcm8ucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9zY2FsZS5kaXNwb3NlKCksdGhpcy5fc2NhbGU9bnVsbCx0aGlzLl90aHJlc2guZGlzcG9zZSgpLHRoaXMuX3RocmVzaD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuR3JlYXRlclRoYW5aZXJvfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg4NCksaSgxMyksaSgyKTtzLmRlZmF1bHQuR3JlYXRlclRoYW49ZnVuY3Rpb24odCl7cy5kZWZhdWx0LlNpZ25hbC5jYWxsKHRoaXMpLHRoaXMuY3JlYXRlSW5zT3V0cygyLDApLHRoaXMuX3BhcmFtPXRoaXMuaW5wdXRbMF09bmV3IHMuZGVmYXVsdC5TdWJ0cmFjdCh0KSx0aGlzLmlucHV0WzFdPXRoaXMuX3BhcmFtLmlucHV0WzFdLHRoaXMuX2d0ej10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LkdyZWF0ZXJUaGFuWmVybyx0aGlzLl9wYXJhbS5jb25uZWN0KHRoaXMuX2d0eil9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkdyZWF0ZXJUaGFuLHMuZGVmYXVsdC5TaWduYWwpLHMuZGVmYXVsdC5HcmVhdGVyVGhhbi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fZ3R6LmRpc3Bvc2UoKSx0aGlzLl9ndHo9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkdyZWF0ZXJUaGFufSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg0NyksaSgyNik7cy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJhdHRhY2tcIixcImRlY2F5XCIsXCJzdXN0YWluXCIsXCJyZWxlYXNlXCJdLHMuZGVmYXVsdC5FbnZlbG9wZSk7cy5kZWZhdWx0LkVudmVsb3BlLmNhbGwodGhpcyx0KSx0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQscy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlLmRlZmF1bHRzKSx0aGlzLl9leHA9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5Qb3codC5leHBvbmVudCksdGhpcy5fc2NhbGU9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5TY2FsZSh0Lm1pbix0Lm1heCksdGhpcy5fc2lnLmNoYWluKHRoaXMuX2V4cCx0aGlzLl9zY2FsZSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlLHMuZGVmYXVsdC5FbnZlbG9wZSkscy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlLmRlZmF1bHRzPXttaW46MCxtYXg6MSxleHBvbmVudDoxfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlNjYWxlZEVudmVsb3BlLnByb3RvdHlwZSxcIm1pblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2NhbGUubWlufSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fc2NhbGUubWluPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5TY2FsZWRFbnZlbG9wZS5wcm90b3R5cGUsXCJtYXhcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NjYWxlLm1heH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3NjYWxlLm1heD10fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU2NhbGVkRW52ZWxvcGUucHJvdG90eXBlLFwiZXhwb25lbnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2V4cC52YWx1ZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2V4cC52YWx1ZT10fX0pLHMuZGVmYXVsdC5TY2FsZWRFbnZlbG9wZS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuRW52ZWxvcGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9zY2FsZS5kaXNwb3NlKCksdGhpcy5fc2NhbGU9bnVsbCx0aGlzLl9leHAuZGlzcG9zZSgpLHRoaXMuX2V4cD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuU2NhbGVkRW52ZWxvcGV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDcpLGkoMzApO3MuZGVmYXVsdC5BYnM9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuU2lnbmFsQmFzZS5jYWxsKHRoaXMpLHRoaXMuX2Ficz10aGlzLmlucHV0PXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuV2F2ZVNoYXBlcihmdW5jdGlvbih0KXtyZXR1cm4gTWF0aC5hYnModCk8LjAwMT8wOk1hdGguYWJzKHQpfSwxMDI0KX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQWJzLHMuZGVmYXVsdC5TaWduYWxCYXNlKSxzLmRlZmF1bHQuQWJzLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fYWJzLmRpc3Bvc2UoKSx0aGlzLl9hYnM9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkFic30sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMyksaSgxKTtzLmRlZmF1bHQuU29sbz1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wic29sb1wiXSxzLmRlZmF1bHQuU29sbyk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuaW5wdXQ9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5HYWluLHRoaXMuX3NvbG9CaW5kPXRoaXMuX3NvbG9lZC5iaW5kKHRoaXMpLHRoaXMuY29udGV4dC5vbihcInNvbG9cIix0aGlzLl9zb2xvQmluZCksdGhpcy5zb2xvPXQuc29sb30scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU29sbyxzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuU29sby5kZWZhdWx0cz17c29sbzohMX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Tb2xvLnByb3RvdHlwZSxcInNvbG9cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lzU29sb2VkKCl9LHNldDpmdW5jdGlvbih0KXt0P3RoaXMuX2FkZFNvbG8oKTp0aGlzLl9yZW1vdmVTb2xvKCksdGhpcy5jb250ZXh0LmVtaXQoXCJzb2xvXCIsdGhpcyl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Tb2xvLnByb3RvdHlwZSxcIm11dGVkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiAwPT09dGhpcy5pbnB1dC5nYWluLnZhbHVlfX0pLHMuZGVmYXVsdC5Tb2xvLnByb3RvdHlwZS5fYWRkU29sbz1mdW5jdGlvbigpe3MuZGVmYXVsdC5pc0FycmF5KHRoaXMuY29udGV4dC5fY3VycmVudFNvbG8pfHwodGhpcy5jb250ZXh0Ll9jdXJyZW50U29sbz1bXSksdGhpcy5faXNTb2xvZWQoKXx8dGhpcy5jb250ZXh0Ll9jdXJyZW50U29sby5wdXNoKHRoaXMpfSxzLmRlZmF1bHQuU29sby5wcm90b3R5cGUuX3JlbW92ZVNvbG89ZnVuY3Rpb24oKXtpZih0aGlzLl9pc1NvbG9lZCgpKXt2YXIgdD10aGlzLmNvbnRleHQuX2N1cnJlbnRTb2xvLmluZGV4T2YodGhpcyk7dGhpcy5jb250ZXh0Ll9jdXJyZW50U29sby5zcGxpY2UodCwxKX19LHMuZGVmYXVsdC5Tb2xvLnByb3RvdHlwZS5faXNTb2xvZWQ9ZnVuY3Rpb24oKXtyZXR1cm4hIXMuZGVmYXVsdC5pc0FycmF5KHRoaXMuY29udGV4dC5fY3VycmVudFNvbG8pJiYoMCE9PXRoaXMuY29udGV4dC5fY3VycmVudFNvbG8ubGVuZ3RoJiYtMSE9PXRoaXMuY29udGV4dC5fY3VycmVudFNvbG8uaW5kZXhPZih0aGlzKSl9LHMuZGVmYXVsdC5Tb2xvLnByb3RvdHlwZS5fbm9Tb2xvcz1mdW5jdGlvbigpe3JldHVybiFzLmRlZmF1bHQuaXNBcnJheSh0aGlzLmNvbnRleHQuX2N1cnJlbnRTb2xvKXx8MD09PXRoaXMuY29udGV4dC5fY3VycmVudFNvbG8ubGVuZ3RofSxzLmRlZmF1bHQuU29sby5wcm90b3R5cGUuX3NvbG9lZD1mdW5jdGlvbigpe3RoaXMuX2lzU29sb2VkKCk/dGhpcy5pbnB1dC5nYWluLnZhbHVlPTE6dGhpcy5fbm9Tb2xvcygpP3RoaXMuaW5wdXQuZ2Fpbi52YWx1ZT0xOnRoaXMuaW5wdXQuZ2Fpbi52YWx1ZT0wfSxzLmRlZmF1bHQuU29sby5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbnRleHQub2ZmKFwic29sb1wiLHRoaXMuX3NvbG9CaW5kKSx0aGlzLl9yZW1vdmVTb2xvKCksdGhpcy5fc29sb0JpbmQ9bnVsbCxzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5Tb2xvfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg3KTtzLmRlZmF1bHQuRXF1YWxQb3dlckdhaW49ZnVuY3Rpb24oKXtzLmRlZmF1bHQuU2lnbmFsQmFzZS5jYWxsKHRoaXMpLHRoaXMuX2VxUG93ZXI9dGhpcy5pbnB1dD10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LldhdmVTaGFwZXIoZnVuY3Rpb24odCl7cmV0dXJuIE1hdGguYWJzKHQpPC4wMDE/MDpzLmRlZmF1bHQuZXF1YWxQb3dlclNjYWxlKHQpfS5iaW5kKHRoaXMpLDQwOTYpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5FcXVhbFBvd2VyR2FpbixzLmRlZmF1bHQuU2lnbmFsQmFzZSkscy5kZWZhdWx0LkVxdWFsUG93ZXJHYWluLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fZXFQb3dlci5kaXNwb3NlKCksdGhpcy5fZXFQb3dlcj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRXF1YWxQb3dlckdhaW59LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDUpLGkoMik7cy5kZWZhdWx0Lk5lZ2F0ZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksdGhpcy5fbXVsdGlwbHk9dGhpcy5pbnB1dD10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0Lk11bHRpcGx5KC0xKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTmVnYXRlLHMuZGVmYXVsdC5TaWduYWxCYXNlKSxzLmRlZmF1bHQuTmVnYXRlLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fbXVsdGlwbHkuZGlzcG9zZSgpLHRoaXMuX211bHRpcGx5PW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5OZWdhdGV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDQ4KSxpKDI3KSxpKDEpO3MuZGVmYXVsdC5QYW5Wb2w9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInBhblwiLFwidm9sdW1lXCJdLHMuZGVmYXVsdC5QYW5Wb2wpO3MuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSx0aGlzLl9wYW5uZXI9dGhpcy5pbnB1dD1uZXcgcy5kZWZhdWx0LlBhbm5lcih0LnBhbiksdGhpcy5wYW49dGhpcy5fcGFubmVyLnBhbix0aGlzLl92b2x1bWU9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5Wb2x1bWUodC52b2x1bWUpLHRoaXMudm9sdW1lPXRoaXMuX3ZvbHVtZS52b2x1bWUsdGhpcy5fcGFubmVyLmNvbm5lY3QodGhpcy5fdm9sdW1lKSx0aGlzLm11dGU9dC5tdXRlLHRoaXMuX3JlYWRPbmx5KFtcInBhblwiLFwidm9sdW1lXCJdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUGFuVm9sLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5QYW5Wb2wuZGVmYXVsdHM9e3BhbjowLHZvbHVtZTowLG11dGU6ITF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFuVm9sLnByb3RvdHlwZSxcIm11dGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3ZvbHVtZS5tdXRlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fdm9sdW1lLm11dGU9dH19KSxzLmRlZmF1bHQuUGFuVm9sLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJwYW5cIixcInZvbHVtZVwiXSksdGhpcy5fcGFubmVyLmRpc3Bvc2UoKSx0aGlzLl9wYW5uZXI9bnVsbCx0aGlzLnBhbj1udWxsLHRoaXMuX3ZvbHVtZS5kaXNwb3NlKCksdGhpcy5fdm9sdW1lPW51bGwsdGhpcy52b2x1bWU9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlBhblZvbH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO3ZhciBzPWkoMCk7aWYocy5kZWZhdWx0LnN1cHBvcnRlZCl7IXMuZGVmYXVsdC5nbG9iYWwuaGFzT3duUHJvcGVydHkoXCJPZmZsaW5lQXVkaW9Db250ZXh0XCIpJiZzLmRlZmF1bHQuZ2xvYmFsLmhhc093blByb3BlcnR5KFwid2Via2l0T2ZmbGluZUF1ZGlvQ29udGV4dFwiKSYmKHMuZGVmYXVsdC5nbG9iYWwuT2ZmbGluZUF1ZGlvQ29udGV4dD1zLmRlZmF1bHQuZ2xvYmFsLndlYmtpdE9mZmxpbmVBdWRpb0NvbnRleHQpO3ZhciBuPW5ldyBPZmZsaW5lQXVkaW9Db250ZXh0KDEsMSw0NDEwMCkuc3RhcnRSZW5kZXJpbmcoKTtuJiZzLmRlZmF1bHQuaXNGdW5jdGlvbihuLnRoZW4pfHwoT2ZmbGluZUF1ZGlvQ29udGV4dC5wcm90b3R5cGUuX25hdGl2ZV9zdGFydFJlbmRlcmluZz1PZmZsaW5lQXVkaW9Db250ZXh0LnByb3RvdHlwZS5zdGFydFJlbmRlcmluZyxPZmZsaW5lQXVkaW9Db250ZXh0LnByb3RvdHlwZS5zdGFydFJlbmRlcmluZz1mdW5jdGlvbigpe3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbih0KXt0aGlzLm9uY29tcGxldGU9ZnVuY3Rpb24oZSl7dChlLnJlbmRlcmVkQnVmZmVyKX0sdGhpcy5fbmF0aXZlX3N0YXJ0UmVuZGVyaW5nKCl9LmJpbmQodGhpcykpfSl9fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7ZS5hPVwiZGV2XCJ9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDQ2KTtzLmRlZmF1bHQuTWlkaT1mdW5jdGlvbih0LGUpe2lmKCEodGhpcyBpbnN0YW5jZW9mIHMuZGVmYXVsdC5NaWRpKSlyZXR1cm4gbmV3IHMuZGVmYXVsdC5NaWRpKHQsZSk7cy5kZWZhdWx0LkZyZXF1ZW5jeS5jYWxsKHRoaXMsdCxlKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTWlkaSxzLmRlZmF1bHQuRnJlcXVlbmN5KSxzLmRlZmF1bHQuTWlkaS5wcm90b3R5cGUuX2RlZmF1bHRVbml0cz1cIm1pZGlcIixzLmRlZmF1bHQuTWlkaS5wcm90b3R5cGUuX2ZyZXF1ZW5jeVRvVW5pdHM9ZnVuY3Rpb24odCl7cmV0dXJuIHMuZGVmYXVsdC5GcmVxdWVuY3kuZnRvbShzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS5fZnJlcXVlbmN5VG9Vbml0cy5jYWxsKHRoaXMsdCkpfSxzLmRlZmF1bHQuTWlkaS5wcm90b3R5cGUuX3RpY2tzVG9Vbml0cz1mdW5jdGlvbih0KXtyZXR1cm4gcy5kZWZhdWx0LkZyZXF1ZW5jeS5mdG9tKHMuZGVmYXVsdC5GcmVxdWVuY3kucHJvdG90eXBlLl90aWNrc1RvVW5pdHMuY2FsbCh0aGlzLHQpKX0scy5kZWZhdWx0Lk1pZGkucHJvdG90eXBlLl9iZWF0c1RvVW5pdHM9ZnVuY3Rpb24odCl7cmV0dXJuIHMuZGVmYXVsdC5GcmVxdWVuY3kuZnRvbShzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS5fYmVhdHNUb1VuaXRzLmNhbGwodGhpcyx0KSl9LHMuZGVmYXVsdC5NaWRpLnByb3RvdHlwZS5fc2Vjb25kc1RvVW5pdHM9ZnVuY3Rpb24odCl7cmV0dXJuIHMuZGVmYXVsdC5GcmVxdWVuY3kuZnRvbShzLmRlZmF1bHQuRnJlcXVlbmN5LnByb3RvdHlwZS5fc2Vjb25kc1RvVW5pdHMuY2FsbCh0aGlzLHQpKX0scy5kZWZhdWx0Lk1pZGkucHJvdG90eXBlLnRvTWlkaT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnZhbHVlT2YoKX0scy5kZWZhdWx0Lk1pZGkucHJvdG90eXBlLnRvRnJlcXVlbmN5PWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5GcmVxdWVuY3kubXRvZih0aGlzLnRvTWlkaSgpKX0scy5kZWZhdWx0Lk1pZGkucHJvdG90eXBlLnRyYW5zcG9zZT1mdW5jdGlvbih0KXtyZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy50b01pZGkoKSt0KX0sZS5kZWZhdWx0PXMuZGVmYXVsdC5NaWRpfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyNyksaSgxKTtzLmRlZmF1bHQuVXNlck1lZGlhPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJ2b2x1bWVcIl0scy5kZWZhdWx0LlVzZXJNZWRpYSk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuX21lZGlhU3RyZWFtPW51bGwsdGhpcy5fc3RyZWFtPW51bGwsdGhpcy5fZGV2aWNlPW51bGwsdGhpcy5fdm9sdW1lPXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuVm9sdW1lKHQudm9sdW1lKSx0aGlzLnZvbHVtZT10aGlzLl92b2x1bWUudm9sdW1lLHRoaXMuX3JlYWRPbmx5KFwidm9sdW1lXCIpLHRoaXMubXV0ZT10Lm11dGV9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlVzZXJNZWRpYSxzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuVXNlck1lZGlhLmRlZmF1bHRzPXt2b2x1bWU6MCxtdXRlOiExfSxzLmRlZmF1bHQuVXNlck1lZGlhLnByb3RvdHlwZS5vcGVuPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLnN0YXRlPT09cy5kZWZhdWx0LlN0YXRlLlN0YXJ0ZWQmJnRoaXMuY2xvc2UoKSxzLmRlZmF1bHQuVXNlck1lZGlhLmVudW1lcmF0ZURldmljZXMoKS50aGVuKGZ1bmN0aW9uKGUpe3ZhciBpO2lmKHMuZGVmYXVsdC5pc051bWJlcih0KSlpPWVbdF07ZWxzZSBpZighKGk9ZS5maW5kKGZ1bmN0aW9uKGUpe3JldHVybiBlLmxhYmVsPT09dHx8ZS5kZXZpY2VJZD09PXR9KSkmJmUubGVuZ3RoPjApaT1lWzBdO2Vsc2UgaWYoIWkmJnMuZGVmYXVsdC5pc0RlZmluZWQodCkpdGhyb3cgbmV3IEVycm9yKFwiVG9uZS5Vc2VyTWVkaWE6IG5vIG1hdGNoaW5nIGRldmljZTogXCIrdCk7dGhpcy5fZGV2aWNlPWk7dmFyIG49e2F1ZGlvOntlY2hvQ2FuY2VsbGF0aW9uOiExLHNhbXBsZVJhdGU6dGhpcy5jb250ZXh0LnNhbXBsZVJhdGUsbm9pc2VTdXBwcmVzc2lvbjohMSxtb3pOb2lzZVN1cHByZXNzaW9uOiExfX07cmV0dXJuIGkmJihuLmF1ZGlvLmRldmljZUlkPWkuZGV2aWNlSWQpLG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKG4pLnRoZW4oZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX3N0cmVhbXx8KHRoaXMuX3N0cmVhbT10LHRoaXMuX21lZGlhU3RyZWFtPXRoaXMuY29udGV4dC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZSh0KSxzLmRlZmF1bHQuY29ubmVjdCh0aGlzLl9tZWRpYVN0cmVhbSx0aGlzLm91dHB1dCkpLHRoaXN9LmJpbmQodGhpcykpfS5iaW5kKHRoaXMpKX0scy5kZWZhdWx0LlVzZXJNZWRpYS5wcm90b3R5cGUuY2xvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RyZWFtJiYodGhpcy5fc3RyZWFtLmdldEF1ZGlvVHJhY2tzKCkuZm9yRWFjaChmdW5jdGlvbih0KXt0LnN0b3AoKX0pLHRoaXMuX3N0cmVhbT1udWxsLHRoaXMuX21lZGlhU3RyZWFtLmRpc2Nvbm5lY3QoKSx0aGlzLl9tZWRpYVN0cmVhbT1udWxsKSx0aGlzLl9kZXZpY2U9bnVsbCx0aGlzfSxzLmRlZmF1bHQuVXNlck1lZGlhLmVudW1lcmF0ZURldmljZXM9ZnVuY3Rpb24oKXtyZXR1cm4gbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5lbnVtZXJhdGVEZXZpY2VzKCkudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gdC5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuXCJhdWRpb2lucHV0XCI9PT10LmtpbmR9KX0pfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlVzZXJNZWRpYS5wcm90b3R5cGUsXCJzdGF0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3RyZWFtJiZ0aGlzLl9zdHJlYW0uYWN0aXZlP3MuZGVmYXVsdC5TdGF0ZS5TdGFydGVkOnMuZGVmYXVsdC5TdGF0ZS5TdG9wcGVkfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVXNlck1lZGlhLnByb3RvdHlwZSxcImRldmljZUlkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9kZXZpY2U/dGhpcy5fZGV2aWNlLmRldmljZUlkOm51bGx9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Vc2VyTWVkaWEucHJvdG90eXBlLFwiZ3JvdXBJZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGV2aWNlP3RoaXMuX2RldmljZS5ncm91cElkOm51bGx9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5Vc2VyTWVkaWEucHJvdG90eXBlLFwibGFiZWxcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RldmljZT90aGlzLl9kZXZpY2UubGFiZWw6bnVsbH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlVzZXJNZWRpYS5wcm90b3R5cGUsXCJtdXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl92b2x1bWUubXV0ZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3ZvbHVtZS5tdXRlPXR9fSkscy5kZWZhdWx0LlVzZXJNZWRpYS5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5jbG9zZSgpLHRoaXMuX3dyaXRhYmxlKFwidm9sdW1lXCIpLHRoaXMuX3ZvbHVtZS5kaXNwb3NlKCksdGhpcy5fdm9sdW1lPW51bGwsdGhpcy52b2x1bWU9bnVsbCx0aGlzfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlVzZXJNZWRpYSxcInN1cHBvcnRlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LmlzRGVmaW5lZChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzKSYmcy5kZWZhdWx0LmlzRnVuY3Rpb24obmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEpfX0pLGUuZGVmYXVsdD1zLmRlZmF1bHQuVXNlck1lZGlhfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg2NCksaSgyNyksaSgxKTtzLmRlZmF1bHQuUGxheWVycz1mdW5jdGlvbih0KXt2YXIgZT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO2Uuc2hpZnQoKTt2YXIgaT1zLmRlZmF1bHQuZGVmYXVsdHMoZSxbXCJvbmxvYWRcIl0scy5kZWZhdWx0LlBsYXllcnMpO2Zvcih2YXIgbiBpbiBzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyxpKSx0aGlzLl92b2x1bWU9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5Wb2x1bWUoaS52b2x1bWUpLHRoaXMudm9sdW1lPXRoaXMuX3ZvbHVtZS52b2x1bWUsdGhpcy5fcmVhZE9ubHkoXCJ2b2x1bWVcIiksdGhpcy5fdm9sdW1lLm91dHB1dC5vdXRwdXQuY2hhbm5lbENvdW50PTIsdGhpcy5fdm9sdW1lLm91dHB1dC5vdXRwdXQuY2hhbm5lbENvdW50TW9kZT1cImV4cGxpY2l0XCIsdGhpcy5tdXRlPWkubXV0ZSx0aGlzLl9wbGF5ZXJzPXt9LHRoaXMuX2xvYWRpbmdDb3VudD0wLHRoaXMuX2ZhZGVJbj1pLmZhZGVJbix0aGlzLl9mYWRlT3V0PWkuZmFkZU91dCx0KXRoaXMuX2xvYWRpbmdDb3VudCsrLHRoaXMuYWRkKG4sdFtuXSx0aGlzLl9idWZmZXJMb2FkZWQuYmluZCh0aGlzLGkub25sb2FkKSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBsYXllcnMscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LlBsYXllcnMuZGVmYXVsdHM9e3ZvbHVtZTowLG11dGU6ITEsb25sb2FkOnMuZGVmYXVsdC5ub09wLGZhZGVJbjowLGZhZGVPdXQ6MH0scy5kZWZhdWx0LlBsYXllcnMucHJvdG90eXBlLl9idWZmZXJMb2FkZWQ9ZnVuY3Rpb24odCl7dGhpcy5fbG9hZGluZ0NvdW50LS0sMD09PXRoaXMuX2xvYWRpbmdDb3VudCYmdCYmdCh0aGlzKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QbGF5ZXJzLnByb3RvdHlwZSxcIm11dGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3ZvbHVtZS5tdXRlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fdm9sdW1lLm11dGU9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllcnMucHJvdG90eXBlLFwiZmFkZUluXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9mYWRlSW59LHNldDpmdW5jdGlvbih0KXt0aGlzLl9mYWRlSW49dCx0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKGUpe2UuZmFkZUluPXR9KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllcnMucHJvdG90eXBlLFwiZmFkZU91dFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZmFkZU91dH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2ZhZGVPdXQ9dCx0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKGUpe2UuZmFkZU91dD10fSl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QbGF5ZXJzLnByb3RvdHlwZSxcInN0YXRlXCIse2dldDpmdW5jdGlvbigpe3ZhciB0PSExO3JldHVybiB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKGUpe3Q9dHx8ZS5zdGF0ZT09PXMuZGVmYXVsdC5TdGF0ZS5TdGFydGVkfSksdD9zLmRlZmF1bHQuU3RhdGUuU3RhcnRlZDpzLmRlZmF1bHQuU3RhdGUuU3RvcHBlZH19KSxzLmRlZmF1bHQuUGxheWVycy5wcm90b3R5cGUuaGFzPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9wbGF5ZXJzLmhhc093blByb3BlcnR5KHQpfSxzLmRlZmF1bHQuUGxheWVycy5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKHQpe2lmKHRoaXMuaGFzKHQpKXJldHVybiB0aGlzLl9wbGF5ZXJzW3RdO3Rocm93IG5ldyBFcnJvcihcIlRvbmUuUGxheWVyczogbm8gcGxheWVyIG5hbWVkIFwiK3QpfSxzLmRlZmF1bHQuUGxheWVycy5wcm90b3R5cGUuX2ZvckVhY2g9ZnVuY3Rpb24odCl7Zm9yKHZhciBlIGluIHRoaXMuX3BsYXllcnMpdCh0aGlzLl9wbGF5ZXJzW2VdLGUpO3JldHVybiB0aGlzfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBsYXllcnMucHJvdG90eXBlLFwibG9hZGVkXCIse2dldDpmdW5jdGlvbigpe3ZhciB0PSEwO3JldHVybiB0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKGUpe3Q9dCYmZS5sb2FkZWR9KSx0fX0pLHMuZGVmYXVsdC5QbGF5ZXJzLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCxlLGkpe3JldHVybiB0aGlzLl9wbGF5ZXJzW3RdPW5ldyBzLmRlZmF1bHQuUGxheWVyKGUsaSkuY29ubmVjdCh0aGlzLm91dHB1dCksdGhpcy5fcGxheWVyc1t0XS5mYWRlSW49dGhpcy5fZmFkZUluLHRoaXMuX3BsYXllcnNbdF0uZmFkZU91dD10aGlzLl9mYWRlT3V0LHRoaXN9LHMuZGVmYXVsdC5QbGF5ZXJzLnByb3RvdHlwZS5zdG9wQWxsPWZ1bmN0aW9uKHQpe3RoaXMuX2ZvckVhY2goZnVuY3Rpb24oZSl7ZS5zdG9wKHQpfSl9LHMuZGVmYXVsdC5QbGF5ZXJzLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl92b2x1bWUuZGlzcG9zZSgpLHRoaXMuX3ZvbHVtZT1udWxsLHRoaXMuX3dyaXRhYmxlKFwidm9sdW1lXCIpLHRoaXMudm9sdW1lPW51bGwsdGhpcy5vdXRwdXQ9bnVsbCx0aGlzLl9mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuZGlzcG9zZSgpfSksdGhpcy5fcGxheWVycz1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuUGxheWVyc30sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNiksaSgxMSksaSgzMik7cy5kZWZhdWx0LkdyYWluUGxheWVyPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJ1cmxcIixcIm9ubG9hZFwiXSxzLmRlZmF1bHQuR3JhaW5QbGF5ZXIpO3MuZGVmYXVsdC5Tb3VyY2UuY2FsbCh0aGlzLHQpLHRoaXMuYnVmZmVyPW5ldyBzLmRlZmF1bHQuQnVmZmVyKHQudXJsLHQub25sb2FkLmJpbmQodm9pZCAwLHRoaXMpKSx0aGlzLl9jbG9jaz1uZXcgcy5kZWZhdWx0LkNsb2NrKHRoaXMuX3RpY2suYmluZCh0aGlzKSx0LmdyYWluU2l6ZSksdGhpcy5fbG9vcFN0YXJ0PTAsdGhpcy5fbG9vcEVuZD0wLHRoaXMuX2FjdGl2ZVNvdXJjZXM9W10sdGhpcy5fcGxheWJhY2tSYXRlPXQucGxheWJhY2tSYXRlLHRoaXMuX2dyYWluU2l6ZT10LmdyYWluU2l6ZSx0aGlzLl9vdmVybGFwPXQub3ZlcmxhcCx0aGlzLmRldHVuZT10LmRldHVuZSx0aGlzLm92ZXJsYXA9dC5vdmVybGFwLHRoaXMubG9vcD10Lmxvb3AsdGhpcy5wbGF5YmFja1JhdGU9dC5wbGF5YmFja1JhdGUsdGhpcy5ncmFpblNpemU9dC5ncmFpblNpemUsdGhpcy5sb29wU3RhcnQ9dC5sb29wU3RhcnQsdGhpcy5sb29wRW5kPXQubG9vcEVuZCx0aGlzLnJldmVyc2U9dC5yZXZlcnNlLHRoaXMuX2Nsb2NrLm9uKFwic3RvcFwiLHRoaXMuX29uc3RvcC5iaW5kKHRoaXMpKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuR3JhaW5QbGF5ZXIscy5kZWZhdWx0LlNvdXJjZSkscy5kZWZhdWx0LkdyYWluUGxheWVyLmRlZmF1bHRzPXtvbmxvYWQ6cy5kZWZhdWx0Lm5vT3Asb3ZlcmxhcDouMSxncmFpblNpemU6LjIscGxheWJhY2tSYXRlOjEsZGV0dW5lOjAsbG9vcDohMSxsb29wU3RhcnQ6MCxsb29wRW5kOjAscmV2ZXJzZTohMX0scy5kZWZhdWx0LkdyYWluUGxheWVyLnByb3RvdHlwZS5fc3RhcnQ9ZnVuY3Rpb24odCxlLGkpe2U9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwwKSxlPXRoaXMudG9TZWNvbmRzKGUpLHQ9dGhpcy50b1NlY29uZHModCksdGhpcy5fb2Zmc2V0PWUsdGhpcy5fY2xvY2suc3RhcnQodCksaSYmdGhpcy5zdG9wKHQrdGhpcy50b1NlY29uZHMoaSkpfSxzLmRlZmF1bHQuR3JhaW5QbGF5ZXIucHJvdG90eXBlLl9zdG9wPWZ1bmN0aW9uKHQpe3RoaXMuX2Nsb2NrLnN0b3AodCl9LHMuZGVmYXVsdC5HcmFpblBsYXllci5wcm90b3R5cGUuX29uc3RvcD1mdW5jdGlvbih0KXt0aGlzLl9hY3RpdmVTb3VyY2VzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS5mYWRlT3V0PTAsZS5zdG9wKHQpfSl9LHMuZGVmYXVsdC5HcmFpblBsYXllci5wcm90b3R5cGUuX3RpY2s9ZnVuY3Rpb24odCl7aWYoIXRoaXMubG9vcCYmdGhpcy5fb2Zmc2V0PnRoaXMuYnVmZmVyLmR1cmF0aW9uKXRoaXMuc3RvcCh0KTtlbHNle3ZhciBlPXRoaXMuX29mZnNldDx0aGlzLl9vdmVybGFwPzA6dGhpcy5fb3ZlcmxhcCxpPW5ldyBzLmRlZmF1bHQuQnVmZmVyU291cmNlKHtidWZmZXI6dGhpcy5idWZmZXIsZmFkZUluOmUsZmFkZU91dDp0aGlzLl9vdmVybGFwLGxvb3A6dGhpcy5sb29wLGxvb3BTdGFydDp0aGlzLl9sb29wU3RhcnQsbG9vcEVuZDp0aGlzLl9sb29wRW5kLHBsYXliYWNrUmF0ZTpzLmRlZmF1bHQuaW50ZXJ2YWxUb0ZyZXF1ZW5jeVJhdGlvKHRoaXMuZGV0dW5lLzEwMCl9KS5jb25uZWN0KHRoaXMub3V0cHV0KTtpLnN0YXJ0KHQsdGhpcy5fb2Zmc2V0KSx0aGlzLl9vZmZzZXQrPXRoaXMuZ3JhaW5TaXplLGkuc3RvcCh0K3RoaXMuZ3JhaW5TaXplL3RoaXMucGxheWJhY2tSYXRlKSx0aGlzLl9hY3RpdmVTb3VyY2VzLnB1c2goaSksaS5vbmVuZGVkPWZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fYWN0aXZlU291cmNlcy5pbmRleE9mKGkpOy0xIT09dCYmdGhpcy5fYWN0aXZlU291cmNlcy5zcGxpY2UodCwxKX0uYmluZCh0aGlzKX19LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuR3JhaW5QbGF5ZXIucHJvdG90eXBlLFwicGxheWJhY2tSYXRlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wbGF5YmFja1JhdGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9wbGF5YmFja1JhdGU9dCx0aGlzLmdyYWluU2l6ZT10aGlzLl9ncmFpblNpemV9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5HcmFpblBsYXllci5wcm90b3R5cGUsXCJsb29wU3RhcnRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xvb3BTdGFydH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2xvb3BTdGFydD10aGlzLnRvU2Vjb25kcyh0KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkdyYWluUGxheWVyLnByb3RvdHlwZSxcImxvb3BFbmRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xvb3BFbmR9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9sb29wRW5kPXRoaXMudG9TZWNvbmRzKHQpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuR3JhaW5QbGF5ZXIucHJvdG90eXBlLFwicmV2ZXJzZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5idWZmZXIucmV2ZXJzZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuYnVmZmVyLnJldmVyc2U9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkdyYWluUGxheWVyLnByb3RvdHlwZSxcImdyYWluU2l6ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZ3JhaW5TaXplfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fZ3JhaW5TaXplPXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX2Nsb2NrLmZyZXF1ZW5jeS52YWx1ZT10aGlzLl9wbGF5YmFja1JhdGUvdGhpcy5fZ3JhaW5TaXplfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuR3JhaW5QbGF5ZXIucHJvdG90eXBlLFwib3ZlcmxhcFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3ZlcmxhcH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX292ZXJsYXA9dGhpcy50b1NlY29uZHModCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5HcmFpblBsYXllci5wcm90b3R5cGUsXCJsb2FkZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYnVmZmVyLmxvYWRlZH19KSxzLmRlZmF1bHQuR3JhaW5QbGF5ZXIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlNvdXJjZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuYnVmZmVyLmRpc3Bvc2UoKSx0aGlzLmJ1ZmZlcj1udWxsLHRoaXMuX2Nsb2NrLmRpc3Bvc2UoKSx0aGlzLl9jbG9jaz1udWxsLHRoaXMuX2FjdGl2ZVNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbih0KXt0LmRpc3Bvc2UoKX0pLHRoaXMuX2FjdGl2ZVNvdXJjZXM9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkdyYWluUGxheWVyfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgxNiksaSgyKSxpKDQ1KTtzLmRlZmF1bHQuVHJhbnNwb3J0VGltZWxpbmVTaWduYWw9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuU2lnbmFsLmFwcGx5KHRoaXMsYXJndW1lbnRzKSx0aGlzLm91dHB1dD10aGlzLl9vdXRwdXRTaWc9bmV3IHMuZGVmYXVsdC5TaWduYWwodGhpcy5faW5pdGlhbFZhbHVlKSx0aGlzLl9sYXN0VmFsPXRoaXMudmFsdWUsdGhpcy5fc3luY2VkPXMuZGVmYXVsdC5UcmFuc3BvcnQuc2NoZWR1bGVSZXBlYXQodGhpcy5fb25UaWNrLmJpbmQodGhpcyksXCIxaVwiKSx0aGlzLl9iaW5kQW5jaG9yVmFsdWU9dGhpcy5fYW5jaG9yVmFsdWUuYmluZCh0aGlzKSxzLmRlZmF1bHQuVHJhbnNwb3J0Lm9uKFwic3RhcnQgc3RvcCBwYXVzZVwiLHRoaXMuX2JpbmRBbmNob3JWYWx1ZSksdGhpcy5fZXZlbnRzLm1lbW9yeT0xLzB9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLHMuZGVmYXVsdC5TaWduYWwpLHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbC5wcm90b3R5cGUuX29uVGljaz1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFZhbHVlQXRUaW1lKHMuZGVmYXVsdC5UcmFuc3BvcnQuc2Vjb25kcyk7dGhpcy5fbGFzdFZhbCE9PWUmJih0aGlzLl9sYXN0VmFsPWUsdGhpcy5fb3V0cHV0U2lnLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lKGUsdCkpfSxzLmRlZmF1bHQuVHJhbnNwb3J0VGltZWxpbmVTaWduYWwucHJvdG90eXBlLl9hbmNob3JWYWx1ZT1mdW5jdGlvbih0KXt2YXIgZT10aGlzLmdldFZhbHVlQXRUaW1lKHMuZGVmYXVsdC5UcmFuc3BvcnQuc2Vjb25kcyk7cmV0dXJuIHRoaXMuX2xhc3RWYWw9ZSx0aGlzLl9vdXRwdXRTaWcuY2FuY2VsU2NoZWR1bGVkVmFsdWVzKHQpLHRoaXMuX291dHB1dFNpZy5zZXRWYWx1ZUF0VGltZShlLHQpLHRoaXN9LHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbC5wcm90b3R5cGUuZ2V0VmFsdWVBdFRpbWU9ZnVuY3Rpb24odCl7cmV0dXJuIHQ9cy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUodCkscy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUuZ2V0VmFsdWVBdFRpbWUuY2FsbCh0aGlzLHQpfSxzLmRlZmF1bHQuVHJhbnNwb3J0VGltZWxpbmVTaWduYWwucHJvdG90eXBlLnNldFZhbHVlQXRUaW1lPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGU9cy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUoZSkscy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUuc2V0VmFsdWVBdFRpbWUuY2FsbCh0aGlzLHQsZSksdGhpc30scy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLnByb3RvdHlwZS5saW5lYXJSYW1wVG9WYWx1ZUF0VGltZT1mdW5jdGlvbih0LGUpe3JldHVybiBlPXMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKGUpLHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmxpbmVhclJhbXBUb1ZhbHVlQXRUaW1lLmNhbGwodGhpcyx0LGUpLHRoaXN9LHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbC5wcm90b3R5cGUuZXhwb25lbnRpYWxSYW1wVG9WYWx1ZUF0VGltZT1mdW5jdGlvbih0LGUpe3JldHVybiBlPXMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKGUpLHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUuY2FsbCh0aGlzLHQsZSksdGhpc30scy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLnByb3RvdHlwZS5zZXRUYXJnZXRBdFRpbWU9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBlPXMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKGUpLHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLnNldFRhcmdldEF0VGltZS5jYWxsKHRoaXMsdCxlLGkpLHRoaXN9LHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbC5wcm90b3R5cGUuY2FuY2VsU2NoZWR1bGVkVmFsdWVzPWZ1bmN0aW9uKHQpe3JldHVybiB0PXMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKHQpLHMuZGVmYXVsdC5TaWduYWwucHJvdG90eXBlLmNhbmNlbFNjaGVkdWxlZFZhbHVlcy5jYWxsKHRoaXMsdCksdGhpc30scy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLnByb3RvdHlwZS5zZXRWYWx1ZUN1cnZlQXRUaW1lPWZ1bmN0aW9uKHQsZSxpLG4pe3JldHVybiBlPXMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lKGUpLGk9cy5kZWZhdWx0LlRyYW5zcG9ydFRpbWUoaSkscy5kZWZhdWx0LlNpZ25hbC5wcm90b3R5cGUuc2V0VmFsdWVDdXJ2ZUF0VGltZS5jYWxsKHRoaXMsdCxlLGksbiksdGhpc30scy5kZWZhdWx0LlRyYW5zcG9ydFRpbWVsaW5lU2lnbmFsLnByb3RvdHlwZS5jYW5jZWxBbmRIb2xkQXRUaW1lPWZ1bmN0aW9uKHQpe3JldHVybiBzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5jYW5jZWxBbmRIb2xkQXRUaW1lLmNhbGwodGhpcyxzLmRlZmF1bHQuVHJhbnNwb3J0VGltZSh0KSl9LHMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5UcmFuc3BvcnQuY2xlYXIodGhpcy5fc3luY2VkKSxzLmRlZmF1bHQuVHJhbnNwb3J0Lm9mZihcInN0YXJ0IHN0b3AgcGF1c2VcIix0aGlzLl9zeW5jZWRDYWxsYmFjayksdGhpcy5fZXZlbnRzLmNhbmNlbCgwKSxzLmRlZmF1bHQuU2lnbmFsLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fb3V0cHV0U2lnLmRpc3Bvc2UoKSx0aGlzLl9vdXRwdXRTaWc9bnVsbH0sZS5kZWZhdWx0PXMuZGVmYXVsdC5UcmFuc3BvcnRUaW1lbGluZVNpZ25hbH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMjkpLGkoNSk7cy5kZWZhdWx0Lk5vcm1hbGl6ZT1mdW5jdGlvbih0LGUpe3MuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksdGhpcy5faW5wdXRNaW49cy5kZWZhdWx0LmRlZmF1bHRBcmcodCwwKSx0aGlzLl9pbnB1dE1heD1zLmRlZmF1bHQuZGVmYXVsdEFyZyhlLDEpLHRoaXMuX3N1Yj10aGlzLmlucHV0PW5ldyBzLmRlZmF1bHQuQWRkKDApLHRoaXMuX2Rpdj10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0Lk11bHRpcGx5KDEpLHRoaXMuX3N1Yi5jb25uZWN0KHRoaXMuX2RpdiksdGhpcy5fc2V0UmFuZ2UoKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTm9ybWFsaXplLHMuZGVmYXVsdC5TaWduYWxCYXNlKSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk5vcm1hbGl6ZS5wcm90b3R5cGUsXCJtaW5cIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2lucHV0TWlufSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5faW5wdXRNaW49dCx0aGlzLl9zZXRSYW5nZSgpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTm9ybWFsaXplLnByb3RvdHlwZSxcIm1heFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5faW5wdXRNYXh9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9pbnB1dE1heD10LHRoaXMuX3NldFJhbmdlKCl9fSkscy5kZWZhdWx0Lk5vcm1hbGl6ZS5wcm90b3R5cGUuX3NldFJhbmdlPWZ1bmN0aW9uKCl7dGhpcy5fc3ViLnZhbHVlPS10aGlzLl9pbnB1dE1pbix0aGlzLl9kaXYudmFsdWU9MS8odGhpcy5faW5wdXRNYXgtdGhpcy5faW5wdXRNaW4pfSxzLmRlZmF1bHQuTm9ybWFsaXplLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5TaWduYWxCYXNlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fc3ViLmRpc3Bvc2UoKSx0aGlzLl9zdWI9bnVsbCx0aGlzLl9kaXYuZGlzcG9zZSgpLHRoaXMuX2Rpdj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuTm9ybWFsaXplfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg3KSxpKDIpO3MuZGVmYXVsdC5HYWluVG9BdWRpbz1mdW5jdGlvbigpe3MuZGVmYXVsdC5TaWduYWxCYXNlLmNhbGwodGhpcyksdGhpcy5fbm9ybT10aGlzLmlucHV0PXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuV2F2ZVNoYXBlcihmdW5jdGlvbih0KXtyZXR1cm4gMipNYXRoLmFicyh0KS0xfSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkdhaW5Ub0F1ZGlvLHMuZGVmYXVsdC5TaWduYWxCYXNlKSxzLmRlZmF1bHQuR2FpblRvQXVkaW8ucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlNpZ25hbEJhc2UucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9ub3JtLmRpc3Bvc2UoKSx0aGlzLl9ub3JtPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5HYWluVG9BdWRpb30sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMjEpLGkoNzcpLGkoMzIpO3MuZGVmYXVsdC5TYW1wbGVyPWZ1bmN0aW9uKHQpe3ZhciBlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7ZS5zaGlmdCgpO3ZhciBpPXMuZGVmYXVsdC5kZWZhdWx0cyhlLFtcIm9ubG9hZFwiLFwiYmFzZVVybFwiXSxzLmRlZmF1bHQuU2FtcGxlcik7cy5kZWZhdWx0Lkluc3RydW1lbnQuY2FsbCh0aGlzLGkpO3ZhciBuPXt9O2Zvcih2YXIgbyBpbiB0KWlmKHMuZGVmYXVsdC5pc05vdGUobykpe25bcy5kZWZhdWx0LkZyZXF1ZW5jeShvKS50b01pZGkoKV09dFtvXX1lbHNle2lmKGlzTmFOKHBhcnNlRmxvYXQobykpKXRocm93IG5ldyBFcnJvcihcIlRvbmUuU2FtcGxlcjogdXJsIGtleXMgbXVzdCBiZSB0aGUgbm90ZSdzIHBpdGNoXCIpO25bb109dFtvXX10aGlzLl9idWZmZXJzPW5ldyBzLmRlZmF1bHQuQnVmZmVycyhuLGkub25sb2FkLGkuYmFzZVVybCksdGhpcy5fYWN0aXZlU291cmNlcz17fSx0aGlzLmF0dGFjaz1pLmF0dGFjayx0aGlzLnJlbGVhc2U9aS5yZWxlYXNlLHRoaXMuY3VydmU9aS5jdXJ2ZX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuU2FtcGxlcixzLmRlZmF1bHQuSW5zdHJ1bWVudCkscy5kZWZhdWx0LlNhbXBsZXIuZGVmYXVsdHM9e2F0dGFjazowLHJlbGVhc2U6LjEsb25sb2FkOnMuZGVmYXVsdC5ub09wLGJhc2VVcmw6XCJcIixjdXJ2ZTpcImV4cG9uZW50aWFsXCJ9LHMuZGVmYXVsdC5TYW1wbGVyLnByb3RvdHlwZS5fZmluZENsb3Nlc3Q9ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7ZTw5Njspe2lmKHRoaXMuX2J1ZmZlcnMuaGFzKHQrZSkpcmV0dXJuLWU7aWYodGhpcy5fYnVmZmVycy5oYXModC1lKSlyZXR1cm4gZTtlKyt9dGhyb3cgbmV3IEVycm9yKFwiTm8gYXZhaWxhYmxlIGJ1ZmZlcnMgZm9yIG5vdGU6IFwiK3QpfSxzLmRlZmF1bHQuU2FtcGxlci5wcm90b3R5cGUudHJpZ2dlckF0dGFjaz1mdW5jdGlvbih0LGUsaSl7dGhpcy5sb2coXCJ0cmlnZ2VyQXR0YWNrXCIsdCxlLGkpLEFycmF5LmlzQXJyYXkodCl8fCh0PVt0XSk7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciBvPXMuZGVmYXVsdC5GcmVxdWVuY3kodFtuXSkudG9NaWRpKCksYT10aGlzLl9maW5kQ2xvc2VzdChvKSxyPW8tYSxsPXRoaXMuX2J1ZmZlcnMuZ2V0KHIpLHU9cy5kZWZhdWx0LmludGVydmFsVG9GcmVxdWVuY3lSYXRpbyhhKSxmPW5ldyBzLmRlZmF1bHQuQnVmZmVyU291cmNlKHtidWZmZXI6bCxwbGF5YmFja1JhdGU6dSxmYWRlSW46dGhpcy5hdHRhY2ssZmFkZU91dDp0aGlzLnJlbGVhc2UsY3VydmU6dGhpcy5jdXJ2ZX0pLmNvbm5lY3QodGhpcy5vdXRwdXQpO2Yuc3RhcnQoZSwwLGwuZHVyYXRpb24vdSxpKSxzLmRlZmF1bHQuaXNBcnJheSh0aGlzLl9hY3RpdmVTb3VyY2VzW29dKXx8KHRoaXMuX2FjdGl2ZVNvdXJjZXNbb109W10pLHRoaXMuX2FjdGl2ZVNvdXJjZXNbb10ucHVzaChmKSxmLm9uZW5kZWQ9ZnVuY3Rpb24oKXtpZih0aGlzLl9hY3RpdmVTb3VyY2VzJiZ0aGlzLl9hY3RpdmVTb3VyY2VzW29dKXt2YXIgdD10aGlzLl9hY3RpdmVTb3VyY2VzW29dLmluZGV4T2YoZik7LTEhPT10JiZ0aGlzLl9hY3RpdmVTb3VyY2VzW29dLnNwbGljZSh0LDEpfX0uYmluZCh0aGlzKX1yZXR1cm4gdGhpc30scy5kZWZhdWx0LlNhbXBsZXIucHJvdG90eXBlLnRyaWdnZXJSZWxlYXNlPWZ1bmN0aW9uKHQsZSl7dGhpcy5sb2coXCJ0cmlnZ2VyUmVsZWFzZVwiLHQsZSksQXJyYXkuaXNBcnJheSh0KXx8KHQ9W3RdKTtmb3IodmFyIGk9MDtpPHQubGVuZ3RoO2krKyl7dmFyIG49cy5kZWZhdWx0LkZyZXF1ZW5jeSh0W2ldKS50b01pZGkoKTt0aGlzLl9hY3RpdmVTb3VyY2VzW25dJiZ0aGlzLl9hY3RpdmVTb3VyY2VzW25dLmxlbmd0aCYmKGU9dGhpcy50b1NlY29uZHMoZSksdGhpcy5fYWN0aXZlU291cmNlc1tuXS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3Quc3RvcChlKX0pLHRoaXMuX2FjdGl2ZVNvdXJjZXNbbl09W10pfXJldHVybiB0aGlzfSxzLmRlZmF1bHQuU2FtcGxlci5wcm90b3R5cGUucmVsZWFzZUFsbD1mdW5jdGlvbih0KXtmb3IodmFyIGUgaW4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9hY3RpdmVTb3VyY2VzKWZvcih2YXIgaT10aGlzLl9hY3RpdmVTb3VyY2VzW2VdO2kubGVuZ3RoOyl7aS5zaGlmdCgpLnN0b3AodCl9cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5TYW1wbGVyLnByb3RvdHlwZS5zeW5jPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3N5bmNNZXRob2QoXCJ0cmlnZ2VyQXR0YWNrXCIsMSksdGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJSZWxlYXNlXCIsMSksdGhpc30scy5kZWZhdWx0LlNhbXBsZXIucHJvdG90eXBlLnRyaWdnZXJBdHRhY2tSZWxlYXNlPWZ1bmN0aW9uKHQsZSxpLG4pe2lmKGk9dGhpcy50b1NlY29uZHMoaSksdGhpcy50cmlnZ2VyQXR0YWNrKHQsaSxuKSxzLmRlZmF1bHQuaXNBcnJheShlKSYmcy5kZWZhdWx0LmlzQXJyYXkodCkpZm9yKHZhciBvPTA7bzx0Lmxlbmd0aDtvKyspe3ZhciBhPWVbTWF0aC5taW4obyxlLmxlbmd0aC0xKV07dGhpcy50cmlnZ2VyUmVsZWFzZSh0W29dLGkrdGhpcy50b1NlY29uZHMoYSkpfWVsc2UgdGhpcy50cmlnZ2VyUmVsZWFzZSh0LGkrdGhpcy50b1NlY29uZHMoZSkpO3JldHVybiB0aGlzfSxzLmRlZmF1bHQuU2FtcGxlci5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKHQsZSxpKXtpZihzLmRlZmF1bHQuaXNOb3RlKHQpKXt2YXIgbj1zLmRlZmF1bHQuRnJlcXVlbmN5KHQpLnRvTWlkaSgpO3RoaXMuX2J1ZmZlcnMuYWRkKG4sZSxpKX1lbHNle2lmKGlzTmFOKHBhcnNlRmxvYXQodCkpKXRocm93IG5ldyBFcnJvcihcIlRvbmUuU2FtcGxlcjogbm90ZSBtdXN0IGJlIHRoZSBub3RlJ3MgcGl0Y2guIEluc3RlYWQgZ290IFwiK3QpO3RoaXMuX2J1ZmZlcnMuYWRkKHQsZSxpKX19LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuU2FtcGxlci5wcm90b3R5cGUsXCJsb2FkZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2J1ZmZlcnMubG9hZGVkfX0pLHMuZGVmYXVsdC5TYW1wbGVyLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7Zm9yKHZhciB0IGluIHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fYnVmZmVycy5kaXNwb3NlKCksdGhpcy5fYnVmZmVycz1udWxsLHRoaXMuX2FjdGl2ZVNvdXJjZXMpdGhpcy5fYWN0aXZlU291cmNlc1t0XS5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuZGlzcG9zZSgpfSk7cmV0dXJuIHRoaXMuX2FjdGl2ZVNvdXJjZXM9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlNhbXBsZXJ9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDM4KSxpKDYpO3MuZGVmYXVsdC5Qb2x5U3ludGg9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInBvbHlwaG9ueVwiLFwidm9pY2VcIl0scy5kZWZhdWx0LlBvbHlTeW50aCk7cy5kZWZhdWx0Lkluc3RydW1lbnQuY2FsbCh0aGlzLHQpLCh0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQscy5kZWZhdWx0Lkluc3RydW1lbnQuZGVmYXVsdHMpKS5wb2x5cGhvbnk9TWF0aC5taW4ocy5kZWZhdWx0LlBvbHlTeW50aC5NQVhfUE9MWVBIT05ZLHQucG9seXBob255KSx0aGlzLnZvaWNlcz1uZXcgQXJyYXkodC5wb2x5cGhvbnkpLHRoaXMuYXNzZXJ0KHQucG9seXBob255PjAsXCJwb2x5cGhvbnkgbXVzdCBiZSBncmVhdGVyIHRoYW4gMFwiKSx0aGlzLmRldHVuZT1uZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmRldHVuZSxzLmRlZmF1bHQuVHlwZS5DZW50cyksdGhpcy5fcmVhZE9ubHkoXCJkZXR1bmVcIik7Zm9yKHZhciBlPTA7ZTx0LnBvbHlwaG9ueTtlKyspe3ZhciBpPW5ldyB0LnZvaWNlKGFyZ3VtZW50c1syXSxhcmd1bWVudHNbM10pO2lmKCEoaSBpbnN0YW5jZW9mIHMuZGVmYXVsdC5Nb25vcGhvbmljKSl0aHJvdyBuZXcgRXJyb3IoXCJTeW50aCBjb25zdHJ1Y3RvciBtdXN0IGJlIGluc3RhbmNlIG9mIFRvbmUuTW9ub3Bob25pY1wiKTt0aGlzLnZvaWNlc1tlXT1pLGkuaW5kZXg9ZSxpLmNvbm5lY3QodGhpcy5vdXRwdXQpLGkuaGFzT3duUHJvcGVydHkoXCJkZXR1bmVcIikmJnRoaXMuZGV0dW5lLmNvbm5lY3QoaS5kZXR1bmUpfX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUG9seVN5bnRoLHMuZGVmYXVsdC5JbnN0cnVtZW50KSxzLmRlZmF1bHQuUG9seVN5bnRoLmRlZmF1bHRzPXtwb2x5cGhvbnk6NCx2b2x1bWU6MCxkZXR1bmU6MCx2b2ljZTpzLmRlZmF1bHQuU3ludGh9LHMuZGVmYXVsdC5Qb2x5U3ludGgucHJvdG90eXBlLl9nZXRDbG9zZXN0Vm9pY2U9ZnVuY3Rpb24odCxlKXt2YXIgaT10aGlzLnZvaWNlcy5maW5kKGZ1bmN0aW9uKGkpe2lmKE1hdGguYWJzKGkuZnJlcXVlbmN5LmdldFZhbHVlQXRUaW1lKHQpLXMuZGVmYXVsdC5GcmVxdWVuY3koZSkpPDFlLTQmJmkuZ2V0TGV2ZWxBdFRpbWUodCk+MWUtNSlyZXR1cm4gaX0pO3JldHVybiBpfHx0aGlzLnZvaWNlcy5zbGljZSgpLnNvcnQoZnVuY3Rpb24oZSxpKXt2YXIgcz1lLmdldExldmVsQXRUaW1lKHQrdGhpcy5ibG9ja1RpbWUpLG49aS5nZXRMZXZlbEF0VGltZSh0K3RoaXMuYmxvY2tUaW1lKTtyZXR1cm4gczwxZS01JiYocz0wKSxuPDFlLTUmJihuPTApLHMtbn0uYmluZCh0aGlzKSlbMF19LHMuZGVmYXVsdC5Qb2x5U3ludGgucHJvdG90eXBlLnRyaWdnZXJBdHRhY2s9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBBcnJheS5pc0FycmF5KHQpfHwodD1bdF0pLGU9dGhpcy50b1NlY29uZHMoZSksdC5mb3JFYWNoKGZ1bmN0aW9uKHQpe3ZhciBzPXRoaXMuX2dldENsb3Nlc3RWb2ljZShlLHQpO3MudHJpZ2dlckF0dGFjayh0LGUsaSksdGhpcy5sb2coXCJ0cmlnZ2VyQXR0YWNrXCIscy5pbmRleCx0KX0uYmluZCh0aGlzKSksdGhpc30scy5kZWZhdWx0LlBvbHlTeW50aC5wcm90b3R5cGUudHJpZ2dlclJlbGVhc2U9ZnVuY3Rpb24odCxlKXtyZXR1cm4gQXJyYXkuaXNBcnJheSh0KXx8KHQ9W3RdKSxlPXRoaXMudG9TZWNvbmRzKGUpLHQuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgaT10aGlzLl9nZXRDbG9zZXN0Vm9pY2UoZSx0KTt0aGlzLmxvZyhcInRyaWdnZXJSZWxlYXNlXCIsaS5pbmRleCx0KSxpLnRyaWdnZXJSZWxlYXNlKGUpfS5iaW5kKHRoaXMpKSx0aGlzfSxzLmRlZmF1bHQuUG9seVN5bnRoLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrUmVsZWFzZT1mdW5jdGlvbih0LGUsaSxuKXtpZihpPXRoaXMudG9TZWNvbmRzKGkpLHRoaXMudHJpZ2dlckF0dGFjayh0LGksbikscy5kZWZhdWx0LmlzQXJyYXkoZSkmJnMuZGVmYXVsdC5pc0FycmF5KHQpKWZvcih2YXIgbz0wO288dC5sZW5ndGg7bysrKXt2YXIgYT1lW01hdGgubWluKG8sZS5sZW5ndGgtMSldO3RoaXMudHJpZ2dlclJlbGVhc2UodFtvXSxpK3RoaXMudG9TZWNvbmRzKGEpKX1lbHNlIHRoaXMudHJpZ2dlclJlbGVhc2UodCxpK3RoaXMudG9TZWNvbmRzKGUpKTtyZXR1cm4gdGhpc30scy5kZWZhdWx0LlBvbHlTeW50aC5wcm90b3R5cGUuc3luYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlckF0dGFja1wiLDEpLHRoaXMuX3N5bmNNZXRob2QoXCJ0cmlnZ2VyUmVsZWFzZVwiLDEpLHRoaXN9LHMuZGVmYXVsdC5Qb2x5U3ludGgucHJvdG90eXBlLnNldD1mdW5jdGlvbih0LGUsaSl7Zm9yKHZhciBzPTA7czx0aGlzLnZvaWNlcy5sZW5ndGg7cysrKXRoaXMudm9pY2VzW3NdLnNldCh0LGUsaSk7cmV0dXJuIHRoaXN9LHMuZGVmYXVsdC5Qb2x5U3ludGgucHJvdG90eXBlLmdldD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy52b2ljZXNbMF0uZ2V0KHQpfSxzLmRlZmF1bHQuUG9seVN5bnRoLnByb3RvdHlwZS5yZWxlYXNlQWxsPWZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMudm9pY2VzLmZvckVhY2goZnVuY3Rpb24oZSl7ZS50cmlnZ2VyUmVsZWFzZSh0KX0pLHRoaXN9LHMuZGVmYXVsdC5Qb2x5U3ludGgucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0Lkluc3RydW1lbnQucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLnZvaWNlcy5mb3JFYWNoKGZ1bmN0aW9uKHQpe3QuZGlzcG9zZSgpfSksdGhpcy5fd3JpdGFibGUoXCJkZXR1bmVcIiksdGhpcy5kZXR1bmUuZGlzcG9zZSgpLHRoaXMuZGV0dW5lPW51bGwsdGhpcy52b2ljZXM9bnVsbCx0aGlzfSxzLmRlZmF1bHQuUG9seVN5bnRoLk1BWF9QT0xZUEhPTlk9MjAsZS5kZWZhdWx0PXMuZGVmYXVsdC5Qb2x5U3ludGh9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDIxKSxpKDM5KSxpKDU0KTtzLmRlZmF1bHQuUGx1Y2tTeW50aD1mdW5jdGlvbih0KXt0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQscy5kZWZhdWx0LlBsdWNrU3ludGguZGVmYXVsdHMpLHMuZGVmYXVsdC5JbnN0cnVtZW50LmNhbGwodGhpcyx0KSx0aGlzLl9ub2lzZT1uZXcgcy5kZWZhdWx0Lk5vaXNlKFwicGlua1wiKSx0aGlzLmF0dGFja05vaXNlPXQuYXR0YWNrTm9pc2UsdGhpcy5fbGZjZj1uZXcgcy5kZWZhdWx0Lkxvd3Bhc3NDb21iRmlsdGVyKHtyZXNvbmFuY2U6dC5yZXNvbmFuY2UsZGFtcGVuaW5nOnQuZGFtcGVuaW5nfSksdGhpcy5yZXNvbmFuY2U9dGhpcy5fbGZjZi5yZXNvbmFuY2UsdGhpcy5kYW1wZW5pbmc9dGhpcy5fbGZjZi5kYW1wZW5pbmcsdGhpcy5fbm9pc2UuY29ubmVjdCh0aGlzLl9sZmNmKSx0aGlzLl9sZmNmLmNvbm5lY3QodGhpcy5vdXRwdXQpLHRoaXMuX3JlYWRPbmx5KFtcInJlc29uYW5jZVwiLFwiZGFtcGVuaW5nXCJdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUGx1Y2tTeW50aCxzLmRlZmF1bHQuSW5zdHJ1bWVudCkscy5kZWZhdWx0LlBsdWNrU3ludGguZGVmYXVsdHM9e2F0dGFja05vaXNlOjEsZGFtcGVuaW5nOjRlMyxyZXNvbmFuY2U6Ljd9LHMuZGVmYXVsdC5QbHVja1N5bnRoLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrPWZ1bmN0aW9uKHQsZSl7dD10aGlzLnRvRnJlcXVlbmN5KHQpLGU9dGhpcy50b1NlY29uZHMoZSk7dmFyIGk9MS90O3JldHVybiB0aGlzLl9sZmNmLmRlbGF5VGltZS5zZXRWYWx1ZUF0VGltZShpLGUpLHRoaXMuX25vaXNlLnN0YXJ0KGUpLHRoaXMuX25vaXNlLnN0b3AoZStpKnRoaXMuYXR0YWNrTm9pc2UpLHRoaXN9LHMuZGVmYXVsdC5QbHVja1N5bnRoLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fbm9pc2UuZGlzcG9zZSgpLHRoaXMuX2xmY2YuZGlzcG9zZSgpLHRoaXMuX25vaXNlPW51bGwsdGhpcy5fbGZjZj1udWxsLHRoaXMuX3dyaXRhYmxlKFtcInJlc29uYW5jZVwiLFwiZGFtcGVuaW5nXCJdKSx0aGlzLmRhbXBlbmluZz1udWxsLHRoaXMucmVzb25hbmNlPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5QbHVja1N5bnRofSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgzMSksaSg0MSksaSgzOSksaSgyKSxpKDkpLGkoMjEpO3MuZGVmYXVsdC5Ob2lzZVN5bnRoPWZ1bmN0aW9uKHQpe3Q9cy5kZWZhdWx0LmRlZmF1bHRBcmcodCxzLmRlZmF1bHQuTm9pc2VTeW50aC5kZWZhdWx0cykscy5kZWZhdWx0Lkluc3RydW1lbnQuY2FsbCh0aGlzLHQpLHRoaXMubm9pc2U9bmV3IHMuZGVmYXVsdC5Ob2lzZSh0Lm5vaXNlKSx0aGlzLmVudmVsb3BlPW5ldyBzLmRlZmF1bHQuQW1wbGl0dWRlRW52ZWxvcGUodC5lbnZlbG9wZSksdGhpcy5ub2lzZS5jaGFpbih0aGlzLmVudmVsb3BlLHRoaXMub3V0cHV0KSx0aGlzLl9yZWFkT25seShbXCJub2lzZVwiLFwiZW52ZWxvcGVcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Ob2lzZVN5bnRoLHMuZGVmYXVsdC5JbnN0cnVtZW50KSxzLmRlZmF1bHQuTm9pc2VTeW50aC5kZWZhdWx0cz17bm9pc2U6e3R5cGU6XCJ3aGl0ZVwifSxlbnZlbG9wZTp7YXR0YWNrOi4wMDUsZGVjYXk6LjEsc3VzdGFpbjowfX0scy5kZWZhdWx0Lk5vaXNlU3ludGgucHJvdG90eXBlLnRyaWdnZXJBdHRhY2s9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLmVudmVsb3BlLnRyaWdnZXJBdHRhY2sodCxlKSx0aGlzLm5vaXNlLnN0YXJ0KHQpLDA9PT10aGlzLmVudmVsb3BlLnN1c3RhaW4mJnRoaXMubm9pc2Uuc3RvcCh0K3RoaXMuZW52ZWxvcGUuYXR0YWNrK3RoaXMuZW52ZWxvcGUuZGVjYXkpLHRoaXN9LHMuZGVmYXVsdC5Ob2lzZVN5bnRoLnByb3RvdHlwZS50cmlnZ2VyUmVsZWFzZT1mdW5jdGlvbih0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLmVudmVsb3BlLnRyaWdnZXJSZWxlYXNlKHQpLHRoaXMubm9pc2Uuc3RvcCh0K3RoaXMuZW52ZWxvcGUucmVsZWFzZSksdGhpc30scy5kZWZhdWx0Lk5vaXNlU3ludGgucHJvdG90eXBlLnN5bmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc3luY01ldGhvZChcInRyaWdnZXJBdHRhY2tcIiwwKSx0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlclJlbGVhc2VcIiwwKSx0aGlzfSxzLmRlZmF1bHQuTm9pc2VTeW50aC5wcm90b3R5cGUudHJpZ2dlckF0dGFja1JlbGVhc2U9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBlPXRoaXMudG9TZWNvbmRzKGUpLHQ9dGhpcy50b1NlY29uZHModCksdGhpcy50cmlnZ2VyQXR0YWNrKGUsaSksdGhpcy50cmlnZ2VyUmVsZWFzZShlK3QpLHRoaXN9LHMuZGVmYXVsdC5Ob2lzZVN5bnRoLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoW1wibm9pc2VcIixcImVudmVsb3BlXCJdKSx0aGlzLm5vaXNlLmRpc3Bvc2UoKSx0aGlzLm5vaXNlPW51bGwsdGhpcy5lbnZlbG9wZS5kaXNwb3NlKCksdGhpcy5lbnZlbG9wZT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuTm9pc2VTeW50aH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApLG49KGkoMjEpLGkoNDkpLGkoOSksaSg0MSksaSgzMSksaSgzKSxpKDI2KSxpKDUpLFsxLDEuNDgzLDEuOTMyLDIuNTQ2LDIuNjMsMy44OTddKTtzLmRlZmF1bHQuTWV0YWxTeW50aD1mdW5jdGlvbih0KXt0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQscy5kZWZhdWx0Lk1ldGFsU3ludGguZGVmYXVsdHMpLHMuZGVmYXVsdC5JbnN0cnVtZW50LmNhbGwodGhpcyx0KSx0aGlzLmZyZXF1ZW5jeT1uZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmZyZXF1ZW5jeSxzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kpLHRoaXMuX29zY2lsbGF0b3JzPVtdLHRoaXMuX2ZyZXFNdWx0aXBsaWVycz1bXSx0aGlzLl9hbXBsaXR1ZT1uZXcgcy5kZWZhdWx0LkdhaW4oMCkuY29ubmVjdCh0aGlzLm91dHB1dCksdGhpcy5faGlnaHBhc3M9bmV3IHMuZGVmYXVsdC5GaWx0ZXIoe3R5cGU6XCJoaWdocGFzc1wiLFE6LTMuMDEwMjk5OTU2NjM5ODEyNX0pLmNvbm5lY3QodGhpcy5fYW1wbGl0dWUpLHRoaXMuX29jdGF2ZXM9dC5vY3RhdmVzLHRoaXMuX2ZpbHRlckZyZXFTY2FsZXI9bmV3IHMuZGVmYXVsdC5TY2FsZSh0LnJlc29uYW5jZSw3ZTMpLHRoaXMuZW52ZWxvcGU9bmV3IHMuZGVmYXVsdC5FbnZlbG9wZSh7YXR0YWNrOnQuZW52ZWxvcGUuYXR0YWNrLGF0dGFja0N1cnZlOlwibGluZWFyXCIsZGVjYXk6dC5lbnZlbG9wZS5kZWNheSxzdXN0YWluOjAscmVsZWFzZTp0LmVudmVsb3BlLnJlbGVhc2V9KS5jaGFpbih0aGlzLl9maWx0ZXJGcmVxU2NhbGVyLHRoaXMuX2hpZ2hwYXNzLmZyZXF1ZW5jeSksdGhpcy5lbnZlbG9wZS5jb25uZWN0KHRoaXMuX2FtcGxpdHVlLmdhaW4pO2Zvcih2YXIgZT0wO2U8bi5sZW5ndGg7ZSsrKXt2YXIgaT1uZXcgcy5kZWZhdWx0LkZNT3NjaWxsYXRvcih7dHlwZTpcInNxdWFyZVwiLG1vZHVsYXRpb25UeXBlOlwic3F1YXJlXCIsaGFybW9uaWNpdHk6dC5oYXJtb25pY2l0eSxtb2R1bGF0aW9uSW5kZXg6dC5tb2R1bGF0aW9uSW5kZXh9KTtpLmNvbm5lY3QodGhpcy5faGlnaHBhc3MpLHRoaXMuX29zY2lsbGF0b3JzW2VdPWk7dmFyIG89bmV3IHMuZGVmYXVsdC5NdWx0aXBseShuW2VdKTt0aGlzLl9mcmVxTXVsdGlwbGllcnNbZV09byx0aGlzLmZyZXF1ZW5jeS5jaGFpbihvLGkuZnJlcXVlbmN5KX10aGlzLm9jdGF2ZXM9dC5vY3RhdmVzfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5NZXRhbFN5bnRoLHMuZGVmYXVsdC5JbnN0cnVtZW50KSxzLmRlZmF1bHQuTWV0YWxTeW50aC5kZWZhdWx0cz17ZnJlcXVlbmN5OjIwMCxlbnZlbG9wZTp7YXR0YWNrOi4wMDEsZGVjYXk6MS40LHJlbGVhc2U6LjJ9LGhhcm1vbmljaXR5OjUuMSxtb2R1bGF0aW9uSW5kZXg6MzIscmVzb25hbmNlOjRlMyxvY3RhdmVzOjEuNX0scy5kZWZhdWx0Lk1ldGFsU3ludGgucHJvdG90eXBlLnRyaWdnZXJBdHRhY2s9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSxlPXMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsMSksdGhpcy5lbnZlbG9wZS50cmlnZ2VyQXR0YWNrKHQsZSksdGhpcy5fb3NjaWxsYXRvcnMuZm9yRWFjaChmdW5jdGlvbihlKXtlLnN0YXJ0KHQpfSksMD09PXRoaXMuZW52ZWxvcGUuc3VzdGFpbiYmdGhpcy5fb3NjaWxsYXRvcnMuZm9yRWFjaChmdW5jdGlvbihlKXtlLnN0b3AodCt0aGlzLmVudmVsb3BlLmF0dGFjayt0aGlzLmVudmVsb3BlLmRlY2F5KX0uYmluZCh0aGlzKSksdGhpc30scy5kZWZhdWx0Lk1ldGFsU3ludGgucHJvdG90eXBlLnRyaWdnZXJSZWxlYXNlPWZ1bmN0aW9uKHQpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuZW52ZWxvcGUudHJpZ2dlclJlbGVhc2UodCksdGhpcy5fb3NjaWxsYXRvcnMuZm9yRWFjaChmdW5jdGlvbihlKXtlLnN0b3AodCt0aGlzLmVudmVsb3BlLnJlbGVhc2UpfS5iaW5kKHRoaXMpKSx0aGlzfSxzLmRlZmF1bHQuTWV0YWxTeW50aC5wcm90b3R5cGUuc3luYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9zeW5jTWV0aG9kKFwidHJpZ2dlckF0dGFja1wiLDApLHRoaXMuX3N5bmNNZXRob2QoXCJ0cmlnZ2VyUmVsZWFzZVwiLDApLHRoaXN9LHMuZGVmYXVsdC5NZXRhbFN5bnRoLnByb3RvdHlwZS50cmlnZ2VyQXR0YWNrUmVsZWFzZT1mdW5jdGlvbih0LGUsaSl7cmV0dXJuIGU9dGhpcy50b1NlY29uZHMoZSksdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLnRyaWdnZXJBdHRhY2soZSxpKSx0aGlzLnRyaWdnZXJSZWxlYXNlKGUrdCksdGhpc30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5NZXRhbFN5bnRoLnByb3RvdHlwZSxcIm1vZHVsYXRpb25JbmRleFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvcnNbMF0ubW9kdWxhdGlvbkluZGV4LnZhbHVlfSxzZXQ6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPTA7ZTx0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGg7ZSsrKXRoaXMuX29zY2lsbGF0b3JzW2VdLm1vZHVsYXRpb25JbmRleC52YWx1ZT10fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTWV0YWxTeW50aC5wcm90b3R5cGUsXCJoYXJtb25pY2l0eVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3NjaWxsYXRvcnNbMF0uaGFybW9uaWNpdHkudmFsdWV9LHNldDpmdW5jdGlvbih0KXtmb3IodmFyIGU9MDtlPHRoaXMuX29zY2lsbGF0b3JzLmxlbmd0aDtlKyspdGhpcy5fb3NjaWxsYXRvcnNbZV0uaGFybW9uaWNpdHkudmFsdWU9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lk1ldGFsU3ludGgucHJvdG90eXBlLFwicmVzb25hbmNlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9maWx0ZXJGcmVxU2NhbGVyLm1pbn0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2ZpbHRlckZyZXFTY2FsZXIubWluPXQsdGhpcy5vY3RhdmVzPXRoaXMuX29jdGF2ZXN9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5NZXRhbFN5bnRoLnByb3RvdHlwZSxcIm9jdGF2ZXNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29jdGF2ZXN9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9vY3RhdmVzPXQsdGhpcy5fZmlsdGVyRnJlcVNjYWxlci5tYXg9dGhpcy5fZmlsdGVyRnJlcVNjYWxlci5taW4qTWF0aC5wb3coMix0KX19KSxzLmRlZmF1bHQuTWV0YWxTeW50aC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5JbnN0cnVtZW50LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7Zm9yKHZhciB0PTA7dDx0aGlzLl9vc2NpbGxhdG9ycy5sZW5ndGg7dCsrKXRoaXMuX29zY2lsbGF0b3JzW3RdLmRpc3Bvc2UoKSx0aGlzLl9mcmVxTXVsdGlwbGllcnNbdF0uZGlzcG9zZSgpO3RoaXMuX29zY2lsbGF0b3JzPW51bGwsdGhpcy5fZnJlcU11bHRpcGxpZXJzPW51bGwsdGhpcy5mcmVxdWVuY3kuZGlzcG9zZSgpLHRoaXMuZnJlcXVlbmN5PW51bGwsdGhpcy5fZmlsdGVyRnJlcVNjYWxlci5kaXNwb3NlKCksdGhpcy5fZmlsdGVyRnJlcVNjYWxlcj1udWxsLHRoaXMuX2FtcGxpdHVlLmRpc3Bvc2UoKSx0aGlzLl9hbXBsaXR1ZT1udWxsLHRoaXMuZW52ZWxvcGUuZGlzcG9zZSgpLHRoaXMuZW52ZWxvcGU9bnVsbCx0aGlzLl9oaWdocGFzcy5kaXNwb3NlKCksdGhpcy5faGlnaHBhc3M9bnVsbH0sZS5kZWZhdWx0PXMuZGVmYXVsdC5NZXRhbFN5bnRofSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgzNyksaSgyMSksaSgzMSk7cy5kZWZhdWx0Lk1lbWJyYW5lU3ludGg9ZnVuY3Rpb24odCl7dD1zLmRlZmF1bHQuZGVmYXVsdEFyZyh0LHMuZGVmYXVsdC5NZW1icmFuZVN5bnRoLmRlZmF1bHRzKSxzLmRlZmF1bHQuSW5zdHJ1bWVudC5jYWxsKHRoaXMsdCksdGhpcy5vc2NpbGxhdG9yPW5ldyBzLmRlZmF1bHQuT21uaU9zY2lsbGF0b3IodC5vc2NpbGxhdG9yKSx0aGlzLmVudmVsb3BlPW5ldyBzLmRlZmF1bHQuQW1wbGl0dWRlRW52ZWxvcGUodC5lbnZlbG9wZSksdGhpcy5vY3RhdmVzPXQub2N0YXZlcyx0aGlzLnBpdGNoRGVjYXk9dC5waXRjaERlY2F5LHRoaXMub3NjaWxsYXRvci5jaGFpbih0aGlzLmVudmVsb3BlLHRoaXMub3V0cHV0KSx0aGlzLl9yZWFkT25seShbXCJvc2NpbGxhdG9yXCIsXCJlbnZlbG9wZVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk1lbWJyYW5lU3ludGgscy5kZWZhdWx0Lkluc3RydW1lbnQpLHMuZGVmYXVsdC5NZW1icmFuZVN5bnRoLmRlZmF1bHRzPXtwaXRjaERlY2F5Oi4wNSxvY3RhdmVzOjEwLG9zY2lsbGF0b3I6e3R5cGU6XCJzaW5lXCJ9LGVudmVsb3BlOnthdHRhY2s6LjAwMSxkZWNheTouNCxzdXN0YWluOi4wMSxyZWxlYXNlOjEuNCxhdHRhY2tDdXJ2ZTpcImV4cG9uZW50aWFsXCJ9fSxzLmRlZmF1bHQuTWVtYnJhbmVTeW50aC5wcm90b3R5cGUudHJpZ2dlckF0dGFjaz1mdW5jdGlvbih0LGUsaSl7ZT10aGlzLnRvU2Vjb25kcyhlKTt2YXIgcz0odD10aGlzLnRvRnJlcXVlbmN5KHQpKSp0aGlzLm9jdGF2ZXM7cmV0dXJuIHRoaXMub3NjaWxsYXRvci5mcmVxdWVuY3kuc2V0VmFsdWVBdFRpbWUocyxlKSx0aGlzLm9zY2lsbGF0b3IuZnJlcXVlbmN5LmV4cG9uZW50aWFsUmFtcFRvVmFsdWVBdFRpbWUodCxlK3RoaXMudG9TZWNvbmRzKHRoaXMucGl0Y2hEZWNheSkpLHRoaXMuZW52ZWxvcGUudHJpZ2dlckF0dGFjayhlLGkpLHRoaXMub3NjaWxsYXRvci5zdGFydChlKSwwPT09dGhpcy5lbnZlbG9wZS5zdXN0YWluJiZ0aGlzLm9zY2lsbGF0b3Iuc3RvcChlK3RoaXMuZW52ZWxvcGUuYXR0YWNrK3RoaXMuZW52ZWxvcGUuZGVjYXkpLHRoaXN9LHMuZGVmYXVsdC5NZW1icmFuZVN5bnRoLnByb3RvdHlwZS50cmlnZ2VyUmVsZWFzZT1mdW5jdGlvbih0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLmVudmVsb3BlLnRyaWdnZXJSZWxlYXNlKHQpLHRoaXMub3NjaWxsYXRvci5zdG9wKHQrdGhpcy5lbnZlbG9wZS5yZWxlYXNlKSx0aGlzfSxzLmRlZmF1bHQuTWVtYnJhbmVTeW50aC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuSW5zdHJ1bWVudC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3dyaXRhYmxlKFtcIm9zY2lsbGF0b3JcIixcImVudmVsb3BlXCJdKSx0aGlzLm9zY2lsbGF0b3IuZGlzcG9zZSgpLHRoaXMub3NjaWxsYXRvcj1udWxsLHRoaXMuZW52ZWxvcGUuZGlzcG9zZSgpLHRoaXMuZW52ZWxvcGU9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lk1lbWJyYW5lU3ludGh9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDM4KSxpKDIpLGkoNSksaSgyNSk7cy5kZWZhdWx0LkZNU3ludGg9ZnVuY3Rpb24odCl7dD1zLmRlZmF1bHQuZGVmYXVsdEFyZyh0LHMuZGVmYXVsdC5GTVN5bnRoLmRlZmF1bHRzKSxzLmRlZmF1bHQuTW9ub3Bob25pYy5jYWxsKHRoaXMsdCksdGhpcy5fY2Fycmllcj1uZXcgcy5kZWZhdWx0LlN5bnRoKHQuY2FycmllciksdGhpcy5fY2Fycmllci52b2x1bWUudmFsdWU9LTEwLHRoaXMub3NjaWxsYXRvcj10aGlzLl9jYXJyaWVyLm9zY2lsbGF0b3IsdGhpcy5lbnZlbG9wZT10aGlzLl9jYXJyaWVyLmVudmVsb3BlLnNldCh0LmVudmVsb3BlKSx0aGlzLl9tb2R1bGF0b3I9bmV3IHMuZGVmYXVsdC5TeW50aCh0Lm1vZHVsYXRvciksdGhpcy5fbW9kdWxhdG9yLnZvbHVtZS52YWx1ZT0tMTAsdGhpcy5tb2R1bGF0aW9uPXRoaXMuX21vZHVsYXRvci5vc2NpbGxhdG9yLnNldCh0Lm1vZHVsYXRpb24pLHRoaXMubW9kdWxhdGlvbkVudmVsb3BlPXRoaXMuX21vZHVsYXRvci5lbnZlbG9wZS5zZXQodC5tb2R1bGF0aW9uRW52ZWxvcGUpLHRoaXMuZnJlcXVlbmN5PW5ldyBzLmRlZmF1bHQuU2lnbmFsKDQ0MCxzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kpLHRoaXMuZGV0dW5lPW5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZGV0dW5lLHMuZGVmYXVsdC5UeXBlLkNlbnRzKSx0aGlzLmhhcm1vbmljaXR5PW5ldyBzLmRlZmF1bHQuTXVsdGlwbHkodC5oYXJtb25pY2l0eSksdGhpcy5oYXJtb25pY2l0eS51bml0cz1zLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSx0aGlzLm1vZHVsYXRpb25JbmRleD1uZXcgcy5kZWZhdWx0Lk11bHRpcGx5KHQubW9kdWxhdGlvbkluZGV4KSx0aGlzLm1vZHVsYXRpb25JbmRleC51bml0cz1zLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSx0aGlzLl9tb2R1bGF0aW9uTm9kZT1uZXcgcy5kZWZhdWx0LkdhaW4oMCksdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9jYXJyaWVyLmZyZXF1ZW5jeSksdGhpcy5mcmVxdWVuY3kuY2hhaW4odGhpcy5oYXJtb25pY2l0eSx0aGlzLl9tb2R1bGF0b3IuZnJlcXVlbmN5KSx0aGlzLmZyZXF1ZW5jeS5jaGFpbih0aGlzLm1vZHVsYXRpb25JbmRleCx0aGlzLl9tb2R1bGF0aW9uTm9kZSksdGhpcy5kZXR1bmUuZmFuKHRoaXMuX2NhcnJpZXIuZGV0dW5lLHRoaXMuX21vZHVsYXRvci5kZXR1bmUpLHRoaXMuX21vZHVsYXRvci5jb25uZWN0KHRoaXMuX21vZHVsYXRpb25Ob2RlLmdhaW4pLHRoaXMuX21vZHVsYXRpb25Ob2RlLmNvbm5lY3QodGhpcy5fY2Fycmllci5mcmVxdWVuY3kpLHRoaXMuX2NhcnJpZXIuY29ubmVjdCh0aGlzLm91dHB1dCksdGhpcy5fcmVhZE9ubHkoW1wiZnJlcXVlbmN5XCIsXCJoYXJtb25pY2l0eVwiLFwibW9kdWxhdGlvbkluZGV4XCIsXCJvc2NpbGxhdG9yXCIsXCJlbnZlbG9wZVwiLFwibW9kdWxhdGlvblwiLFwibW9kdWxhdGlvbkVudmVsb3BlXCIsXCJkZXR1bmVcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5GTVN5bnRoLHMuZGVmYXVsdC5Nb25vcGhvbmljKSxzLmRlZmF1bHQuRk1TeW50aC5kZWZhdWx0cz17aGFybW9uaWNpdHk6Myxtb2R1bGF0aW9uSW5kZXg6MTAsZGV0dW5lOjAsb3NjaWxsYXRvcjp7dHlwZTpcInNpbmVcIn0sZW52ZWxvcGU6e2F0dGFjazouMDEsZGVjYXk6LjAxLHN1c3RhaW46MSxyZWxlYXNlOi41fSxtb2R1bGF0aW9uOnt0eXBlOlwic3F1YXJlXCJ9LG1vZHVsYXRpb25FbnZlbG9wZTp7YXR0YWNrOi41LGRlY2F5OjAsc3VzdGFpbjoxLHJlbGVhc2U6LjV9fSxzLmRlZmF1bHQuRk1TeW50aC5wcm90b3R5cGUuX3RyaWdnZXJFbnZlbG9wZUF0dGFjaz1mdW5jdGlvbih0LGUpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMuX2NhcnJpZXIuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayh0LGUpLHRoaXMuX21vZHVsYXRvci5fdHJpZ2dlckVudmVsb3BlQXR0YWNrKHQpLHRoaXN9LHMuZGVmYXVsdC5GTVN5bnRoLnByb3RvdHlwZS5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZT1mdW5jdGlvbih0KXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9jYXJyaWVyLl90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlKHQpLHRoaXMuX21vZHVsYXRvci5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZSh0KSx0aGlzfSxzLmRlZmF1bHQuRk1TeW50aC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuTW9ub3Bob25pYy5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3dyaXRhYmxlKFtcImZyZXF1ZW5jeVwiLFwiaGFybW9uaWNpdHlcIixcIm1vZHVsYXRpb25JbmRleFwiLFwib3NjaWxsYXRvclwiLFwiZW52ZWxvcGVcIixcIm1vZHVsYXRpb25cIixcIm1vZHVsYXRpb25FbnZlbG9wZVwiLFwiZGV0dW5lXCJdKSx0aGlzLl9jYXJyaWVyLmRpc3Bvc2UoKSx0aGlzLl9jYXJyaWVyPW51bGwsdGhpcy5fbW9kdWxhdG9yLmRpc3Bvc2UoKSx0aGlzLl9tb2R1bGF0b3I9bnVsbCx0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3k9bnVsbCx0aGlzLmRldHVuZS5kaXNwb3NlKCksdGhpcy5kZXR1bmU9bnVsbCx0aGlzLm1vZHVsYXRpb25JbmRleC5kaXNwb3NlKCksdGhpcy5tb2R1bGF0aW9uSW5kZXg9bnVsbCx0aGlzLmhhcm1vbmljaXR5LmRpc3Bvc2UoKSx0aGlzLmhhcm1vbmljaXR5PW51bGwsdGhpcy5fbW9kdWxhdGlvbk5vZGUuZGlzcG9zZSgpLHRoaXMuX21vZHVsYXRpb25Ob2RlPW51bGwsdGhpcy5vc2NpbGxhdG9yPW51bGwsdGhpcy5lbnZlbG9wZT1udWxsLHRoaXMubW9kdWxhdGlvbkVudmVsb3BlPW51bGwsdGhpcy5tb2R1bGF0aW9uPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5GTVN5bnRofSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg2NSksaSgxMiksaSgyKSxpKDUpLGkoMjUpLGkoMTQpO3MuZGVmYXVsdC5EdW9TeW50aD1mdW5jdGlvbih0KXt0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQscy5kZWZhdWx0LkR1b1N5bnRoLmRlZmF1bHRzKSxzLmRlZmF1bHQuTW9ub3Bob25pYy5jYWxsKHRoaXMsdCksdGhpcy52b2ljZTA9bmV3IHMuZGVmYXVsdC5Nb25vU3ludGgodC52b2ljZTApLHRoaXMudm9pY2UwLnZvbHVtZS52YWx1ZT0tMTAsdGhpcy52b2ljZTE9bmV3IHMuZGVmYXVsdC5Nb25vU3ludGgodC52b2ljZTEpLHRoaXMudm9pY2UxLnZvbHVtZS52YWx1ZT0tMTAsdGhpcy5fdmlicmF0bz1uZXcgcy5kZWZhdWx0LkxGTyh0LnZpYnJhdG9SYXRlLC01MCw1MCksdGhpcy5fdmlicmF0by5zdGFydCgpLHRoaXMudmlicmF0b1JhdGU9dGhpcy5fdmlicmF0by5mcmVxdWVuY3ksdGhpcy5fdmlicmF0b0dhaW49bmV3IHMuZGVmYXVsdC5HYWluKHQudmlicmF0b0Ftb3VudCxzLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSksdGhpcy52aWJyYXRvQW1vdW50PXRoaXMuX3ZpYnJhdG9HYWluLmdhaW4sdGhpcy5mcmVxdWVuY3k9bmV3IHMuZGVmYXVsdC5TaWduYWwoNDQwLHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksdGhpcy5oYXJtb25pY2l0eT1uZXcgcy5kZWZhdWx0Lk11bHRpcGx5KHQuaGFybW9uaWNpdHkpLHRoaXMuaGFybW9uaWNpdHkudW5pdHM9cy5kZWZhdWx0LlR5cGUuUG9zaXRpdmUsdGhpcy5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLnZvaWNlMC5mcmVxdWVuY3kpLHRoaXMuZnJlcXVlbmN5LmNoYWluKHRoaXMuaGFybW9uaWNpdHksdGhpcy52b2ljZTEuZnJlcXVlbmN5KSx0aGlzLl92aWJyYXRvLmNvbm5lY3QodGhpcy5fdmlicmF0b0dhaW4pLHRoaXMuX3ZpYnJhdG9HYWluLmZhbih0aGlzLnZvaWNlMC5kZXR1bmUsdGhpcy52b2ljZTEuZGV0dW5lKSx0aGlzLnZvaWNlMC5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLnZvaWNlMS5jb25uZWN0KHRoaXMub3V0cHV0KSx0aGlzLl9yZWFkT25seShbXCJ2b2ljZTBcIixcInZvaWNlMVwiLFwiZnJlcXVlbmN5XCIsXCJ2aWJyYXRvQW1vdW50XCIsXCJ2aWJyYXRvUmF0ZVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkR1b1N5bnRoLHMuZGVmYXVsdC5Nb25vcGhvbmljKSxzLmRlZmF1bHQuRHVvU3ludGguZGVmYXVsdHM9e3ZpYnJhdG9BbW91bnQ6LjUsdmlicmF0b1JhdGU6NSxoYXJtb25pY2l0eToxLjUsdm9pY2UwOnt2b2x1bWU6LTEwLHBvcnRhbWVudG86MCxvc2NpbGxhdG9yOnt0eXBlOlwic2luZVwifSxmaWx0ZXJFbnZlbG9wZTp7YXR0YWNrOi4wMSxkZWNheTowLHN1c3RhaW46MSxyZWxlYXNlOi41fSxlbnZlbG9wZTp7YXR0YWNrOi4wMSxkZWNheTowLHN1c3RhaW46MSxyZWxlYXNlOi41fX0sdm9pY2UxOnt2b2x1bWU6LTEwLHBvcnRhbWVudG86MCxvc2NpbGxhdG9yOnt0eXBlOlwic2luZVwifSxmaWx0ZXJFbnZlbG9wZTp7YXR0YWNrOi4wMSxkZWNheTowLHN1c3RhaW46MSxyZWxlYXNlOi41fSxlbnZlbG9wZTp7YXR0YWNrOi4wMSxkZWNheTowLHN1c3RhaW46MSxyZWxlYXNlOi41fX19LHMuZGVmYXVsdC5EdW9TeW50aC5wcm90b3R5cGUuX3RyaWdnZXJFbnZlbG9wZUF0dGFjaz1mdW5jdGlvbih0LGUpe3JldHVybiB0PXRoaXMudG9TZWNvbmRzKHQpLHRoaXMudm9pY2UwLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2sodCxlKSx0aGlzLnZvaWNlMS5fdHJpZ2dlckVudmVsb3BlQXR0YWNrKHQsZSksdGhpc30scy5kZWZhdWx0LkR1b1N5bnRoLnByb3RvdHlwZS5fdHJpZ2dlckVudmVsb3BlUmVsZWFzZT1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy52b2ljZTAuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UodCksdGhpcy52b2ljZTEuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UodCksdGhpc30scy5kZWZhdWx0LkR1b1N5bnRoLnByb3RvdHlwZS5nZXRMZXZlbEF0VGltZT1mdW5jdGlvbih0KXtyZXR1cm4odGhpcy52b2ljZTAuZ2V0TGV2ZWxBdFRpbWUodCkrdGhpcy52b2ljZTEuZ2V0TGV2ZWxBdFRpbWUodCkpLzJ9LHMuZGVmYXVsdC5EdW9TeW50aC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuTW9ub3Bob25pYy5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3dyaXRhYmxlKFtcInZvaWNlMFwiLFwidm9pY2UxXCIsXCJmcmVxdWVuY3lcIixcInZpYnJhdG9BbW91bnRcIixcInZpYnJhdG9SYXRlXCJdKSx0aGlzLnZvaWNlMC5kaXNwb3NlKCksdGhpcy52b2ljZTA9bnVsbCx0aGlzLnZvaWNlMS5kaXNwb3NlKCksdGhpcy52b2ljZTE9bnVsbCx0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3k9bnVsbCx0aGlzLl92aWJyYXRvR2Fpbi5kaXNwb3NlKCksdGhpcy5fdmlicmF0b0dhaW49bnVsbCx0aGlzLl92aWJyYXRvPW51bGwsdGhpcy5oYXJtb25pY2l0eS5kaXNwb3NlKCksdGhpcy5oYXJtb25pY2l0eT1udWxsLHRoaXMudmlicmF0b0Ftb3VudC5kaXNwb3NlKCksdGhpcy52aWJyYXRvQW1vdW50PW51bGwsdGhpcy52aWJyYXRvUmF0ZT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRHVvU3ludGh9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDM4KSxpKDIpLGkoNSksaSgyNSksaSgyMiksaSgzKTtzLmRlZmF1bHQuQU1TeW50aD1mdW5jdGlvbih0KXt0PXMuZGVmYXVsdC5kZWZhdWx0QXJnKHQscy5kZWZhdWx0LkFNU3ludGguZGVmYXVsdHMpLHMuZGVmYXVsdC5Nb25vcGhvbmljLmNhbGwodGhpcyx0KSx0aGlzLl9jYXJyaWVyPW5ldyBzLmRlZmF1bHQuU3ludGgsdGhpcy5fY2Fycmllci52b2x1bWUudmFsdWU9LTEwLHRoaXMub3NjaWxsYXRvcj10aGlzLl9jYXJyaWVyLm9zY2lsbGF0b3Iuc2V0KHQub3NjaWxsYXRvciksdGhpcy5lbnZlbG9wZT10aGlzLl9jYXJyaWVyLmVudmVsb3BlLnNldCh0LmVudmVsb3BlKSx0aGlzLl9tb2R1bGF0b3I9bmV3IHMuZGVmYXVsdC5TeW50aCx0aGlzLl9tb2R1bGF0b3Iudm9sdW1lLnZhbHVlPS0xMCx0aGlzLm1vZHVsYXRpb249dGhpcy5fbW9kdWxhdG9yLm9zY2lsbGF0b3Iuc2V0KHQubW9kdWxhdGlvbiksdGhpcy5tb2R1bGF0aW9uRW52ZWxvcGU9dGhpcy5fbW9kdWxhdG9yLmVudmVsb3BlLnNldCh0Lm1vZHVsYXRpb25FbnZlbG9wZSksdGhpcy5mcmVxdWVuY3k9bmV3IHMuZGVmYXVsdC5TaWduYWwoNDQwLHMuZGVmYXVsdC5UeXBlLkZyZXF1ZW5jeSksdGhpcy5kZXR1bmU9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5kZXR1bmUscy5kZWZhdWx0LlR5cGUuQ2VudHMpLHRoaXMuaGFybW9uaWNpdHk9bmV3IHMuZGVmYXVsdC5NdWx0aXBseSh0Lmhhcm1vbmljaXR5KSx0aGlzLmhhcm1vbmljaXR5LnVuaXRzPXMuZGVmYXVsdC5UeXBlLlBvc2l0aXZlLHRoaXMuX21vZHVsYXRpb25TY2FsZT1uZXcgcy5kZWZhdWx0LkF1ZGlvVG9HYWluLHRoaXMuX21vZHVsYXRpb25Ob2RlPW5ldyBzLmRlZmF1bHQuR2Fpbix0aGlzLmZyZXF1ZW5jeS5jb25uZWN0KHRoaXMuX2NhcnJpZXIuZnJlcXVlbmN5KSx0aGlzLmZyZXF1ZW5jeS5jaGFpbih0aGlzLmhhcm1vbmljaXR5LHRoaXMuX21vZHVsYXRvci5mcmVxdWVuY3kpLHRoaXMuZGV0dW5lLmZhbih0aGlzLl9jYXJyaWVyLmRldHVuZSx0aGlzLl9tb2R1bGF0b3IuZGV0dW5lKSx0aGlzLl9tb2R1bGF0b3IuY2hhaW4odGhpcy5fbW9kdWxhdGlvblNjYWxlLHRoaXMuX21vZHVsYXRpb25Ob2RlLmdhaW4pLHRoaXMuX2NhcnJpZXIuY2hhaW4odGhpcy5fbW9kdWxhdGlvbk5vZGUsdGhpcy5vdXRwdXQpLHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLFwiaGFybW9uaWNpdHlcIixcIm9zY2lsbGF0b3JcIixcImVudmVsb3BlXCIsXCJtb2R1bGF0aW9uXCIsXCJtb2R1bGF0aW9uRW52ZWxvcGVcIixcImRldHVuZVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkFNU3ludGgscy5kZWZhdWx0Lk1vbm9waG9uaWMpLHMuZGVmYXVsdC5BTVN5bnRoLmRlZmF1bHRzPXtoYXJtb25pY2l0eTozLGRldHVuZTowLG9zY2lsbGF0b3I6e3R5cGU6XCJzaW5lXCJ9LGVudmVsb3BlOnthdHRhY2s6LjAxLGRlY2F5Oi4wMSxzdXN0YWluOjEscmVsZWFzZTouNX0sbW9kdWxhdGlvbjp7dHlwZTpcInNxdWFyZVwifSxtb2R1bGF0aW9uRW52ZWxvcGU6e2F0dGFjazouNSxkZWNheTowLHN1c3RhaW46MSxyZWxlYXNlOi41fX0scy5kZWZhdWx0LkFNU3ludGgucHJvdG90eXBlLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2s9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdD10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLl9jYXJyaWVyLl90cmlnZ2VyRW52ZWxvcGVBdHRhY2sodCxlKSx0aGlzLl9tb2R1bGF0b3IuX3RyaWdnZXJFbnZlbG9wZUF0dGFjayh0KSx0aGlzfSxzLmRlZmF1bHQuQU1TeW50aC5wcm90b3R5cGUuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2U9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2NhcnJpZXIuX3RyaWdnZXJFbnZlbG9wZVJlbGVhc2UodCksdGhpcy5fbW9kdWxhdG9yLl90cmlnZ2VyRW52ZWxvcGVSZWxlYXNlKHQpLHRoaXN9LHMuZGVmYXVsdC5BTVN5bnRoLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5Nb25vcGhvbmljLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoW1wiZnJlcXVlbmN5XCIsXCJoYXJtb25pY2l0eVwiLFwib3NjaWxsYXRvclwiLFwiZW52ZWxvcGVcIixcIm1vZHVsYXRpb25cIixcIm1vZHVsYXRpb25FbnZlbG9wZVwiLFwiZGV0dW5lXCJdKSx0aGlzLl9jYXJyaWVyLmRpc3Bvc2UoKSx0aGlzLl9jYXJyaWVyPW51bGwsdGhpcy5fbW9kdWxhdG9yLmRpc3Bvc2UoKSx0aGlzLl9tb2R1bGF0b3I9bnVsbCx0aGlzLmZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5mcmVxdWVuY3k9bnVsbCx0aGlzLmRldHVuZS5kaXNwb3NlKCksdGhpcy5kZXR1bmU9bnVsbCx0aGlzLmhhcm1vbmljaXR5LmRpc3Bvc2UoKSx0aGlzLmhhcm1vbmljaXR5PW51bGwsdGhpcy5fbW9kdWxhdGlvblNjYWxlLmRpc3Bvc2UoKSx0aGlzLl9tb2R1bGF0aW9uU2NhbGU9bnVsbCx0aGlzLl9tb2R1bGF0aW9uTm9kZS5kaXNwb3NlKCksdGhpcy5fbW9kdWxhdGlvbk5vZGU9bnVsbCx0aGlzLm9zY2lsbGF0b3I9bnVsbCx0aGlzLmVudmVsb3BlPW51bGwsdGhpcy5tb2R1bGF0aW9uRW52ZWxvcGU9bnVsbCx0aGlzLm1vZHVsYXRpb249bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkFNU3ludGh9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDY5KSxpKDE2KTtzLmRlZmF1bHQuU2VxdWVuY2U9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImNhbGxiYWNrXCIsXCJldmVudHNcIixcInN1YmRpdmlzaW9uXCJdLHMuZGVmYXVsdC5TZXF1ZW5jZSksZT10LmV2ZW50cztpZihkZWxldGUgdC5ldmVudHMscy5kZWZhdWx0LlBhcnQuY2FsbCh0aGlzLHQpLHRoaXMuX3N1YmRpdmlzaW9uPXRoaXMudG9UaWNrcyh0LnN1YmRpdmlzaW9uKSxzLmRlZmF1bHQuaXNVbmRlZih0Lmxvb3BFbmQpJiZzLmRlZmF1bHQuaXNEZWZpbmVkKGUpJiYodGhpcy5fbG9vcEVuZD1lLmxlbmd0aCp0aGlzLl9zdWJkaXZpc2lvbiksdGhpcy5fbG9vcD0hMCxzLmRlZmF1bHQuaXNEZWZpbmVkKGUpKWZvcih2YXIgaT0wO2k8ZS5sZW5ndGg7aSsrKXRoaXMuYWRkKGksZVtpXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlNlcXVlbmNlLHMuZGVmYXVsdC5QYXJ0KSxzLmRlZmF1bHQuU2VxdWVuY2UuZGVmYXVsdHM9e3N1YmRpdmlzaW9uOlwiNG5cIn0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5TZXF1ZW5jZS5wcm90b3R5cGUsXCJzdWJkaXZpc2lvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlRpY2tzKHRoaXMuX3N1YmRpdmlzaW9uKS50b1NlY29uZHMoKX19KSxzLmRlZmF1bHQuU2VxdWVuY2UucHJvdG90eXBlLmF0PWZ1bmN0aW9uKHQsZSl7cmV0dXJuIHMuZGVmYXVsdC5pc0FycmF5KGUpJiZ0aGlzLnJlbW92ZSh0KSxzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUuYXQuY2FsbCh0aGlzLHRoaXMuX2luZGV4VGltZSh0KSxlKX0scy5kZWZhdWx0LlNlcXVlbmNlLnByb3RvdHlwZS5hZGQ9ZnVuY3Rpb24odCxlKXtpZihudWxsPT09ZSlyZXR1cm4gdGhpcztpZihzLmRlZmF1bHQuaXNBcnJheShlKSl7dmFyIGk9TWF0aC5yb3VuZCh0aGlzLl9zdWJkaXZpc2lvbi9lLmxlbmd0aCk7ZT1uZXcgcy5kZWZhdWx0LlNlcXVlbmNlKHRoaXMuX3RpY2suYmluZCh0aGlzKSxlLHMuZGVmYXVsdC5UaWNrcyhpKSl9cmV0dXJuIHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5hZGQuY2FsbCh0aGlzLHRoaXMuX2luZGV4VGltZSh0KSxlKSx0aGlzfSxzLmRlZmF1bHQuU2VxdWVuY2UucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbih0LGUpe3JldHVybiBzLmRlZmF1bHQuUGFydC5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcyx0aGlzLl9pbmRleFRpbWUodCksZSksdGhpc30scy5kZWZhdWx0LlNlcXVlbmNlLnByb3RvdHlwZS5faW5kZXhUaW1lPWZ1bmN0aW9uKHQpe3JldHVybiB0IGluc3RhbmNlb2Ygcy5kZWZhdWx0LlRyYW5zcG9ydFRpbWU/dDpzLmRlZmF1bHQuVGlja3ModCp0aGlzLl9zdWJkaXZpc2lvbit0aGlzLnN0YXJ0T2Zmc2V0KS50b1NlY29uZHMoKX0scy5kZWZhdWx0LlNlcXVlbmNlLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5QYXJ0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5TZXF1ZW5jZX0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNzApLGkoNzgpO3MuZGVmYXVsdC5QYXR0ZXJuPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJjYWxsYmFja1wiLFwidmFsdWVzXCIsXCJwYXR0ZXJuXCJdLHMuZGVmYXVsdC5QYXR0ZXJuKTtzLmRlZmF1bHQuTG9vcC5jYWxsKHRoaXMsdCksdGhpcy5fcGF0dGVybj1uZXcgcy5kZWZhdWx0LkN0cmxQYXR0ZXJuKHt2YWx1ZXM6dC52YWx1ZXMsdHlwZTp0LnBhdHRlcm4saW5kZXg6dC5pbmRleH0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5QYXR0ZXJuLHMuZGVmYXVsdC5Mb29wKSxzLmRlZmF1bHQuUGF0dGVybi5kZWZhdWx0cz17cGF0dGVybjpzLmRlZmF1bHQuQ3RybFBhdHRlcm4uVHlwZS5VcCxjYWxsYmFjazpzLmRlZmF1bHQubm9PcCx2YWx1ZXM6W119LHMuZGVmYXVsdC5QYXR0ZXJuLnByb3RvdHlwZS5fdGljaz1mdW5jdGlvbih0KXt0aGlzLmNhbGxiYWNrKHQsdGhpcy5fcGF0dGVybi52YWx1ZSksdGhpcy5fcGF0dGVybi5uZXh0KCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGF0dGVybi5wcm90b3R5cGUsXCJpbmRleFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGF0dGVybi5pbmRleH0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3BhdHRlcm4uaW5kZXg9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhdHRlcm4ucHJvdG90eXBlLFwidmFsdWVzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wYXR0ZXJuLnZhbHVlc30sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3BhdHRlcm4udmFsdWVzPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYXR0ZXJuLnByb3RvdHlwZSxcInZhbHVlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wYXR0ZXJuLnZhbHVlfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGF0dGVybi5wcm90b3R5cGUsXCJwYXR0ZXJuXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wYXR0ZXJuLnR5cGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9wYXR0ZXJuLnR5cGU9dH19KSxzLmRlZmF1bHQuUGF0dGVybi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5Mb29wLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fcGF0dGVybi5kaXNwb3NlKCksdGhpcy5fcGF0dGVybj1udWxsfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlBhdHRlcm59LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDgpLGkoMTgpLGkoMTIpO3MuZGVmYXVsdC5WaWJyYXRvPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcImRlcHRoXCJdLHMuZGVmYXVsdC5WaWJyYXRvKTtzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcyx0KSx0aGlzLl9kZWxheU5vZGU9bmV3IHMuZGVmYXVsdC5EZWxheSgwLHQubWF4RGVsYXkpLHRoaXMuX2xmbz1uZXcgcy5kZWZhdWx0LkxGTyh7dHlwZTp0LnR5cGUsbWluOjAsbWF4OnQubWF4RGVsYXksZnJlcXVlbmN5OnQuZnJlcXVlbmN5LHBoYXNlOi05MH0pLnN0YXJ0KCkuY29ubmVjdCh0aGlzLl9kZWxheU5vZGUuZGVsYXlUaW1lKSx0aGlzLmZyZXF1ZW5jeT10aGlzLl9sZm8uZnJlcXVlbmN5LHRoaXMuZGVwdGg9dGhpcy5fbGZvLmFtcGxpdHVkZSx0aGlzLmRlcHRoLnZhbHVlPXQuZGVwdGgsdGhpcy5fcmVhZE9ubHkoW1wiZnJlcXVlbmN5XCIsXCJkZXB0aFwiXSksdGhpcy5lZmZlY3RTZW5kLmNoYWluKHRoaXMuX2RlbGF5Tm9kZSx0aGlzLmVmZmVjdFJldHVybil9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlZpYnJhdG8scy5kZWZhdWx0LkVmZmVjdCkscy5kZWZhdWx0LlZpYnJhdG8uZGVmYXVsdHM9e21heERlbGF5Oi4wMDUsZnJlcXVlbmN5OjUsZGVwdGg6LjEsdHlwZTpcInNpbmVcIn0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5WaWJyYXRvLnByb3RvdHlwZSxcInR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xmby50eXBlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fbGZvLnR5cGU9dH19KSxzLmRlZmF1bHQuVmlicmF0by5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9kZWxheU5vZGUuZGlzcG9zZSgpLHRoaXMuX2RlbGF5Tm9kZT1udWxsLHRoaXMuX2xmby5kaXNwb3NlKCksdGhpcy5fbGZvPW51bGwsdGhpcy5fd3JpdGFibGUoW1wiZnJlcXVlbmN5XCIsXCJkZXB0aFwiXSksdGhpcy5mcmVxdWVuY3k9bnVsbCx0aGlzLmRlcHRoPW51bGx9LGUuZGVmYXVsdD1zLmRlZmF1bHQuVmlicmF0b30sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTIpLGkoMTUpO3MuZGVmYXVsdC5UcmVtb2xvPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJmcmVxdWVuY3lcIixcImRlcHRoXCJdLHMuZGVmYXVsdC5UcmVtb2xvKTtzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LmNhbGwodGhpcyx0KSx0aGlzLl9sZm9MPW5ldyBzLmRlZmF1bHQuTEZPKHtwaGFzZTp0LnNwcmVhZCxtaW46MSxtYXg6MH0pLHRoaXMuX2xmb1I9bmV3IHMuZGVmYXVsdC5MRk8oe3BoYXNlOnQuc3ByZWFkLG1pbjoxLG1heDowfSksdGhpcy5fYW1wbGl0dWRlTD1uZXcgcy5kZWZhdWx0LkdhaW4sdGhpcy5fYW1wbGl0dWRlUj1uZXcgcy5kZWZhdWx0LkdhaW4sdGhpcy5mcmVxdWVuY3k9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5mcmVxdWVuY3kscy5kZWZhdWx0LlR5cGUuRnJlcXVlbmN5KSx0aGlzLmRlcHRoPW5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuZGVwdGgscy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UpLHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLFwiZGVwdGhcIl0pLHRoaXMuZWZmZWN0U2VuZEwuY2hhaW4odGhpcy5fYW1wbGl0dWRlTCx0aGlzLmVmZmVjdFJldHVybkwpLHRoaXMuZWZmZWN0U2VuZFIuY2hhaW4odGhpcy5fYW1wbGl0dWRlUix0aGlzLmVmZmVjdFJldHVyblIpLHRoaXMuX2xmb0wuY29ubmVjdCh0aGlzLl9hbXBsaXR1ZGVMLmdhaW4pLHRoaXMuX2xmb1IuY29ubmVjdCh0aGlzLl9hbXBsaXR1ZGVSLmdhaW4pLHRoaXMuZnJlcXVlbmN5LmZhbih0aGlzLl9sZm9MLmZyZXF1ZW5jeSx0aGlzLl9sZm9SLmZyZXF1ZW5jeSksdGhpcy5kZXB0aC5mYW4odGhpcy5fbGZvUi5hbXBsaXR1ZGUsdGhpcy5fbGZvTC5hbXBsaXR1ZGUpLHRoaXMudHlwZT10LnR5cGUsdGhpcy5zcHJlYWQ9dC5zcHJlYWR9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlRyZW1vbG8scy5kZWZhdWx0LlN0ZXJlb0VmZmVjdCkscy5kZWZhdWx0LlRyZW1vbG8uZGVmYXVsdHM9e2ZyZXF1ZW5jeToxMCx0eXBlOlwic2luZVwiLGRlcHRoOi41LHNwcmVhZDoxODB9LHMuZGVmYXVsdC5UcmVtb2xvLnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbGZvTC5zdGFydCh0KSx0aGlzLl9sZm9SLnN0YXJ0KHQpLHRoaXN9LHMuZGVmYXVsdC5UcmVtb2xvLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9sZm9MLnN0b3AodCksdGhpcy5fbGZvUi5zdG9wKHQpLHRoaXN9LHMuZGVmYXVsdC5UcmVtb2xvLnByb3RvdHlwZS5zeW5jPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9sZm9MLnN5bmModCksdGhpcy5fbGZvUi5zeW5jKHQpLHMuZGVmYXVsdC5UcmFuc3BvcnQuc3luY1NpZ25hbCh0aGlzLmZyZXF1ZW5jeSksdGhpc30scy5kZWZhdWx0LlRyZW1vbG8ucHJvdG90eXBlLnVuc3luYz1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9sZm9MLnVuc3luYygpLHRoaXMuX2xmb1IudW5zeW5jKCkscy5kZWZhdWx0LlRyYW5zcG9ydC51bnN5bmNTaWduYWwodGhpcy5mcmVxdWVuY3kpLHRoaXN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuVHJlbW9sby5wcm90b3R5cGUsXCJ0eXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sZm9MLnR5cGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9sZm9MLnR5cGU9dCx0aGlzLl9sZm9SLnR5cGU9dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlRyZW1vbG8ucHJvdG90eXBlLFwic3ByZWFkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sZm9SLnBoYXNlLXRoaXMuX2xmb0wucGhhc2V9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9sZm9MLnBoYXNlPTkwLXQvMix0aGlzLl9sZm9SLnBoYXNlPXQvMis5MH19KSxzLmRlZmF1bHQuVHJlbW9sby5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoW1wiZnJlcXVlbmN5XCIsXCJkZXB0aFwiXSksdGhpcy5fbGZvTC5kaXNwb3NlKCksdGhpcy5fbGZvTD1udWxsLHRoaXMuX2xmb1IuZGlzcG9zZSgpLHRoaXMuX2xmb1I9bnVsbCx0aGlzLl9hbXBsaXR1ZGVMLmRpc3Bvc2UoKSx0aGlzLl9hbXBsaXR1ZGVMPW51bGwsdGhpcy5fYW1wbGl0dWRlUi5kaXNwb3NlKCksdGhpcy5fYW1wbGl0dWRlUj1udWxsLHRoaXMuZnJlcXVlbmN5PW51bGwsdGhpcy5kZXB0aD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuVHJlbW9sb30sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNzIpLGkoMiksaSg1KSxpKDEzKTtzLmRlZmF1bHQuU3RlcmVvV2lkZW5lcj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wid2lkdGhcIl0scy5kZWZhdWx0LlN0ZXJlb1dpZGVuZXIpO3MuZGVmYXVsdC5NaWRTaWRlRWZmZWN0LmNhbGwodGhpcyx0KSx0aGlzLndpZHRoPW5ldyBzLmRlZmF1bHQuU2lnbmFsKHQud2lkdGgscy5kZWZhdWx0LlR5cGUuTm9ybWFsUmFuZ2UpLHRoaXMuX3JlYWRPbmx5KFtcIndpZHRoXCJdKSx0aGlzLl90d29UaW1lc1dpZHRoTWlkPW5ldyBzLmRlZmF1bHQuTXVsdGlwbHkoMiksdGhpcy5fdHdvVGltZXNXaWR0aFNpZGU9bmV3IHMuZGVmYXVsdC5NdWx0aXBseSgyKSx0aGlzLl9taWRNdWx0PW5ldyBzLmRlZmF1bHQuTXVsdGlwbHksdGhpcy5fdHdvVGltZXNXaWR0aE1pZC5jb25uZWN0KHRoaXMuX21pZE11bHQsMCwxKSx0aGlzLm1pZFNlbmQuY2hhaW4odGhpcy5fbWlkTXVsdCx0aGlzLm1pZFJldHVybiksdGhpcy5fb25lTWludXNXaWR0aD1uZXcgcy5kZWZhdWx0LlN1YnRyYWN0LHRoaXMuX29uZU1pbnVzV2lkdGguY29ubmVjdCh0aGlzLl90d29UaW1lc1dpZHRoTWlkKSxzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmNvbnRleHQuZ2V0Q29uc3RhbnQoMSksdGhpcy5fb25lTWludXNXaWR0aCwwLDApLHRoaXMud2lkdGguY29ubmVjdCh0aGlzLl9vbmVNaW51c1dpZHRoLDAsMSksdGhpcy5fc2lkZU11bHQ9bmV3IHMuZGVmYXVsdC5NdWx0aXBseSx0aGlzLndpZHRoLmNvbm5lY3QodGhpcy5fdHdvVGltZXNXaWR0aFNpZGUpLHRoaXMuX3R3b1RpbWVzV2lkdGhTaWRlLmNvbm5lY3QodGhpcy5fc2lkZU11bHQsMCwxKSx0aGlzLnNpZGVTZW5kLmNoYWluKHRoaXMuX3NpZGVNdWx0LHRoaXMuc2lkZVJldHVybil9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlN0ZXJlb1dpZGVuZXIscy5kZWZhdWx0Lk1pZFNpZGVFZmZlY3QpLHMuZGVmYXVsdC5TdGVyZW9XaWRlbmVyLmRlZmF1bHRzPXt3aWR0aDouNX0scy5kZWZhdWx0LlN0ZXJlb1dpZGVuZXIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0Lk1pZFNpZGVFZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJ3aWR0aFwiXSksdGhpcy53aWR0aC5kaXNwb3NlKCksdGhpcy53aWR0aD1udWxsLHRoaXMuX21pZE11bHQuZGlzcG9zZSgpLHRoaXMuX21pZE11bHQ9bnVsbCx0aGlzLl9zaWRlTXVsdC5kaXNwb3NlKCksdGhpcy5fc2lkZU11bHQ9bnVsbCx0aGlzLl90d29UaW1lc1dpZHRoTWlkLmRpc3Bvc2UoKSx0aGlzLl90d29UaW1lc1dpZHRoTWlkPW51bGwsdGhpcy5fdHdvVGltZXNXaWR0aFNpZGUuZGlzcG9zZSgpLHRoaXMuX3R3b1RpbWVzV2lkdGhTaWRlPW51bGwsdGhpcy5fb25lTWludXNXaWR0aC5kaXNwb3NlKCksdGhpcy5fb25lTWludXNXaWR0aD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuU3RlcmVvV2lkZW5lcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTUpLGkoMzMpLGkoMyk7cy5kZWZhdWx0LlN0ZXJlb0ZlZWRiYWNrRWZmZWN0PWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJmZWVkYmFja1wiXSxzLmRlZmF1bHQuRmVlZGJhY2tFZmZlY3QpO3MuZGVmYXVsdC5TdGVyZW9FZmZlY3QuY2FsbCh0aGlzLHQpLHRoaXMuZmVlZGJhY2s9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5mZWVkYmFjayxzLmRlZmF1bHQuVHlwZS5Ob3JtYWxSYW5nZSksdGhpcy5fZmVlZGJhY2tMPW5ldyBzLmRlZmF1bHQuR2Fpbix0aGlzLl9mZWVkYmFja1I9bmV3IHMuZGVmYXVsdC5HYWluLHRoaXMuZWZmZWN0UmV0dXJuTC5jaGFpbih0aGlzLl9mZWVkYmFja0wsdGhpcy5lZmZlY3RTZW5kTCksdGhpcy5lZmZlY3RSZXR1cm5SLmNoYWluKHRoaXMuX2ZlZWRiYWNrUix0aGlzLmVmZmVjdFNlbmRSKSx0aGlzLmZlZWRiYWNrLmZhbih0aGlzLl9mZWVkYmFja0wuZ2Fpbix0aGlzLl9mZWVkYmFja1IuZ2FpbiksdGhpcy5fcmVhZE9ubHkoW1wiZmVlZGJhY2tcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5TdGVyZW9GZWVkYmFja0VmZmVjdCxzLmRlZmF1bHQuU3RlcmVvRWZmZWN0KSxzLmRlZmF1bHQuU3RlcmVvRmVlZGJhY2tFZmZlY3QucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlN0ZXJlb0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3dyaXRhYmxlKFtcImZlZWRiYWNrXCJdKSx0aGlzLmZlZWRiYWNrLmRpc3Bvc2UoKSx0aGlzLmZlZWRiYWNrPW51bGwsdGhpcy5fZmVlZGJhY2tMLmRpc3Bvc2UoKSx0aGlzLl9mZWVkYmFja0w9bnVsbCx0aGlzLl9mZWVkYmFja1IuZGlzcG9zZSgpLHRoaXMuX2ZlZWRiYWNrUj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuU3RlcmVvRmVlZGJhY2tFZmZlY3R9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDc2KSxpKDkpLGkoMTApLGkoMzkpLGkoMyksaSg3Myk7cy5kZWZhdWx0LlJldmVyYj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiZGVjYXlcIl0scy5kZWZhdWx0LlJldmVyYik7cy5kZWZhdWx0LkVmZmVjdC5jYWxsKHRoaXMsdCksdGhpcy5fY29udm9sdmVyPXRoaXMuY29udGV4dC5jcmVhdGVDb252b2x2ZXIoKSx0aGlzLmRlY2F5PXQuZGVjYXksdGhpcy5wcmVEZWxheT10LnByZURlbGF5LHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLl9jb252b2x2ZXIpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5SZXZlcmIscy5kZWZhdWx0LkVmZmVjdCkscy5kZWZhdWx0LlJldmVyYi5kZWZhdWx0cz17ZGVjYXk6MS41LHByZURlbGF5Oi4wMX0scy5kZWZhdWx0LlJldmVyYi5wcm90b3R5cGUuZ2VuZXJhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0Lk9mZmxpbmUoZnVuY3Rpb24oKXt2YXIgdD1uZXcgcy5kZWZhdWx0Lk5vaXNlLGU9bmV3IHMuZGVmYXVsdC5Ob2lzZSxpPW5ldyBzLmRlZmF1bHQuTWVyZ2U7dC5jb25uZWN0KGkubGVmdCksZS5jb25uZWN0KGkucmlnaHQpO3ZhciBuPShuZXcgcy5kZWZhdWx0LkdhaW4pLnRvTWFzdGVyKCk7aS5jb25uZWN0KG4pLHQuc3RhcnQoMCksZS5zdGFydCgwKSxuLmdhaW4uc2V0VmFsdWVBdFRpbWUoMCwwKSxuLmdhaW4uc2V0VmFsdWVBdFRpbWUoMSx0aGlzLnByZURlbGF5KSxuLmdhaW4uZXhwb25lbnRpYWxBcHByb2FjaFZhbHVlQXRUaW1lKDAsdGhpcy5wcmVEZWxheSx0aGlzLmRlY2F5K3RoaXMucHJlRGVsYXkpfS5iaW5kKHRoaXMpLHRoaXMuZGVjYXkrdGhpcy5wcmVEZWxheSkudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fY29udm9sdmVyLmJ1ZmZlcj10LmdldCgpLHRoaXN9LmJpbmQodGhpcykpfSxzLmRlZmF1bHQuUmV2ZXJiLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9jb252b2x2ZXIuZGlzY29ubmVjdCgpLHRoaXMuX2NvbnZvbHZlcj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuUmV2ZXJifSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgxMiksaSgyMyksaSgyKSxpKDMzKSxpKDE4KTtzLmRlZmF1bHQuUGl0Y2hTaGlmdD1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wicGl0Y2hcIl0scy5kZWZhdWx0LlBpdGNoU2hpZnQpO3MuZGVmYXVsdC5GZWVkYmFja0VmZmVjdC5jYWxsKHRoaXMsdCksdGhpcy5fZnJlcXVlbmN5PW5ldyBzLmRlZmF1bHQuU2lnbmFsKDApLHRoaXMuX2RlbGF5QT1uZXcgcy5kZWZhdWx0LkRlbGF5KDAsMSksdGhpcy5fbGZvQT1uZXcgcy5kZWZhdWx0LkxGTyh7bWluOjAsbWF4Oi4xLHR5cGU6XCJzYXd0b290aFwifSkuY29ubmVjdCh0aGlzLl9kZWxheUEuZGVsYXlUaW1lKSx0aGlzLl9kZWxheUI9bmV3IHMuZGVmYXVsdC5EZWxheSgwLDEpLHRoaXMuX2xmb0I9bmV3IHMuZGVmYXVsdC5MRk8oe21pbjowLG1heDouMSx0eXBlOlwic2F3dG9vdGhcIixwaGFzZToxODB9KS5jb25uZWN0KHRoaXMuX2RlbGF5Qi5kZWxheVRpbWUpLHRoaXMuX2Nyb3NzRmFkZT1uZXcgcy5kZWZhdWx0LkNyb3NzRmFkZSx0aGlzLl9jcm9zc0ZhZGVMRk89bmV3IHMuZGVmYXVsdC5MRk8oe21pbjowLG1heDoxLHR5cGU6XCJ0cmlhbmdsZVwiLHBoYXNlOjkwfSkuY29ubmVjdCh0aGlzLl9jcm9zc0ZhZGUuZmFkZSksdGhpcy5fZmVlZGJhY2tEZWxheT1uZXcgcy5kZWZhdWx0LkRlbGF5KHQuZGVsYXlUaW1lKSx0aGlzLmRlbGF5VGltZT10aGlzLl9mZWVkYmFja0RlbGF5LmRlbGF5VGltZSx0aGlzLl9yZWFkT25seShcImRlbGF5VGltZVwiKSx0aGlzLl9waXRjaD10LnBpdGNoLHRoaXMuX3dpbmRvd1NpemU9dC53aW5kb3dTaXplLHRoaXMuX2RlbGF5QS5jb25uZWN0KHRoaXMuX2Nyb3NzRmFkZS5hKSx0aGlzLl9kZWxheUIuY29ubmVjdCh0aGlzLl9jcm9zc0ZhZGUuYiksdGhpcy5fZnJlcXVlbmN5LmZhbih0aGlzLl9sZm9BLmZyZXF1ZW5jeSx0aGlzLl9sZm9CLmZyZXF1ZW5jeSx0aGlzLl9jcm9zc0ZhZGVMRk8uZnJlcXVlbmN5KSx0aGlzLmVmZmVjdFNlbmQuZmFuKHRoaXMuX2RlbGF5QSx0aGlzLl9kZWxheUIpLHRoaXMuX2Nyb3NzRmFkZS5jaGFpbih0aGlzLl9mZWVkYmFja0RlbGF5LHRoaXMuZWZmZWN0UmV0dXJuKTt2YXIgZT10aGlzLm5vdygpO3RoaXMuX2xmb0Euc3RhcnQoZSksdGhpcy5fbGZvQi5zdGFydChlKSx0aGlzLl9jcm9zc0ZhZGVMRk8uc3RhcnQoZSksdGhpcy53aW5kb3dTaXplPXRoaXMuX3dpbmRvd1NpemV9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBpdGNoU2hpZnQscy5kZWZhdWx0LkZlZWRiYWNrRWZmZWN0KSxzLmRlZmF1bHQuUGl0Y2hTaGlmdC5kZWZhdWx0cz17cGl0Y2g6MCx3aW5kb3dTaXplOi4xLGRlbGF5VGltZTowLGZlZWRiYWNrOjB9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGl0Y2hTaGlmdC5wcm90b3R5cGUsXCJwaXRjaFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGl0Y2h9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9waXRjaD10O3ZhciBlPTA7dDwwPyh0aGlzLl9sZm9BLm1pbj0wLHRoaXMuX2xmb0EubWF4PXRoaXMuX3dpbmRvd1NpemUsdGhpcy5fbGZvQi5taW49MCx0aGlzLl9sZm9CLm1heD10aGlzLl93aW5kb3dTaXplLGU9cy5kZWZhdWx0LmludGVydmFsVG9GcmVxdWVuY3lSYXRpbyh0LTEpKzEpOih0aGlzLl9sZm9BLm1pbj10aGlzLl93aW5kb3dTaXplLHRoaXMuX2xmb0EubWF4PTAsdGhpcy5fbGZvQi5taW49dGhpcy5fd2luZG93U2l6ZSx0aGlzLl9sZm9CLm1heD0wLGU9cy5kZWZhdWx0LmludGVydmFsVG9GcmVxdWVuY3lSYXRpbyh0KS0xKSx0aGlzLl9mcmVxdWVuY3kudmFsdWU9ZSooMS4yL3RoaXMuX3dpbmRvd1NpemUpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGl0Y2hTaGlmdC5wcm90b3R5cGUsXCJ3aW5kb3dTaXplXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl93aW5kb3dTaXplfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fd2luZG93U2l6ZT10aGlzLnRvU2Vjb25kcyh0KSx0aGlzLnBpdGNoPXRoaXMuX3BpdGNofX0pLHMuZGVmYXVsdC5QaXRjaFNoaWZ0LnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX2ZyZXF1ZW5jeS5kaXNwb3NlKCksdGhpcy5fZnJlcXVlbmN5PW51bGwsdGhpcy5fZGVsYXlBLmRpc2Nvbm5lY3QoKSx0aGlzLl9kZWxheUE9bnVsbCx0aGlzLl9kZWxheUIuZGlzY29ubmVjdCgpLHRoaXMuX2RlbGF5Qj1udWxsLHRoaXMuX2xmb0EuZGlzcG9zZSgpLHRoaXMuX2xmb0E9bnVsbCx0aGlzLl9sZm9CLmRpc3Bvc2UoKSx0aGlzLl9sZm9CPW51bGwsdGhpcy5fY3Jvc3NGYWRlLmRpc3Bvc2UoKSx0aGlzLl9jcm9zc0ZhZGU9bnVsbCx0aGlzLl9jcm9zc0ZhZGVMRk8uZGlzcG9zZSgpLHRoaXMuX2Nyb3NzRmFkZUxGTz1udWxsLHRoaXMuX3dyaXRhYmxlKFwiZGVsYXlUaW1lXCIpLHRoaXMuX2ZlZWRiYWNrRGVsYXkuZGlzcG9zZSgpLHRoaXMuX2ZlZWRiYWNrRGVsYXk9bnVsbCx0aGlzLmRlbGF5VGltZT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuUGl0Y2hTaGlmdH0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNzEpLGkoMiksaSgxOCk7cy5kZWZhdWx0LlBpbmdQb25nRGVsYXk9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImRlbGF5VGltZVwiLFwiZmVlZGJhY2tcIl0scy5kZWZhdWx0LlBpbmdQb25nRGVsYXkpO3MuZGVmYXVsdC5TdGVyZW9YRmVlZGJhY2tFZmZlY3QuY2FsbCh0aGlzLHQpLHRoaXMuX2xlZnREZWxheT1uZXcgcy5kZWZhdWx0LkRlbGF5KDAsdC5tYXhEZWxheVRpbWUpLHRoaXMuX3JpZ2h0RGVsYXk9bmV3IHMuZGVmYXVsdC5EZWxheSgwLHQubWF4RGVsYXlUaW1lKSx0aGlzLl9yaWdodFByZURlbGF5PW5ldyBzLmRlZmF1bHQuRGVsYXkoMCx0Lm1heERlbGF5VGltZSksdGhpcy5kZWxheVRpbWU9bmV3IHMuZGVmYXVsdC5TaWduYWwodC5kZWxheVRpbWUscy5kZWZhdWx0LlR5cGUuVGltZSksdGhpcy5lZmZlY3RTZW5kTC5jaGFpbih0aGlzLl9sZWZ0RGVsYXksdGhpcy5lZmZlY3RSZXR1cm5MKSx0aGlzLmVmZmVjdFNlbmRSLmNoYWluKHRoaXMuX3JpZ2h0UHJlRGVsYXksdGhpcy5fcmlnaHREZWxheSx0aGlzLmVmZmVjdFJldHVyblIpLHRoaXMuZGVsYXlUaW1lLmZhbih0aGlzLl9sZWZ0RGVsYXkuZGVsYXlUaW1lLHRoaXMuX3JpZ2h0RGVsYXkuZGVsYXlUaW1lLHRoaXMuX3JpZ2h0UHJlRGVsYXkuZGVsYXlUaW1lKSx0aGlzLl9mZWVkYmFja0xSLmRpc2Nvbm5lY3QoKSx0aGlzLl9mZWVkYmFja0xSLmNvbm5lY3QodGhpcy5fcmlnaHREZWxheSksdGhpcy5fcmVhZE9ubHkoW1wiZGVsYXlUaW1lXCJdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuUGluZ1BvbmdEZWxheSxzLmRlZmF1bHQuU3RlcmVvWEZlZWRiYWNrRWZmZWN0KSxzLmRlZmF1bHQuUGluZ1BvbmdEZWxheS5kZWZhdWx0cz17ZGVsYXlUaW1lOi4yNSxtYXhEZWxheVRpbWU6MX0scy5kZWZhdWx0LlBpbmdQb25nRGVsYXkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LlN0ZXJlb1hGZWVkYmFja0VmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX2xlZnREZWxheS5kaXNwb3NlKCksdGhpcy5fbGVmdERlbGF5PW51bGwsdGhpcy5fcmlnaHREZWxheS5kaXNwb3NlKCksdGhpcy5fcmlnaHREZWxheT1udWxsLHRoaXMuX3JpZ2h0UHJlRGVsYXkuZGlzcG9zZSgpLHRoaXMuX3JpZ2h0UHJlRGVsYXk9bnVsbCx0aGlzLl93cml0YWJsZShbXCJkZWxheVRpbWVcIl0pLHRoaXMuZGVsYXlUaW1lLmRpc3Bvc2UoKSx0aGlzLmRlbGF5VGltZT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuUGluZ1BvbmdEZWxheX0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTIpLGkoOSksaSgxNSk7cy5kZWZhdWx0LlBoYXNlcj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCIsXCJvY3RhdmVzXCIsXCJiYXNlRnJlcXVlbmN5XCJdLHMuZGVmYXVsdC5QaGFzZXIpO3MuZGVmYXVsdC5TdGVyZW9FZmZlY3QuY2FsbCh0aGlzLHQpLHRoaXMuX2xmb0w9bmV3IHMuZGVmYXVsdC5MRk8odC5mcmVxdWVuY3ksMCwxKSx0aGlzLl9sZm9SPW5ldyBzLmRlZmF1bHQuTEZPKHQuZnJlcXVlbmN5LDAsMSksdGhpcy5fbGZvUi5waGFzZT0xODAsdGhpcy5fYmFzZUZyZXF1ZW5jeT10LmJhc2VGcmVxdWVuY3ksdGhpcy5fb2N0YXZlcz10Lm9jdGF2ZXMsdGhpcy5RPW5ldyBzLmRlZmF1bHQuU2lnbmFsKHQuUSxzLmRlZmF1bHQuVHlwZS5Qb3NpdGl2ZSksdGhpcy5fZmlsdGVyc0w9dGhpcy5fbWFrZUZpbHRlcnModC5zdGFnZXMsdGhpcy5fbGZvTCx0aGlzLlEpLHRoaXMuX2ZpbHRlcnNSPXRoaXMuX21ha2VGaWx0ZXJzKHQuc3RhZ2VzLHRoaXMuX2xmb1IsdGhpcy5RKSx0aGlzLmZyZXF1ZW5jeT10aGlzLl9sZm9MLmZyZXF1ZW5jeSx0aGlzLmZyZXF1ZW5jeS52YWx1ZT10LmZyZXF1ZW5jeSx0aGlzLmVmZmVjdFNlbmRMLmNvbm5lY3QodGhpcy5fZmlsdGVyc0xbMF0pLHRoaXMuZWZmZWN0U2VuZFIuY29ubmVjdCh0aGlzLl9maWx0ZXJzUlswXSkscy5kZWZhdWx0LmNvbm5lY3QodGhpcy5fZmlsdGVyc0xbdC5zdGFnZXMtMV0sdGhpcy5lZmZlY3RSZXR1cm5MKSxzLmRlZmF1bHQuY29ubmVjdCh0aGlzLl9maWx0ZXJzUlt0LnN0YWdlcy0xXSx0aGlzLmVmZmVjdFJldHVyblIpLHRoaXMuX2xmb0wuZnJlcXVlbmN5LmNvbm5lY3QodGhpcy5fbGZvUi5mcmVxdWVuY3kpLHRoaXMuYmFzZUZyZXF1ZW5jeT10LmJhc2VGcmVxdWVuY3ksdGhpcy5vY3RhdmVzPXQub2N0YXZlcyx0aGlzLl9sZm9MLnN0YXJ0KCksdGhpcy5fbGZvUi5zdGFydCgpLHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLFwiUVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBoYXNlcixzLmRlZmF1bHQuU3RlcmVvRWZmZWN0KSxzLmRlZmF1bHQuUGhhc2VyLmRlZmF1bHRzPXtmcmVxdWVuY3k6LjUsb2N0YXZlczozLHN0YWdlczoxMCxROjEwLGJhc2VGcmVxdWVuY3k6MzUwfSxzLmRlZmF1bHQuUGhhc2VyLnByb3RvdHlwZS5fbWFrZUZpbHRlcnM9ZnVuY3Rpb24odCxlLGkpe2Zvcih2YXIgbj1uZXcgQXJyYXkodCksbz0wO288dDtvKyspe3ZhciBhPXRoaXMuY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTthLnR5cGU9XCJhbGxwYXNzXCIsaS5jb25uZWN0KGEuUSksZS5jb25uZWN0KGEuZnJlcXVlbmN5KSxuW29dPWF9cmV0dXJuIHMuZGVmYXVsdC5jb25uZWN0U2VyaWVzLmFwcGx5KHMuZGVmYXVsdCxuKSxufSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBoYXNlci5wcm90b3R5cGUsXCJvY3RhdmVzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vY3RhdmVzfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb2N0YXZlcz10O3ZhciBlPXRoaXMuX2Jhc2VGcmVxdWVuY3kqTWF0aC5wb3coMix0KTt0aGlzLl9sZm9MLm1heD1lLHRoaXMuX2xmb1IubWF4PWV9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QaGFzZXIucHJvdG90eXBlLFwiYmFzZUZyZXF1ZW5jeVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYmFzZUZyZXF1ZW5jeX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2Jhc2VGcmVxdWVuY3k9dCx0aGlzLl9sZm9MLm1pbj10LHRoaXMuX2xmb1IubWluPXQsdGhpcy5vY3RhdmVzPXRoaXMuX29jdGF2ZXN9fSkscy5kZWZhdWx0LlBoYXNlci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5TdGVyZW9FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJmcmVxdWVuY3lcIixcIlFcIl0pLHRoaXMuUS5kaXNwb3NlKCksdGhpcy5RPW51bGwsdGhpcy5fbGZvTC5kaXNwb3NlKCksdGhpcy5fbGZvTD1udWxsLHRoaXMuX2xmb1IuZGlzcG9zZSgpLHRoaXMuX2xmb1I9bnVsbDtmb3IodmFyIHQ9MDt0PHRoaXMuX2ZpbHRlcnNMLmxlbmd0aDt0KyspdGhpcy5fZmlsdGVyc0xbdF0uZGlzY29ubmVjdCgpLHRoaXMuX2ZpbHRlcnNMW3RdPW51bGw7dGhpcy5fZmlsdGVyc0w9bnVsbDtmb3IodmFyIGU9MDtlPHRoaXMuX2ZpbHRlcnNSLmxlbmd0aDtlKyspdGhpcy5fZmlsdGVyc1JbZV0uZGlzY29ubmVjdCgpLHRoaXMuX2ZpbHRlcnNSW2VdPW51bGw7cmV0dXJuIHRoaXMuX2ZpbHRlcnNSPW51bGwsdGhpcy5mcmVxdWVuY3k9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlBoYXNlcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApLG49KGkoNTkpLGkoMTUpLGkoMjYpLFsuMDY3NDgsLjA2NDA0LC4wODIxMiwuMDkwMDRdKSxvPVsuNzczLC44MDIsLjc1MywuNzMzXSxhPVszNDcsMTEzLDM3XTtzLmRlZmF1bHQuSkNSZXZlcmI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInJvb21TaXplXCJdLHMuZGVmYXVsdC5KQ1JldmVyYik7cy5kZWZhdWx0LlN0ZXJlb0VmZmVjdC5jYWxsKHRoaXMsdCksdGhpcy5yb29tU2l6ZT1uZXcgcy5kZWZhdWx0LlNpZ25hbCh0LnJvb21TaXplLHMuZGVmYXVsdC5UeXBlLk5vcm1hbFJhbmdlKSx0aGlzLl9zY2FsZVJvb21TaXplPW5ldyBzLmRlZmF1bHQuU2NhbGUoLS43MzMsLjE5NyksdGhpcy5fYWxscGFzc0ZpbHRlcnM9W10sdGhpcy5fZmVlZGJhY2tDb21iRmlsdGVycz1bXTtmb3IodmFyIGU9MDtlPGEubGVuZ3RoO2UrKyl7dmFyIGk9dGhpcy5jb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO2kudHlwZT1cImFsbHBhc3NcIixpLmZyZXF1ZW5jeS52YWx1ZT1hW2VdLHRoaXMuX2FsbHBhc3NGaWx0ZXJzLnB1c2goaSl9Zm9yKHZhciByPTA7cjxuLmxlbmd0aDtyKyspe3ZhciBsPW5ldyBzLmRlZmF1bHQuRmVlZGJhY2tDb21iRmlsdGVyKG5bcl0sLjEpO3RoaXMuX3NjYWxlUm9vbVNpemUuY29ubmVjdChsLnJlc29uYW5jZSksbC5yZXNvbmFuY2UudmFsdWU9b1tyXSxzLmRlZmF1bHQuY29ubmVjdCh0aGlzLl9hbGxwYXNzRmlsdGVyc1t0aGlzLl9hbGxwYXNzRmlsdGVycy5sZW5ndGgtMV0sbCkscjxuLmxlbmd0aC8yP2wuY29ubmVjdCh0aGlzLmVmZmVjdFJldHVybkwpOmwuY29ubmVjdCh0aGlzLmVmZmVjdFJldHVyblIpLHRoaXMuX2ZlZWRiYWNrQ29tYkZpbHRlcnMucHVzaChsKX10aGlzLnJvb21TaXplLmNvbm5lY3QodGhpcy5fc2NhbGVSb29tU2l6ZSkscy5kZWZhdWx0LmNvbm5lY3RTZXJpZXMuYXBwbHkocy5kZWZhdWx0LHRoaXMuX2FsbHBhc3NGaWx0ZXJzKSx0aGlzLmVmZmVjdFNlbmRMLmNvbm5lY3QodGhpcy5fYWxscGFzc0ZpbHRlcnNbMF0pLHRoaXMuZWZmZWN0U2VuZFIuY29ubmVjdCh0aGlzLl9hbGxwYXNzRmlsdGVyc1swXSksdGhpcy5fcmVhZE9ubHkoW1wicm9vbVNpemVcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5KQ1JldmVyYixzLmRlZmF1bHQuU3RlcmVvRWZmZWN0KSxzLmRlZmF1bHQuSkNSZXZlcmIuZGVmYXVsdHM9e3Jvb21TaXplOi41fSxzLmRlZmF1bHQuSkNSZXZlcmIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7Zm9yKHZhciB0PTA7dDx0aGlzLl9hbGxwYXNzRmlsdGVycy5sZW5ndGg7dCsrKXRoaXMuX2FsbHBhc3NGaWx0ZXJzW3RdLmRpc2Nvbm5lY3QoKSx0aGlzLl9hbGxwYXNzRmlsdGVyc1t0XT1udWxsO3RoaXMuX2FsbHBhc3NGaWx0ZXJzPW51bGw7Zm9yKHZhciBlPTA7ZTx0aGlzLl9mZWVkYmFja0NvbWJGaWx0ZXJzLmxlbmd0aDtlKyspdGhpcy5fZmVlZGJhY2tDb21iRmlsdGVyc1tlXS5kaXNwb3NlKCksdGhpcy5fZmVlZGJhY2tDb21iRmlsdGVyc1tlXT1udWxsO3JldHVybiB0aGlzLl9mZWVkYmFja0NvbWJGaWx0ZXJzPW51bGwsdGhpcy5fd3JpdGFibGUoW1wicm9vbVNpemVcIl0pLHRoaXMucm9vbVNpemUuZGlzcG9zZSgpLHRoaXMucm9vbVNpemU9bnVsbCx0aGlzLl9zY2FsZVJvb21TaXplLmRpc3Bvc2UoKSx0aGlzLl9zY2FsZVJvb21TaXplPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5KQ1JldmVyYn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApLG49KGkoNTQpLGkoMTUpLGkoMiksaSgxOSksaSgxMCksaSg0MiksWzE1NTcvNDQxMDAsMTYxNy80NDEwMCwxNDkxLzQ0MTAwLDE0MjIvNDQxMDAsMTI3Ny80NDEwMCwxMzU2LzQ0MTAwLDExODgvNDQxMDAsMTExNi80NDEwMF0pLG89WzIyNSw1NTYsNDQxLDM0MV07cy5kZWZhdWx0LkZyZWV2ZXJiPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJyb29tU2l6ZVwiLFwiZGFtcGVuaW5nXCJdLHMuZGVmYXVsdC5GcmVldmVyYik7cy5kZWZhdWx0LlN0ZXJlb0VmZmVjdC5jYWxsKHRoaXMsdCksdGhpcy5yb29tU2l6ZT1uZXcgcy5kZWZhdWx0LlNpZ25hbCh0LnJvb21TaXplLHMuZGVmYXVsdC5UeXBlLk5vcm1hbFJhbmdlKSx0aGlzLmRhbXBlbmluZz1uZXcgcy5kZWZhdWx0LlNpZ25hbCh0LmRhbXBlbmluZyxzLmRlZmF1bHQuVHlwZS5GcmVxdWVuY3kpLHRoaXMuX2NvbWJGaWx0ZXJzPVtdLHRoaXMuX2FsbHBhc3NGaWx0ZXJzTD1bXSx0aGlzLl9hbGxwYXNzRmlsdGVyc1I9W107Zm9yKHZhciBlPTA7ZTxvLmxlbmd0aDtlKyspe3ZhciBpPXRoaXMuY29udGV4dC5jcmVhdGVCaXF1YWRGaWx0ZXIoKTtpLnR5cGU9XCJhbGxwYXNzXCIsaS5mcmVxdWVuY3kudmFsdWU9b1tlXSx0aGlzLl9hbGxwYXNzRmlsdGVyc0wucHVzaChpKX1mb3IodmFyIGE9MDthPG8ubGVuZ3RoO2ErKyl7dmFyIHI9dGhpcy5jb250ZXh0LmNyZWF0ZUJpcXVhZEZpbHRlcigpO3IudHlwZT1cImFsbHBhc3NcIixyLmZyZXF1ZW5jeS52YWx1ZT1vW2FdLHRoaXMuX2FsbHBhc3NGaWx0ZXJzUi5wdXNoKHIpfWZvcih2YXIgbD0wO2w8bi5sZW5ndGg7bCsrKXt2YXIgdT1uZXcgcy5kZWZhdWx0Lkxvd3Bhc3NDb21iRmlsdGVyKG5bbF0pO2w8bi5sZW5ndGgvMj90aGlzLmVmZmVjdFNlbmRMLmNoYWluKHUsdGhpcy5fYWxscGFzc0ZpbHRlcnNMWzBdKTp0aGlzLmVmZmVjdFNlbmRSLmNoYWluKHUsdGhpcy5fYWxscGFzc0ZpbHRlcnNSWzBdKSx0aGlzLnJvb21TaXplLmNvbm5lY3QodS5yZXNvbmFuY2UpLHRoaXMuZGFtcGVuaW5nLmNvbm5lY3QodS5kYW1wZW5pbmcpLHRoaXMuX2NvbWJGaWx0ZXJzLnB1c2godSl9cy5kZWZhdWx0LmNvbm5lY3RTZXJpZXMuYXBwbHkocy5kZWZhdWx0LHRoaXMuX2FsbHBhc3NGaWx0ZXJzTCkscy5kZWZhdWx0LmNvbm5lY3RTZXJpZXMuYXBwbHkocy5kZWZhdWx0LHRoaXMuX2FsbHBhc3NGaWx0ZXJzUikscy5kZWZhdWx0LmNvbm5lY3QodGhpcy5fYWxscGFzc0ZpbHRlcnNMW3RoaXMuX2FsbHBhc3NGaWx0ZXJzTC5sZW5ndGgtMV0sdGhpcy5lZmZlY3RSZXR1cm5MKSxzLmRlZmF1bHQuY29ubmVjdCh0aGlzLl9hbGxwYXNzRmlsdGVyc1JbdGhpcy5fYWxscGFzc0ZpbHRlcnNSLmxlbmd0aC0xXSx0aGlzLmVmZmVjdFJldHVyblIpLHRoaXMuX3JlYWRPbmx5KFtcInJvb21TaXplXCIsXCJkYW1wZW5pbmdcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5GcmVldmVyYixzLmRlZmF1bHQuU3RlcmVvRWZmZWN0KSxzLmRlZmF1bHQuRnJlZXZlcmIuZGVmYXVsdHM9e3Jvb21TaXplOi43LGRhbXBlbmluZzozZTN9LHMuZGVmYXVsdC5GcmVldmVyYi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5TdGVyZW9FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKTtmb3IodmFyIHQ9MDt0PHRoaXMuX2FsbHBhc3NGaWx0ZXJzTC5sZW5ndGg7dCsrKXRoaXMuX2FsbHBhc3NGaWx0ZXJzTFt0XS5kaXNjb25uZWN0KCksdGhpcy5fYWxscGFzc0ZpbHRlcnNMW3RdPW51bGw7dGhpcy5fYWxscGFzc0ZpbHRlcnNMPW51bGw7Zm9yKHZhciBlPTA7ZTx0aGlzLl9hbGxwYXNzRmlsdGVyc1IubGVuZ3RoO2UrKyl0aGlzLl9hbGxwYXNzRmlsdGVyc1JbZV0uZGlzY29ubmVjdCgpLHRoaXMuX2FsbHBhc3NGaWx0ZXJzUltlXT1udWxsO3RoaXMuX2FsbHBhc3NGaWx0ZXJzUj1udWxsO2Zvcih2YXIgaT0wO2k8dGhpcy5fY29tYkZpbHRlcnMubGVuZ3RoO2krKyl0aGlzLl9jb21iRmlsdGVyc1tpXS5kaXNwb3NlKCksdGhpcy5fY29tYkZpbHRlcnNbaV09bnVsbDtyZXR1cm4gdGhpcy5fY29tYkZpbHRlcnM9bnVsbCx0aGlzLl93cml0YWJsZShbXCJyb29tU2l6ZVwiLFwiZGFtcGVuaW5nXCJdKSx0aGlzLnJvb21TaXplLmRpc3Bvc2UoKSx0aGlzLnJvb21TaXplPW51bGwsdGhpcy5kYW1wZW5pbmcuZGlzcG9zZSgpLHRoaXMuZGFtcGVuaW5nPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5GcmVldmVyYn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMzMpLGkoMiksaSgxOCk7cy5kZWZhdWx0LkZlZWRiYWNrRGVsYXk9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImRlbGF5VGltZVwiLFwiZmVlZGJhY2tcIl0scy5kZWZhdWx0LkZlZWRiYWNrRGVsYXkpO3MuZGVmYXVsdC5GZWVkYmFja0VmZmVjdC5jYWxsKHRoaXMsdCksdGhpcy5fZGVsYXlOb2RlPW5ldyBzLmRlZmF1bHQuRGVsYXkodC5kZWxheVRpbWUsdC5tYXhEZWxheSksdGhpcy5kZWxheVRpbWU9dGhpcy5fZGVsYXlOb2RlLmRlbGF5VGltZSx0aGlzLmNvbm5lY3RFZmZlY3QodGhpcy5fZGVsYXlOb2RlKSx0aGlzLl9yZWFkT25seShbXCJkZWxheVRpbWVcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5GZWVkYmFja0RlbGF5LHMuZGVmYXVsdC5GZWVkYmFja0VmZmVjdCkscy5kZWZhdWx0LkZlZWRiYWNrRGVsYXkuZGVmYXVsdHM9e2RlbGF5VGltZTouMjUsbWF4RGVsYXk6MX0scy5kZWZhdWx0LkZlZWRiYWNrRGVsYXkucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkZlZWRiYWNrRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fZGVsYXlOb2RlLmRpc3Bvc2UoKSx0aGlzLl9kZWxheU5vZGU9bnVsbCx0aGlzLl93cml0YWJsZShbXCJkZWxheVRpbWVcIl0pLHRoaXMuZGVsYXlUaW1lPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5GZWVkYmFja0RlbGF5fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg4KSxpKDcpO3MuZGVmYXVsdC5EaXN0b3J0aW9uPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJkaXN0b3J0aW9uXCJdLHMuZGVmYXVsdC5EaXN0b3J0aW9uKTtzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcyx0KSx0aGlzLl9zaGFwZXI9bmV3IHMuZGVmYXVsdC5XYXZlU2hhcGVyKDQwOTYpLHRoaXMuX2Rpc3RvcnRpb249dC5kaXN0b3J0aW9uLHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLl9zaGFwZXIpLHRoaXMuZGlzdG9ydGlvbj10LmRpc3RvcnRpb24sdGhpcy5vdmVyc2FtcGxlPXQub3ZlcnNhbXBsZX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRGlzdG9ydGlvbixzLmRlZmF1bHQuRWZmZWN0KSxzLmRlZmF1bHQuRGlzdG9ydGlvbi5kZWZhdWx0cz17ZGlzdG9ydGlvbjouNCxvdmVyc2FtcGxlOlwibm9uZVwifSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkRpc3RvcnRpb24ucHJvdG90eXBlLFwiZGlzdG9ydGlvblwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGlzdG9ydGlvbn0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2Rpc3RvcnRpb249dDt2YXIgZT0xMDAqdCxpPU1hdGguUEkvMTgwO3RoaXMuX3NoYXBlci5zZXRNYXAoZnVuY3Rpb24odCl7cmV0dXJuIE1hdGguYWJzKHQpPC4wMDE/MDooMytlKSp0KjIwKmkvKE1hdGguUEkrZSpNYXRoLmFicyh0KSl9KX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkRpc3RvcnRpb24ucHJvdG90eXBlLFwib3ZlcnNhbXBsZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2hhcGVyLm92ZXJzYW1wbGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zaGFwZXIub3ZlcnNhbXBsZT10fX0pLHMuZGVmYXVsdC5EaXN0b3J0aW9uLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9zaGFwZXIuZGlzcG9zZSgpLHRoaXMuX3NoYXBlcj1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuRGlzdG9ydGlvbn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTIpLGkoMTUpLGkoMTgpO3MuZGVmYXVsdC5DaG9ydXM9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwiZGVsYXlUaW1lXCIsXCJkZXB0aFwiXSxzLmRlZmF1bHQuQ2hvcnVzKTtzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LmNhbGwodGhpcyx0KSx0aGlzLl9kZXB0aD10LmRlcHRoLHRoaXMuX2RlbGF5VGltZT10LmRlbGF5VGltZS8xZTMsdGhpcy5fbGZvTD1uZXcgcy5kZWZhdWx0LkxGTyh7ZnJlcXVlbmN5OnQuZnJlcXVlbmN5LG1pbjowLG1heDoxfSksdGhpcy5fbGZvUj1uZXcgcy5kZWZhdWx0LkxGTyh7ZnJlcXVlbmN5OnQuZnJlcXVlbmN5LG1pbjowLG1heDoxLHBoYXNlOjE4MH0pLHRoaXMuX2RlbGF5Tm9kZUw9bmV3IHMuZGVmYXVsdC5EZWxheSx0aGlzLl9kZWxheU5vZGVSPW5ldyBzLmRlZmF1bHQuRGVsYXksdGhpcy5mcmVxdWVuY3k9dGhpcy5fbGZvTC5mcmVxdWVuY3ksdGhpcy5lZmZlY3RTZW5kTC5jaGFpbih0aGlzLl9kZWxheU5vZGVMLHRoaXMuZWZmZWN0UmV0dXJuTCksdGhpcy5lZmZlY3RTZW5kUi5jaGFpbih0aGlzLl9kZWxheU5vZGVSLHRoaXMuZWZmZWN0UmV0dXJuUiksdGhpcy5lZmZlY3RTZW5kTC5jb25uZWN0KHRoaXMuZWZmZWN0UmV0dXJuTCksdGhpcy5lZmZlY3RTZW5kUi5jb25uZWN0KHRoaXMuZWZmZWN0UmV0dXJuUiksdGhpcy5fbGZvTC5jb25uZWN0KHRoaXMuX2RlbGF5Tm9kZUwuZGVsYXlUaW1lKSx0aGlzLl9sZm9SLmNvbm5lY3QodGhpcy5fZGVsYXlOb2RlUi5kZWxheVRpbWUpLHRoaXMuX2xmb0wuc3RhcnQoKSx0aGlzLl9sZm9SLnN0YXJ0KCksdGhpcy5fbGZvTC5mcmVxdWVuY3kuY29ubmVjdCh0aGlzLl9sZm9SLmZyZXF1ZW5jeSksdGhpcy5kZXB0aD10aGlzLl9kZXB0aCx0aGlzLmZyZXF1ZW5jeS52YWx1ZT10LmZyZXF1ZW5jeSx0aGlzLnR5cGU9dC50eXBlLHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiXSksdGhpcy5zcHJlYWQ9dC5zcHJlYWR9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkNob3J1cyxzLmRlZmF1bHQuU3RlcmVvRWZmZWN0KSxzLmRlZmF1bHQuQ2hvcnVzLmRlZmF1bHRzPXtmcmVxdWVuY3k6MS41LGRlbGF5VGltZTozLjUsZGVwdGg6LjcsdHlwZTpcInNpbmVcIixzcHJlYWQ6MTgwfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNob3J1cy5wcm90b3R5cGUsXCJkZXB0aFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGVwdGh9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9kZXB0aD10O3ZhciBlPXRoaXMuX2RlbGF5VGltZSp0O3RoaXMuX2xmb0wubWluPU1hdGgubWF4KHRoaXMuX2RlbGF5VGltZS1lLDApLHRoaXMuX2xmb0wubWF4PXRoaXMuX2RlbGF5VGltZStlLHRoaXMuX2xmb1IubWluPU1hdGgubWF4KHRoaXMuX2RlbGF5VGltZS1lLDApLHRoaXMuX2xmb1IubWF4PXRoaXMuX2RlbGF5VGltZStlfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ2hvcnVzLnByb3RvdHlwZSxcImRlbGF5VGltZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gMWUzKnRoaXMuX2RlbGF5VGltZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2RlbGF5VGltZT10LzFlMyx0aGlzLmRlcHRoPXRoaXMuX2RlcHRofX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ2hvcnVzLnByb3RvdHlwZSxcInR5cGVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xmb0wudHlwZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2xmb0wudHlwZT10LHRoaXMuX2xmb1IudHlwZT10fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ2hvcnVzLnByb3RvdHlwZSxcInNwcmVhZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbGZvUi5waGFzZS10aGlzLl9sZm9MLnBoYXNlfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fbGZvTC5waGFzZT05MC10LzIsdGhpcy5fbGZvUi5waGFzZT10LzIrOTB9fSkscy5kZWZhdWx0LkNob3J1cy5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuU3RlcmVvRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fbGZvTC5kaXNwb3NlKCksdGhpcy5fbGZvTD1udWxsLHRoaXMuX2xmb1IuZGlzcG9zZSgpLHRoaXMuX2xmb1I9bnVsbCx0aGlzLl9kZWxheU5vZGVMLmRpc3Bvc2UoKSx0aGlzLl9kZWxheU5vZGVMPW51bGwsdGhpcy5fZGVsYXlOb2RlUi5kaXNwb3NlKCksdGhpcy5fZGVsYXlOb2RlUj1udWxsLHRoaXMuX3dyaXRhYmxlKFwiZnJlcXVlbmN5XCIpLHRoaXMuZnJlcXVlbmN5PW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5DaG9ydXN9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDgpLGkoNyk7cy5kZWZhdWx0LkNoZWJ5c2hldj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wib3JkZXJcIl0scy5kZWZhdWx0LkNoZWJ5c2hldik7cy5kZWZhdWx0LkVmZmVjdC5jYWxsKHRoaXMsdCksdGhpcy5fc2hhcGVyPW5ldyBzLmRlZmF1bHQuV2F2ZVNoYXBlcig0MDk2KSx0aGlzLl9vcmRlcj10Lm9yZGVyLHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLl9zaGFwZXIpLHRoaXMub3JkZXI9dC5vcmRlcix0aGlzLm92ZXJzYW1wbGU9dC5vdmVyc2FtcGxlfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5DaGVieXNoZXYscy5kZWZhdWx0LkVmZmVjdCkscy5kZWZhdWx0LkNoZWJ5c2hldi5kZWZhdWx0cz17b3JkZXI6MSxvdmVyc2FtcGxlOlwibm9uZVwifSxzLmRlZmF1bHQuQ2hlYnlzaGV2LnByb3RvdHlwZS5fZ2V0Q29lZmZpY2llbnQ9ZnVuY3Rpb24odCxlLGkpe3JldHVybiBpLmhhc093blByb3BlcnR5KGUpP2lbZV06KGlbZV09MD09PWU/MDoxPT09ZT90OjIqdCp0aGlzLl9nZXRDb2VmZmljaWVudCh0LGUtMSxpKS10aGlzLl9nZXRDb2VmZmljaWVudCh0LGUtMixpKSxpW2VdKX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DaGVieXNoZXYucHJvdG90eXBlLFwib3JkZXJcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29yZGVyfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3JkZXI9dDtmb3IodmFyIGU9bmV3IEFycmF5KDQwOTYpLGk9ZS5sZW5ndGgscz0wO3M8aTsrK3Mpe3ZhciBuPTIqcy9pLTE7ZVtzXT0wPT09bj8wOnRoaXMuX2dldENvZWZmaWNpZW50KG4sdCx7fSl9dGhpcy5fc2hhcGVyLmN1cnZlPWV9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5DaGVieXNoZXYucHJvdG90eXBlLFwib3ZlcnNhbXBsZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fc2hhcGVyLm92ZXJzYW1wbGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zaGFwZXIub3ZlcnNhbXBsZT10fX0pLHMuZGVmYXVsdC5DaGVieXNoZXYucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkVmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX3NoYXBlci5kaXNwb3NlKCksdGhpcy5fc2hhcGVyPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5DaGVieXNoZXZ9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDgpLGkoMTMpLGkoNzQpO3MuZGVmYXVsdC5CaXRDcnVzaGVyPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJiaXRzXCJdLHMuZGVmYXVsdC5CaXRDcnVzaGVyKTtzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcyx0KTt2YXIgZT0xL01hdGgucG93KDIsdC5iaXRzLTEpO3RoaXMuX3N1YnRyYWN0PW5ldyBzLmRlZmF1bHQuU3VidHJhY3QsdGhpcy5fbW9kdWxvPW5ldyBzLmRlZmF1bHQuTW9kdWxvKGUpLHRoaXMuX2JpdHM9dC5iaXRzLHRoaXMuZWZmZWN0U2VuZC5mYW4odGhpcy5fc3VidHJhY3QsdGhpcy5fbW9kdWxvKSx0aGlzLl9tb2R1bG8uY29ubmVjdCh0aGlzLl9zdWJ0cmFjdCwwLDEpLHRoaXMuX3N1YnRyYWN0LmNvbm5lY3QodGhpcy5lZmZlY3RSZXR1cm4pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5CaXRDcnVzaGVyLHMuZGVmYXVsdC5FZmZlY3QpLHMuZGVmYXVsdC5CaXRDcnVzaGVyLmRlZmF1bHRzPXtiaXRzOjR9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQml0Q3J1c2hlci5wcm90b3R5cGUsXCJiaXRzXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9iaXRzfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fYml0cz10O3ZhciBlPTEvTWF0aC5wb3coMix0LTEpO3RoaXMuX21vZHVsby52YWx1ZT1lfX0pLHMuZGVmYXVsdC5CaXRDcnVzaGVyLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9zdWJ0cmFjdC5kaXNwb3NlKCksdGhpcy5fc3VidHJhY3Q9bnVsbCx0aGlzLl9tb2R1bG8uZGlzcG9zZSgpLHRoaXMuX21vZHVsbz1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuQml0Q3J1c2hlcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNTgpLGkoNDIpLGkoOCksaSg5KTtzLmRlZmF1bHQuQXV0b1dhaD1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiYmFzZUZyZXF1ZW5jeVwiLFwib2N0YXZlc1wiLFwic2Vuc2l0aXZpdHlcIl0scy5kZWZhdWx0LkF1dG9XYWgpO3MuZGVmYXVsdC5FZmZlY3QuY2FsbCh0aGlzLHQpLHRoaXMuZm9sbG93ZXI9bmV3IHMuZGVmYXVsdC5Gb2xsb3dlcih0LmZvbGxvd2VyKSx0aGlzLl9zd2VlcFJhbmdlPW5ldyBzLmRlZmF1bHQuU2NhbGVFeHAoMCwxLC41KSx0aGlzLl9iYXNlRnJlcXVlbmN5PXQuYmFzZUZyZXF1ZW5jeSx0aGlzLl9vY3RhdmVzPXQub2N0YXZlcyx0aGlzLl9pbnB1dEJvb3N0PW5ldyBzLmRlZmF1bHQuR2Fpbix0aGlzLl9iYW5kcGFzcz1uZXcgcy5kZWZhdWx0LkZpbHRlcih7cm9sbG9mZjotNDgsZnJlcXVlbmN5OjAsUTp0LlF9KSx0aGlzLl9wZWFraW5nPW5ldyBzLmRlZmF1bHQuRmlsdGVyKDAsXCJwZWFraW5nXCIpLHRoaXMuX3BlYWtpbmcuZ2Fpbi52YWx1ZT10LmdhaW4sdGhpcy5nYWluPXRoaXMuX3BlYWtpbmcuZ2Fpbix0aGlzLlE9dGhpcy5fYmFuZHBhc3MuUSx0aGlzLmVmZmVjdFNlbmQuY2hhaW4odGhpcy5faW5wdXRCb29zdCx0aGlzLmZvbGxvd2VyLHRoaXMuX3N3ZWVwUmFuZ2UpLHRoaXMuX3N3ZWVwUmFuZ2UuY29ubmVjdCh0aGlzLl9iYW5kcGFzcy5mcmVxdWVuY3kpLHRoaXMuX3N3ZWVwUmFuZ2UuY29ubmVjdCh0aGlzLl9wZWFraW5nLmZyZXF1ZW5jeSksdGhpcy5lZmZlY3RTZW5kLmNoYWluKHRoaXMuX2JhbmRwYXNzLHRoaXMuX3BlYWtpbmcsdGhpcy5lZmZlY3RSZXR1cm4pLHRoaXMuX3NldFN3ZWVwUmFuZ2UoKSx0aGlzLnNlbnNpdGl2aXR5PXQuc2Vuc2l0aXZpdHksdGhpcy5fcmVhZE9ubHkoW1wiZ2FpblwiLFwiUVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkF1dG9XYWgscy5kZWZhdWx0LkVmZmVjdCkscy5kZWZhdWx0LkF1dG9XYWguZGVmYXVsdHM9e2Jhc2VGcmVxdWVuY3k6MTAwLG9jdGF2ZXM6NixzZW5zaXRpdml0eTowLFE6MixnYWluOjIsZm9sbG93ZXI6e2F0dGFjazouMyxyZWxlYXNlOi41fX0sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BdXRvV2FoLnByb3RvdHlwZSxcIm9jdGF2ZXNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29jdGF2ZXN9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9vY3RhdmVzPXQsdGhpcy5fc2V0U3dlZXBSYW5nZSgpfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQXV0b1dhaC5wcm90b3R5cGUsXCJiYXNlRnJlcXVlbmN5XCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9iYXNlRnJlcXVlbmN5fSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fYmFzZUZyZXF1ZW5jeT10LHRoaXMuX3NldFN3ZWVwUmFuZ2UoKX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkF1dG9XYWgucHJvdG90eXBlLFwic2Vuc2l0aXZpdHlcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5nYWluVG9EYigxL3RoaXMuX2lucHV0Qm9vc3QuZ2Fpbi52YWx1ZSl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9pbnB1dEJvb3N0LmdhaW4udmFsdWU9MS9zLmRlZmF1bHQuZGJUb0dhaW4odCl9fSkscy5kZWZhdWx0LkF1dG9XYWgucHJvdG90eXBlLl9zZXRTd2VlcFJhbmdlPWZ1bmN0aW9uKCl7dGhpcy5fc3dlZXBSYW5nZS5taW49dGhpcy5fYmFzZUZyZXF1ZW5jeSx0aGlzLl9zd2VlcFJhbmdlLm1heD1NYXRoLm1pbih0aGlzLl9iYXNlRnJlcXVlbmN5Kk1hdGgucG93KDIsdGhpcy5fb2N0YXZlcyksdGhpcy5jb250ZXh0LnNhbXBsZVJhdGUvMil9LHMuZGVmYXVsdC5BdXRvV2FoLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5FZmZlY3QucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLmZvbGxvd2VyLmRpc3Bvc2UoKSx0aGlzLmZvbGxvd2VyPW51bGwsdGhpcy5fc3dlZXBSYW5nZS5kaXNwb3NlKCksdGhpcy5fc3dlZXBSYW5nZT1udWxsLHRoaXMuX2JhbmRwYXNzLmRpc3Bvc2UoKSx0aGlzLl9iYW5kcGFzcz1udWxsLHRoaXMuX3BlYWtpbmcuZGlzcG9zZSgpLHRoaXMuX3BlYWtpbmc9bnVsbCx0aGlzLl9pbnB1dEJvb3N0LmRpc3Bvc2UoKSx0aGlzLl9pbnB1dEJvb3N0PW51bGwsdGhpcy5fd3JpdGFibGUoW1wiZ2FpblwiLFwiUVwiXSksdGhpcy5nYWluPW51bGwsdGhpcy5RPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5BdXRvV2FofSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg4KSxpKDEyKSxpKDQ4KTtzLmRlZmF1bHQuQXV0b1Bhbm5lcj1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wiZnJlcXVlbmN5XCJdLHMuZGVmYXVsdC5BdXRvUGFubmVyKTtzLmRlZmF1bHQuRWZmZWN0LmNhbGwodGhpcyx0KSx0aGlzLl9sZm89bmV3IHMuZGVmYXVsdC5MRk8oe2ZyZXF1ZW5jeTp0LmZyZXF1ZW5jeSxhbXBsaXR1ZGU6dC5kZXB0aCxtaW46LTEsbWF4OjF9KSx0aGlzLmRlcHRoPXRoaXMuX2xmby5hbXBsaXR1ZGUsdGhpcy5fcGFubmVyPW5ldyBzLmRlZmF1bHQuUGFubmVyLHRoaXMuZnJlcXVlbmN5PXRoaXMuX2xmby5mcmVxdWVuY3ksdGhpcy5jb25uZWN0RWZmZWN0KHRoaXMuX3Bhbm5lciksdGhpcy5fbGZvLmNvbm5lY3QodGhpcy5fcGFubmVyLnBhbiksdGhpcy50eXBlPXQudHlwZSx0aGlzLl9yZWFkT25seShbXCJkZXB0aFwiLFwiZnJlcXVlbmN5XCJdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQXV0b1Bhbm5lcixzLmRlZmF1bHQuRWZmZWN0KSxzLmRlZmF1bHQuQXV0b1Bhbm5lci5kZWZhdWx0cz17ZnJlcXVlbmN5OjEsdHlwZTpcInNpbmVcIixkZXB0aDoxfSxzLmRlZmF1bHQuQXV0b1Bhbm5lci5wcm90b3R5cGUuc3RhcnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2xmby5zdGFydCh0KSx0aGlzfSxzLmRlZmF1bHQuQXV0b1Bhbm5lci5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbGZvLnN0b3AodCksdGhpc30scy5kZWZhdWx0LkF1dG9QYW5uZXIucHJvdG90eXBlLnN5bmM9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2xmby5zeW5jKHQpLHRoaXN9LHMuZGVmYXVsdC5BdXRvUGFubmVyLnByb3RvdHlwZS51bnN5bmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbGZvLnVuc3luYygpLHRoaXN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQXV0b1Bhbm5lci5wcm90b3R5cGUsXCJ0eXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sZm8udHlwZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2xmby50eXBlPXR9fSkscy5kZWZhdWx0LkF1dG9QYW5uZXIucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkVmZmVjdC5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX2xmby5kaXNwb3NlKCksdGhpcy5fbGZvPW51bGwsdGhpcy5fcGFubmVyLmRpc3Bvc2UoKSx0aGlzLl9wYW5uZXI9bnVsbCx0aGlzLl93cml0YWJsZShbXCJkZXB0aFwiLFwiZnJlcXVlbmN5XCJdKSx0aGlzLmZyZXF1ZW5jeT1udWxsLHRoaXMuZGVwdGg9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkF1dG9QYW5uZXJ9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDgpLGkoMTIpLGkoOSk7cy5kZWZhdWx0LkF1dG9GaWx0ZXI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcImZyZXF1ZW5jeVwiLFwiYmFzZUZyZXF1ZW5jeVwiLFwib2N0YXZlc1wiXSxzLmRlZmF1bHQuQXV0b0ZpbHRlcik7cy5kZWZhdWx0LkVmZmVjdC5jYWxsKHRoaXMsdCksdGhpcy5fbGZvPW5ldyBzLmRlZmF1bHQuTEZPKHtmcmVxdWVuY3k6dC5mcmVxdWVuY3ksYW1wbGl0dWRlOnQuZGVwdGh9KSx0aGlzLmRlcHRoPXRoaXMuX2xmby5hbXBsaXR1ZGUsdGhpcy5mcmVxdWVuY3k9dGhpcy5fbGZvLmZyZXF1ZW5jeSx0aGlzLmZpbHRlcj1uZXcgcy5kZWZhdWx0LkZpbHRlcih0LmZpbHRlciksdGhpcy5fb2N0YXZlcz0wLHRoaXMuY29ubmVjdEVmZmVjdCh0aGlzLmZpbHRlciksdGhpcy5fbGZvLmNvbm5lY3QodGhpcy5maWx0ZXIuZnJlcXVlbmN5KSx0aGlzLnR5cGU9dC50eXBlLHRoaXMuX3JlYWRPbmx5KFtcImZyZXF1ZW5jeVwiLFwiZGVwdGhcIl0pLHRoaXMub2N0YXZlcz10Lm9jdGF2ZXMsdGhpcy5iYXNlRnJlcXVlbmN5PXQuYmFzZUZyZXF1ZW5jeX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQXV0b0ZpbHRlcixzLmRlZmF1bHQuRWZmZWN0KSxzLmRlZmF1bHQuQXV0b0ZpbHRlci5kZWZhdWx0cz17ZnJlcXVlbmN5OjEsdHlwZTpcInNpbmVcIixkZXB0aDoxLGJhc2VGcmVxdWVuY3k6MjAwLG9jdGF2ZXM6Mi42LGZpbHRlcjp7dHlwZTpcImxvd3Bhc3NcIixyb2xsb2ZmOi0xMixROjF9fSxzLmRlZmF1bHQuQXV0b0ZpbHRlci5wcm90b3R5cGUuc3RhcnQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2xmby5zdGFydCh0KSx0aGlzfSxzLmRlZmF1bHQuQXV0b0ZpbHRlci5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fbGZvLnN0b3AodCksdGhpc30scy5kZWZhdWx0LkF1dG9GaWx0ZXIucHJvdG90eXBlLnN5bmM9ZnVuY3Rpb24odCl7cmV0dXJuIHRoaXMuX2xmby5zeW5jKHQpLHRoaXN9LHMuZGVmYXVsdC5BdXRvRmlsdGVyLnByb3RvdHlwZS51bnN5bmM9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbGZvLnVuc3luYygpLHRoaXN9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQXV0b0ZpbHRlci5wcm90b3R5cGUsXCJ0eXBlXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9sZm8udHlwZX0sc2V0OmZ1bmN0aW9uKHQpe3RoaXMuX2xmby50eXBlPXR9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BdXRvRmlsdGVyLnByb3RvdHlwZSxcImJhc2VGcmVxdWVuY3lcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2xmby5taW59LHNldDpmdW5jdGlvbih0KXt0aGlzLl9sZm8ubWluPXRoaXMudG9GcmVxdWVuY3kodCksdGhpcy5vY3RhdmVzPXRoaXMuX29jdGF2ZXN9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5BdXRvRmlsdGVyLnByb3RvdHlwZSxcIm9jdGF2ZXNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29jdGF2ZXN9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9vY3RhdmVzPXQsdGhpcy5fbGZvLm1heD10aGlzLmJhc2VGcmVxdWVuY3kqTWF0aC5wb3coMix0KX19KSxzLmRlZmF1bHQuQXV0b0ZpbHRlci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuRWZmZWN0LnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fbGZvLmRpc3Bvc2UoKSx0aGlzLl9sZm89bnVsbCx0aGlzLmZpbHRlci5kaXNwb3NlKCksdGhpcy5maWx0ZXI9bnVsbCx0aGlzLl93cml0YWJsZShbXCJmcmVxdWVuY3lcIixcImRlcHRoXCJdKSx0aGlzLmZyZXF1ZW5jeT1udWxsLHRoaXMuZGVwdGg9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkF1dG9GaWx0ZXJ9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDIzKSxpKDEwKSxpKDE5KSxpKDIpLGkoMjIpLGkoMjgpO3MuZGVmYXVsdC5MaXN0ZW5lcj1mdW5jdGlvbigpe3MuZGVmYXVsdC5jYWxsKHRoaXMpLHRoaXMuX29yaWVudGF0aW9uPVswLDAsMCwwLDAsMF0sdGhpcy5fcG9zaXRpb249WzAsMCwwXSxzLmRlZmF1bHQuZ2V0Q29udGV4dChmdW5jdGlvbigpe3RoaXMuc2V0KG4uZGVmYXVsdHMpfS5iaW5kKHRoaXMpKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuTGlzdGVuZXIpLHMuZGVmYXVsdC5MaXN0ZW5lci5kZWZhdWx0cz17cG9zaXRpb25YOjAscG9zaXRpb25ZOjAscG9zaXRpb25aOjAsZm9yd2FyZFg6MCxmb3J3YXJkWTowLGZvcndhcmRaOjEsdXBYOjAsdXBZOjEsdXBaOjB9LHMuZGVmYXVsdC5MaXN0ZW5lci5wcm90b3R5cGUuaXNMaXN0ZW5lcj0hMCxzLmRlZmF1bHQuTGlzdGVuZXIucHJvdG90eXBlLl9yYW1wVGltZUNvbnN0YW50PS4wMSxzLmRlZmF1bHQuTGlzdGVuZXIucHJvdG90eXBlLnNldFBvc2l0aW9uPWZ1bmN0aW9uKHQsZSxpKXtpZih0aGlzLmNvbnRleHQucmF3Q29udGV4dC5saXN0ZW5lci5wb3NpdGlvblgpe3ZhciBzPXRoaXMubm93KCk7dGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIucG9zaXRpb25YLnNldFRhcmdldEF0VGltZSh0LHMsdGhpcy5fcmFtcFRpbWVDb25zdGFudCksdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIucG9zaXRpb25ZLnNldFRhcmdldEF0VGltZShlLHMsdGhpcy5fcmFtcFRpbWVDb25zdGFudCksdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIucG9zaXRpb25aLnNldFRhcmdldEF0VGltZShpLHMsdGhpcy5fcmFtcFRpbWVDb25zdGFudCl9ZWxzZSB0aGlzLmNvbnRleHQucmF3Q29udGV4dC5saXN0ZW5lci5zZXRQb3NpdGlvbih0LGUsaSk7cmV0dXJuIHRoaXMuX3Bvc2l0aW9uPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyksdGhpc30scy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZS5zZXRPcmllbnRhdGlvbj1mdW5jdGlvbih0LGUsaSxzLG4sbyl7aWYodGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIuZm9yd2FyZFgpe3ZhciBhPXRoaXMubm93KCk7dGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIuZm9yd2FyZFguc2V0VGFyZ2V0QXRUaW1lKHQsYSx0aGlzLl9yYW1wVGltZUNvbnN0YW50KSx0aGlzLmNvbnRleHQucmF3Q29udGV4dC5saXN0ZW5lci5mb3J3YXJkWS5zZXRUYXJnZXRBdFRpbWUoZSxhLHRoaXMuX3JhbXBUaW1lQ29uc3RhbnQpLHRoaXMuY29udGV4dC5yYXdDb250ZXh0Lmxpc3RlbmVyLmZvcndhcmRaLnNldFRhcmdldEF0VGltZShpLGEsdGhpcy5fcmFtcFRpbWVDb25zdGFudCksdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIudXBYLnNldFRhcmdldEF0VGltZShzLGEsdGhpcy5fcmFtcFRpbWVDb25zdGFudCksdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIudXBZLnNldFRhcmdldEF0VGltZShuLGEsdGhpcy5fcmFtcFRpbWVDb25zdGFudCksdGhpcy5jb250ZXh0LnJhd0NvbnRleHQubGlzdGVuZXIudXBaLnNldFRhcmdldEF0VGltZShvLGEsdGhpcy5fcmFtcFRpbWVDb25zdGFudCl9ZWxzZSB0aGlzLmNvbnRleHQucmF3Q29udGV4dC5saXN0ZW5lci5zZXRPcmllbnRhdGlvbih0LGUsaSxzLG4sbyk7cmV0dXJuIHRoaXMuX29yaWVudGF0aW9uPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyksdGhpc30sT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MaXN0ZW5lci5wcm90b3R5cGUsXCJwb3NpdGlvblhcIix7c2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3Bvc2l0aW9uWzBdPXQsdGhpcy5zZXRQb3NpdGlvbi5hcHBseSh0aGlzLHRoaXMuX3Bvc2l0aW9uKX0sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Bvc2l0aW9uWzBdfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTGlzdGVuZXIucHJvdG90eXBlLFwicG9zaXRpb25ZXCIse3NldDpmdW5jdGlvbih0KXt0aGlzLl9wb3NpdGlvblsxXT10LHRoaXMuc2V0UG9zaXRpb24uYXBwbHkodGhpcyx0aGlzLl9wb3NpdGlvbil9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb3NpdGlvblsxXX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZSxcInBvc2l0aW9uWlwiLHtzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fcG9zaXRpb25bMl09dCx0aGlzLnNldFBvc2l0aW9uLmFwcGx5KHRoaXMsdGhpcy5fcG9zaXRpb24pfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9zaXRpb25bMl19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MaXN0ZW5lci5wcm90b3R5cGUsXCJmb3J3YXJkWFwiLHtzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3JpZW50YXRpb25bMF09dCx0aGlzLnNldE9yaWVudGF0aW9uLmFwcGx5KHRoaXMsdGhpcy5fb3JpZW50YXRpb24pfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3JpZW50YXRpb25bMF19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MaXN0ZW5lci5wcm90b3R5cGUsXCJmb3J3YXJkWVwiLHtzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3JpZW50YXRpb25bMV09dCx0aGlzLnNldE9yaWVudGF0aW9uLmFwcGx5KHRoaXMsdGhpcy5fb3JpZW50YXRpb24pfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3JpZW50YXRpb25bMV19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MaXN0ZW5lci5wcm90b3R5cGUsXCJmb3J3YXJkWlwiLHtzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3JpZW50YXRpb25bMl09dCx0aGlzLnNldE9yaWVudGF0aW9uLmFwcGx5KHRoaXMsdGhpcy5fb3JpZW50YXRpb24pfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3JpZW50YXRpb25bMl19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5MaXN0ZW5lci5wcm90b3R5cGUsXCJ1cFhcIix7c2V0OmZ1bmN0aW9uKHQpe3RoaXMuX29yaWVudGF0aW9uWzNdPXQsdGhpcy5zZXRPcmllbnRhdGlvbi5hcHBseSh0aGlzLHRoaXMuX29yaWVudGF0aW9uKX0sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29yaWVudGF0aW9uWzNdfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuTGlzdGVuZXIucHJvdG90eXBlLFwidXBZXCIse3NldDpmdW5jdGlvbih0KXt0aGlzLl9vcmllbnRhdGlvbls0XT10LHRoaXMuc2V0T3JpZW50YXRpb24uYXBwbHkodGhpcyx0aGlzLl9vcmllbnRhdGlvbil9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vcmllbnRhdGlvbls0XX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZSxcInVwWlwiLHtzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3JpZW50YXRpb25bNV09dCx0aGlzLnNldE9yaWVudGF0aW9uLmFwcGx5KHRoaXMsdGhpcy5fb3JpZW50YXRpb24pfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3JpZW50YXRpb25bNV19fSkscy5kZWZhdWx0Lkxpc3RlbmVyLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29yaWVudGF0aW9uPW51bGwsdGhpcy5fcG9zaXRpb249bnVsbCx0aGlzfTt2YXIgbj1zLmRlZmF1bHQuTGlzdGVuZXI7cy5kZWZhdWx0Lkxpc3RlbmVyPW5ldyBuLHMuZGVmYXVsdC5Db250ZXh0Lm9uKFwiaW5pdFwiLGZ1bmN0aW9uKHQpe3QubGlzdGVuZXImJnQubGlzdGVuZXIuaXNMaXN0ZW5lcj9zLmRlZmF1bHQuTGlzdGVuZXI9dC5saXN0ZW5lcjpzLmRlZmF1bHQuTGlzdGVuZXI9bmV3IG59KSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lkxpc3RlbmVyfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyNCk7cy5kZWZhdWx0LkRyYXc9ZnVuY3Rpb24oKXtzLmRlZmF1bHQuY2FsbCh0aGlzKSx0aGlzLl9ldmVudHM9bmV3IHMuZGVmYXVsdC5UaW1lbGluZSx0aGlzLmV4cGlyYXRpb249LjI1LHRoaXMuYW50aWNpcGF0aW9uPS4wMDgsdGhpcy5fYm91bmREcmF3TG9vcD10aGlzLl9kcmF3TG9vcC5iaW5kKHRoaXMpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5EcmF3KSxzLmRlZmF1bHQuRHJhdy5wcm90b3R5cGUuc2NoZWR1bGU9ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5fZXZlbnRzLmFkZCh7Y2FsbGJhY2s6dCx0aW1lOnRoaXMudG9TZWNvbmRzKGUpfSksMT09PXRoaXMuX2V2ZW50cy5sZW5ndGgmJnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9ib3VuZERyYXdMb29wKSx0aGlzfSxzLmRlZmF1bHQuRHJhdy5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9ldmVudHMuY2FuY2VsKHRoaXMudG9TZWNvbmRzKHQpKSx0aGlzfSxzLmRlZmF1bHQuRHJhdy5wcm90b3R5cGUuX2RyYXdMb29wPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXMuZGVmYXVsdC5jb250ZXh0LmN1cnJlbnRUaW1lO3RoaXMuX2V2ZW50cy5sZW5ndGgmJnRoaXMuX2V2ZW50cy5wZWVrKCkudGltZS10aGlzLmFudGljaXBhdGlvbjw9dDspe3ZhciBlPXRoaXMuX2V2ZW50cy5zaGlmdCgpO3QtZS50aW1lPD10aGlzLmV4cGlyYXRpb24mJmUuY2FsbGJhY2soKX10aGlzLl9ldmVudHMubGVuZ3RoPjAmJnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9ib3VuZERyYXdMb29wKX0scy5kZWZhdWx0LkRyYXc9bmV3IHMuZGVmYXVsdC5EcmF3LGUuZGVmYXVsdD1zLmRlZmF1bHQuRHJhd30sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApLG49KGkoMykse30pO3MuZGVmYXVsdC5wcm90b3R5cGUuc2VuZD1mdW5jdGlvbih0LGUpe24uaGFzT3duUHJvcGVydHkodCl8fChuW3RdPXRoaXMuY29udGV4dC5jcmVhdGVHYWluKCkpLGU9cy5kZWZhdWx0LmRlZmF1bHRBcmcoZSwwKTt2YXIgaT1uZXcgcy5kZWZhdWx0LkdhaW4oZSxzLmRlZmF1bHQuVHlwZS5EZWNpYmVscyk7cmV0dXJuIHRoaXMuY29ubmVjdChpKSxpLmNvbm5lY3Qoblt0XSksaX0scy5kZWZhdWx0LnByb3RvdHlwZS5yZWNlaXZlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIG4uaGFzT3duUHJvcGVydHkodCl8fChuW3RdPXRoaXMuY29udGV4dC5jcmVhdGVHYWluKCkpLHMuZGVmYXVsdC5jb25uZWN0KG5bdF0sdGhpcywwLGUpLHRoaXN9LHMuZGVmYXVsdC5Db250ZXh0Lm9uKFwiaW5pdFwiLGZ1bmN0aW9uKHQpe3QuYnVzZXM/bj10LmJ1c2VzOihuPXt9LHQuYnVzZXM9bil9KSxlLmRlZmF1bHQ9cy5kZWZhdWx0fSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg0KTtzLmRlZmF1bHQuQ3RybFJhbmRvbT1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wibWluXCIsXCJtYXhcIl0scy5kZWZhdWx0LkN0cmxSYW5kb20pO3MuZGVmYXVsdC5jYWxsKHRoaXMpLHRoaXMubWluPXQubWluLHRoaXMubWF4PXQubWF4LHRoaXMuaW50ZWdlcj10LmludGVnZXJ9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkN0cmxSYW5kb20pLHMuZGVmYXVsdC5DdHJsUmFuZG9tLmRlZmF1bHRzPXttaW46MCxtYXg6MSxpbnRlZ2VyOiExfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkN0cmxSYW5kb20ucHJvdG90eXBlLFwidmFsdWVcIix7Z2V0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy50b1NlY29uZHModGhpcy5taW4pLGU9dGhpcy50b1NlY29uZHModGhpcy5tYXgpLGk9TWF0aC5yYW5kb20oKSxzPWkqdCsoMS1pKSplO3JldHVybiB0aGlzLmludGVnZXImJihzPU1hdGguZmxvb3IocykpLHN9fSksZS5kZWZhdWx0PXMuZGVmYXVsdC5DdHJsUmFuZG9tfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7cy5kZWZhdWx0LkN0cmxNYXJrb3Y9ZnVuY3Rpb24odCxlKXtzLmRlZmF1bHQuY2FsbCh0aGlzKSx0aGlzLnZhbHVlcz1zLmRlZmF1bHQuZGVmYXVsdEFyZyh0LHt9KSx0aGlzLnZhbHVlPXMuZGVmYXVsdC5kZWZhdWx0QXJnKGUsT2JqZWN0LmtleXModGhpcy52YWx1ZXMpWzBdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuQ3RybE1hcmtvdikscy5kZWZhdWx0LkN0cmxNYXJrb3YucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXtpZih0aGlzLnZhbHVlcy5oYXNPd25Qcm9wZXJ0eSh0aGlzLnZhbHVlKSl7dmFyIHQ9dGhpcy52YWx1ZXNbdGhpcy52YWx1ZV07aWYocy5kZWZhdWx0LmlzQXJyYXkodCkpZm9yKHZhciBlPXRoaXMuX2dldFByb2JEaXN0cmlidXRpb24odCksaT1NYXRoLnJhbmRvbSgpLG49MCxvPTA7bzxlLmxlbmd0aDtvKyspe3ZhciBhPWVbb107aWYoaT5uJiZpPG4rYSl7dmFyIHI9dFtvXTtzLmRlZmF1bHQuaXNPYmplY3Qocik/dGhpcy52YWx1ZT1yLnZhbHVlOnRoaXMudmFsdWU9cn1uKz1hfWVsc2UgdGhpcy52YWx1ZT10fXJldHVybiB0aGlzLnZhbHVlfSxzLmRlZmF1bHQuQ3RybE1hcmtvdi5wcm90b3R5cGUuX2dldFByb2JEaXN0cmlidXRpb249ZnVuY3Rpb24odCl7Zm9yKHZhciBlPVtdLGk9MCxuPSExLG89MDtvPHQubGVuZ3RoO28rKyl7dmFyIGE9dFtvXTtzLmRlZmF1bHQuaXNPYmplY3QoYSk/KG49ITAsZVtvXT1hLnByb2JhYmlsaXR5KTplW29dPTEvdC5sZW5ndGgsaSs9ZVtvXX1pZihuKWZvcih2YXIgcj0wO3I8ZS5sZW5ndGg7cisrKWVbcl09ZVtyXS9pO3JldHVybiBlfSxzLmRlZmF1bHQuQ3RybE1hcmtvdi5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3RoaXMudmFsdWVzPW51bGx9LGUuZGVmYXVsdD1zLmRlZmF1bHQuQ3RybE1hcmtvdn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNCk7cy5kZWZhdWx0LkN0cmxJbnRlcnBvbGF0ZT1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1widmFsdWVzXCIsXCJpbmRleFwiXSxzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlKTtzLmRlZmF1bHQuY2FsbCh0aGlzKSx0aGlzLnZhbHVlcz10LnZhbHVlcyx0aGlzLmluZGV4PXQuaW5kZXh9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkN0cmxJbnRlcnBvbGF0ZSkscy5kZWZhdWx0LkN0cmxJbnRlcnBvbGF0ZS5kZWZhdWx0cz17aW5kZXg6MCx2YWx1ZXM6W119LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlLnByb3RvdHlwZSxcInZhbHVlXCIse2dldDpmdW5jdGlvbigpe3ZhciB0PXRoaXMuaW5kZXg7dD1NYXRoLm1pbih0LHRoaXMudmFsdWVzLmxlbmd0aC0xKTt2YXIgZT1NYXRoLmZsb29yKHQpLGk9dGhpcy52YWx1ZXNbZV0scz10aGlzLnZhbHVlc1tNYXRoLmNlaWwodCldO3JldHVybiB0aGlzLl9pbnRlcnBvbGF0ZSh0LWUsaSxzKX19KSxzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlLnByb3RvdHlwZS5faW50ZXJwb2xhdGU9ZnVuY3Rpb24odCxlLGkpe2lmKHMuZGVmYXVsdC5pc0FycmF5KGUpKXtmb3IodmFyIG49W10sbz0wO288ZS5sZW5ndGg7bysrKW5bb109dGhpcy5faW50ZXJwb2xhdGUodCxlW29dLGlbb10pO3JldHVybiBufWlmKHMuZGVmYXVsdC5pc09iamVjdChlKSl7dmFyIGE9e307Zm9yKHZhciByIGluIGUpYVtyXT10aGlzLl9pbnRlcnBvbGF0ZSh0LGVbcl0saVtyXSk7cmV0dXJuIGF9cmV0dXJuKDEtdCkqKGU9dGhpcy5fdG9OdW1iZXIoZSkpK3QqKGk9dGhpcy5fdG9OdW1iZXIoaSkpfSxzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlLnByb3RvdHlwZS5fdG9OdW1iZXI9ZnVuY3Rpb24odCl7cmV0dXJuIHMuZGVmYXVsdC5pc051bWJlcih0KT90OnRoaXMudG9TZWNvbmRzKHQpfSxzLmRlZmF1bHQuQ3RybEludGVycG9sYXRlLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7dGhpcy52YWx1ZXM9bnVsbH0sZS5kZWZhdWx0PXMuZGVmYXVsdC5DdHJsSW50ZXJwb2xhdGV9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDM2KSxpKDEpO3MuZGVmYXVsdC5XYXZlZm9ybT1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wic2l6ZVwiXSxzLmRlZmF1bHQuV2F2ZWZvcm0pO3QudHlwZT1zLmRlZmF1bHQuQW5hbHlzZXIuVHlwZS5XYXZlZm9ybSxzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5fYW5hbHlzZXI9dGhpcy5pbnB1dD10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LkFuYWx5c2VyKHQpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5XYXZlZm9ybSxzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuV2F2ZWZvcm0uZGVmYXVsdHM9e3NpemU6MTAyNH0scy5kZWZhdWx0LldhdmVmb3JtLnByb3RvdHlwZS5nZXRWYWx1ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLl9hbmFseXNlci5nZXRWYWx1ZSgpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LldhdmVmb3JtLnByb3RvdHlwZSxcInNpemVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FuYWx5c2VyLnNpemV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9hbmFseXNlci5zaXplPXR9fSkscy5kZWZhdWx0LldhdmVmb3JtLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX2FuYWx5c2VyLmRpc3Bvc2UoKSx0aGlzLl9hbmFseXNlcj1udWxsfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LldhdmVmb3JtfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgyMyksaSgxMCksaSgxOSksaSgyKSxpKDIyKSxpKDI4KSxpKDEpO3MuZGVmYXVsdC5QYW5uZXIzRD1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wicG9zaXRpb25YXCIsXCJwb3NpdGlvbllcIixcInBvc2l0aW9uWlwiXSxzLmRlZmF1bHQuUGFubmVyM0QpO3MuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSx0aGlzLl9wYW5uZXI9dGhpcy5pbnB1dD10aGlzLm91dHB1dD10aGlzLmNvbnRleHQuY3JlYXRlUGFubmVyKCksdGhpcy5fcGFubmVyLnBhbm5pbmdNb2RlbD10LnBhbm5pbmdNb2RlbCx0aGlzLl9wYW5uZXIubWF4RGlzdGFuY2U9dC5tYXhEaXN0YW5jZSx0aGlzLl9wYW5uZXIuZGlzdGFuY2VNb2RlbD10LmRpc3RhbmNlTW9kZWwsdGhpcy5fcGFubmVyLmNvbmVPdXRlckdhaW49dC5jb25lT3V0ZXJHYWluLHRoaXMuX3Bhbm5lci5jb25lT3V0ZXJBbmdsZT10LmNvbmVPdXRlckFuZ2xlLHRoaXMuX3Bhbm5lci5jb25lSW5uZXJBbmdsZT10LmNvbmVJbm5lckFuZ2xlLHRoaXMuX3Bhbm5lci5yZWZEaXN0YW5jZT10LnJlZkRpc3RhbmNlLHRoaXMuX3Bhbm5lci5yb2xsb2ZmRmFjdG9yPXQucm9sbG9mZkZhY3Rvcix0aGlzLl9vcmllbnRhdGlvbj1bdC5vcmllbnRhdGlvblgsdC5vcmllbnRhdGlvblksdC5vcmllbnRhdGlvblpdLHRoaXMuX3Bvc2l0aW9uPVt0LnBvc2l0aW9uWCx0LnBvc2l0aW9uWSx0LnBvc2l0aW9uWl0sdGhpcy5vcmllbnRhdGlvblg9dC5vcmllbnRhdGlvblgsdGhpcy5vcmllbnRhdGlvblk9dC5vcmllbnRhdGlvblksdGhpcy5vcmllbnRhdGlvblo9dC5vcmllbnRhdGlvblosdGhpcy5wb3NpdGlvblg9dC5wb3NpdGlvblgsdGhpcy5wb3NpdGlvblk9dC5wb3NpdGlvblksdGhpcy5wb3NpdGlvblo9dC5wb3NpdGlvblp9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LlBhbm5lcjNELHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5QYW5uZXIzRC5kZWZhdWx0cz17cG9zaXRpb25YOjAscG9zaXRpb25ZOjAscG9zaXRpb25aOjAsb3JpZW50YXRpb25YOjAsb3JpZW50YXRpb25ZOjAsb3JpZW50YXRpb25aOjAscGFubmluZ01vZGVsOlwiZXF1YWxwb3dlclwiLG1heERpc3RhbmNlOjFlNCxkaXN0YW5jZU1vZGVsOlwiaW52ZXJzZVwiLGNvbmVPdXRlckdhaW46MCxjb25lT3V0ZXJBbmdsZTozNjAsY29uZUlubmVyQW5nbGU6MzYwLHJlZkRpc3RhbmNlOjEscm9sbG9mZkZhY3RvcjoxfSxzLmRlZmF1bHQuUGFubmVyM0QucHJvdG90eXBlLl9yYW1wVGltZUNvbnN0YW50PS4wMSxzLmRlZmF1bHQuUGFubmVyM0QucHJvdG90eXBlLnNldFBvc2l0aW9uPWZ1bmN0aW9uKHQsZSxpKXtpZih0aGlzLl9wYW5uZXIucG9zaXRpb25YKXt2YXIgcz10aGlzLm5vdygpO3RoaXMuX3Bhbm5lci5wb3NpdGlvblguc2V0VGFyZ2V0QXRUaW1lKHQscyx0aGlzLl9yYW1wVGltZUNvbnN0YW50KSx0aGlzLl9wYW5uZXIucG9zaXRpb25ZLnNldFRhcmdldEF0VGltZShlLHMsdGhpcy5fcmFtcFRpbWVDb25zdGFudCksdGhpcy5fcGFubmVyLnBvc2l0aW9uWi5zZXRUYXJnZXRBdFRpbWUoaSxzLHRoaXMuX3JhbXBUaW1lQ29uc3RhbnQpfWVsc2UgdGhpcy5fcGFubmVyLnNldFBvc2l0aW9uKHQsZSxpKTtyZXR1cm4gdGhpcy5fcG9zaXRpb249QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSx0aGlzfSxzLmRlZmF1bHQuUGFubmVyM0QucHJvdG90eXBlLnNldE9yaWVudGF0aW9uPWZ1bmN0aW9uKHQsZSxpKXtpZih0aGlzLl9wYW5uZXIub3JpZW50YXRpb25YKXt2YXIgcz10aGlzLm5vdygpO3RoaXMuX3Bhbm5lci5vcmllbnRhdGlvblguc2V0VGFyZ2V0QXRUaW1lKHQscyx0aGlzLl9yYW1wVGltZUNvbnN0YW50KSx0aGlzLl9wYW5uZXIub3JpZW50YXRpb25ZLnNldFRhcmdldEF0VGltZShlLHMsdGhpcy5fcmFtcFRpbWVDb25zdGFudCksdGhpcy5fcGFubmVyLm9yaWVudGF0aW9uWi5zZXRUYXJnZXRBdFRpbWUoaSxzLHRoaXMuX3JhbXBUaW1lQ29uc3RhbnQpfWVsc2UgdGhpcy5fcGFubmVyLnNldE9yaWVudGF0aW9uKHQsZSxpKTtyZXR1cm4gdGhpcy5fb3JpZW50YXRpb249QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKSx0aGlzfSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhbm5lcjNELnByb3RvdHlwZSxcInBvc2l0aW9uWFwiLHtzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fcG9zaXRpb25bMF09dCx0aGlzLnNldFBvc2l0aW9uLmFwcGx5KHRoaXMsdGhpcy5fcG9zaXRpb24pfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcG9zaXRpb25bMF19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYW5uZXIzRC5wcm90b3R5cGUsXCJwb3NpdGlvbllcIix7c2V0OmZ1bmN0aW9uKHQpe3RoaXMuX3Bvc2l0aW9uWzFdPXQsdGhpcy5zZXRQb3NpdGlvbi5hcHBseSh0aGlzLHRoaXMuX3Bvc2l0aW9uKX0sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Bvc2l0aW9uWzFdfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFubmVyM0QucHJvdG90eXBlLFwicG9zaXRpb25aXCIse3NldDpmdW5jdGlvbih0KXt0aGlzLl9wb3NpdGlvblsyXT10LHRoaXMuc2V0UG9zaXRpb24uYXBwbHkodGhpcyx0aGlzLl9wb3NpdGlvbil9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9wb3NpdGlvblsyXX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LlBhbm5lcjNELnByb3RvdHlwZSxcIm9yaWVudGF0aW9uWFwiLHtzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fb3JpZW50YXRpb25bMF09dCx0aGlzLnNldE9yaWVudGF0aW9uLmFwcGx5KHRoaXMsdGhpcy5fb3JpZW50YXRpb24pfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fb3JpZW50YXRpb25bMF19fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYW5uZXIzRC5wcm90b3R5cGUsXCJvcmllbnRhdGlvbllcIix7c2V0OmZ1bmN0aW9uKHQpe3RoaXMuX29yaWVudGF0aW9uWzFdPXQsdGhpcy5zZXRPcmllbnRhdGlvbi5hcHBseSh0aGlzLHRoaXMuX29yaWVudGF0aW9uKX0sZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX29yaWVudGF0aW9uWzFdfX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuUGFubmVyM0QucHJvdG90eXBlLFwib3JpZW50YXRpb25aXCIse3NldDpmdW5jdGlvbih0KXt0aGlzLl9vcmllbnRhdGlvblsyXT10LHRoaXMuc2V0T3JpZW50YXRpb24uYXBwbHkodGhpcyx0aGlzLl9vcmllbnRhdGlvbil9LGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9vcmllbnRhdGlvblsyXX19KSxzLmRlZmF1bHQuUGFubmVyM0QuX2FsaWFzUHJvcGVydHk9ZnVuY3Rpb24odCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5QYW5uZXIzRC5wcm90b3R5cGUsdCx7c2V0OmZ1bmN0aW9uKGUpe3RoaXMuX3Bhbm5lclt0XT1lfSxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFubmVyW3RdfX0pfSxzLmRlZmF1bHQuUGFubmVyM0QuX2FsaWFzUHJvcGVydHkoXCJwYW5uaW5nTW9kZWxcIikscy5kZWZhdWx0LlBhbm5lcjNELl9hbGlhc1Byb3BlcnR5KFwicmVmRGlzdGFuY2VcIikscy5kZWZhdWx0LlBhbm5lcjNELl9hbGlhc1Byb3BlcnR5KFwicm9sbG9mZkZhY3RvclwiKSxzLmRlZmF1bHQuUGFubmVyM0QuX2FsaWFzUHJvcGVydHkoXCJkaXN0YW5jZU1vZGVsXCIpLHMuZGVmYXVsdC5QYW5uZXIzRC5fYWxpYXNQcm9wZXJ0eShcImNvbmVJbm5lckFuZ2xlXCIpLHMuZGVmYXVsdC5QYW5uZXIzRC5fYWxpYXNQcm9wZXJ0eShcImNvbmVPdXRlckFuZ2xlXCIpLHMuZGVmYXVsdC5QYW5uZXIzRC5fYWxpYXNQcm9wZXJ0eShcImNvbmVPdXRlckdhaW5cIikscy5kZWZhdWx0LlBhbm5lcjNELl9hbGlhc1Byb3BlcnR5KFwibWF4RGlzdGFuY2VcIikscy5kZWZhdWx0LlBhbm5lcjNELnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9wYW5uZXIuZGlzY29ubmVjdCgpLHRoaXMuX3Bhbm5lcj1udWxsLHRoaXMuX29yaWVudGF0aW9uPW51bGwsdGhpcy5fcG9zaXRpb249bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LlBhbm5lcjNEfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSg2MCksaSg0MyksaSgxKTtzLmRlZmF1bHQuTXVsdGliYW5kQ29tcHJlc3Nvcj1mdW5jdGlvbih0KXtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdD1zLmRlZmF1bHQuZGVmYXVsdEFyZyhhcmd1bWVudHMscy5kZWZhdWx0Lk11bHRpYmFuZENvbXByZXNzb3IuZGVmYXVsdHMpLHRoaXMuX3NwbGl0dGVyPXRoaXMuaW5wdXQ9bmV3IHMuZGVmYXVsdC5NdWx0aWJhbmRTcGxpdCh7bG93RnJlcXVlbmN5OnQubG93RnJlcXVlbmN5LGhpZ2hGcmVxdWVuY3k6dC5oaWdoRnJlcXVlbmN5fSksdGhpcy5sb3dGcmVxdWVuY3k9dGhpcy5fc3BsaXR0ZXIubG93RnJlcXVlbmN5LHRoaXMuaGlnaEZyZXF1ZW5jeT10aGlzLl9zcGxpdHRlci5oaWdoRnJlcXVlbmN5LHRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuR2Fpbix0aGlzLmxvdz1uZXcgcy5kZWZhdWx0LkNvbXByZXNzb3IodC5sb3cpLHRoaXMubWlkPW5ldyBzLmRlZmF1bHQuQ29tcHJlc3Nvcih0Lm1pZCksdGhpcy5oaWdoPW5ldyBzLmRlZmF1bHQuQ29tcHJlc3Nvcih0LmhpZ2gpLHRoaXMuX3NwbGl0dGVyLmxvdy5jaGFpbih0aGlzLmxvdyx0aGlzLm91dHB1dCksdGhpcy5fc3BsaXR0ZXIubWlkLmNoYWluKHRoaXMubWlkLHRoaXMub3V0cHV0KSx0aGlzLl9zcGxpdHRlci5oaWdoLmNoYWluKHRoaXMuaGlnaCx0aGlzLm91dHB1dCksdGhpcy5fcmVhZE9ubHkoW1wiaGlnaFwiLFwibWlkXCIsXCJsb3dcIixcImhpZ2hGcmVxdWVuY3lcIixcImxvd0ZyZXF1ZW5jeVwiXSl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk11bHRpYmFuZENvbXByZXNzb3Iscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0Lk11bHRpYmFuZENvbXByZXNzb3IuZGVmYXVsdHM9e2xvdzpzLmRlZmF1bHQuQ29tcHJlc3Nvci5kZWZhdWx0cyxtaWQ6cy5kZWZhdWx0LkNvbXByZXNzb3IuZGVmYXVsdHMsaGlnaDpzLmRlZmF1bHQuQ29tcHJlc3Nvci5kZWZhdWx0cyxsb3dGcmVxdWVuY3k6MjUwLGhpZ2hGcmVxdWVuY3k6MmUzfSxzLmRlZmF1bHQuTXVsdGliYW5kQ29tcHJlc3Nvci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fc3BsaXR0ZXIuZGlzcG9zZSgpLHRoaXMuX3dyaXRhYmxlKFtcImhpZ2hcIixcIm1pZFwiLFwibG93XCIsXCJoaWdoRnJlcXVlbmN5XCIsXCJsb3dGcmVxdWVuY3lcIl0pLHRoaXMubG93LmRpc3Bvc2UoKSx0aGlzLm1pZC5kaXNwb3NlKCksdGhpcy5oaWdoLmRpc3Bvc2UoKSx0aGlzLl9zcGxpdHRlcj1udWxsLHRoaXMubG93PW51bGwsdGhpcy5taWQ9bnVsbCx0aGlzLmhpZ2g9bnVsbCx0aGlzLmxvd0ZyZXF1ZW5jeT1udWxsLHRoaXMuaGlnaEZyZXF1ZW5jeT1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuTXVsdGliYW5kQ29tcHJlc3Nvcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMTApLGkoMSk7cy5kZWZhdWx0Lk1vbm89ZnVuY3Rpb24oKXtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdGhpcy5jcmVhdGVJbnNPdXRzKDEsMCksdGhpcy5fbWVyZ2U9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5NZXJnZSxzLmRlZmF1bHQuY29ubmVjdCh0aGlzLmlucHV0LHRoaXMuX21lcmdlLDAsMCkscy5kZWZhdWx0LmNvbm5lY3QodGhpcy5pbnB1dCx0aGlzLl9tZXJnZSwwLDEpfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5Nb25vLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5Nb25vLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9tZXJnZS5kaXNwb3NlKCksdGhpcy5fbWVyZ2U9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lk1vbm99LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDUzKSxpKDUyKSxpKDQzKSxpKDEpO3MuZGVmYXVsdC5NaWRTaWRlQ29tcHJlc3Nvcj1mdW5jdGlvbih0KXtzLmRlZmF1bHQuQXVkaW9Ob2RlLmNhbGwodGhpcyksdD1zLmRlZmF1bHQuZGVmYXVsdEFyZyh0LHMuZGVmYXVsdC5NaWRTaWRlQ29tcHJlc3Nvci5kZWZhdWx0cyksdGhpcy5fbWlkU2lkZVNwbGl0PXRoaXMuaW5wdXQ9bmV3IHMuZGVmYXVsdC5NaWRTaWRlU3BsaXQsdGhpcy5fbWlkU2lkZU1lcmdlPXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuTWlkU2lkZU1lcmdlLHRoaXMubWlkPW5ldyBzLmRlZmF1bHQuQ29tcHJlc3Nvcih0Lm1pZCksdGhpcy5zaWRlPW5ldyBzLmRlZmF1bHQuQ29tcHJlc3Nvcih0LnNpZGUpLHRoaXMuX21pZFNpZGVTcGxpdC5taWQuY2hhaW4odGhpcy5taWQsdGhpcy5fbWlkU2lkZU1lcmdlLm1pZCksdGhpcy5fbWlkU2lkZVNwbGl0LnNpZGUuY2hhaW4odGhpcy5zaWRlLHRoaXMuX21pZFNpZGVNZXJnZS5zaWRlKSx0aGlzLl9yZWFkT25seShbXCJtaWRcIixcInNpZGVcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5NaWRTaWRlQ29tcHJlc3NvcixzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuTWlkU2lkZUNvbXByZXNzb3IuZGVmYXVsdHM9e21pZDp7cmF0aW86Myx0aHJlc2hvbGQ6LTI0LHJlbGVhc2U6LjAzLGF0dGFjazouMDIsa25lZToxNn0sc2lkZTp7cmF0aW86Nix0aHJlc2hvbGQ6LTMwLHJlbGVhc2U6LjI1LGF0dGFjazouMDMsa25lZToxMH19LHMuZGVmYXVsdC5NaWRTaWRlQ29tcHJlc3Nvci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoW1wibWlkXCIsXCJzaWRlXCJdKSx0aGlzLm1pZC5kaXNwb3NlKCksdGhpcy5taWQ9bnVsbCx0aGlzLnNpZGUuZGlzcG9zZSgpLHRoaXMuc2lkZT1udWxsLHRoaXMuX21pZFNpZGVTcGxpdC5kaXNwb3NlKCksdGhpcy5fbWlkU2lkZVNwbGl0PW51bGwsdGhpcy5fbWlkU2lkZU1lcmdlLmRpc3Bvc2UoKSx0aGlzLl9taWRTaWRlTWVyZ2U9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0Lk1pZFNpZGVDb21wcmVzc29yfSxmdW5jdGlvbih0LGUsaSl7XCJ1c2Ugc3RyaWN0XCI7aS5yKGUpO3ZhciBzPWkoMCk7aSgzNiksaSgxKTtzLmRlZmF1bHQuTWV0ZXI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInNtb290aGluZ1wiXSxzLmRlZmF1bHQuTWV0ZXIpO3MuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSx0aGlzLnNtb290aGluZz10LnNtb290aGluZyx0aGlzLl9ybXM9MCx0aGlzLmlucHV0PXRoaXMub3V0cHV0PXRoaXMuX2FuYWx5c2VyPW5ldyBzLmRlZmF1bHQuQW5hbHlzZXIoXCJ3YXZlZm9ybVwiLDI1Nil9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0Lk1ldGVyLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5NZXRlci5kZWZhdWx0cz17c21vb3RoaW5nOi44fSxzLmRlZmF1bHQuTWV0ZXIucHJvdG90eXBlLmdldExldmVsPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMuX2FuYWx5c2VyLmdldFZhbHVlKCksZT0wLGk9MDtpPHQubGVuZ3RoO2krKyl7dmFyIG49dFtpXTtlKz1uKm59dmFyIG89TWF0aC5zcXJ0KGUvdC5sZW5ndGgpO3JldHVybiB0aGlzLl9ybXM9TWF0aC5tYXgobyx0aGlzLl9ybXMqdGhpcy5zbW9vdGhpbmcpLHMuZGVmYXVsdC5nYWluVG9EYih0aGlzLl9ybXMpfSxzLmRlZmF1bHQuTWV0ZXIucHJvdG90eXBlLmdldFZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FuYWx5c2VyLmdldFZhbHVlKClbMF19LHMuZGVmYXVsdC5NZXRlci5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fYW5hbHlzZXIuZGlzcG9zZSgpLHRoaXMuX2FuYWx5c2VyPW51bGwsdGhpc30sZS5kZWZhdWx0PXMuZGVmYXVsdC5NZXRlcn0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koNDMpLGkoMSk7cy5kZWZhdWx0LkxpbWl0ZXI9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInRocmVzaG9sZFwiXSxzLmRlZmF1bHQuTGltaXRlcik7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuX2NvbXByZXNzb3I9dGhpcy5pbnB1dD10aGlzLm91dHB1dD1uZXcgcy5kZWZhdWx0LkNvbXByZXNzb3Ioe2F0dGFjazouMDAxLGRlY2F5Oi4wMDEsdGhyZXNob2xkOnQudGhyZXNob2xkfSksdGhpcy50aHJlc2hvbGQ9dGhpcy5fY29tcHJlc3Nvci50aHJlc2hvbGQsdGhpcy5fcmVhZE9ubHkoXCJ0aHJlc2hvbGRcIil9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkxpbWl0ZXIscy5kZWZhdWx0LkF1ZGlvTm9kZSkscy5kZWZhdWx0LkxpbWl0ZXIuZGVmYXVsdHM9e3RocmVzaG9sZDotMTJ9LHMuZGVmYXVsdC5MaW1pdGVyLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9jb21wcmVzc29yLmRpc3Bvc2UoKSx0aGlzLl9jb21wcmVzc29yPW51bGwsdGhpcy5fd3JpdGFibGUoXCJ0aHJlc2hvbGRcIiksdGhpcy50aHJlc2hvbGQ9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkxpbWl0ZXJ9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDU4KSxpKDg1KSxpKDEpO3MuZGVmYXVsdC5HYXRlPWZ1bmN0aW9uKCl7dmFyIHQ9cy5kZWZhdWx0LmRlZmF1bHRzKGFyZ3VtZW50cyxbXCJ0aHJlc2hvbGRcIixcInNtb290aGluZ1wiXSxzLmRlZmF1bHQuR2F0ZSk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMuY3JlYXRlSW5zT3V0cygxLDEpLHRoaXMuX2ZvbGxvd2VyPW5ldyBzLmRlZmF1bHQuRm9sbG93ZXIodC5zbW9vdGhpbmcpLHRoaXMuX2d0PW5ldyBzLmRlZmF1bHQuR3JlYXRlclRoYW4ocy5kZWZhdWx0LmRiVG9HYWluKHQudGhyZXNob2xkKSkscy5kZWZhdWx0LmNvbm5lY3QodGhpcy5pbnB1dCx0aGlzLm91dHB1dCkscy5kZWZhdWx0LmNvbm5lY3RTZXJpZXModGhpcy5pbnB1dCx0aGlzLl9mb2xsb3dlcix0aGlzLl9ndCx0aGlzLm91dHB1dC5nYWluKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuR2F0ZSxzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuR2F0ZS5kZWZhdWx0cz17c21vb3RoaW5nOi4xLHRocmVzaG9sZDotNDB9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuR2F0ZS5wcm90b3R5cGUsXCJ0aHJlc2hvbGRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5nYWluVG9EYih0aGlzLl9ndC52YWx1ZSl9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9ndC52YWx1ZT1zLmRlZmF1bHQuZGJUb0dhaW4odCl9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHMuZGVmYXVsdC5HYXRlLnByb3RvdHlwZSxcInNtb290aGluZ1wiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZm9sbG93ZXIuc21vb3RoaW5nfSxzZXQ6ZnVuY3Rpb24odCl7dGhpcy5fZm9sbG93ZXIuc21vb3RoaW5nPXR9fSkscy5kZWZhdWx0LkdhdGUucHJvdG90eXBlLmRpc3Bvc2U9ZnVuY3Rpb24oKXtyZXR1cm4gcy5kZWZhdWx0LkF1ZGlvTm9kZS5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpLHRoaXMuX2ZvbGxvd2VyLmRpc3Bvc2UoKSx0aGlzLl9ndC5kaXNwb3NlKCksdGhpcy5fZm9sbG93ZXI9bnVsbCx0aGlzLl9ndD1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuR2F0ZX0sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koMzYpLGkoMSk7cy5kZWZhdWx0LkZGVD1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wic2l6ZVwiXSxzLmRlZmF1bHQuRkZUKTt0LnR5cGU9cy5kZWZhdWx0LkFuYWx5c2VyLlR5cGUuRkZULHMuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzKSx0aGlzLl9hbmFseXNlcj10aGlzLmlucHV0PXRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuQW5hbHlzZXIodCl9LHMuZGVmYXVsdC5leHRlbmQocy5kZWZhdWx0LkZGVCxzLmRlZmF1bHQuQXVkaW9Ob2RlKSxzLmRlZmF1bHQuRkZULmRlZmF1bHRzPXtzaXplOjEwMjR9LHMuZGVmYXVsdC5GRlQucHJvdG90eXBlLmdldFZhbHVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FuYWx5c2VyLmdldFZhbHVlKCl9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuRkZULnByb3RvdHlwZSxcInNpemVcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2FuYWx5c2VyLnNpemV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9hbmFseXNlci5zaXplPXR9fSkscy5kZWZhdWx0LkZGVC5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3MuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl9hbmFseXNlci5kaXNwb3NlKCksdGhpcy5fYW5hbHlzZXI9bnVsbH0sZS5kZWZhdWx0PXMuZGVmYXVsdC5GRlR9LGZ1bmN0aW9uKHQsZSxpKXtcInVzZSBzdHJpY3RcIjtpLnIoZSk7dmFyIHM9aSgwKTtpKDYwKSxpKDMpLGkoMSk7cy5kZWZhdWx0LkVRMz1mdW5jdGlvbigpe3ZhciB0PXMuZGVmYXVsdC5kZWZhdWx0cyhhcmd1bWVudHMsW1wibG93XCIsXCJtaWRcIixcImhpZ2hcIl0scy5kZWZhdWx0LkVRMyk7cy5kZWZhdWx0LkF1ZGlvTm9kZS5jYWxsKHRoaXMpLHRoaXMub3V0cHV0PW5ldyBzLmRlZmF1bHQuR2Fpbix0aGlzLl9tdWx0aWJhbmRTcGxpdD10aGlzLmlucHV0PW5ldyBzLmRlZmF1bHQuTXVsdGliYW5kU3BsaXQoe2xvd0ZyZXF1ZW5jeTp0Lmxvd0ZyZXF1ZW5jeSxoaWdoRnJlcXVlbmN5OnQuaGlnaEZyZXF1ZW5jeX0pLHRoaXMuX2xvd0dhaW49bmV3IHMuZGVmYXVsdC5HYWluKHQubG93LHMuZGVmYXVsdC5UeXBlLkRlY2liZWxzKSx0aGlzLl9taWRHYWluPW5ldyBzLmRlZmF1bHQuR2Fpbih0Lm1pZCxzLmRlZmF1bHQuVHlwZS5EZWNpYmVscyksdGhpcy5faGlnaEdhaW49bmV3IHMuZGVmYXVsdC5HYWluKHQuaGlnaCxzLmRlZmF1bHQuVHlwZS5EZWNpYmVscyksdGhpcy5sb3c9dGhpcy5fbG93R2Fpbi5nYWluLHRoaXMubWlkPXRoaXMuX21pZEdhaW4uZ2Fpbix0aGlzLmhpZ2g9dGhpcy5faGlnaEdhaW4uZ2Fpbix0aGlzLlE9dGhpcy5fbXVsdGliYW5kU3BsaXQuUSx0aGlzLmxvd0ZyZXF1ZW5jeT10aGlzLl9tdWx0aWJhbmRTcGxpdC5sb3dGcmVxdWVuY3ksdGhpcy5oaWdoRnJlcXVlbmN5PXRoaXMuX211bHRpYmFuZFNwbGl0LmhpZ2hGcmVxdWVuY3ksdGhpcy5fbXVsdGliYW5kU3BsaXQubG93LmNoYWluKHRoaXMuX2xvd0dhaW4sdGhpcy5vdXRwdXQpLHRoaXMuX211bHRpYmFuZFNwbGl0Lm1pZC5jaGFpbih0aGlzLl9taWRHYWluLHRoaXMub3V0cHV0KSx0aGlzLl9tdWx0aWJhbmRTcGxpdC5oaWdoLmNoYWluKHRoaXMuX2hpZ2hHYWluLHRoaXMub3V0cHV0KSx0aGlzLl9yZWFkT25seShbXCJsb3dcIixcIm1pZFwiLFwiaGlnaFwiLFwibG93RnJlcXVlbmN5XCIsXCJoaWdoRnJlcXVlbmN5XCJdKX0scy5kZWZhdWx0LmV4dGVuZChzLmRlZmF1bHQuRVEzLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5FUTMuZGVmYXVsdHM9e2xvdzowLG1pZDowLGhpZ2g6MCxsb3dGcmVxdWVuY3k6NDAwLGhpZ2hGcmVxdWVuY3k6MjUwMH0scy5kZWZhdWx0LkVRMy5wcm90b3R5cGUuZGlzcG9zZT1mdW5jdGlvbigpe3JldHVybiBzLmRlZmF1bHQuQXVkaW9Ob2RlLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyksdGhpcy5fd3JpdGFibGUoW1wibG93XCIsXCJtaWRcIixcImhpZ2hcIixcImxvd0ZyZXF1ZW5jeVwiLFwiaGlnaEZyZXF1ZW5jeVwiXSksdGhpcy5fbXVsdGliYW5kU3BsaXQuZGlzcG9zZSgpLHRoaXMuX211bHRpYmFuZFNwbGl0PW51bGwsdGhpcy5sb3dGcmVxdWVuY3k9bnVsbCx0aGlzLmhpZ2hGcmVxdWVuY3k9bnVsbCx0aGlzLl9sb3dHYWluLmRpc3Bvc2UoKSx0aGlzLl9sb3dHYWluPW51bGwsdGhpcy5fbWlkR2Fpbi5kaXNwb3NlKCksdGhpcy5fbWlkR2Fpbj1udWxsLHRoaXMuX2hpZ2hHYWluLmRpc3Bvc2UoKSx0aGlzLl9oaWdoR2Fpbj1udWxsLHRoaXMubG93PW51bGwsdGhpcy5taWQ9bnVsbCx0aGlzLmhpZ2g9bnVsbCx0aGlzLlE9bnVsbCx0aGlzfSxlLmRlZmF1bHQ9cy5kZWZhdWx0LkVRM30sZnVuY3Rpb24odCxlLGkpe1widXNlIHN0cmljdFwiO2kucihlKTt2YXIgcz1pKDApO2koOTEpLGkoODgpLGkoMSk7cy5kZWZhdWx0LkNoYW5uZWw9ZnVuY3Rpb24oKXt2YXIgdD1zLmRlZmF1bHQuZGVmYXVsdHMoYXJndW1lbnRzLFtcInZvbHVtZVwiLFwicGFuXCJdLHMuZGVmYXVsdC5QYW5Wb2wpO3MuZGVmYXVsdC5BdWRpb05vZGUuY2FsbCh0aGlzLHQpLHRoaXMuX3NvbG89dGhpcy5pbnB1dD1uZXcgcy5kZWZhdWx0LlNvbG8odC5zb2xvKSx0aGlzLl9wYW5Wb2w9dGhpcy5vdXRwdXQ9bmV3IHMuZGVmYXVsdC5QYW5Wb2woe3Bhbjp0LnBhbix2b2x1bWU6dC52b2x1bWUsbXV0ZTp0Lm11dGV9KSx0aGlzLnBhbj10aGlzLl9wYW5Wb2wucGFuLHRoaXMudm9sdW1lPXRoaXMuX3BhblZvbC52b2x1bWUsdGhpcy5fc29sby5jb25uZWN0KHRoaXMuX3BhblZvbCksdGhpcy5fcmVhZE9ubHkoW1wicGFuXCIsXCJ2b2x1bWVcIl0pfSxzLmRlZmF1bHQuZXh0ZW5kKHMuZGVmYXVsdC5DaGFubmVsLHMuZGVmYXVsdC5BdWRpb05vZGUpLHMuZGVmYXVsdC5DaGFubmVsLmRlZmF1bHRzPXtwYW46MCx2b2x1bWU6MCxtdXRlOiExLHNvbG86ITF9LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzLmRlZmF1bHQuQ2hhbm5lbC5wcm90b3R5cGUsXCJzb2xvXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9zb2xvLnNvbG99LHNldDpmdW5jdGlvbih0KXt0aGlzLl9zb2xvLnNvbG89dH19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNoYW5uZWwucHJvdG90eXBlLFwibXV0ZWRcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3NvbG8ubXV0ZWR8fHRoaXMubXV0ZX19KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocy5kZWZhdWx0LkNoYW5uZWwucHJvdG90eXBlLFwibXV0ZVwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fcGFuVm9sLm11dGV9LHNldDpmdW5jdGlvbih0KXt0aGlzLl9wYW5Wb2wubXV0ZT10fX0pLHMuZGVmYXVsdC5DaGFubmVsLnByb3RvdHlwZS5kaXNwb3NlPWZ1bmN0aW9uKCl7cmV0dXJuIHMuZGVmYXVsdC5BdWRpb05vZGUucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKSx0aGlzLl93cml0YWJsZShbXCJwYW5cIixcInZvbHVtZVwiXSksdGhpcy5fcGFuVm9sLmRpc3Bvc2UoKSx0aGlzLl9wYW5Wb2w9bnVsbCx0aGlzLnBhbj1udWxsLHRoaXMudm9sdW1lPW51bGwsdGhpcy5fc29sby5kaXNwb3NlKCksdGhpcy5fc29sbz1udWxsLHRoaXN9LGUuZGVmYXVsdD1zLmRlZmF1bHQuQ2hhbm5lbH0sZnVuY3Rpb24odCxlKXt2YXIgaTtpPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9KCk7dHJ5e2k9aXx8RnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpfHwoMCxldmFsKShcInRoaXNcIil9Y2F0Y2godCl7XCJvYmplY3RcIj09dHlwZW9mIHdpbmRvdyYmKGk9d2luZG93KX10LmV4cG9ydHM9aX0sZnVuY3Rpb24odCxlLGkpe2koMzEpLGkoMzYpLGkoMTQ2KSxpKDQzKSxpKDIzKSxpKDQ3KSxpKDE0NSksaSg1OSksaSgxNDQpLGkoOSksaSg1OCksaSg0MSksaSgxNDMpLGkoMTIpLGkoMTQyKSxpKDU0KSxpKDEwKSxpKDE0MSksaSgxNDApLGkoNTIpLGkoNTMpLGkoMTM5KSxpKDEzOCksaSg2MCksaSg0OCksaSgxMzcpLGkoOTEpLGkoODYpLGkoODgpLGkoMTkpLGkoMjcpLGkoMTM2KSxpKDEzNSksaSgxMzQpLGkoNzgpLGkoMTMzKSxpKDEpLGkoMTEpLGkoNzcpLGkoMTMyKSxpKDgzKSxpKDIwKSxpKDE4KSxpKDEzMSksaSgzNSksaSgzKSxpKDgxKSxpKDEzMCksaSg0MCksaSg3NiksaSg3NSksaSgxNCksaSgyNCksaSgzNCksaSgxNiksaSg1NiksaSg4MCksaSgxMjkpLGkoMTI4KSxpKDEyNyksaSgxMjYpLGkoMTI1KSxpKDEyNCksaSg3MyksaSgxMjMpLGkoOCksaSgxMjIpLGkoMzMpLGkoMTIxKSxpKDEyMCksaSg3MiksaSgxMTkpLGkoMTE4KSxpKDExNyksaSgxMTYpLGkoMTUpLGkoMTE1KSxpKDExNCksaSg3MSksaSgxMTMpLGkoMTEyKSxpKDUxKSxpKDcwKSxpKDY5KSxpKDExMSksaSgxMTApLGkoMTA5KSxpKDEwOCksaSgxMDcpLGkoMjEpLGkoMTA2KSxpKDEwNSksaSgyNSksaSg2NSksaSgxMDQpLGkoMTAzKSxpKDEwMiksaSgxMDEpLGkoMzgpLGkoODcpLGkoMjkpLGkoMjIpLGkoODkpLGkoMTAwKSxpKDg1KSxpKDg0KSxpKDc0KSxpKDUpLGkoOTApLGkoOTkpLGkoNjEpLGkoMjYpLGkoNDIpLGkoMiksaSgzMCksaSgxMyksaSg4MiksaSg5OCksaSg3KSxpKDI4KSxpKDY3KSxpKDMyKSxpKDY2KSxpKDQ5KSxpKDk3KSxpKDM5KSxpKDM3KSxpKDE3KSxpKDc5KSxpKDY0KSxpKDk2KSxpKDUwKSxpKDY4KSxpKDYpLGkoNTcpLGkoOTUpLGkoNDYpLGkoOTQpLGkoNTUpLGkoNjMpLGkoNjIpLGkoNDUpLGkoNCksdC5leHBvcnRzPWkoMCkuZGVmYXVsdH1dKX0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VG9uZS5qcy5tYXAiLCJleHBvcnQgY29uc3QgX19ERUJVR0dFUl9fID0gbG9jYXRpb24gJiYgLyhkZWJ1Z2dlcj10cnVlKSQvZy50ZXN0KGxvY2F0aW9uLnNlYXJjaCk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1fX2RlYnVnZ2VyX18uanMubWFwIiwiZXhwb3J0IGNvbnN0IE9ORV9NSU5VVEVfU0VDT05EUyA9IDYwO1xuZXhwb3J0IGNvbnN0IEJBU0VfQlBNID0gMTIwO1xuZXhwb3J0IGNvbnN0IEhBTEZfQkFTRV9CUE0gPSA2MDtcbmV4cG9ydCBjb25zdCBOT1RFXzE2ID0gJzE2bic7XG5leHBvcnQgY29uc3QgTk9URV84ID0gJzhuJztcbmV4cG9ydCBjb25zdCBOT1RFXzQgPSAnNG4nO1xuZXhwb3J0IGNvbnN0IE5PVEVfMiA9ICcybic7XG5leHBvcnQgY29uc3QgTk9URV8xID0gJzFuJztcbmV4cG9ydCBjb25zdCBOT1RFX1RJTUVfUkFURV9CQVNFX09OXzhuID0ge1xuICAgICcxbic6IDgsXG4gICAgJzJuJzogNCxcbiAgICAnNG4nOiAyLFxuICAgICc4bic6IDEsXG4gICAgJzE2bic6IDAuNSxcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25zdC5qcy5tYXAiLCJpbXBvcnQgeyBfX2F3YWl0ZXIgfSBmcm9tIFwidHNsaWJcIjtcbmltcG9ydCBfVG9uZSBmcm9tICdAY21hby9jb2RlbWFvLXRvbmUnO1xuY29uc3QgVG9uZSA9IF9Ub25lO1xuaW1wb3J0IHsgTWlkaSB9IGZyb20gJ0B0b25lanMvbWlkaSc7XG5pbXBvcnQgeyBwYXJzZV9yYXdfbWlkaV90b19wcm9jZXNzZWRfbWlkaSwgcGFyc2VfcHJvY2Vzc2VkX21pZGlfdG9fcmF3X21pZGksIGdldF84bl90aW1lX2J5X2JwbSwgZGVzdHJ1Y3RfbWlkaV9uYW1lLCB9IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCB7IGNyZWF0ZV9pbnN0cnVtZW50X3N0b3JlLCBJbnN0cnVtZW50RW51bSwgfSBmcm9tICcuLi9pbnN0cnVtZW50JztcbmltcG9ydCB7IEJBU0VfQlBNIH0gZnJvbSAnLi4vY29uZmlnL2NvbnN0JztcbmltcG9ydCB7IGNyZWF0ZV9vYmJfc3RvcmUsIE9iYkVudW0gfSBmcm9tICcuLi9vYmInO1xuaW1wb3J0IHsgX19ERUJVR0dFUl9fIH0gZnJvbSAnLi4vX19kZWJ1Z2dlcl9fJztcbmltcG9ydCB7IE9iYk1hbyB9IGZyb20gJy4vT2JiTWFvJztcbmltcG9ydCB7IGlzX3Byb2Nlc3NlZF9taWRpLCBTdGF0ZUVudW0sIE1pZGlNYW9FdmVudFR5cGUsIE1JRElfTkFNRV9QUkVGSVgsIH0gZnJvbSAnLi9kZWZzJztcbmNvbnN0IGluc3RydW1lbnRfc3RvcmUgPSBjcmVhdGVfaW5zdHJ1bWVudF9zdG9yZSgpO1xuY29uc3Qgb2JiX3N0b3JlID0gY3JlYXRlX29iYl9zdG9yZSgpO1xuVG9uZS5UcmFuc3BvcnQuYnBtLnZhbHVlID0gQkFTRV9CUE07XG5Ub25lLlRyYW5zcG9ydC5zdGFydCgpO1xuZXhwb3J0IGNsYXNzIE1pZGlNYW8ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmluc3RydW1lbnRfbmFtZSA9IEluc3RydW1lbnRFbnVtLkdBTUU7IC8vIOS5kOWZqOWQje+8iOWPr+S4uiBtaWRp77yJXG4gICAgICAgIHRoaXMuZXZlbnRfaWRfY291bnRlciA9IDE7IC8vIOS6i+S7tiBpZO+8jOiHquWinlxuICAgICAgICBjb25zdCBtaWRpID0gYXJndW1lbnRzWzBdLCBvYmIgPSBhcmd1bWVudHNbMV07XG4gICAgICAgIGlmIChtaWRpKSB7XG4gICAgICAgICAgICBpZiAoaXNfcHJvY2Vzc2VkX21pZGkobWlkaSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NlZF9taWRpID0gbWlkaTtcbiAgICAgICAgICAgICAgICB0aGlzLnJhd19taWRpID0gcGFyc2VfcHJvY2Vzc2VkX21pZGlfdG9fcmF3X21pZGkobWlkaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJhd19taWRpID0gbWlkaTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NlZF9taWRpID0gcGFyc2VfcmF3X21pZGlfdG9fcHJvY2Vzc2VkX21pZGkobWlkaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyDml6Dlj4LvvIzlu7rnq4vnqbrnmb0gbWlkaVxuICAgICAgICAgICAgY29uc3QgcGxhaW5fbWlkaSA9IG5ldyBNaWRpKCk7XG4gICAgICAgICAgICBwbGFpbl9taWRpLmFkZFRyYWNrKCk7XG4gICAgICAgICAgICBwbGFpbl9taWRpLm5hbWUgPSBgJHtNSURJX05BTUVfUFJFRklYfU1JREnpn7PkuZBgO1xuICAgICAgICAgICAgcGxhaW5fbWlkaS5oZWFkZXIuc2V0VGVtcG8oQkFTRV9CUE0pO1xuICAgICAgICAgICAgdGhpcy5yYXdfbWlkaSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgcGxhaW5fbWlkaS50b0pTT04oKSksIHsgZHVyYXRpb246IHBsYWluX21pZGkuZHVyYXRpb24sIGluc3Q6IEluc3RydW1lbnRFbnVtLkdBTUUsIG9iYjogT2JiRW51bS5OT05FIH0pO1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzZWRfbWlkaSA9IHBhcnNlX3Jhd19taWRpX3RvX3Byb2Nlc3NlZF9taWRpKHRoaXMucmF3X21pZGkpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZXZlbnRfbGlzdCA9IHtcbiAgICAgICAgICAgIFtNaWRpTWFvRXZlbnRUeXBlLlNUQVJUXTogbmV3IE1hcCgpLFxuICAgICAgICAgICAgW01pZGlNYW9FdmVudFR5cGUuUExBWUlOR106IG5ldyBNYXAoKSxcbiAgICAgICAgICAgIFtNaWRpTWFvRXZlbnRUeXBlLkVORF06IG5ldyBNYXAoKSxcbiAgICAgICAgICAgIFtNaWRpTWFvRXZlbnRUeXBlLlNUT1BdOiBuZXcgTWFwKCksXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuYnBtID0gTWF0aC5yb3VuZCh0aGlzLnJhd19taWRpLmhlYWRlci50ZW1wb3NbMF0uYnBtKTtcbiAgICAgICAgdGhpcy5hbmNob3JfYnBtID0gdGhpcy5icG07XG4gICAgICAgIHRoaXMuc3RlcCA9IDA7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBTdGF0ZUVudW0uU1RPUDtcbiAgICAgICAgdGhpcy52b2x1bWUgPSAxMDA7XG4gICAgICAgIHRoaXMucGxheWJhY2tfcmF0ZSA9IDE7XG4gICAgICAgIHRoaXMubG9vcCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvb3Bfc3RhcnQgPSAtMTtcbiAgICAgICAgdGhpcy5sb29wX2VuZCA9IC0xO1xuICAgICAgICB0aGlzLl9fdGlkID0gLTE7XG4gICAgICAgIHRoaXMuZ2Fpbl9ub2RlID0gbmV3IFRvbmUuR2FpbigpLnRvTWFzdGVyKCk7XG4gICAgICAgIHRoaXMuZ2Fpbl9ub2RlLmdhaW4ucmFtcFRvKDEsIDAuMSk7XG4gICAgICAgIHRoaXMuc2V0X2luc3RydW1lbnQodGhpcy5yYXdfbWlkaS5pbnN0IHx8IEluc3RydW1lbnRFbnVtLkdBTUUpO1xuICAgICAgICBpZiAob2JiKSB7XG4gICAgICAgICAgICB0aGlzLm9iYiA9IG5ldyBPYmJNYW8oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBvYmIpLCB7IGJwbTogdGhpcy5icG0gfSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vYmIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiDpnZnmgIHmlrnms5UgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5Yid5aeL5YyW5LmQ5ZmoXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg5LmQ5Zmo5ZCNXG4gICAgICogQHBhcmFtIHtJbnN0cnVtZW50UmVzb3VyY2VDb25maWd9IGNvbmZpZyDliqDovb3phY3nva5cbiAgICAgKiBAcGFyYW0geyhyZXNvdXJjZSk9PnZvaWR9IG9ubG9hZCDliJ3lp4vljJblrozmiJDlkI7nmoTlm57osIPlh73mlbDvvIzlhaXlj4LkuLrkuZDlmajotYTmupBcbiAgICAgKiBAcGFyYW0geyhlcnIpPT52b2lkfSBvbmVycm9yIOWIneWni+WMluWksei0peaXtueahOWbnuiwg+WHveaVsO+8jOWFpeWPguS4uumUmeivr+S/oeaBr1xuICAgICAqL1xuICAgIHN0YXRpYyBpbml0X2luc3RydW1lbnQobmFtZSwgY29uZmlnLCBvbmxvYWQsIG9uZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIGluc3RydW1lbnRfc3RvcmUuaW5pdF9pbnN0cnVtZW50KG5hbWUsIGNvbmZpZywgb25sb2FkLCBvbmVycm9yKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOiOt+WPluS5kOWZqOi1hOa6kFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOS5kOWZqOWQjVxuICAgICAqIEByZXR1cm5zIHtUb25lQnVmZmVyc30g5LmQ5Zmo6LWE5rqQXG4gICAgICovXG4gICAgc3RhdGljIGdldF9pbnN0cnVtZW50X3Jlc291cmNlKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIGluc3RydW1lbnRfc3RvcmUuZ2V0X2luc3RydW1lbnRfc291cmNlKG5hbWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5pu/5o2i5oyH5a6a5LmQ5Zmo55qE6LWE5rqQXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg5LmQ5Zmo5ZCNXG4gICAgICogQHBhcmFtIHtUb25lQnVmZmVyc30gc291cmNlIOeUqOS7peabv+aNoueahOS5kOWZqOi1hOa6kFxuICAgICAqL1xuICAgIHN0YXRpYyByZXBsYWNlX2luc3RydW1lbnRfcmVzb3VyY2UobmFtZSwgc291cmNlKSB7XG4gICAgICAgIGluc3RydW1lbnRfc3RvcmUucmVwbGFjZV9pbnN0cnVtZW50X3NvdXJjZShuYW1lLCBzb3VyY2UpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5Yid5aeL5YyW5Ly05aWP6LWE5rqQXG4gICAgICogQHBhcmFtIG5hbWUg5Ly05aWP5ZCNXG4gICAgICogQHBhcmFtIHVybCDkvLTlpY/lnLDlnYBcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX0g5Yid5aeL5YyW6L+H56iL55qEIFByb21pc2XvvIzml6DlpLHotKXlpITnkIZcbiAgICAgKi9cbiAgICBzdGF0aWMgaW5pdF9vYmIobmFtZSwgdXJsKSB7XG4gICAgICAgIHJldHVybiBvYmJfc3RvcmUuaW5pdF9vYmIobmFtZSwgdXJsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOiOt+WPluS8tOWlj+i1hOa6kFxuICAgICAqIEBwYXJhbSBuYW1lIOS8tOWlj+WQjVxuICAgICAqIEByZXR1cm5zIHtUb25lQnVmZmVyfSDkvLTlpY/otYTmupBcbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0X29iYihuYW1lKSB7XG4gICAgICAgIHJldHVybiBvYmJfc3RvcmUuZ2V0X29iYihuYW1lKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOS7jiBtaWRpIHVybCDkuK3op6PmnpAgTWlkaUpTT07vvIzov5Tlm57kuIDkuKrljIXlkKsgTWlkaU1hbyDlrp7kvovnmoQgUHJvbWlzZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgbWlkaSDotYTmupAgdXJsXG4gICAgICogQHJldHVybnMge1Byb21pc2U8TWlkaU1hbyB8IG51bGw+fSBNaWRpTWFvIOWunuS+i+aIliBudWxsIOeahCBQcm9taXNlXG4gICAgICovXG4gICAgc3RhdGljIGdldF9taWRpX2J5X3VybCh1cmwgPSAnJykge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCByYXdfbWlkaSA9IHlpZWxkIE1pZGkuZnJvbVVybCh1cmwpO1xuICAgICAgICAgICAgICAgIHJhd19taWRpLm5hbWUgPSBkZWNvZGVVUklDb21wb25lbnQocmF3X21pZGkubmFtZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBNaWRpTWFvKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgcmF3X21pZGkudG9KU09OKCkpLCB7IGR1cmF0aW9uOiByYXdfbWlkaS5kdXJhdGlvbiwgaW5zdDogSW5zdHJ1bWVudEVudW0uR0FNRSwgb2JiOiBPYmJFbnVtLk5PTkUgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKF9hKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5bCGIG1pZGkg5YWD5pWw5o2u6L2s5YyW5Li66YCC55So5LqO55uR5ZCs55qEIG1pZGkg56iA55aP55+p6Zi1XG4gICAgICogQHBhcmFtIHtNaWRpSlNPTn0gbWlkaSBtaWRpIOWFg+aVsOaNrlxuICAgICAqIEByZXR1cm5zIHtQcm9jZXNzZWRNaWRpfVxuICAgICAqL1xuICAgIHN0YXRpYyBwYXJzZShtaWRpKSB7XG4gICAgICAgIHJldHVybiBwYXJzZV9yYXdfbWlkaV90b19wcm9jZXNzZWRfbWlkaShtaWRpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOWwhiBtaWRpIOeogOeWj+efqemYtei9rOWMluS4uiBtaWRpIOWFg+aVsOaNrlxuICAgICAqIEBwYXJhbSB7UHJvY2Vzc2VkTWlkaX0gcHJvY2Vzc2VkX21pZGkgbWlkaSDnqIDnlo/nn6npmLVcbiAgICAgKiBAcmV0dXJucyB7TWlkaUpTT059XG4gICAgICovXG4gICAgc3RhdGljIHBhcnNlX3RvX3Jhdyhwcm9jZXNzZWRfbWlkaSkge1xuICAgICAgICByZXR1cm4gcGFyc2VfcHJvY2Vzc2VkX21pZGlfdG9fcmF3X21pZGkocHJvY2Vzc2VkX21pZGkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5LuO5LiA5LiqIG1pZGkg6LWE5rqQ5paH5Lu2IHVybCDkuK3ojrflj5blubbop6PmnpDlh7ogbWlkaSDlhYPmlbDmja7vvIzov5Tlm57kuIDkuKrmkK3ovb0gTWlkaUpzb24g55qEIFByb21pc2VcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIG1pZGkg6LWE5rqQIHVybFxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPE1pZGlKU09OPn1cbiAgICAgKi9cbiAgICBzdGF0aWMgcGFyc2VfbWlkaV9maWxlKHVybCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgY29uc3QgbWlkaSA9IHlpZWxkIE1pZGkuZnJvbVVybCh1cmwpO1xuICAgICAgICAgICAgY29uc3QgeyBuYW1lLCBpbnN0LCBvYmIgfSA9IGRlc3RydWN0X21pZGlfbmFtZShkZWNvZGVVUklDb21wb25lbnQobWlkaS5oZWFkZXIubmFtZSkpO1xuICAgICAgICAgICAgbWlkaS5oZWFkZXIubmFtZSA9IG5hbWU7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBtaWRpLnRvSlNPTigpKSwgeyBkdXJhdGlvbjogbWlkaS5kdXJhdGlvbiwgaW5zdCxcbiAgICAgICAgICAgICAgICBvYmIgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5bCGIG1pZGkg5YWD5pWw5o2u6L6T5Ye65oiQIDgg6L+b5Yi25pWw5o2uXG4gICAgICogQHBhcmFtIHtNaWRpSlNPTn0gbWlkaSDopoHovpPlh7rnmoQgbWlkaSDlhYPmlbDmja5cbiAgICAgKiBAcmV0dXJucyB7e2RhdGE6IFVpbnQ4QXJyYXksIE1JTUU6IHN0cmluZywgc3VmZml4OiBzdHJpbmd9fSDov5Tlm57kuIDkuKrljIXlkKsgOCDov5vliLbmlbDmja7jgIFNSU1FIOexu+Wei+OAgeaWh+S7tuWQjue8gOeahOWvueixoVxuICAgICAqL1xuICAgIHN0YXRpYyBvdXRwdXRfbWlkaV9maWxlX2luX1VpbnQ4QXJyYXkobWlkaSkge1xuICAgICAgICBjb25zdCBmaWxlID0gbmV3IE1pZGkoKTtcbiAgICAgICAgZmlsZS5mcm9tSlNPTihtaWRpKTtcbiAgICAgICAgcmV0dXJuIHsgZGF0YTogZmlsZS50b0FycmF5KCksIE1JTUU6ICdhdWRpby9taWQnLCBzdWZmaXg6ICdtaWQnIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDkvb/nlKjmn5DkuKrkuZDlmajmkq3mlL7ljZXkuIDpn7PnrKZcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaW5zdHJ1bWVudCDmjIflrprkuZDlmahcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbm90ZSDopoHmkq3mlL7nmoTpn7PnrKZcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZHVyYXRpb24g5oyB57ut5pe26Ze0XG4gICAgICovXG4gICAgc3RhdGljIHBsYXlfbm90ZShpbnN0cnVtZW50ID0gSW5zdHJ1bWVudEVudW0uR0FNRSwgbm90ZSwgZHVyYXRpb24pIHtcbiAgICAgICAgaWYgKGluc3RydW1lbnQgPT09IEluc3RydW1lbnRFbnVtLk1JREkpIHtcbiAgICAgICAgICAgIGNvbnN0IHN5bnRoID0gbmV3IFRvbmUuUG9seVN5bnRoKCkudG9NYXN0ZXIoKTtcbiAgICAgICAgICAgIHN5bnRoLnRyaWdnZXJBdHRhY2tSZWxlYXNlKG5vdGUsIGR1cmF0aW9uIHx8ICc4bicpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGluc3RydW1lbnRfc3RvcmUuaXNfcmVhZHkoaW5zdHJ1bWVudCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNhbXBsZXIgPSBuZXcgVG9uZS5TYW1wbGVyKGluc3RydW1lbnRfc3RvcmUuZ2V0X2luc3RydW1lbnRfc291cmNlKGluc3RydW1lbnQpLl9idWZmZXJzKS50b01hc3RlcigpO1xuICAgICAgICAgICAgc2FtcGxlci50cmlnZ2VyQXR0YWNrUmVsZWFzZShub3RlLCBkdXJhdGlvbiB8fCAnOG4nKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgVGhlIGluc3RydW1lbnQoJHtpbnN0cnVtZW50fSkgeW91IHVzZWQgaXMgbm90IHJlYWR5IHlldC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UgaGF2ZSBsb2FkZWQgdGhlIGluc3RydW1lbnQgcmVzb3VyY2UuYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOaSreaUvumdniBtaWRpIOmfs+S5kFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg6Z+z5LmQ6LWE5rqQIHVybFxuICAgICAqIEByZXR1cm5zIHtUb25lLlBsYXllcn0g6Z+z5LmQ5o6n5Yi25ZmoXG4gICAgICovXG4gICAgc3RhdGljIHBsYXlfbm9ybWFsX211c2ljKHVybCkge1xuICAgICAgICBjb25zdCBwbGF5ZXIgPSBuZXcgVG9uZS5QbGF5ZXIodXJsLCAoKSA9PiBwbGF5ZXIuc3RhcnQoKSkudG9NYXN0ZXIoKTtcbiAgICAgICAgcmV0dXJuIHBsYXllcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOWIm+W7uuS4gOS4quepuueZvSBtaWRpIOWFg+aVsOaNrlxuICAgICAqIEByZXR1cm5zIHtNaWRpfSDnqbogbWlkaVxuICAgICAqL1xuICAgIHN0YXRpYyBjcmVhdGVfcGxhaW5fbWlkaSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNaWRpKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDph43nva7lhajlsYAgYnBtIOS4uiAxMjBcbiAgICAgKi9cbiAgICBzdGF0aWMgcmVzZXRfZ2xvYmFsX2JwbSgpIHtcbiAgICAgICAgVG9uZS5UcmFuc3BvcnQuYnBtLnZhbHVlID0gQkFTRV9CUE07XG4gICAgfVxuICAgIC8vIGlvcyBzYWZhcmkg56aB5q2i5LitIEF1ZGlvQ29udGV4dCDoh6rliqjmv4DmtLvjgIJcbiAgICAvLyDlv4XpobvlnKjnlKjmiLfkuLvliqjop6blj5HnmoTkuovku7bvvIjkuI3ljIXlkKvpvKDmoIfnp7vliqjkuovku7bvvInkuK3kv67mlLkgQXVkaW9Db250ZXh0IOeahOeKtuaAgeW5tua/gOa0u+Wug++8iOWQjOatpeOAgeW8guatpeWdh+WPr++8ieOAguWQpuWImeaXoOazleaSreaUvuWjsOmfs+OAglxuICAgIC8vIOS/neivgSBNaWRpTWFvIOWunuS+i+aYr+WcqOeUqOaIt+S4u+WKqOinpuWPkeeahOS6i+S7tuS4reiiq+WunuS+i+WMlueahO+8jOWwseiDveS/neivgSBUb25lIOeahCBBdWRpb0NvbnRleHQg6KKr5q2j56Gu5r+A5rS744CCXG4gICAgLy8gVG9uZS5zdGFydCgpIOWwseaYr+aJp+ihjOS6hiBBdWRpb0NvbnRleHQucmVzdW1lKCk7XG4gICAgc3RhdGljIGFjdGl2YXRlX2F1ZGlvX2NvbnRleHQoKSB7XG4gICAgICAgIFRvbmUuY29udGV4dC5zdGF0ZSA9PT0gJ3N1c3BlbmRlZCcgJiYgKCgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsgcmV0dXJuIHlpZWxkIFRvbmUuc3RhcnQoKTsgfSkpKCk7XG4gICAgfVxuICAgIC8qKiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiDpnZnmgIHmlrnms5UgZW5kICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgLyoqICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIOWunuS+i+aWueazlSAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDmm7TmlrAgTWlkaU1hbyDlrp7kvovnmoQgbWlkaSDmlbDmja7miJbkvLTlpY/mlbDmja5cbiAgICAgKiBAcGFyYW0ge3ttaWRpPzogTWlkaUpTT04gfCBQcm9jZXNzZWRNaWRpLCBvYmI/OiB7IGRhdGE/OiBhbnk7IG5hbWU/OiBzdHJpbmc7IGJwbT86IG51bWJlciB9fX0gZGF0YSBtaWRpIOaIluS8tOWlj+aVsOaNrui9veS9k++8jFxuICAgICAqIOWFtuS4rSBvYmIuZGF0YSDkuLrkvLTlpY/otYTmupDvvIxvYmIubmFtZSDkuLrkvLTlpY/lkI3vvIxvYmIuYnBtIOS4uuS8tOWlj+eahOiKguaLjVxuICAgICAqIEByZXR1cm5zIHtNaWRpTWFvfSBNaWRpTWFvIOWunuS+i+acrOi6q1xuICAgICAqL1xuICAgIHVwZGF0ZShkYXRhKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlICE9PSBTdGF0ZUVudW0uU1RPUCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBtaWRpLCBvYmIgfSA9IGRhdGE7XG4gICAgICAgIC8vIOS4u+aXi+W+i+OAgeS8tOWlj+WIhuW8gOabtOaWsO+8jOW/veeVpSBtaWRpIOS4reaQuuW4pueahCBvYmIg5L+h5oGv77yM5Y+q5pu05paw5Li75peL5b6L55u45YWzXG4gICAgICAgIGlmIChtaWRpKSB7XG4gICAgICAgICAgICBpZiAoaXNfcHJvY2Vzc2VkX21pZGkobWlkaSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NlZF9taWRpID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBtaWRpKSwgeyBvYmI6IHRoaXMucHJvY2Vzc2VkX21pZGkub2JiIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMucmF3X21pZGkgPSBwYXJzZV9wcm9jZXNzZWRfbWlkaV90b19yYXdfbWlkaShtaWRpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmF3X21pZGkgPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG1pZGkpLCB7IG9iYjogdGhpcy5yYXdfbWlkaS5vYmIgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzZWRfbWlkaSA9IHBhcnNlX3Jhd19taWRpX3RvX3Byb2Nlc3NlZF9taWRpKG1pZGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hbmNob3JfYnBtID0gdGhpcy5icG0gPSBNYXRoLnJvdW5kKHRoaXMucmF3X21pZGkuaGVhZGVyLnRlbXBvc1swXS5icG0pO1xuICAgICAgICAgICAgdGhpcy5pbnN0cnVtZW50X25hbWUgPSBtaWRpLmluc3Q7XG4gICAgICAgICAgICB0aGlzLnNldF9pbnN0cnVtZW50KG1pZGkuaW5zdCk7XG4gICAgICAgICAgICB0aGlzLnNldF9wbGF5YmFja19yYXRlKDEpO1xuICAgICAgICB9XG4gICAgICAgIC8vIOabtOaWsOS8tOWlj++8jOWwhuS4u+aXi+W+i+S4reS8tOWlj+S/oeaBr+S4gOWQjOabtOaWsFxuICAgICAgICBpZiAob2JiKSB7XG4gICAgICAgICAgICB0aGlzLm9iYiA9IHRoaXMub2JiID8gdGhpcy5vYmIudXBkYXRlKG9iYikgOiBuZXcgT2JiTWFvKCkudXBkYXRlKG9iYik7XG4gICAgICAgICAgICAvLyDkvb/kvLTlpY/kuI7kuLvml4vlvovoioLmi43kuIDoh7RcbiAgICAgICAgICAgIHRoaXMub2JiLnNldF9wbGF5YmFja19yYXRlX2J5X2JwbSh0aGlzLmFuY2hvcl9icG0gKiB0aGlzLnBsYXliYWNrX3JhdGUpO1xuICAgICAgICAgICAgb2JiLm5hbWUgJiYgKHRoaXMucmF3X21pZGkub2JiID0gb2JiLm5hbWUpO1xuICAgICAgICAgICAgb2JiLm5hbWUgJiYgKHRoaXMucHJvY2Vzc2VkX21pZGkub2JiID0gb2JiLm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5riF6ZmkIE1pZGlNYW8g5a6e5L6L55qE5Ly05aWPXG4gICAgICogQHJldHVybnMge01pZGlNYW99IE1pZGlNYW8g5a6e5L6L6Ieq6LqrXG4gICAgICovXG4gICAgY2xlYXJfb2JiKCkge1xuICAgICAgICB0aGlzLm9iYiA9IG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5pKt5pS+5a6e5L6L5Yqg6L2955qEIG1pZGkg6Z+z5LmQXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRhcmdldF9zdGVwIOWMuumXtOaSreaUvuaXtu+8jOWMuumXtOe7iOeCuVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBvYmJfb2Zmc2V0IOS8tOWlj+W8gOWni+WBj+enu+mHj1xuICAgICAqIEByZXR1cm5zIHtNaWRpSW5mb31cbiAgICAgKi9cbiAgICBfcGxheSh0YXJnZXRfc3RlcCwgb2JiX29mZnNldCkge1xuICAgICAgICBpZiAodGhpcy5wcm9jZXNzZWRfbWlkaS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldF9taWRpX2luZm8oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pbnN0cnVtZW50X25hbWUgIT09IEluc3RydW1lbnRFbnVtLk1JREkgJiYgIXRoaXMuaW5zdHJ1bWVudCkge1xuICAgICAgICAgICAgY29uc3QgcmVzID0gdGhpcy5zZXRfaW5zdHJ1bWVudCh0aGlzLmluc3RydW1lbnRfbmFtZSk7XG4gICAgICAgICAgICBpZiAoIXJlcykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldF9taWRpX2luZm8oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBUSU1FXzhuID0gZ2V0XzhuX3RpbWVfYnlfYnBtKHRoaXMuYnBtKTtcbiAgICAgICAgbGV0IG5ld19wbGF5ID0gdHJ1ZTtcbiAgICAgICAgbGV0IGN1cnJlbnRfbm90ZXMgPSBbXTtcbiAgICAgICAgY29uc3QgX19wbGF5ID0gKHRpbWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IF9fV0FZID0gdGhpcy5pbnN0cnVtZW50X25hbWUgPT09IEluc3RydW1lbnRFbnVtLk1JREkgP1xuICAgICAgICAgICAgICAgIHRoaXMucGxheV93aXRoX21pZGkgOlxuICAgICAgICAgICAgICAgIHRoaXMucGxheV93aXRoX2luc3RydW1lbnQ7XG4gICAgICAgICAgICBjb25zdCBfX1NZTiA9IHRoaXMuaW5zdHJ1bWVudF9uYW1lID09PSBJbnN0cnVtZW50RW51bS5NSURJID9cbiAgICAgICAgICAgICAgICB0aGlzLmluc3RydW1lbnRfbWlkaSA6XG4gICAgICAgICAgICAgICAgdGhpcy5pbnN0cnVtZW50O1xuICAgICAgICAgICAgY3VycmVudF9ub3RlcyA9IF9fV0FZLmNhbGwodGhpcywgdGhpcy5zdGVwLCBfX1NZTik7XG4gICAgICAgICAgICBfX0RFQlVHR0VSX18gJiYgY29uc29sZS5sb2coJ21pZGkgcGxheWluZycpO1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyX2V2ZW50KE1pZGlNYW9FdmVudFR5cGUuUExBWUlORywgY3VycmVudF9ub3RlcywgdGltZSk7XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudF9ub3RlcztcbiAgICAgICAgfTtcbiAgICAgICAgLy8g5L2/5q+P5LiA5Liq5rOo5YaM55qEIHNjaGVkdWxlUmVwZWF0IOmUmuWumiAxMjAg55qEIGJwbe+8jOS7peatpOadpeWJpeemuyBtaWRpIOacrOi6q+eahCBicG0g5ZKM5YWo5bGAIGJwbSDnmoTlhbPns7vvvIzpgb/lhY3lnKjlj5jpgJ/ml7bkuqfnlJ/nuqDnvKDlvbHlk43jgIJcbiAgICAgICAgY29uc3QgVFJVRV9CUE0gPSBUb25lLlRyYW5zcG9ydC5icG0udmFsdWU7XG4gICAgICAgIFRvbmUuVHJhbnNwb3J0LmJwbS52YWx1ZSA9IEJBU0VfQlBNO1xuICAgICAgICB0aGlzLl9fdGlkID0gVG9uZS5UcmFuc3BvcnQuc2NoZWR1bGVSZXBlYXQoKHRpbWUpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIGlmIChuZXdfcGxheSkge1xuICAgICAgICAgICAgICAgIF9fREVCVUdHRVJfXyAmJiBjb25zb2xlLmxvZygnbWlkaSBzdGFydCcpO1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcl9ldmVudChNaWRpTWFvRXZlbnRUeXBlLlNUQVJULCBjdXJyZW50X25vdGVzLCB0aW1lKTtcbiAgICAgICAgICAgICAgICAvLyDlvIDlp4vmkq3mlL7ml7bmo4DmtYvmgaLlpI3mkq3mlL7plb/pn7PnrKZcbiAgICAgICAgICAgICAgICB0aGlzLnJlY292ZXJfbG9uZ19ub3RlKCk7XG4gICAgICAgICAgICAgICAgKF9hID0gdGhpcy5vYmIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wbGF5KG9iYl9vZmZzZXQpO1xuICAgICAgICAgICAgICAgIG5ld19wbGF5ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50X25vdGVzID0gW107XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRhcmdldF9zdGVwID09PSAnbnVtYmVyJyAmJiB0aGlzLnN0ZXAgPD0gdGFyZ2V0X3N0ZXApIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50X25vdGVzID0gX19wbGF5KHRpbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIHRhcmdldF9zdGVwICE9PSAnbnVtYmVyJyAmJlxuICAgICAgICAgICAgICAgIHRoaXMuc3RlcCA8IHRoaXMucHJvY2Vzc2VkX21pZGkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudF9ub3RlcyA9IF9fcGxheSh0aW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIOW+queOr+aSreaUvu+8jOiwg+aVtOatpei/m+WZqFxuICAgICAgICAgICAgaWYgKHRoaXMubG9vcCAmJiB0aGlzLnN0ZXAgPT09IHRoaXMubG9vcF9lbmQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKHRoaXMuc3RlcCA9IHRoaXMubG9vcF9zdGFydCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDljLrpl7Tmkq3mlL7miJbmkq3mlL7mlbTpppbvvIzmkq3mlL7nu5PmnZ/opoHmuIXpmaTluo/liJfvvIzkuLvliqjmuIXpmaTvvIzkvb/nlKggPj0g5Yik5pat77yM6YG/5YWNIHNjaGVkdWxlUmVwZWF0IOaEj+WkluWkmuS9meiwg+eUqFxuICAgICAgICAgICAgaWYgKHR5cGVvZiB0YXJnZXRfc3RlcCA9PT0gJ251bWJlcicgJiYgdGhpcy5zdGVwID49IHRhcmdldF9zdGVwICsgMSkge1xuICAgICAgICAgICAgICAgIF9fREVCVUdHRVJfXyAmJiBjb25zb2xlLmxvZygnbWlkaSBlbmQnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXJfZXZlbnQoTWlkaU1hb0V2ZW50VHlwZS5FTkQsIGN1cnJlbnRfbm90ZXMsIHRpbWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIOWmguaenCB0YXJnZXRfc3RlcCA+IG1pZGlfbGVuZ3Ro77yM5b2T5pKt5pS+5a6M5ZCO5Lmf5Lya5YGc5q2iXG4gICAgICAgICAgICBpZiAodGhpcy5zdGVwID49IHRoaXMucHJvY2Vzc2VkX21pZGkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgX19ERUJVR0dFUl9fICYmIGNvbnNvbGUubG9nKCdtaWRpIGVuZCcpO1xuICAgICAgICAgICAgICAgIC8vIOS/neivgeWjsOmfs+aSreaUvuWujOavleWQjuaJjeinpuWPkSBlbmQg5LqL5Lu277yM5L2G6KaB56uL5Y2z5riF6ZmkIHNjaGVkdWxl77yM6YG/5YWN6L+b5YWl5LiL5LiA5qyh5pKt5pS+77yI5aSa5L2Z55qE77yJXG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyX2V2ZW50KE1pZGlNYW9FdmVudFR5cGUuRU5ELCBjdXJyZW50X25vdGVzLCB0aW1lKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDlvZMgc3RlcCDmraXov5vliLDmnIDlkI7kuIDliJfml7bnu6fnu60gKzEg5YaN6L+b6KGM5LiA5qyhIHNjaGVkdWxlUmVwZWF077yM5q2k5qyh6YeN5aSN5Y+q55So5LqO6Kem5Y+RIGVuZCDkuovku7bvvIzpgb/lhY3kvb/nlKjorqHml7blmajlr7zoh7TlgbblsJTnmoTml6Dms5XlgZzmraLmkq3mlL5cbiAgICAgICAgICAgIC8vIHRoaXMucHJvY2Vzc2VkX21pZGkgLSAxICAgPT09PiAgIHRoaXMucHJvY2Vzc2VkX21pZGkubGVuZ3RoXG4gICAgICAgICAgICB0aGlzLnN0ZXArKztcbiAgICAgICAgfSwgVElNRV84biwgMCk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBTdGF0ZUVudW0uUExBWUlORztcbiAgICAgICAgVG9uZS5UcmFuc3BvcnQuYnBtLnZhbHVlID0gVFJVRV9CUE07XG4gICAgICAgIFRvbmUuVHJhbnNwb3J0LnN0YXJ0KCk7XG4gICAgICAgIHJldHVybiB0aGlzLmdldF9taWRpX2luZm8oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOaSreaUvuWunuS+i+eahCBtaWRpIOmfs+S5kO+8jOWmguaenOaYr+ato+WcqOaSreaUvuS4reWImeW/veeVpVxuICAgICAqIEByZXR1cm5zIHtNaWRpSW5mb31cbiAgICAgKi9cbiAgICBwbGF5KCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gU3RhdGVFbnVtLlBMQVlJTkcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldF9taWRpX2luZm8oKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnN0YXRlID09PSBTdGF0ZUVudW0uUEFVU0UpIHtcbiAgICAgICAgICAgIC8vIOaaguWBnOWJjeWPr+iDveaYr+WMuumXtOaSreaUvu+8jOS8oOWFpSB0YXJnZXRfc3RlcFxuICAgICAgICAgICAgdGhpcy5fcGxheSh0aGlzLnRhcmdldF9zdGVwKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldF9taWRpX2luZm8oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fcGxheSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5pKt5pS+5oyH5a6a5Yy65Z+f6Z+z56ym77yM5YWI5YGc5q2i5bey5a2Y5Zyo5pKt5pS+5bqP5YiX77yM5YaN5pKt5pS+5Yy66Ze044CC5aaC5p6c6LW354K55aSn5LqOIG1pZGkg6ZW/5bqm44CBZW5kID4gc3RhcnTvvIzlv73nlaXmiafooYzjgILlj6rkvKAgc3RhcnQg5YiZ5Y+q5pKt5pS+IHN0YXJ0IOWIl+OAglxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydCDljLrpl7TotbfngrnvvIzku44gMCDlvIDlp4vorqHnrpdcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZW5kIOWMuumXtOe7iOeCuVxuICAgICAqIEByZXR1cm5zIHtNaWRpSW5mb31cbiAgICAgKi9cbiAgICBwbGF5X3BhcnQoc3RhcnQsIGVuZCkge1xuICAgICAgICBpZiAoc3RhcnQgPiB0aGlzLnByb2Nlc3NlZF9taWRpLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldF9taWRpX2luZm8oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdGF0ZSAhPT0gU3RhdGVFbnVtLlNUT1ApIHtcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxlbiA9IHR5cGVvZiBlbmQgPT09ICdudW1iZXInID8gZW5kIC0gc3RhcnQgOiAxO1xuICAgICAgICBpZiAobGVuIDwgMCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0X21pZGlfaW5mbygpO1xuICAgICAgICB9XG4gICAgICAgIC8vIOWmguaenOS8oOS6hiBlbmQg5LiUIGVuZCDlpKfkuo7mm7LlrZDplb/luqbjgIJcbiAgICAgICAgaWYgKGVuZCAmJiBlbmQgPiB0aGlzLnByb2Nlc3NlZF9taWRpLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIGVuZCA9IHRoaXMucHJvY2Vzc2VkX21pZGkubGVuZ3RoIC0gMTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0ZXAgPSBzdGFydDtcbiAgICAgICAgdGhpcy50YXJnZXRfc3RlcCA9IGVuZDtcbiAgICAgICAgY29uc3Qgb2JiX29mZnNldCA9IGdldF84bl90aW1lX2J5X2JwbSh0aGlzLmJwbSkgKiBzdGFydDtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BsYXkoZW5kIHx8IHN0YXJ0LCBvYmJfb2Zmc2V0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOWMuumXtOaSreaUvuaIluiAheaYr+WFiOWJjeeKtuaAgeS4uuaaguWBnO+8jOajgOa1i+W9k+WJjeS9jee9ruaYr+WQpuaciemVv+mfs+espu+8jOiLpeacie+8jOWImee7p+e7reaSreaUvumVv+mfs+espuWJqeS9meaXtuWAvFxuICAgICAqL1xuICAgIHJlY292ZXJfbG9uZ19ub3RlKCkge1xuICAgICAgICAvLyDlhYjliY3nirbmgIHkuLrmmoLlgZzvvIzmo4DmtYvmmoLlgZzml7bmmK/lkKbmnInplb/pn7PnrKbvvIzoi6XmnInvvIzliJnnu6fnu63mkq3mlL7plb/pn7PnrKbliankvZnml7blgLxcbiAgICAgICAgY29uc3Qgbm90ZXMgPSB0aGlzLmdldF9jdXJyZW50X2xvbmdfbm90ZXMoKTtcbiAgICAgICAgaWYgKG5vdGVzLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICBpZiAodGhpcy5pbnN0cnVtZW50X25hbWUgPT09IEluc3RydW1lbnRFbnVtLk1JREkpIHtcbiAgICAgICAgICAgIG5vdGVzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmluc3RydW1lbnRfbWlkaVtpdGVtWzBdXS50cmlnZ2VyQXR0YWNrKGl0ZW1bMV0ubmFtZSwgVG9uZS5ub3coKSwgMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5vdGVzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmluc3RydW1lbnQgJiZcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnN0cnVtZW50LnRyaWdnZXJBdHRhY2soaXRlbVsxXS5uYW1lLCBUb25lLm5vdygpLCAxKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5pqC5YGc5pKt5pS+5bqP5YiX77yM5bm25Y246L295a+55bqU55qEIFRvbmUg5LqL5Lu2XG4gICAgICovXG4gICAgcGF1c2UoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgX19ERUJVR0dFUl9fICYmIGNvbnNvbGUubG9nKCdtaWRpIHBhdXNlJyk7XG4gICAgICAgIFRvbmUuVHJhbnNwb3J0LmNsZWFyKHRoaXMuX190aWQpO1xuICAgICAgICAvLyDmuIXpmaTpn7PnrKZcbiAgICAgICAgdGhpcy5zdG9wX25vdGVzKCk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBTdGF0ZUVudW0uUEFVU0U7XG4gICAgICAgIHRoaXMuX190aWQgPSAtMTtcbiAgICAgICAgKF9hID0gdGhpcy5vYmIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zdG9wKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5YGc5q2i5pKt5pS+5bqP5YiX77yM5rOo6ZSA5a+55bqUIFRvbmUg5LqL5Lu2XG4gICAgICovXG4gICAgc3RvcCgpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBfX0RFQlVHR0VSX18gJiYgY29uc29sZS5sb2coJ21pZGkgc3RvcCcpO1xuICAgICAgICBUb25lLlRyYW5zcG9ydC5jbGVhcih0aGlzLl9fdGlkKTtcbiAgICAgICAgLy8g5riF6Zmk6Z+z56ymXG4gICAgICAgIHRoaXMuc3RvcF9ub3RlcygpO1xuICAgICAgICB0aGlzLnN0ZXAgPSAwO1xuICAgICAgICB0aGlzLl9fdGlkID0gLTE7XG4gICAgICAgIHRoaXMubG9vcCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvb3BfZW5kID0gLTE7XG4gICAgICAgIHRoaXMubG9vcF9zdGFydCA9IC0xO1xuICAgICAgICB0aGlzLnRhcmdldF9zdGVwID0gdW5kZWZpbmVkO1xuICAgICAgICAoX2EgPSB0aGlzLm9iYikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnN0b3AoKTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgIT09IFN0YXRlRW51bS5TVE9QKSB7XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXJfZXZlbnQoTWlkaU1hb0V2ZW50VHlwZS5TVE9QKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGVFbnVtLlNUT1A7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5YGc5q2i5Zyo5pKt55qE5pe25YC86LaF6L+HOOWIhumfs+espueahOmVv+mfs+espuOAglxuICAgICAqIEBjb21tZW50IOmAmui/hyB0cmlnZ2VyQXR0YWNrIOinpuWPkeeahOWjsOmfs+WmguaenOS4jeS4u+WKqOa4hemZpO+8jOWImeWjsOmfs+S8muS4gOebtOaMgee7re+8jOWboOatpOimgeS4u+WKqOa4hemZpFxuICAgICAqL1xuICAgIHN0b3Bfbm90ZXMoKSB7XG4gICAgICAgIGlmICh0aGlzLmluc3RydW1lbnRfbmFtZSA9PT0gSW5zdHJ1bWVudEVudW0uTUlESSkge1xuICAgICAgICAgICAgY29uc3Qgbm90ZXMgPSB0aGlzLmdldF9jdXJyZW50X2xvbmdfbm90ZXMoKTtcbiAgICAgICAgICAgIG5vdGVzLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuaW5zdHJ1bWVudF9taWRpW2l0ZW1bMF1dLnRyaWdnZXJSZWxlYXNlKGl0ZW1bMV0ubmFtZSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5pbnN0cnVtZW50ICYmIHRoaXMuaW5zdHJ1bWVudC5yZWxlYXNlQWxsKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOiOt+WPluW9k+WJjeWcqOaSreeahOmVv+mfs+espuOAglxuICAgICAqL1xuICAgIGdldF9jdXJyZW50X2xvbmdfbm90ZXMoKSB7XG4gICAgICAgIGNvbnN0IG5vdGVzID0gW107XG4gICAgICAgIHRoaXMucHJvY2Vzc2VkX21pZGkudHJhY2tzLmZvckVhY2goKHRyYWNrLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm90ZSA9IHRyYWNrLm5vdGVzW3RoaXMuc3RlcF07XG4gICAgICAgICAgICBub3RlICYmIG5vdGUucGFkZGluZ19ub3RlICYmIG5vdGVzLnB1c2goW2luZGV4LCBub3RlXSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbm90ZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDkvb/nlKggbWlkaSDljp/pn7Pmkq3mlL7vvIzov5Tlm57ooqvmkq3mlL7nmoTpn7PnrKbvvIzpnIDmsYLkuK3ml6AgbWlkaSDpn7PoibLvvIzmmoLnlKjkuI3kuIpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RlcCDlvZPliY3mraXov5vlgLxcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBzeW50aHMg5ZCI5oiQ5Zmo5pWw57uEXG4gICAgICogQHJldHVybnMge0FycmF5PHN0cmluZz59IOiiq+aSreaUvueahOmfs+esplxuICAgICAqL1xuICAgIHBsYXlfd2l0aF9taWRpKHN0ZXAsIHN5bnRocykge1xuICAgICAgICBjb25zdCBjdXJyZW50X25vdGVzID0gW107XG4gICAgICAgIHRoaXMucHJvY2Vzc2VkX21pZGkudHJhY2tzLmZvckVhY2goKHRyYWNrLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm90ZSA9IHRyYWNrLm5vdGVzW3N0ZXBdO1xuICAgICAgICAgICAgbm90ZSAmJiBjdXJyZW50X25vdGVzLnB1c2gobm90ZS5uYW1lKTtcbiAgICAgICAgICAgIG5vdGUgJiZcbiAgICAgICAgICAgICAgICAhbm90ZS5wYWRkaW5nX25vdGUgJiZcbiAgICAgICAgICAgICAgICBzeW50aHNbaW5kZXhdLnRyaWdnZXJBdHRhY2tSZWxlYXNlKG5vdGUubmFtZSwgbm90ZS5kdXJhdGlvbiAvIHRoaXMucGxheWJhY2tfcmF0ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY3VycmVudF9ub3RlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOS9v+eUqOS5kOWZqOaSreaUvu+8jOi/lOWbnuiiq+aSreaUvueahOmfs+esplxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwIOW9k+WJjeatpei/m+WAvFxuICAgICAqIEBwYXJhbSB7YW55fSBzYW1wX3N5bnRoIOS5kOWZqOWQiOaIkOWZqFxuICAgICAqIEByZXR1cm5zIHtBcnJheTxzdHJpbmc+fSDooqvmkq3mlL7nmoTpn7PnrKZcbiAgICAgKi9cbiAgICBwbGF5X3dpdGhfaW5zdHJ1bWVudChzdGVwLCBzYW1wX3N5bnRoKSB7XG4gICAgICAgIGlmICghc2FtcF9zeW50aCkge1xuICAgICAgICAgICAgcmVtaW5kX2luc3RydW1lbnRfZXJyb3IodGhpcy5pbnN0cnVtZW50X25hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIC8vIOaSreaUvuWJjeWFiOa4heeQhuS4iuS4gOasoeaui+eVmeeahOmfs+esplxuICAgICAgICB0aGlzLnJlbGVhc2VfbGFzdF9ub3RlcyhzdGVwLCBzYW1wX3N5bnRoKTtcbiAgICAgICAgY29uc3QgY3VycmVudF9ub3RlcyA9IFtdO1xuICAgICAgICB0aGlzLnByb2Nlc3NlZF9taWRpLnRyYWNrcy5mb3JFYWNoKCh0cmFjaykgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm90ZSA9IHRyYWNrLm5vdGVzW3N0ZXBdO1xuICAgICAgICAgICAgbm90ZSAmJiBjdXJyZW50X25vdGVzLnB1c2gobm90ZS5uYW1lKTtcbiAgICAgICAgICAgIG5vdGUgJiZcbiAgICAgICAgICAgICAgICAhbm90ZS5wYWRkaW5nX25vdGUgJiZcbiAgICAgICAgICAgICAgICBzYW1wX3N5bnRoLnRyaWdnZXJBdHRhY2sobm90ZS5uYW1lLCBcbiAgICAgICAgICAgICAgICAvLyBub3RlLmR1cmF0aW9uIC8gdGhpcy5wbGF5YmFja19yYXRlLFxuICAgICAgICAgICAgICAgIFRvbmUubm93KCksIDEpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRfbm90ZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDmuIXnkIbljZUgOG4g5pe26ZW/55qE6Z+z56ym5ZKM6ZW/6Z+z56ym55qE5bC+6Z+z56ymXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0ZXAg5b2T5YmN5pKt5pS+5YiXXG4gICAgICogQHBhcmFtIHthbnl9IOimgea4hemZpOWjsOmfs+eahOWQiOaIkOWZqFxuICAgICAqL1xuICAgIHJlbGVhc2VfbGFzdF9ub3RlcyhzdGVwLCBzYW1wX3N5bnRoKSB7XG4gICAgICAgIGNvbnN0IHByZXZfc3RlcCA9IHN0ZXAgLSAxO1xuICAgICAgICBpZiAocHJldl9zdGVwIDwgMClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgY29uc3Qgbm90ZXMgPSBbXTtcbiAgICAgICAgdGhpcy5wcm9jZXNzZWRfbWlkaS50cmFja3MuZm9yRWFjaCgodHJhY2spID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5vdGUgPSB0cmFjay5ub3Rlc1twcmV2X3N0ZXBdO1xuICAgICAgICAgICAgLy8g5LiN5piv6ZW/6Z+z56ym44CB5aGr5YWF6Z+z56ym55qE6Z+z56ym5bCx5piv5q2j5bi4IDhuIOaXtumVv+eahOmfs+esplxuICAgICAgICAgICAgbm90ZSAmJiAhbm90ZS5zdGFydF9ub3RlICYmICFub3RlLnBhZGRpbmdfbm90ZSAmJiBub3Rlcy5wdXNoKG5vdGUubmFtZSk7XG4gICAgICAgICAgICAvLyDlsL7pn7PnrKZcbiAgICAgICAgICAgIG5vdGUgJiYgbm90ZS5lbmRfbm90ZSAmJiBub3Rlcy5wdXNoKG5vdGUubmFtZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBzYW1wX3N5bnRoLnRyaWdnZXJSZWxlYXNlKG5vdGVzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOW8gOWQr+atjOabsuW+queOr++8jOm7mOiupOW+queOr+aVtOmmluabsuWtkO+8jOWmguaenCBzdGFydCA8IGVuZCDmiJYgc3RhcnQgPCAwIOaIliBzdGFydCA+IOabsuWtkOmVv+W6pu+8jOaUvuW8g+aJp+ihjOOAglxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9vcCDmmK/lkKblvIDlkK/lvqrnjq9cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnQg5b6q546v5Yy66Ze06LW354K5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZCDlvqrnjq/ljLrpl7Tnu4jngrlcbiAgICAgKiBAcmV0dXJucyB7TWlkaU1hb30g5a6e5L6L5pys6LqrXG4gICAgICovXG4gICAgc2V0X2xvb3AobG9vcCwgc3RhcnQgPSAwLCBlbmQgPSB0aGlzLnByb2Nlc3NlZF9taWRpLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgaWYgKHN0YXJ0IDwgMCB8fCBlbmQgPCBzdGFydCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ID4gdGhpcy5wcm9jZXNzZWRfbWlkaS5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxvb3AgPSBsb29wO1xuICAgICAgICB0aGlzLmxvb3BfZW5kID0gTWF0aC50cnVuYyhlbmQgPT09IDAgP1xuICAgICAgICAgICAgMCA6XG4gICAgICAgICAgICBlbmQgPiB0aGlzLnByb2Nlc3NlZF9taWRpLmxlbmd0aCA/XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzZWRfbWlkaS5sZW5ndGggLSAxIDpcbiAgICAgICAgICAgICAgICBlbmQpO1xuICAgICAgICB0aGlzLmxvb3Bfc3RhcnQgPSBNYXRoLnRydW5jKHN0YXJ0KTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDorr7nva7lrp7kvovmkq3mlL7lgI3njodcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcmF0ZSDmkq3mlL7pgJ/luqblgI3njodcbiAgICAgKiBAcmV0dXJucyB7TWlkaU1hb30g5a6e5L6L5pys6LqrXG4gICAgICovXG4gICAgc2V0X3BsYXliYWNrX3JhdGUocmF0ZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIFRvbmUuVHJhbnNwb3J0LmJwbS52YWx1ZSA9IEJBU0VfQlBNICogcmF0ZTtcbiAgICAgICAgdGhpcy5wbGF5YmFja19yYXRlID0gcmF0ZTtcbiAgICAgICAgKF9hID0gdGhpcy5vYmIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXRfcGxheWJhY2tfcmF0ZV9ieV9icG0odGhpcy5hbmNob3JfYnBtICogcmF0ZSk7XG4gICAgICAgIC8vIOmBv+WFjeaAp+iDvemXrumimOS4i+WvvOiHtOeahOWPmOmAn+aXtuWIu+mfs+espuayoeacieiiq+a4hemZpFxuICAgICAgICB0aGlzLmluc3RydW1lbnQgJiYgdGhpcy5pbnN0cnVtZW50LnJlbGVhc2VBbGwoKTtcbiAgICAgICAgdGhpcy5sb25nX25vdGVfY29tcGVuc2F0ZSgpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOS7pSBicG0g6K6+572u5a6e5L6L5pKt5pS+5YCN546HXG4gICAgICogQHBhcmFtIHtudW1iZXJ9ICBicG0gIOebruaghyBicG1cbiAgICAgKiBAcmV0dXJucyB7TWlkaU1hb30g5a6e5L6L5pys6LqrXG4gICAgICovXG4gICAgc2V0X3BsYXliYWNrX3JhdGVfYnlfYnBtKGJwbSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IHJhdGUgPSBicG0gLyB0aGlzLmFuY2hvcl9icG07XG4gICAgICAgIFRvbmUuVHJhbnNwb3J0LmJwbS52YWx1ZSA9IEJBU0VfQlBNICogcmF0ZTtcbiAgICAgICAgdGhpcy5wbGF5YmFja19yYXRlID0gcmF0ZTtcbiAgICAgICAgKF9hID0gdGhpcy5vYmIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXRfcGxheWJhY2tfcmF0ZV9ieV9icG0oYnBtKTtcbiAgICAgICAgdGhpcy5pbnN0cnVtZW50ICYmIHRoaXMuaW5zdHJ1bWVudC5yZWxlYXNlQWxsKCk7XG4gICAgICAgIHRoaXMubG9uZ19ub3RlX2NvbXBlbnNhdGUoKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDms6jlhoznm5HlkKzkuovku7bvvIzov5Tlm57or6Xkuovku7YgaWRcbiAgICAgKiBAcGFyYW0ge01pZGlNYW9FdmVudFR5cGV9IHR5cGUg5LqL5Lu257G75Z6LXG4gICAgICogQHBhcmFtIHtFdmVudENhbGxiYWNrfSBldnQg5rOo5YaM55qE5Zue6LCD5Ye95pWwXG4gICAgICogQHJldHVybnMge251bWJlcn0g5LqL5Lu2IGlkXG4gICAgICovXG4gICAgcmVnaXN0ZXJfZXZlbnQodHlwZSwgZXZ0KSB7XG4gICAgICAgIHRoaXMuZXZlbnRfbGlzdFt0eXBlXS5zZXQodGhpcy5ldmVudF9pZF9jb3VudGVyLCB7XG4gICAgICAgICAgICBpZDogdGhpcy5ldmVudF9pZF9jb3VudGVyLFxuICAgICAgICAgICAgY2I6IGV2dCxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzLmV2ZW50X2lkX2NvdW50ZXIrKztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOenu+mZpOebkeWQrOS6i+S7tlxuICAgICAqIEBwYXJhbSB7TWlkaU1hb0V2ZW50VHlwZX0gdHlwZSDkuovku7bnsbvlnotcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaWQg5LqL5Lu2IGlkXG4gICAgICogQHJldHVybnMge01pZGlNYW99IOWunuS+i+acrOi6q1xuICAgICAqL1xuICAgIHJlbW92ZV9ldmVudCh0eXBlLCBpZCkge1xuICAgICAgICB0aGlzLmV2ZW50X2xpc3RbdHlwZV0uaGFzKGlkKSAmJiB0aGlzLmV2ZW50X2xpc3RbdHlwZV0uZGVsZXRlKGlkKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDnp7vpmaTmiYDmnInnm5HlkKzkuovku7ZcbiAgICAgKiBAcmV0dXJucyB7TWlkaU1hb30g5a6e5L6L5pys6LqrXG4gICAgICovXG4gICAgcmVtb3ZlX2FsbF9ldmVudCgpIHtcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5ldmVudF9saXN0KS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRfbGlzdFtrZXldLmNsZWFyKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOinpuWPkeS7peazqOWGjOS6i+S7tu+8jOS8oOWFpeWbnuiwg+WAvFxuICAgICAqIEBwYXJhbSB7TWlkaU1hb0V2ZW50VHlwZX0gdHlwZSDkuovku7bnsbvlnotcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBub3RlcyDlvZPliY3mkq3mlL7nmoTpn7PnrKbvvIjmjInliJforrDvvIlcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdGltZSDlvZPliY3mkq3mlL7ml7bpl7TvvIjkuI3mmK/pn7PkuZDlt7Lmkq3mlL7ml7bpl7TvvIlcbiAgICAgKi9cbiAgICB0cmlnZ2VyX2V2ZW50KHR5cGUsIG5vdGVzLCB0aW1lKSB7XG4gICAgICAgIHRoaXMuZXZlbnRfbGlzdFt0eXBlXS5mb3JFYWNoKChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5jYihub3RlcywgdGhpcy5nZXRfbWlkaV9pbmZvKCksIHRpbWUsIHRoaXMucHJvY2Vzc2VkX21pZGkpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOiuvue9ruWunuS+i+aSreaUvuS5kOWZqFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOS5kOWZqOWQjVxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSB0cnVlOiDmiJDlip/vvIwgZmFsZTog5aSx6LSlXG4gICAgICovXG4gICAgc2V0X2luc3RydW1lbnQobmFtZSkge1xuICAgICAgICB0aGlzLmluc3RydW1lbnRfbmFtZSA9IG5hbWU7XG4gICAgICAgIGlmIChuYW1lID09PSBJbnN0cnVtZW50RW51bS5NSURJKSB7XG4gICAgICAgICAgICAvLyDlhYjlu7rnq4vlkIjmiJDlmajvvIzku6Xkvr/lpI3nlKjvvIzml6DpnIDph43lpI3liJvlu7rvvIznlLHkuo7mmK/mr4/mrKHmkq3mlL7ml7bpg73mmK/lhajmlrDkuIDlpZcgUG9seVN5bnRoIOWQiOaIkOWZqO+8jOaXoOmcgOaWreW8gOmfs+mHj+iKgueCueOAglxuICAgICAgICAgICAgY29uc3QgbWlkaV9zeW50aHMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc2VkX21pZGkudHJhY2tzLmZvckVhY2goKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHN5bnRoID0gbmV3IFRvbmUuUG9seVN5bnRoKCk7XG4gICAgICAgICAgICAgICAgc3ludGguY29ubmVjdCh0aGlzLmdhaW5fbm9kZSk7XG4gICAgICAgICAgICAgICAgbWlkaV9zeW50aHMucHVzaChzeW50aCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuaW5zdHJ1bWVudF9taWRpID0gbWlkaV9zeW50aHM7XG4gICAgICAgICAgICB0aGlzLmluc3RydW1lbnQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgcmVzID0gdGhpcy5nZXRfdHJ1bHlfaW5zdHJ1bWVudChuYW1lKTtcbiAgICAgICAgICAgIGlmICghcmVzKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaW5zdHJ1bWVudCAmJiB0aGlzLmluc3RydW1lbnQucmVsZWFzZUFsbCgpO1xuICAgICAgICAgICAgdGhpcy5pbnN0cnVtZW50ID0gcmVzO1xuICAgICAgICAgICAgLy8g5oiQ5Yqf6I635Y+W5LmQ5Zmo5ZCO6L+e5o6l6Z+z6YeP6IqC54K5XG4gICAgICAgICAgICB0aGlzLmluc3RydW1lbnQuY29ubmVjdCh0aGlzLmdhaW5fbm9kZSk7XG4gICAgICAgICAgICB0aGlzLmxvbmdfbm90ZV9jb21wZW5zYXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDlj5jpgJ/jgIHmlLnlj5jkuZDlmajlkI7vvIzplb/pn7PnrKbooaXlgb9cbiAgICAgKi9cbiAgICBsb25nX25vdGVfY29tcGVuc2F0ZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmluc3RydW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxvbmdfbm90ZXMgPSBbXTtcbiAgICAgICAgdGhpcy5wcm9jZXNzZWRfbWlkaS50cmFja3MuZm9yRWFjaCgodHJhY2spID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5vdGUgPSB0cmFjay5ub3Rlc1t0aGlzLnN0ZXBdO1xuICAgICAgICAgICAgbm90ZSAmJiBub3RlLnBhZGRpbmdfbm90ZSAmJiAhbm90ZS5lbmRfbm90ZSAmJiBsb25nX25vdGVzLnB1c2gobm90ZS5uYW1lKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaW5zdHJ1bWVudC50cmlnZ2VyQXR0YWNrKGxvbmdfbm90ZXMsIFRvbmUubm93KCksIDEpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOS7jumfs+iJsuW6k+S4reWKoOi9vemfs+iJsui1hOa6kOS7peWIm+W7uuS5kOWZqFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOS5kOWZqOWQjVxuICAgICAqIEByZXR1cm5zIHthbnl9IOWmguaenOmfs+iJsui1hOa6kOacquWHhuWkh+Wlve+8jOi/lOWbniBudWxs77yM5ZCm5YiZ6L+U5Zue5LmQ5ZmoXG4gICAgICovXG4gICAgZ2V0X3RydWx5X2luc3RydW1lbnQobmFtZSkge1xuICAgICAgICBpZiAobmFtZSA9PT0gSW5zdHJ1bWVudEVudW0uTUlESSB8fCAhaW5zdHJ1bWVudF9zdG9yZS5pc19yZWFkeShuYW1lKSkge1xuICAgICAgICAgICAgcmVtaW5kX2luc3RydW1lbnRfZXJyb3IodGhpcy5pbnN0cnVtZW50X25hbWUpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2FtcGxlciA9IG5ldyBUb25lLlNhbXBsZXIoaW5zdHJ1bWVudF9zdG9yZS5nZXRfaW5zdHJ1bWVudF9zb3VyY2UobmFtZSkuX2J1ZmZlcnMpO1xuICAgICAgICByZXR1cm4gc2FtcGxlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOiuvue9ruWunuS+i+mfs+mHj1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSDpn7Pph4/lpKflsI/vvIgw772eMTAw77yJXG4gICAgICogQHJldHVybnMge01pZGlNYW99IOWunuS+i+acrOi6q1xuICAgICAqL1xuICAgIHNldF92b2x1bWUodmFsdWUpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB0aGlzLnZvbHVtZSA9IHZhbHVlID4gMTAwID8gMTAwIDogdmFsdWUgPCAwID8gMCA6IHZhbHVlO1xuICAgICAgICB0aGlzLmdhaW5fbm9kZS5nYWluLnJhbXBUbyh0aGlzLnZvbHVtZSAvIDEwMCwgMC4xKTtcbiAgICAgICAgKF9hID0gdGhpcy5vYmIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXRfdm9sdW1lKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBkZXNjcmlwdGlvbiDojrflj5bovazljJblkI7nmoQgbWlkaSDnn6npmLXmlbDmja5cbiAgICAgKi9cbiAgICBnZXRfcHJvX21pZGkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb2Nlc3NlZF9taWRpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g6I635Y+WIG1pZGkg5YWD5pWw5o2uXG4gICAgICovXG4gICAgZ2V0X3Jhd19taWRpKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yYXdfbWlkaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOiOt+WPliBtaWRpIOmfs+S5kOmFjee9ruS/oeaBr1xuICAgICAqIEByZXR1cm4ge01pZGlJbmZvfVxuICAgICAqL1xuICAgIGdldF9taWRpX2luZm8oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuYW1lOiB0aGlzLnJhd19taWRpLmhlYWRlci5uYW1lLFxuICAgICAgICAgICAgb2JiX25hbWU6IHRoaXMub2JiID8gdGhpcy5vYmIubmFtZSA6IE9iYkVudW0uTk9ORSxcbiAgICAgICAgICAgIHN0ZXA6IHRoaXMuc3RlcCxcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxuICAgICAgICAgICAgcGxheWJhY2tfcmF0ZTogdGhpcy5wbGF5YmFja19yYXRlLFxuICAgICAgICAgICAgbG9vcDogdGhpcy5sb29wLFxuICAgICAgICAgICAgbG9vcF9wYXJ0OiBbdGhpcy5sb29wX3N0YXJ0LCB0aGlzLmxvb3BfZW5kXSxcbiAgICAgICAgICAgIHZvbHVtZTogdGhpcy52b2x1bWUsXG4gICAgICAgICAgICBpbnN0cnVtZW50X25hbWU6IHRoaXMuaW5zdHJ1bWVudF9uYW1lLFxuICAgICAgICAgICAgbGVuZ3RoOiB0aGlzLnByb2Nlc3NlZF9taWRpLmxlbmd0aCxcbiAgICAgICAgICAgIGJwbTogdGhpcy5icG0sXG4gICAgICAgICAgICBkdXJhdGlvbjogdGhpcy5wcm9jZXNzZWRfbWlkaS5kdXJhdGlvbixcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOiOt+WPluS8tOWlj+S/oeaBr+OAgei1hOa6kFxuICAgICAqIEByZXR1cm5zIHt7b2JiX25hbWU6IHN0cmluZywgb2JiX2RhdGE6IGFueX19IOS8tOWlj+WQjeS4juS8tOWlj+i1hOa6kFxuICAgICAqL1xuICAgIGdldF9vYmIoKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBvYmJfbmFtZTogKChfYSA9IHRoaXMub2JiKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubmFtZSkgfHwgT2JiRW51bS5OT05FLFxuICAgICAgICAgICAgb2JiX2RhdGE6ICgoX2IgPSB0aGlzLm9iYikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLl9idWZmZXIpIHx8IG51bGwsXG4gICAgICAgIH07XG4gICAgfVxufVxuZnVuY3Rpb24gcmVtaW5kX2luc3RydW1lbnRfZXJyb3IobmFtZSkge1xuICAgIGNvbnNvbGUud2FybihgSW5zdHJ1bWVudCgke25hbWV9KSBub3QgcmVhZHkgeWV0LiBQbGVhc2UgbWFrZSBzdXJlIHlvdSBoYXZlIGxvYWRlZCB0aGUgaW5zdHJ1bWVudCByZXNvdXJjZSBhbmQgcmVzZXQgaW5zdGFuY2UncyBpbnN0cnVtZW50LmApO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9TWlkaU1hby5qcy5tYXAiLCJpbXBvcnQgX1RvbmUgZnJvbSAnQGNtYW8vY29kZW1hby10b25lJztcbmNvbnN0IFRvbmUgPSBfVG9uZTtcbmltcG9ydCB7IGp1ZGdlX3NwZWVkX3N0YXRlIH0gZnJvbSAnLi4vdXRpbHMnO1xuaW1wb3J0IHsgQkFTRV9CUE0gfSBmcm9tICcuLi9jb25maWcvY29uc3QnO1xuaW1wb3J0IHsgY3JlYXRlX29iYl9zdG9yZSwgT2JiRW51bSB9IGZyb20gJy4uL29iYic7XG5pbXBvcnQgeyBPQkJfVk9MX1BFUkNFTlQsIFNwZWVkU3RhdGVFbnVtLCBTdGF0ZUVudW0gfSBmcm9tICcuL2RlZnMnO1xuY29uc3Qgb2JiX3N0b3JlID0gY3JlYXRlX29iYl9zdG9yZSgpO1xuZXhwb3J0IGNsYXNzIE9iYk1hbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucGxheWJhY2tfcmF0ZSA9IDE7XG4gICAgICAgIGNvbnN0IG9iYiA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgaWYgKG9iYiAmJiBvYmIuZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5fYnVmZmVyID0gb2JiLmRhdGE7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBvYmIubmFtZTtcbiAgICAgICAgICAgIHRoaXMuc3BlZWRfc3RhdGUgPSBqdWRnZV9zcGVlZF9zdGF0ZShvYmIuYnBtKTtcbiAgICAgICAgICAgIHRoaXMucGxheWVyID0gbmV3IFRvbmUuUGxheWVyKHRoaXMuX2J1ZmZlcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9idWZmZXIgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gT2JiRW51bS5OT05FO1xuICAgICAgICAgICAgdGhpcy5zcGVlZF9zdGF0ZSA9IFNwZWVkU3RhdGVFbnVtLkhJR0g7XG4gICAgICAgICAgICB0aGlzLnBsYXllciA9IG5ldyBUb25lLlBsYXllcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ2Fpbl9ub2RlID0gbmV3IFRvbmUuR2FpbigpLnRvTWFzdGVyKCk7XG4gICAgICAgIHRoaXMuZ2Fpbl9ub2RlLmdhaW4ucmFtcFRvKDEgKiBPQkJfVk9MX1BFUkNFTlQsIDAuMSk7XG4gICAgICAgIHRoaXMucGxheWVyLmxvb3AgPSB0cnVlO1xuICAgICAgICB0aGlzLnBsYXllci5jb25uZWN0KHRoaXMuZ2Fpbl9ub2RlKTtcbiAgICAgICAgdGhpcy5zZXRfcGxheWJhY2tfcmF0ZV9ieV9icG0ob2JiID8gb2JiLmJwbSA6IEJBU0VfQlBNKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IFN0YXRlRW51bS5TVE9QO1xuICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IC0xO1xuICAgICAgICB0aGlzLnN0b3BUaW1lID0gLTE7XG4gICAgfVxuICAgIHVwZGF0ZShvYmIpIHtcbiAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIGlmIChvYmIuZGF0YSA9PT0gbnVsbCB8fCBvYmIuZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5fYnVmZmVyID0gb2JiLmRhdGE7XG4gICAgICAgICAgICB0aGlzLnBsYXllciA9XG4gICAgICAgICAgICAgICAgb2JiLmRhdGEgPT09IG51bGwgPyBuZXcgVG9uZS5QbGF5ZXIoKSA6IG5ldyBUb25lLlBsYXllcih0aGlzLl9idWZmZXIpO1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuY29ubmVjdCh0aGlzLmdhaW5fbm9kZSk7XG4gICAgICAgICAgICB0aGlzLnBsYXllci5sb29wID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucGxheWVyLnBsYXliYWNrUmF0ZSA9IHRoaXMucGxheWJhY2tfcmF0ZSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9iYi5uYW1lKSB7XG4gICAgICAgICAgICB0aGlzLm5hbWUgPSBvYmIubmFtZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2JiLmJwbSkge1xuICAgICAgICAgICAgdGhpcy5zcGVlZF9zdGF0ZSA9IGp1ZGdlX3NwZWVkX3N0YXRlKG9iYi5icG0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB1cGRhdGVfYmFzZV9zcGVlZChicG0pIHtcbiAgICAgICAgdGhpcy5zcGVlZF9zdGF0ZSA9IGp1ZGdlX3NwZWVkX3N0YXRlKGJwbSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBwbGF5KG9mZnNldCkge1xuICAgICAgICAvLyDmkq3mlL7lmajkuI3lrZjlnKgg5oiWIOaSreaUvuWZqOWKoOi9vei1hOa6kOaXtu+8jOi1hOa6kOWPr+iDveWwmuacquiOt+WPluWIsO+8jOaSreaUvuWJjemHjeaWsOiOt+WPluS4i+i1hOa6kFxuICAgICAgICBpZiAoIXRoaXMucGxheWVyIHx8XG4gICAgICAgICAgICAoIXRoaXMucGxheWVyLmxvYWRlZCAmJiBvYmJfc3RvcmUuaXNfcmVhZHkodGhpcy5uYW1lKSkpIHtcbiAgICAgICAgICAgIHRoaXMucGxheWVyICYmIHRoaXMucGxheWVyLmRpc2Nvbm5lY3QodGhpcy5nYWluX25vZGUpO1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIgPSBuZXcgVG9uZS5QbGF5ZXIob2JiX3N0b3JlLmdldF9vYmIodGhpcy5uYW1lKSk7XG4gICAgICAgICAgICB0aGlzLnBsYXllci5jb25uZWN0KHRoaXMuZ2Fpbl9ub2RlKTtcbiAgICAgICAgICAgIHRoaXMucGxheWVyLmxvb3AgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIucGxheWJhY2tSYXRlID0gdGhpcy5wbGF5YmFja19yYXRlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5wbGF5ZXIubG9hZGVkIHx8IHRoaXMuc3RhdGUgPT09IFN0YXRlRW51bS5QTEFZSU5HKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gU3RhdGVFbnVtLlBBVVNFKSB7XG4gICAgICAgICAgICB0aGlzLnBsYXllci5zdGFydCh1bmRlZmluZWQsICh0aGlzLnN0b3BUaW1lIC0gdGhpcy5zdGFydFRpbWUpICUgdGhpcy5wbGF5ZXIuYnVmZmVyLmR1cmF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGxheWVyLnN0YXJ0KHVuZGVmaW5lZCwgb2Zmc2V0KTtcbiAgICAgICAgfVxuICAgICAgICAvLyAwLjEwNSDlt6blj7PnmoTlvqrnjq/ooaXlgb/vvIznuqDmraPkvLTlpY/kuI7kuLvml4vlvovnmoToioLlpY9cbiAgICAgICAgdGhpcy5wbGF5ZXIubG9vcEVuZCA9IHRoaXMucGxheWVyLmJ1ZmZlci5kdXJhdGlvbiAtIDAuMTA2O1xuICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGVFbnVtLlBMQVlJTkc7XG4gICAgICAgIHRoaXMuc3RhcnRUaW1lID0gVG9uZS5ub3coKTtcbiAgICAgICAgLy8g5b6q546v57uT5p2f5pe26Ze05o+Q5YmNIDAuMDkg56eS77yM6YG/5YWN5b6q546v5aSa5qyh5ZCO5Ly05aWP5peL5b6L5LiO5Li75peL5b6L5LiN5a+56b2Q44CCMC4xMDYg5piv5L2T6aqM5Ye65p2l55qE5YC877yIMC4xMDUgfiAwLjExMOWGheW/heacieS4gOS4quacgOS9s+WAvO+8iVxuICAgICAgICB0aGlzLnBsYXllci5sb29wRW5kID0gdGhpcy5wbGF5ZXIuYnVmZmVyLmR1cmF0aW9uIC0gMC4xMDY7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g5YGc5q2i5pKt5pS+5bqP5YiX77yM5rOo6ZSA5a+55bqUIFRvbmUg5LqL5Lu2XG4gICAgICovXG4gICAgc3RvcCgpIHtcbiAgICAgICAgaWYgKHRoaXMucGxheWVyICYmIHRoaXMucGxheWVyLmxvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuc3RvcCgpO1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGlzY29ubmVjdCh0aGlzLmdhaW5fbm9kZSk7XG4gICAgICAgICAgICB0aGlzLnBsYXllci5kaXNwb3NlKCk7XG4gICAgICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGF0ZSA9IFN0YXRlRW51bS5TVE9QO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgcGF1c2UoKSB7XG4gICAgICAgIHRoaXMucGxheWVyLmxvYWRlZCAmJiB0aGlzLnBsYXllci5zdG9wKCk7XG4gICAgICAgIHRoaXMuc3RvcFRpbWUgPSBUb25lLm5vdygpO1xuICAgICAgICB0aGlzLnN0YXRlID0gU3RhdGVFbnVtLlBBVVNFO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIOiuvue9ruWunuS+i+mfs+mHj++8jOS7peeZvuWIhuavlOiuoeeul1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSDpn7Pph4/lpKflsI/vvIgw772eMTAw77yJXG4gICAgICovXG4gICAgc2V0X3ZvbHVtZSh2YWx1ZSkge1xuICAgICAgICBjb25zdCB2b2x1bWUgPSB2YWx1ZSA+IDEwMCA/IDEwMCA6IHZhbHVlIDwgMCA/IDAgOiB2YWx1ZTtcbiAgICAgICAgdGhpcy5nYWluX25vZGUuZ2Fpbi5yYW1wVG8oKHZvbHVtZSAvIDEwMCkgKiBPQkJfVk9MX1BFUkNFTlQsIDAuMSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24g6K6+572u5a6e5L6L5pKt5pS+5YCN546HXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJwbSAg55uu5qCHIGJwbVxuICAgICAqL1xuICAgIHNldF9wbGF5YmFja19yYXRlX2J5X2JwbShicG0pIHtcbiAgICAgICAgbGV0IHJhdGUgPSAxO1xuICAgICAgICBzd2l0Y2ggKHRoaXMuc3BlZWRfc3RhdGUpIHtcbiAgICAgICAgICAgIGNhc2UgU3BlZWRTdGF0ZUVudW0uSElHSDoge1xuICAgICAgICAgICAgICAgIHJhdGUgPSBicG0gLyAxODA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFNwZWVkU3RhdGVFbnVtLk1JRF9ISUdIOiB7XG4gICAgICAgICAgICAgICAgcmF0ZSA9IGJwbSAvIDE1MDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgU3BlZWRTdGF0ZUVudW0uTk9STUFMOiB7XG4gICAgICAgICAgICAgICAgcmF0ZSA9IGJwbSAvIDEyMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgU3BlZWRTdGF0ZUVudW0uTUlEX0xPVzoge1xuICAgICAgICAgICAgICAgIHJhdGUgPSBicG0gLyA5MDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgU3BlZWRTdGF0ZUVudW0uTE9XOiB7XG4gICAgICAgICAgICAgICAgcmF0ZSA9IGJwbSAvIDYwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBsYXliYWNrX3JhdGUgPSByYXRlO1xuICAgICAgICB0aGlzLnBsYXllciAmJiAodGhpcy5wbGF5ZXIucGxheWJhY2tSYXRlID0gcmF0ZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPU9iYk1hby5qcy5tYXAiLCJleHBvcnQgY29uc3QgTUlESV9OQU1FX1BSRUZJWCA9ICdjbWFvLW1pZGlfJztcbmV4cG9ydCBjb25zdCBPQkJfVk9MX1BFUkNFTlQgPSAwLjg7XG5leHBvcnQgdmFyIE1pZGlNYW9FdmVudFR5cGU7XG4oZnVuY3Rpb24gKE1pZGlNYW9FdmVudFR5cGUpIHtcbiAgICBNaWRpTWFvRXZlbnRUeXBlW1wiU1RBUlRcIl0gPSBcInN0YXJ0XCI7XG4gICAgTWlkaU1hb0V2ZW50VHlwZVtcIlBMQVlJTkdcIl0gPSBcInBsYXlpbmdcIjtcbiAgICBNaWRpTWFvRXZlbnRUeXBlW1wiRU5EXCJdID0gXCJlbmRcIjtcbiAgICBNaWRpTWFvRXZlbnRUeXBlW1wiU1RPUFwiXSA9IFwic3RvcFwiO1xufSkoTWlkaU1hb0V2ZW50VHlwZSB8fCAoTWlkaU1hb0V2ZW50VHlwZSA9IHt9KSk7XG5leHBvcnQgZnVuY3Rpb24gaXNfcHJvY2Vzc2VkX21pZGkobWlkaSkge1xuICAgIHJldHVybiBtaWRpLnBybztcbn1cbmV4cG9ydCB2YXIgU3RhdGVFbnVtO1xuKGZ1bmN0aW9uIChTdGF0ZUVudW0pIHtcbiAgICBTdGF0ZUVudW1bU3RhdGVFbnVtW1wiUExBWUlOR1wiXSA9IDFdID0gXCJQTEFZSU5HXCI7XG4gICAgU3RhdGVFbnVtW1N0YXRlRW51bVtcIlNUT1BcIl0gPSAyXSA9IFwiU1RPUFwiO1xuICAgIFN0YXRlRW51bVtTdGF0ZUVudW1bXCJQQVVTRVwiXSA9IDNdID0gXCJQQVVTRVwiO1xufSkoU3RhdGVFbnVtIHx8IChTdGF0ZUVudW0gPSB7fSkpO1xuZXhwb3J0IHZhciBTcGVlZFN0YXRlRW51bTtcbihmdW5jdGlvbiAoU3BlZWRTdGF0ZUVudW0pIHtcbiAgICBTcGVlZFN0YXRlRW51bVtcIkhJR0hcIl0gPSBcImhpZ2hcIjtcbiAgICBTcGVlZFN0YXRlRW51bVtcIk1JRF9ISUdIXCJdID0gXCJtaWRfaGlnaFwiO1xuICAgIFNwZWVkU3RhdGVFbnVtW1wiTk9STUFMXCJdID0gXCJcIjtcbiAgICBTcGVlZFN0YXRlRW51bVtcIk1JRF9MT1dcIl0gPSBcIm1pZF9sb3dcIjtcbiAgICBTcGVlZFN0YXRlRW51bVtcIkxPV1wiXSA9IFwibG93XCI7XG59KShTcGVlZFN0YXRlRW51bSB8fCAoU3BlZWRTdGF0ZUVudW0gPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVmcy5qcy5tYXAiLCJpbXBvcnQgeyBNaWRpTWFvIH0gZnJvbSAnLi9NaWRpTWFvJztcbmltcG9ydCB7IE9iYk1hbyB9IGZyb20gJy4vT2JiTWFvJztcbmV4cG9ydCB7IE1pZGlNYW8sIE9iYk1hbyB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiZXhwb3J0ICogZnJvbSAnLi9jb250cm9sbGVyL2RlZnMnO1xuZXhwb3J0ICogZnJvbSAnLi9pbnN0cnVtZW50L2RlZnMnO1xuZXhwb3J0IHsgT2JiRW51bSB9IGZyb20gJy4vb2JiJztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlZnMuanMubWFwIiwiaW1wb3J0IHsgTWlkaSB9IGZyb20gJ0B0b25lanMvbWlkaSc7XG5leHBvcnQgeyBNaWRpIH07XG5pbXBvcnQgKiBhcyBNaWRpQ29sbGVjdGlvbiBmcm9tICdAdG9uZWpzL21pZGknO1xuZXhwb3J0IHsgTWlkaUNvbGxlY3Rpb24gfTtcbmltcG9ydCBUb25lIGZyb20gJ0BjbWFvL2NvZGVtYW8tdG9uZSc7XG5leHBvcnQgeyBUb25lIH07XG5pbXBvcnQgKiBhcyBUb25lQ29sbGVjdGlvbiBmcm9tICdAY21hby9jb2RlbWFvLXRvbmUnO1xuZXhwb3J0IHsgVG9uZUNvbGxlY3Rpb24gfTtcbmltcG9ydCB7IE1pZGlNYW8sIE9iYk1hbyB9IGZyb20gJy4vY29udHJvbGxlcic7XG5leHBvcnQgeyBNaWRpTWFvLCBPYmJNYW8gfTtcbmV4cG9ydCAqIGZyb20gJy4vZGVmcyc7XG5leHBvcnQgKiBmcm9tICcuL2NvbmZpZy9jb25zdCc7XG5leHBvcnQgeyBnZXRfOG5fdGltZV9ieV9icG0sIGp1ZGdlX3NwZWVkX3N0YXRlIH0gZnJvbSAnLi91dGlscyc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJleHBvcnQgdmFyIEluc3RydW1lbnRFbnVtO1xuKGZ1bmN0aW9uIChJbnN0cnVtZW50RW51bSkge1xuICAgIEluc3RydW1lbnRFbnVtW1wiR0FNRVwiXSA9IFwiZ2FtZVwiO1xuICAgIEluc3RydW1lbnRFbnVtW1wiSk9LRVJcIl0gPSBcImpva2VyXCI7XG4gICAgSW5zdHJ1bWVudEVudW1bXCJFTEVDVFJJQ1wiXSA9IFwiZWxlY3RyaWNcIjtcbiAgICBJbnN0cnVtZW50RW51bVtcIkRSRUFNXCJdID0gXCJkcmVhbVwiO1xuICAgIEluc3RydW1lbnRFbnVtW1wiUElBTk9cIl0gPSBcInBpYW5vXCI7XG4gICAgSW5zdHJ1bWVudEVudW1bXCJHVUlUQVJcIl0gPSBcImd1aXRhclwiO1xuICAgIEluc3RydW1lbnRFbnVtW1wiQkVBVFwiXSA9IFwiYmVhdFwiO1xuICAgIEluc3RydW1lbnRFbnVtW1wiTUlESVwiXSA9IFwibWlkaVwiO1xufSkoSW5zdHJ1bWVudEVudW0gfHwgKEluc3RydW1lbnRFbnVtID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlZnMuanMubWFwIiwiaW1wb3J0IF9Ub25lIGZyb20gJ0BjbWFvL2NvZGVtYW8tdG9uZSc7XG5jb25zdCBUb25lID0gX1RvbmU7XG5pbXBvcnQgeyBfX0RFQlVHR0VSX18gfSBmcm9tICcuLi9fX2RlYnVnZ2VyX18nO1xuaW1wb3J0IHsgSW5zdHJ1bWVudEVudW0gfSBmcm9tICcuL2RlZnMnO1xuZXhwb3J0ICogZnJvbSAnLi9kZWZzJztcbmNvbnN0IGluc3RydW1lbnRzID0ge1xuICAgIFtJbnN0cnVtZW50RW51bS5HVUlUQVJdOiBudWxsLFxuICAgIFtJbnN0cnVtZW50RW51bS5QSUFOT106IG51bGwsXG4gICAgW0luc3RydW1lbnRFbnVtLkpPS0VSXTogbnVsbCxcbiAgICBbSW5zdHJ1bWVudEVudW0uR0FNRV06IG51bGwsXG4gICAgW0luc3RydW1lbnRFbnVtLkRSRUFNXTogbnVsbCxcbiAgICBbSW5zdHJ1bWVudEVudW0uRUxFQ1RSSUNdOiBudWxsLFxuICAgIFtJbnN0cnVtZW50RW51bS5CRUFUXTogbnVsbCxcbn07XG47XG5sZXQgc3RvcmU7XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlX2luc3RydW1lbnRfc3RvcmUoKSB7XG4gICAgaWYgKHN0b3JlKVxuICAgICAgICByZXR1cm4gc3RvcmU7XG4gICAgZnVuY3Rpb24gaW5pdF9pbnN0cnVtZW50KG5hbWUsIGNvbmZpZywgb25sb2FkLCBvbmVycm9yKSB7XG4gICAgICAgIGlmIChpbnN0cnVtZW50c1tuYW1lXSkge1xuICAgICAgICAgICAgX19ERUJVR0dFUl9fICYmIGNvbnNvbGUubG9nKGAke25hbWV9IGhhZCBsb2FkZWRgKTtcbiAgICAgICAgICAgIG9ubG9hZCAmJiBvbmxvYWQoaW5zdHJ1bWVudHNbbmFtZV0pO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShpbnN0cnVtZW50c1tuYW1lXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZSA9IG5ldyBUb25lLkJ1ZmZlcnMoY29uZmlnLm5vdGVzX21hcCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGluc3RydW1lbnRzW25hbWVdID0gc291cmNlO1xuICAgICAgICAgICAgICAgIF9fREVCVUdHRVJfXyAmJiBjb25zb2xlLmxvZyhgJHtuYW1lfSBsb2FkZWRgKTtcbiAgICAgICAgICAgICAgICBvbmxvYWQgJiYgb25sb2FkKGluc3RydW1lbnRzW25hbWVdKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGluc3RydW1lbnRzW25hbWVdKTtcbiAgICAgICAgICAgIH0sIGNvbmZpZy5iYXNlX3VybCwgKGVycikgPT4ge1xuICAgICAgICAgICAgICAgIG9uZXJyb3IgJiYgb25lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiByZXBsYWNlX2luc3RydW1lbnRfc291cmNlKG5hbWUsIHNvdXJjZSkge1xuICAgICAgICBpbnN0cnVtZW50c1tuYW1lXSA9IHNvdXJjZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0X2luc3RydW1lbnRfc291cmNlKG5hbWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IEluc3RydW1lbnRFbnVtLk1JREkpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnN0cnVtZW50c1tuYW1lXTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaXNfcmVhZHkobmFtZSkge1xuICAgICAgICByZXR1cm4gISFpbnN0cnVtZW50c1tuYW1lXTtcbiAgICB9XG4gICAgc3RvcmUgPSB7XG4gICAgICAgIGluaXRfaW5zdHJ1bWVudCxcbiAgICAgICAgcmVwbGFjZV9pbnN0cnVtZW50X3NvdXJjZSxcbiAgICAgICAgZ2V0X2luc3RydW1lbnRfc291cmNlLFxuICAgICAgICBpc19yZWFkeSxcbiAgICB9O1xuICAgIHJldHVybiBzdG9yZTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImltcG9ydCBUb25lIGZyb20gJ0BjbWFvL2NvZGVtYW8tdG9uZSc7XG5leHBvcnQgdmFyIE9iYkVudW07XG4oZnVuY3Rpb24gKE9iYkVudW0pIHtcbiAgICBPYmJFbnVtW1wiTk9ORVwiXSA9IFwiX19OT05FX19cIjtcbiAgICBPYmJFbnVtW1wiRlVOS19MT1dcIl0gPSBcImZ1bmtfbG93XCI7XG4gICAgT2JiRW51bVtcIkZVTktfTUlEX0xPV1wiXSA9IFwiZnVua19taWRfbG93XCI7XG4gICAgT2JiRW51bVtcIkZVTktcIl0gPSBcImZ1bmtcIjtcbiAgICBPYmJFbnVtW1wiRlVOS19NSURfSElHSFwiXSA9IFwiZnVua19taWRfaGlnaFwiO1xuICAgIE9iYkVudW1bXCJGVU5LX0hJR0hcIl0gPSBcImZ1bmtfaGlnaFwiO1xuICAgIE9iYkVudW1bXCJKQVpaX0xPV1wiXSA9IFwiamF6el9sb3dcIjtcbiAgICBPYmJFbnVtW1wiSkFaWl9NSURfTE9XXCJdID0gXCJqYXp6X21pZF9sb3dcIjtcbiAgICBPYmJFbnVtW1wiSkFaWlwiXSA9IFwiamF6elwiO1xuICAgIE9iYkVudW1bXCJKQVpaX01JRF9ISUdIXCJdID0gXCJqYXp6X21pZF9oaWdoXCI7XG4gICAgT2JiRW51bVtcIkpBWlpfSElHSFwiXSA9IFwiamF6el9oaWdoXCI7XG4gICAgT2JiRW51bVtcIkxBVElOX0xPV1wiXSA9IFwibGF0aW5fbG93XCI7XG4gICAgT2JiRW51bVtcIkxBVElOX01JRF9MT1dcIl0gPSBcImxhdGluX21pZF9sb3dcIjtcbiAgICBPYmJFbnVtW1wiTEFUSU5cIl0gPSBcImxhdGluXCI7XG4gICAgT2JiRW51bVtcIkxBVElOX01JRF9ISUdIXCJdID0gXCJsYXRpbl9taWRfaGlnaFwiO1xuICAgIE9iYkVudW1bXCJMQVRJTl9ISUdIXCJdID0gXCJsYXRpbl9oaWdoXCI7XG4gICAgT2JiRW51bVtcIkRBTkNFX0xPV1wiXSA9IFwiZGFuY2VfbG93XCI7XG4gICAgT2JiRW51bVtcIkRBTkNFX01JRF9MT1dcIl0gPSBcImRhbmNlX21pZF9sb3dcIjtcbiAgICBPYmJFbnVtW1wiREFOQ0VcIl0gPSBcImRhbmNlXCI7XG4gICAgT2JiRW51bVtcIkRBTkNFX01JRF9ISUdIXCJdID0gXCJkYW5jZV9taWRfaGlnaFwiO1xuICAgIE9iYkVudW1bXCJEQU5DRV9ISUdIXCJdID0gXCJkYW5jZV9oaWdoXCI7XG4gICAgT2JiRW51bVtcIkhJUEhPUF9MT1dcIl0gPSBcImhpcGhvcF9sb3dcIjtcbiAgICBPYmJFbnVtW1wiSElQSE9QX01JRF9MT1dcIl0gPSBcImhpcGhvcF9taWRfbG93XCI7XG4gICAgT2JiRW51bVtcIkhJUEhPUFwiXSA9IFwiaGlwaG9wXCI7XG4gICAgT2JiRW51bVtcIkhJUEhPUF9NSURfSElHSFwiXSA9IFwiaGlwaG9wX21pZF9oaWdoXCI7XG4gICAgT2JiRW51bVtcIkhJUEhPUF9ISUdIXCJdID0gXCJoaXBob3BfaGlnaFwiO1xuICAgIE9iYkVudW1bXCJST0NLX0xPV1wiXSA9IFwicm9ja19sb3dcIjtcbiAgICBPYmJFbnVtW1wiUk9DS19NSURfTE9XXCJdID0gXCJyb2NrX21pZF9sb3dcIjtcbiAgICBPYmJFbnVtW1wiUk9DS1wiXSA9IFwicm9ja1wiO1xuICAgIE9iYkVudW1bXCJST0NLX01JRF9ISUdIXCJdID0gXCJyb2NrX21pZF9oaWdoXCI7XG4gICAgT2JiRW51bVtcIlJPQ0tfSElHSFwiXSA9IFwicm9ja19oaWdoXCI7XG59KShPYmJFbnVtIHx8IChPYmJFbnVtID0ge30pKTtcbmNvbnN0IG9iYnMgPSB7XG4gICAgW09iYkVudW0uTk9ORV06IG51bGwsXG4gICAgW09iYkVudW0uUk9DS19MT1ddOiBudWxsLFxuICAgIFtPYmJFbnVtLkRBTkNFX0xPV106IG51bGwsXG4gICAgW09iYkVudW0uRlVOS19MT1ddOiBudWxsLFxuICAgIFtPYmJFbnVtLkhJUEhPUF9MT1ddOiBudWxsLFxuICAgIFtPYmJFbnVtLkpBWlpfTE9XXTogbnVsbCxcbiAgICBbT2JiRW51bS5MQVRJTl9MT1ddOiBudWxsLFxuICAgIFtPYmJFbnVtLlJPQ0tfTUlEX0xPV106IG51bGwsXG4gICAgW09iYkVudW0uREFOQ0VfTUlEX0xPV106IG51bGwsXG4gICAgW09iYkVudW0uRlVOS19NSURfTE9XXTogbnVsbCxcbiAgICBbT2JiRW51bS5ISVBIT1BfTUlEX0xPV106IG51bGwsXG4gICAgW09iYkVudW0uSkFaWl9NSURfTE9XXTogbnVsbCxcbiAgICBbT2JiRW51bS5MQVRJTl9NSURfTE9XXTogbnVsbCxcbiAgICBbT2JiRW51bS5ST0NLXTogbnVsbCxcbiAgICBbT2JiRW51bS5EQU5DRV06IG51bGwsXG4gICAgW09iYkVudW0uRlVOS106IG51bGwsXG4gICAgW09iYkVudW0uSElQSE9QXTogbnVsbCxcbiAgICBbT2JiRW51bS5KQVpaXTogbnVsbCxcbiAgICBbT2JiRW51bS5MQVRJTl06IG51bGwsXG4gICAgW09iYkVudW0uUk9DS19NSURfSElHSF06IG51bGwsXG4gICAgW09iYkVudW0uREFOQ0VfTUlEX0hJR0hdOiBudWxsLFxuICAgIFtPYmJFbnVtLkZVTktfTUlEX0hJR0hdOiBudWxsLFxuICAgIFtPYmJFbnVtLkhJUEhPUF9NSURfSElHSF06IG51bGwsXG4gICAgW09iYkVudW0uSkFaWl9NSURfSElHSF06IG51bGwsXG4gICAgW09iYkVudW0uTEFUSU5fTUlEX0hJR0hdOiBudWxsLFxuICAgIFtPYmJFbnVtLlJPQ0tfSElHSF06IG51bGwsXG4gICAgW09iYkVudW0uREFOQ0VfSElHSF06IG51bGwsXG4gICAgW09iYkVudW0uRlVOS19ISUdIXTogbnVsbCxcbiAgICBbT2JiRW51bS5ISVBIT1BfSElHSF06IG51bGwsXG4gICAgW09iYkVudW0uSkFaWl9ISUdIXTogbnVsbCxcbiAgICBbT2JiRW51bS5MQVRJTl9ISUdIXTogbnVsbCxcbn07XG5sZXQgc3RvcmU7XG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlX29iYl9zdG9yZSgpIHtcbiAgICBpZiAoc3RvcmUpXG4gICAgICAgIHJldHVybiBzdG9yZTtcbiAgICBmdW5jdGlvbiBpbml0X29iYihuYW1lLCB1cmwpIHtcbiAgICAgICAgLy8g5aeL57uI5L+d5oyBIE9iYkVudW0uTk9ORSDotYTmupDkuLogbnVsbO+8jE9iYk1hbyDliqDovb3lroPml7bpnZnpu5jlpLHotKVcbiAgICAgICAgaWYgKG5hbWUgPT09IE9iYkVudW0uTk9ORSkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbbmFtZSwgbnVsbF0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvYmJzW25hbWVdKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtuYW1lLCBvYmJzW25hbWVdXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBvYmJfYnVmZmVyID0gbmV3IFRvbmUuQnVmZmVyKHVybCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIG9iYnNbbmFtZV0gPSBvYmJfYnVmZmVyO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoW25hbWUsIG9iYl9idWZmZXJdKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ2V0X29iYihuYW1lKSB7XG4gICAgICAgIHJldHVybiBvYmJzW25hbWVdO1xuICAgIH1cbiAgICBmdW5jdGlvbiBpc19yZWFkeShuYW1lKSB7XG4gICAgICAgIHJldHVybiAhIW9iYnNbbmFtZV07XG4gICAgfVxuICAgIHN0b3JlID0ge1xuICAgICAgICBpbml0X29iYixcbiAgICAgICAgZ2V0X29iYixcbiAgICAgICAgaXNfcmVhZHksXG4gICAgfTtcbiAgICByZXR1cm4gc3RvcmU7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJpbXBvcnQgeyBTcGVlZFN0YXRlRW51bSwgTUlESV9OQU1FX1BSRUZJWCwgfSBmcm9tICcuLi9jb250cm9sbGVyL2RlZnMnO1xuaW1wb3J0IHsgT05FX01JTlVURV9TRUNPTkRTIH0gZnJvbSAnLi4vY29uZmlnL2NvbnN0JztcbmltcG9ydCB7IE9iYkVudW0gfSBmcm9tICcuLi9vYmInO1xuaW1wb3J0IHsgSW5zdHJ1bWVudEVudW0gfSBmcm9tICcuLi9pbnN0cnVtZW50JztcbmV4cG9ydCBmdW5jdGlvbiBnZXRfOG5fdGltZV9ieV9icG0oYnBtKSB7XG4gICAgcmV0dXJuIE51bWJlcigoT05FX01JTlVURV9TRUNPTkRTIC8gYnBtIC8gMikudG9GaXhlZCg1KSk7XG59XG5leHBvcnQgZnVuY3Rpb24gcGFyc2VfcmF3X21pZGlfdG9fcHJvY2Vzc2VkX21pZGkobWlkaSkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCBicG0gPSBtaWRpLmhlYWRlci50ZW1wb3NbMF0uYnBtLCB0aW1lXzhuID0gZ2V0XzhuX3RpbWVfYnlfYnBtKGJwbSksIFxuICAgIC8vIHRpY2tfOG4gPSAobWlkaS5oZWFkZXIucHBxIHx8IDQ4MCkgLyAyLFxuICAgIG1pZGlfZHVyYXRpb24gPSAoX2EgPSBtaWRpLmR1cmF0aW9uKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBnZXRfbWlkaV9kdXJhdGlvbihtaWRpKTtcbiAgICBsZXQgbWlkaV9sZW5ndGggPSBNYXRoLnJvdW5kKG1pZGlfZHVyYXRpb24gLyB0aW1lXzhuKTtcbiAgICBjb25zdCByZW1haW5kZXIgPSBtaWRpX2xlbmd0aCAlIDg7XG4gICAgLy8g5Lul5bCP6IqC5Li65Z+656GA6ZW/5bqm77yM5LiN6Laz5LiA5bCP6IqC6KGl5ruh5LiA5bCP6IqC77yM5LiA5bCP6IqC5pyJIDgg5LiqIDgg5YiG6Z+z56ymXG4gICAgbWlkaV9sZW5ndGggPSByZW1haW5kZXIgPiAwID8gbWlkaV9sZW5ndGggLSByZW1haW5kZXIgKyA4IDogbWlkaV9sZW5ndGg7XG4gICAgY29uc3QgcGFyc2VfdHJhY2tzID0gbWlkaS50cmFja3MubWFwKCh0cmFjaykgPT4ge1xuICAgICAgICBsZXQgbmV3X25vdGVzID0gbmV3IEFycmF5KG1pZGlfbGVuZ3RoKSwgc2lsZW50XzhuX2NvdW50LCBkdXJhdGlvbl84bl9jb3VudCwgcGFkX251bTtcbiAgICAgICAgdHJhY2subm90ZXMuZm9yRWFjaCgobm90ZSkgPT4ge1xuICAgICAgICAgICAgLy8g5pyJ5pWI6Z+z55qE5L2N572u77yM6Z2Z6Z+z5oC75pWw55qE5L2N572u5bCx5piv5pyJ5pWI6Z+z55qE5L2N572u77yI5pWw57uE5LuOMOW8gOWni++8iVxuICAgICAgICAgICAgLy8gc2lsZW50XzhuX2NvdW50ID0gTWF0aC5yb3VuZChub3RlLnRpY2tzIC8gdGlja184bik7XG4gICAgICAgICAgICBzaWxlbnRfOG5fY291bnQgPSBNYXRoLnJvdW5kKG5vdGUudGltZSAvIHRpbWVfOG4pO1xuICAgICAgICAgICAgLy8g5aGr5YWF6Z+z5pWw6YeP77yM5Y675o6J5pyJ5pWI6Z+z5Y2g55So55qE56ys5LiA5Liq5L2N572uXG4gICAgICAgICAgICAvLyBkdXJhdGlvbl84bl9jb3VudCA9IE1hdGgucm91bmQobm90ZS5kdXJhdGlvblRpY2tzIC8gdGlja184bikgLSAxO1xuICAgICAgICAgICAgZHVyYXRpb25fOG5fY291bnQgPSBNYXRoLnJvdW5kKG5vdGUuZHVyYXRpb24gLyB0aW1lXzhuKSAtIDE7XG4gICAgICAgICAgICAvLyDmlL7nva7mnInmlYjpn7NcbiAgICAgICAgICAgIG5ld19ub3Rlc1tzaWxlbnRfOG5fY291bnRdID0gbm90ZTtcbiAgICAgICAgICAgIC8vIOaUvue9ruWhq+WFhemfs1xuICAgICAgICAgICAgaWYgKGR1cmF0aW9uXzhuX2NvdW50IDwgMSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIOagh+W/l+mVv+mfs+espueahOmmlumfs+esplxuICAgICAgICAgICAgbmV3X25vdGVzW3NpbGVudF84bl9jb3VudF0uc3RhcnRfbm90ZSA9IHRydWU7XG4gICAgICAgICAgICBwYWRfbnVtID0gZHVyYXRpb25fOG5fY291bnQ7XG4gICAgICAgICAgICBmb3IgKDsgcGFkX251bSA+IDA7IHBhZF9udW0tLSkge1xuICAgICAgICAgICAgICAgIG5ld19ub3Rlc1tzaWxlbnRfOG5fY291bnQgKyBwYWRfbnVtXSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgbm90ZSksIHsgbmFtZTogbm90ZS5uYW1lLCB0aW1lOiBub3RlLnRpbWUsIGR1cmF0aW9uOiBub3RlLmR1cmF0aW9uIC0gcGFkX251bSAqIHRpbWVfOG4sIHBhZGRpbmdfbm90ZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIOagh+W/l+mVv+mfs+espueahOWwvumfs+espu+8jOWwvumfs+espuWQjOaXtuS5n+aYr+Whq+WFhemfs+esplxuICAgICAgICAgICAgbmV3X25vdGVzW3NpbGVudF84bl9jb3VudCArIGR1cmF0aW9uXzhuX2NvdW50XS5lbmRfbm90ZSA9IHRydWU7XG4gICAgICAgIH0pO1xuICAgICAgICBuZXdfbm90ZXMgPSBwYWRfYXJ5X251bGwobmV3X25vdGVzKTtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgdHJhY2spLCB7IG5vdGVzOiBuZXdfbm90ZXMgfSk7XG4gICAgfSk7XG4gICAgY29uc3QgeyBuYW1lLCBvYmIsIGluc3QgfSA9IGRlc3RydWN0X21pZGlfbmFtZShtaWRpLmhlYWRlci5uYW1lKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBoZWFkZXI6IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgbWlkaS5oZWFkZXIpLCB7IG5hbWUgfSksXG4gICAgICAgIGR1cmF0aW9uOiBtaWRpX2xlbmd0aCAqIHRpbWVfOG4sXG4gICAgICAgIGxlbmd0aDogbWlkaV9sZW5ndGgsXG4gICAgICAgIHRyYWNrczogcGFyc2VfdHJhY2tzLFxuICAgICAgICBwcm86IHRydWUsXG4gICAgICAgIGluc3Q6IG1pZGkuaW5zdCB8fCBpbnN0LFxuICAgICAgICBvYmI6IG1pZGkub2JiIHx8IG9iYixcbiAgICB9O1xufVxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlX3Byb2Nlc3NlZF9taWRpX3RvX3Jhd19taWRpKG1pZGkpIHtcbiAgICBjb25zdCByYXdfdHJhY2tzID0gbWlkaS50cmFja3MubWFwKCh0cmFjaykgPT4ge1xuICAgICAgICBjb25zdCByYXdfbm90ZXMgPSBbXTtcbiAgICAgICAgdHJhY2subm90ZXMuZm9yRWFjaCgobm90ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFub3RlIHx8IG5vdGUucGFkZGluZ19ub3RlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmF3X25vdGVzLnB1c2gobm90ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0cmFjayksIHsgbm90ZXM6IHJhd19ub3RlcywgaW5zdDogbWlkaS5pbnN0LCBvYmI6IG1pZGkub2JiIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIGhlYWRlcjogbWlkaS5oZWFkZXIsXG4gICAgICAgIHRyYWNrczogcmF3X3RyYWNrcyxcbiAgICAgICAgaW5zdDogbWlkaS5pbnN0LFxuICAgICAgICBvYmI6IG1pZGkub2JiLFxuICAgICAgICBkdXJhdGlvbjogbWlkaS5kdXJhdGlvbixcbiAgICB9O1xufVxuZnVuY3Rpb24gcGFkX2FyeV9udWxsKGFycikge1xuICAgIGxldCBpID0gMDtcbiAgICBjb25zdCBsZW4gPSBhcnIubGVuZ3RoLCBhcnkgPSBbXTtcbiAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGFyeVtpXSA9IGFycltpXSA/IGFycltpXSA6IG51bGw7XG4gICAgfVxuICAgIHJldHVybiBhcnk7XG59XG5leHBvcnQgZnVuY3Rpb24gZ2V0X21pZGlfZHVyYXRpb24obWlkaSkge1xuICAgIC8vIOWunumZheeahCBtaWRpIOmfs+S5kOmfs+i9qOS4reeahOacgOWQjuS4gOS4qumfs+espuS4jeS4gOWumuaYr+acgOWQjue7k+adn+eahO+8iOWQjOS4gOi9qOmBk+WQjOS4gOaXtumXtOWPr+S7peWtmOWcqOWkmuS4quWjsOmfs++8iVxuICAgIC8vIOS9huaMieeFp+mcgOaxgu+8jOWcqCBtaWRpIOmfs+S5kOebkuS4reaYr+OAgm1pZGkg6Z+z5LmQ55uS5Yib5L2c55qEIG1pZGkg6Z+z5LmQ6KeE5YiZ5oCn6L6D5by644CCXG4gICAgY29uc3QgZHVyYXRpb25zID0gbWlkaS50cmFja3MubWFwKCh0cmFjaykgPT4ge1xuICAgICAgICBjb25zdCBsYXN0X25vdGUgPSB0cmFjay5ub3Rlc1t0cmFjay5ub3Rlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgcmV0dXJuIGxhc3Rfbm90ZSA/IGxhc3Rfbm90ZS50aW1lICsgbGFzdF9ub3RlLmR1cmF0aW9uIDogMDtcbiAgICB9KTtcbiAgICByZXR1cm4gTWF0aC5tYXgoLi4uZHVyYXRpb25zKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBkZXN0cnVjdF9taWRpX25hbWUobmFtZSkge1xuICAgIGNvbnN0IHJlZyA9IG5ldyBSZWdFeHAoYF4ke01JRElfTkFNRV9QUkVGSVh9YCk7XG4gICAgaWYgKCFyZWcudGVzdChuYW1lKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogYCR7TUlESV9OQU1FX1BSRUZJWH0ke25hbWV9YCxcbiAgICAgICAgICAgIG9iYjogT2JiRW51bS5OT05FLFxuICAgICAgICAgICAgaW5zdDogSW5zdHJ1bWVudEVudW0uR0FNRSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgW21pZGlfbmFtZSwgcXVlcnldID0gbmFtZS5zcGxpdCgnPycpO1xuICAgIGlmICghcXVlcnkpIHtcbiAgICAgICAgcmV0dXJuIHsgbmFtZTogbWlkaV9uYW1lLCBvYmI6IE9iYkVudW0uTk9ORSwgaW5zdDogSW5zdHJ1bWVudEVudW0uR0FNRSB9O1xuICAgIH1cbiAgICBjb25zdCB7IG9iYiA9IE9iYkVudW0uTk9ORSwgaW5zdCA9IEluc3RydW1lbnRFbnVtLkdBTUUgfSA9IHF1ZXJ5XG4gICAgICAgIC5zcGxpdCgnJicpIC8vIGs9dlxuICAgICAgICAubWFwKChrdikgPT4ga3Yuc3BsaXQoJz0nKSkgLy8gW1trLCB2XSwgLi4uXVxuICAgICAgICAucmVkdWNlKChhY2MsIGN1cikgPT4gKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgYWNjKSwgeyBbY3VyWzBdXTogY3VyWzFdIH0pKSwge30pOyAvLyB7azE6IHYxLCBrMjogdjIsIC4uLn1cbiAgICByZXR1cm4geyBuYW1lOiBtaWRpX25hbWUsIG9iYiwgaW5zdCB9O1xufVxuLyoqXG4gKiDlgI3njofliLDpn7Ppq5jlj5jljJbnmoTmlbDlrablhbPns7tcbiAqIEBwYXJhbSB7bnVtYmVyfSBzaGlmdCDmkq3mlL7pgJ/njodcbiAqIEByZXR1cm5zIHtudW1iZXJ9IOWvueW6lOaSreaUvumAn+eOh+S4i+mfs+mrmOeahOWPmOWMluWAvO+8iOWNiumfs++8iVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2hpZnRfdG9fc2VtaXRvbmVzKHNoaWZ0KSB7XG4gICAgcmV0dXJuIE1hdGgucm91bmQoLTEyICogTWF0aC5sb2cyKDEgLyBzaGlmdCkpO1xufVxuLyoqXG4gKiDpn7Ppq5jliLDlgI3njoflj5jljJbnmoTmlbDlrablhbPns7tcbiAqIEBwYXJhbSB7bnVtYmVyfSBzZW1pdG9uZXMg5Y2K6Z+z6Z+z6auY5YC8XG4gKiBAcmV0dXJucyB7bnVtYmVyfSDlr7nlupTnmoTmkq3mlL7lgI3njodcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNlbWl0b25lc190b19zaGlmdChzZW1pdG9uZXMpIHtcbiAgICByZXR1cm4gTWF0aC5wb3coKE1hdGgucG93KDIsICgxIC8gMTIpKSksIHNlbWl0b25lcyk7XG59XG5leHBvcnQgZnVuY3Rpb24ganVkZ2Vfc3BlZWRfc3RhdGUoYnBtKSB7XG4gICAgY29uc3QgbGV2ZWwgPSBicG0gLyAxNTtcbiAgICBpZiAobGV2ZWwgPCA1KVxuICAgICAgICByZXR1cm4gU3BlZWRTdGF0ZUVudW0uTE9XO1xuICAgIGlmIChsZXZlbCA8IDcpXG4gICAgICAgIHJldHVybiBTcGVlZFN0YXRlRW51bS5NSURfTE9XO1xuICAgIGlmIChsZXZlbCA8IDkpXG4gICAgICAgIHJldHVybiBTcGVlZFN0YXRlRW51bS5OT1JNQUw7XG4gICAgaWYgKGxldmVsIDwgMTEpXG4gICAgICAgIHJldHVybiBTcGVlZFN0YXRlRW51bS5NSURfSElHSDtcbiAgICByZXR1cm4gU3BlZWRTdGF0ZUVudW0uSElHSDtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBSZXR1cm4gdGhlIGluZGV4IG9mIHRoZSBlbGVtZW50IGF0IG9yIGJlZm9yZSB0aGUgZ2l2ZW4gcHJvcGVydHlcbiAqIEBoaWRkZW5cbiAqL1xuZnVuY3Rpb24gc2VhcmNoKGFycmF5LCB2YWx1ZSwgcHJvcCkge1xuICAgIGlmIChwcm9wID09PSB2b2lkIDApIHsgcHJvcCA9IFwidGlja3NcIjsgfVxuICAgIHZhciBiZWdpbm5pbmcgPSAwO1xuICAgIHZhciBsZW4gPSBhcnJheS5sZW5ndGg7XG4gICAgdmFyIGVuZCA9IGxlbjtcbiAgICBpZiAobGVuID4gMCAmJiBhcnJheVtsZW4gLSAxXVtwcm9wXSA8PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gbGVuIC0gMTtcbiAgICB9XG4gICAgd2hpbGUgKGJlZ2lubmluZyA8IGVuZCkge1xuICAgICAgICAvLyBjYWxjdWxhdGUgdGhlIG1pZHBvaW50IGZvciByb3VnaGx5IGVxdWFsIHBhcnRpdGlvblxuICAgICAgICB2YXIgbWlkUG9pbnQgPSBNYXRoLmZsb29yKGJlZ2lubmluZyArIChlbmQgLSBiZWdpbm5pbmcpIC8gMik7XG4gICAgICAgIHZhciBldmVudF8xID0gYXJyYXlbbWlkUG9pbnRdO1xuICAgICAgICB2YXIgbmV4dEV2ZW50ID0gYXJyYXlbbWlkUG9pbnQgKyAxXTtcbiAgICAgICAgaWYgKGV2ZW50XzFbcHJvcF0gPT09IHZhbHVlKSB7XG4gICAgICAgICAgICAvLyBjaG9vc2UgdGhlIGxhc3Qgb25lIHRoYXQgaGFzIHRoZSBzYW1lIHZhbHVlXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gbWlkUG9pbnQ7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciB0ZXN0RXZlbnQgPSBhcnJheVtpXTtcbiAgICAgICAgICAgICAgICBpZiAodGVzdEV2ZW50W3Byb3BdID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBtaWRQb2ludCA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG1pZFBvaW50O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50XzFbcHJvcF0gPCB2YWx1ZSAmJiBuZXh0RXZlbnRbcHJvcF0gPiB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIG1pZFBvaW50O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGV2ZW50XzFbcHJvcF0gPiB2YWx1ZSkge1xuICAgICAgICAgICAgLy8gc2VhcmNoIGxvd2VyXG4gICAgICAgICAgICBlbmQgPSBtaWRQb2ludDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChldmVudF8xW3Byb3BdIDwgdmFsdWUpIHtcbiAgICAgICAgICAgIC8vIHNlYXJjaCB1cHBlclxuICAgICAgICAgICAgYmVnaW5uaW5nID0gbWlkUG9pbnQgKyAxO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbn1cbmV4cG9ydHMuc2VhcmNoID0gc2VhcmNoO1xuLyoqXG4gKiBEb2VzIGEgYmluYXJ5IHNlYXJjaCB0byBpbnNlcnQgdGhlIG5vdGVcbiAqIGluIHRoZSBjb3JyZWN0IHNwb3QgaW4gdGhlIGFycmF5XG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIGluc2VydChhcnJheSwgZXZlbnQsIHByb3ApIHtcbiAgICBpZiAocHJvcCA9PT0gdm9pZCAwKSB7IHByb3AgPSBcInRpY2tzXCI7IH1cbiAgICBpZiAoYXJyYXkubGVuZ3RoKSB7XG4gICAgICAgIHZhciBpbmRleCA9IHNlYXJjaChhcnJheSwgZXZlbnRbcHJvcF0sIHByb3ApO1xuICAgICAgICBhcnJheS5zcGxpY2UoaW5kZXggKyAxLCAwLCBldmVudCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhcnJheS5wdXNoKGV2ZW50KTtcbiAgICB9XG59XG5leHBvcnRzLmluc2VydCA9IGluc2VydDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUJpbmFyeVNlYXJjaC5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKlxuICogQSBtYXAgb2YgdmFsdWVzIHRvIGNvbnRyb2wgY2hhbmdlIG5hbWVzXG4gKiBAaGlkZGVuXG4gKi9cbmV4cG9ydHMuY29udHJvbENoYW5nZU5hbWVzID0ge1xuICAgIDE6IFwibW9kdWxhdGlvbldoZWVsXCIsXG4gICAgMjogXCJicmVhdGhcIixcbiAgICA0OiBcImZvb3RDb250cm9sbGVyXCIsXG4gICAgNTogXCJwb3J0YW1lbnRvVGltZVwiLFxuICAgIDc6IFwidm9sdW1lXCIsXG4gICAgODogXCJiYWxhbmNlXCIsXG4gICAgMTA6IFwicGFuXCIsXG4gICAgNjQ6IFwic3VzdGFpblwiLFxuICAgIDY1OiBcInBvcnRhbWVudG9UaW1lXCIsXG4gICAgNjY6IFwic29zdGVudXRvXCIsXG4gICAgNjc6IFwic29mdFBlZGFsXCIsXG4gICAgNjg6IFwibGVnYXRvRm9vdHN3aXRjaFwiLFxuICAgIDg0OiBcInBvcnRhbWVudG9Db250cm9sXCIsXG59O1xuLyoqXG4gKiBzd2FwIHRoZSBrZXlzIGFuZCB2YWx1ZXNcbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0cy5jb250cm9sQ2hhbmdlSWRzID0gT2JqZWN0LmtleXMoZXhwb3J0cy5jb250cm9sQ2hhbmdlTmFtZXMpLnJlZHVjZShmdW5jdGlvbiAob2JqLCBrZXkpIHtcbiAgICBvYmpbZXhwb3J0cy5jb250cm9sQ2hhbmdlTmFtZXNba2V5XV0gPSBrZXk7XG4gICAgcmV0dXJuIG9iajtcbn0sIHt9KTtcbnZhciBwcml2YXRlSGVhZGVyTWFwID0gbmV3IFdlYWtNYXAoKTtcbnZhciBwcml2YXRlQ0NOdW1iZXJNYXAgPSBuZXcgV2Vha01hcCgpO1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgY29udHJvbCBjaGFuZ2UgZXZlbnRcbiAqL1xudmFyIENvbnRyb2xDaGFuZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGV2ZW50XG4gICAgICogQHBhcmFtIGhlYWRlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIENvbnRyb2xDaGFuZ2UoZXZlbnQsIGhlYWRlcikge1xuICAgICAgICBwcml2YXRlSGVhZGVyTWFwLnNldCh0aGlzLCBoZWFkZXIpO1xuICAgICAgICBwcml2YXRlQ0NOdW1iZXJNYXAuc2V0KHRoaXMsIGV2ZW50LmNvbnRyb2xsZXJUeXBlKTtcbiAgICAgICAgdGhpcy50aWNrcyA9IGV2ZW50LmFic29sdXRlVGltZTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IGV2ZW50LnZhbHVlO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29udHJvbENoYW5nZS5wcm90b3R5cGUsIFwibnVtYmVyXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBjb250cm9sbGVyIG51bWJlclxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcHJpdmF0ZUNDTnVtYmVyTWFwLmdldCh0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbnRyb2xDaGFuZ2UucHJvdG90eXBlLCBcIm5hbWVcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogcmV0dXJuIHRoZSBjb21tb24gbmFtZSBvZiB0aGUgY29udHJvbCBudW1iZXIgaWYgaXQgZXhpc3RzXG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChleHBvcnRzLmNvbnRyb2xDaGFuZ2VOYW1lc1t0aGlzLm51bWJlcl0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXhwb3J0cy5jb250cm9sQ2hhbmdlTmFtZXNbdGhpcy5udW1iZXJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb250cm9sQ2hhbmdlLnByb3RvdHlwZSwgXCJ0aW1lXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0aW1lIG9mIHRoZSBldmVudCBpbiBzZWNvbmRzXG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBoZWFkZXIgPSBwcml2YXRlSGVhZGVyTWFwLmdldCh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiBoZWFkZXIudGlja3NUb1NlY29uZHModGhpcy50aWNrcyk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgIHZhciBoZWFkZXIgPSBwcml2YXRlSGVhZGVyTWFwLmdldCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMudGlja3MgPSBoZWFkZXIuc2Vjb25kc1RvVGlja3ModCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENvbnRyb2xDaGFuZ2UucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG51bWJlcjogdGhpcy5udW1iZXIsXG4gICAgICAgICAgICB0aWNrczogdGhpcy50aWNrcyxcbiAgICAgICAgICAgIHRpbWU6IHRoaXMudGltZSxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLnZhbHVlLFxuICAgICAgICB9O1xuICAgIH07XG4gICAgcmV0dXJuIENvbnRyb2xDaGFuZ2U7XG59KCkpO1xuZXhwb3J0cy5Db250cm9sQ2hhbmdlID0gQ29udHJvbENoYW5nZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnRyb2xDaGFuZ2UuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQ29udHJvbENoYW5nZV8xID0gcmVxdWlyZShcIi4vQ29udHJvbENoYW5nZVwiKTtcbi8qKlxuICogQXV0b21hdGljYWxseSBjcmVhdGVzIGFuIGFsaWFzIGZvciBuYW1lZCBjb250cm9sIHZhbHVlcyB1c2luZyBQcm94aWVzXG4gKiBAaGlkZGVuXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUNvbnRyb2xDaGFuZ2VzKCkge1xuICAgIHJldHVybiBuZXcgUHJveHkoe30sIHtcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiB0eXBlZGVmXG4gICAgICAgIGdldDogZnVuY3Rpb24gKHRhcmdldCwgaGFuZGxlcikge1xuICAgICAgICAgICAgaWYgKHRhcmdldFtoYW5kbGVyXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbaGFuZGxlcl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChDb250cm9sQ2hhbmdlXzEuY29udHJvbENoYW5nZUlkcy5oYXNPd25Qcm9wZXJ0eShoYW5kbGVyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbQ29udHJvbENoYW5nZV8xLmNvbnRyb2xDaGFuZ2VJZHNbaGFuZGxlcl1dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IHR5cGVkZWZcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodGFyZ2V0LCBoYW5kbGVyLCB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKENvbnRyb2xDaGFuZ2VfMS5jb250cm9sQ2hhbmdlSWRzLmhhc093blByb3BlcnR5KGhhbmRsZXIpKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W0NvbnRyb2xDaGFuZ2VfMS5jb250cm9sQ2hhbmdlSWRzW2hhbmRsZXJdXSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0W2hhbmRsZXJdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcbiAgICB9KTtcbn1cbmV4cG9ydHMuY3JlYXRlQ29udHJvbENoYW5nZXMgPSBjcmVhdGVDb250cm9sQ2hhbmdlcztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNvbnRyb2xDaGFuZ2VzLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fc3ByZWFkQXJyYXlzID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5cykgfHwgZnVuY3Rpb24gKCkge1xuICAgIGZvciAodmFyIHMgPSAwLCBpID0gMCwgaWwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgaWw7IGkrKykgcyArPSBhcmd1bWVudHNbaV0ubGVuZ3RoO1xuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXG4gICAgICAgICAgICByW2tdID0gYVtqXTtcbiAgICByZXR1cm4gcjtcbn07XG52YXIgX19pbXBvcnREZWZhdWx0ID0gKHRoaXMgJiYgdGhpcy5fX2ltcG9ydERlZmF1bHQpIHx8IGZ1bmN0aW9uIChtb2QpIHtcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IFwiZGVmYXVsdFwiOiBtb2QgfTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbWlkaV9maWxlXzEgPSByZXF1aXJlKFwibWlkaS1maWxlXCIpO1xudmFyIEhlYWRlcl8xID0gcmVxdWlyZShcIi4vSGVhZGVyXCIpO1xudmFyIGFycmF5X2ZsYXR0ZW5fMSA9IF9faW1wb3J0RGVmYXVsdChyZXF1aXJlKFwiYXJyYXktZmxhdHRlblwiKSk7XG5mdW5jdGlvbiBlbmNvZGVOb3RlKG5vdGUsIGNoYW5uZWwpIHtcbiAgICByZXR1cm4gW3tcbiAgICAgICAgICAgIGFic29sdXRlVGltZTogbm90ZS50aWNrcyxcbiAgICAgICAgICAgIGNoYW5uZWw6IGNoYW5uZWwsXG4gICAgICAgICAgICBkZWx0YVRpbWU6IDAsXG4gICAgICAgICAgICBub3RlTnVtYmVyOiBub3RlLm1pZGksXG4gICAgICAgICAgICB0eXBlOiBcIm5vdGVPblwiLFxuICAgICAgICAgICAgdmVsb2NpdHk6IE1hdGguZmxvb3Iobm90ZS52ZWxvY2l0eSAqIDEyNyksXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIGFic29sdXRlVGltZTogbm90ZS50aWNrcyArIG5vdGUuZHVyYXRpb25UaWNrcyxcbiAgICAgICAgICAgIGNoYW5uZWw6IGNoYW5uZWwsXG4gICAgICAgICAgICBkZWx0YVRpbWU6IDAsXG4gICAgICAgICAgICBub3RlTnVtYmVyOiBub3RlLm1pZGksXG4gICAgICAgICAgICB0eXBlOiBcIm5vdGVPZmZcIixcbiAgICAgICAgICAgIHZlbG9jaXR5OiBNYXRoLmZsb29yKG5vdGUubm90ZU9mZlZlbG9jaXR5ICogMTI3KSxcbiAgICAgICAgfV07XG59XG5mdW5jdGlvbiBlbmNvZGVOb3Rlcyh0cmFjaykge1xuICAgIHJldHVybiBhcnJheV9mbGF0dGVuXzEuZGVmYXVsdCh0cmFjay5ub3Rlcy5tYXAoZnVuY3Rpb24gKG5vdGUpIHsgcmV0dXJuIGVuY29kZU5vdGUobm90ZSwgdHJhY2suY2hhbm5lbCk7IH0pKTtcbn1cbmZ1bmN0aW9uIGVuY29kZUNvbnRyb2xDaGFuZ2UoY2MsIGNoYW5uZWwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBhYnNvbHV0ZVRpbWU6IGNjLnRpY2tzLFxuICAgICAgICBjaGFubmVsOiBjaGFubmVsLFxuICAgICAgICBjb250cm9sbGVyVHlwZTogY2MubnVtYmVyLFxuICAgICAgICBkZWx0YVRpbWU6IDAsXG4gICAgICAgIHR5cGU6IFwiY29udHJvbGxlclwiLFxuICAgICAgICB2YWx1ZTogY2MudmFsdWUsXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGVuY29kZUNvbnRyb2xDaGFuZ2VzKHRyYWNrKSB7XG4gICAgdmFyIGNvbnRyb2xDaGFuZ2VzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMjc7IGkrKykge1xuICAgICAgICBpZiAodHJhY2suY29udHJvbENoYW5nZXMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgIHRyYWNrLmNvbnRyb2xDaGFuZ2VzW2ldLmZvckVhY2goZnVuY3Rpb24gKGNjKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbENoYW5nZXMucHVzaChlbmNvZGVDb250cm9sQ2hhbmdlKGNjLCB0cmFjay5jaGFubmVsKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY29udHJvbENoYW5nZXM7XG59XG5mdW5jdGlvbiBlbmNvZGVQaXRjaEJlbmQocGIsIGNoYW5uZWwpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBhYnNvbHV0ZVRpbWU6IHBiLnRpY2tzLFxuICAgICAgICBjaGFubmVsOiBjaGFubmVsLFxuICAgICAgICBkZWx0YVRpbWU6IDAsXG4gICAgICAgIHR5cGU6IFwicGl0Y2hCZW5kXCIsXG4gICAgICAgIHZhbHVlOiBwYi52YWx1ZSxcbiAgICB9O1xufVxuZnVuY3Rpb24gZW5jb2RlUGl0Y2hCZW5kcyh0cmFjaykge1xuICAgIHZhciBwaXRjaEJlbmRzID0gW107XG4gICAgdHJhY2sucGl0Y2hCZW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChwYikge1xuICAgICAgICBwaXRjaEJlbmRzLnB1c2goZW5jb2RlUGl0Y2hCZW5kKHBiLCB0cmFjay5jaGFubmVsKSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHBpdGNoQmVuZHM7XG59XG5mdW5jdGlvbiBlbmNvZGVJbnN0cnVtZW50KHRyYWNrKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWJzb2x1dGVUaW1lOiAwLFxuICAgICAgICBjaGFubmVsOiB0cmFjay5jaGFubmVsLFxuICAgICAgICBkZWx0YVRpbWU6IDAsXG4gICAgICAgIHByb2dyYW1OdW1iZXI6IHRyYWNrLmluc3RydW1lbnQubnVtYmVyLFxuICAgICAgICB0eXBlOiBcInByb2dyYW1DaGFuZ2VcIixcbiAgICB9O1xufVxuZnVuY3Rpb24gZW5jb2RlVHJhY2tOYW1lKG5hbWUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBhYnNvbHV0ZVRpbWU6IDAsXG4gICAgICAgIGRlbHRhVGltZTogMCxcbiAgICAgICAgbWV0YTogdHJ1ZSxcbiAgICAgICAgdGV4dDogbmFtZSxcbiAgICAgICAgdHlwZTogXCJ0cmFja05hbWVcIixcbiAgICB9O1xufVxuZnVuY3Rpb24gZW5jb2RlVGVtcG8odGVtcG8pIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBhYnNvbHV0ZVRpbWU6IHRlbXBvLnRpY2tzLFxuICAgICAgICBkZWx0YVRpbWU6IDAsXG4gICAgICAgIG1ldGE6IHRydWUsXG4gICAgICAgIG1pY3Jvc2Vjb25kc1BlckJlYXQ6IE1hdGguZmxvb3IoNjAwMDAwMDAgLyB0ZW1wby5icG0pLFxuICAgICAgICB0eXBlOiBcInNldFRlbXBvXCIsXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGVuY29kZVRpbWVTaWduYXR1cmUodGltZVNpZykge1xuICAgIHJldHVybiB7XG4gICAgICAgIGFic29sdXRlVGltZTogdGltZVNpZy50aWNrcyxcbiAgICAgICAgZGVsdGFUaW1lOiAwLFxuICAgICAgICBkZW5vbWluYXRvcjogdGltZVNpZy50aW1lU2lnbmF0dXJlWzFdLFxuICAgICAgICBtZXRhOiB0cnVlLFxuICAgICAgICBtZXRyb25vbWU6IDI0LFxuICAgICAgICBudW1lcmF0b3I6IHRpbWVTaWcudGltZVNpZ25hdHVyZVswXSxcbiAgICAgICAgdGhpcnR5c2Vjb25kczogOCxcbiAgICAgICAgdHlwZTogXCJ0aW1lU2lnbmF0dXJlXCIsXG4gICAgfTtcbn1cbi8vIGZ1bmN0aW9uIGVuY29kZU1ldGEoZXZlbnQ6IClcbmZ1bmN0aW9uIGVuY29kZUtleVNpZ25hdHVyZShrZXlTaWcpIHtcbiAgICB2YXIga2V5SW5kZXggPSBIZWFkZXJfMS5rZXlTaWduYXR1cmVLZXlzLmluZGV4T2Yoa2V5U2lnLmtleSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWJzb2x1dGVUaW1lOiBrZXlTaWcudGlja3MsXG4gICAgICAgIGRlbHRhVGltZTogMCxcbiAgICAgICAga2V5OiBrZXlJbmRleCArIDcsXG4gICAgICAgIG1ldGE6IHRydWUsXG4gICAgICAgIHNjYWxlOiBrZXlTaWcuc2NhbGUgPT09IFwibWFqb3JcIiA/IDAgOiAxLFxuICAgICAgICB0eXBlOiBcImtleVNpZ25hdHVyZVwiLFxuICAgIH07XG59XG5mdW5jdGlvbiBlbmNvZGVUZXh0KHRleHRFdmVudCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGFic29sdXRlVGltZTogdGV4dEV2ZW50LnRpY2tzLFxuICAgICAgICBkZWx0YVRpbWU6IDAsXG4gICAgICAgIG1ldGE6IHRydWUsXG4gICAgICAgIHRleHQ6IHRleHRFdmVudC50ZXh0LFxuICAgICAgICB0eXBlOiB0ZXh0RXZlbnQudHlwZSxcbiAgICB9O1xufVxuLyoqXG4gKiBDb252ZXJ0IHRoZSBtaWRpIG9iamVjdCB0byBhbiBhcnJheVxuICovXG5mdW5jdGlvbiBlbmNvZGUobWlkaSkge1xuICAgIHZhciBtaWRpRGF0YSA9IHtcbiAgICAgICAgaGVhZGVyOiB7XG4gICAgICAgICAgICBmb3JtYXQ6IDEsXG4gICAgICAgICAgICBudW1UcmFja3M6IG1pZGkudHJhY2tzLmxlbmd0aCArIDEsXG4gICAgICAgICAgICB0aWNrc1BlckJlYXQ6IG1pZGkuaGVhZGVyLnBwcSxcbiAgICAgICAgfSxcbiAgICAgICAgdHJhY2tzOiBfX3NwcmVhZEFycmF5cyhbXG4gICAgICAgICAgICBfX3NwcmVhZEFycmF5cyhbXG4gICAgICAgICAgICAgICAgLy8gdGhlIG5hbWUgZGF0YVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgYWJzb2x1dGVUaW1lOiAwLFxuICAgICAgICAgICAgICAgICAgICBkZWx0YVRpbWU6IDAsXG4gICAgICAgICAgICAgICAgICAgIG1ldGE6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IG1pZGkuaGVhZGVyLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwidHJhY2tOYW1lXCIsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXSwgbWlkaS5oZWFkZXIua2V5U2lnbmF0dXJlcy5tYXAoZnVuY3Rpb24gKGtleVNpZykgeyByZXR1cm4gZW5jb2RlS2V5U2lnbmF0dXJlKGtleVNpZyk7IH0pLCBtaWRpLmhlYWRlci5tZXRhLm1hcChmdW5jdGlvbiAoZSkgeyByZXR1cm4gZW5jb2RlVGV4dChlKTsgfSksIG1pZGkuaGVhZGVyLnRlbXBvcy5tYXAoZnVuY3Rpb24gKHRlbXBvKSB7IHJldHVybiBlbmNvZGVUZW1wbyh0ZW1wbyk7IH0pLCBtaWRpLmhlYWRlci50aW1lU2lnbmF0dXJlcy5tYXAoZnVuY3Rpb24gKHRpbWVTaWcpIHsgcmV0dXJuIGVuY29kZVRpbWVTaWduYXR1cmUodGltZVNpZyk7IH0pKVxuICAgICAgICBdLCBtaWRpLnRyYWNrcy5tYXAoZnVuY3Rpb24gKHRyYWNrKSB7XG4gICAgICAgICAgICByZXR1cm4gX19zcHJlYWRBcnJheXMoW1xuICAgICAgICAgICAgICAgIC8vIGFkZCB0aGUgbmFtZVxuICAgICAgICAgICAgICAgIGVuY29kZVRyYWNrTmFtZSh0cmFjay5uYW1lKSxcbiAgICAgICAgICAgICAgICAvLyB0aGUgaW5zdHJ1bWVudFxuICAgICAgICAgICAgICAgIGVuY29kZUluc3RydW1lbnQodHJhY2spXG4gICAgICAgICAgICBdLCBlbmNvZGVOb3Rlcyh0cmFjayksIGVuY29kZUNvbnRyb2xDaGFuZ2VzKHRyYWNrKSwgZW5jb2RlUGl0Y2hCZW5kcyh0cmFjaykpO1xuICAgICAgICB9KSksXG4gICAgfTtcbiAgICAvLyBzb3J0IGFuZCBzZXQgZGVsdGFUaW1lIG9mIGFsbCBvZiB0aGUgdHJhY2tzXG4gICAgbWlkaURhdGEudHJhY2tzID0gbWlkaURhdGEudHJhY2tzLm1hcChmdW5jdGlvbiAodHJhY2spIHtcbiAgICAgICAgdHJhY2sgPSB0cmFjay5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLmFic29sdXRlVGltZSAtIGIuYWJzb2x1dGVUaW1lOyB9KTtcbiAgICAgICAgdmFyIGxhc3RUaW1lID0gMDtcbiAgICAgICAgdHJhY2suZm9yRWFjaChmdW5jdGlvbiAobm90ZSkge1xuICAgICAgICAgICAgbm90ZS5kZWx0YVRpbWUgPSBub3RlLmFic29sdXRlVGltZSAtIGxhc3RUaW1lO1xuICAgICAgICAgICAgbGFzdFRpbWUgPSBub3RlLmFic29sdXRlVGltZTtcbiAgICAgICAgICAgIGRlbGV0ZSBub3RlLmFic29sdXRlVGltZTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGVuZCBvZiB0cmFja1xuICAgICAgICB0cmFjay5wdXNoKHtcbiAgICAgICAgICAgIGRlbHRhVGltZTogMCxcbiAgICAgICAgICAgIG1ldGE6IHRydWUsXG4gICAgICAgICAgICB0eXBlOiBcImVuZE9mVHJhY2tcIixcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0cmFjaztcbiAgICB9KTtcbiAgICAvLyByZXR1cm4gbWlkaURhdGFcbiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkobWlkaV9maWxlXzEud3JpdGVNaWRpKG1pZGlEYXRhKSk7XG59XG5leHBvcnRzLmVuY29kZSA9IGVuY29kZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUVuY29kZS5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBCaW5hcnlTZWFyY2hfMSA9IHJlcXVpcmUoXCIuL0JpbmFyeVNlYXJjaFwiKTtcbnZhciBwcml2YXRlUFBRTWFwID0gbmV3IFdlYWtNYXAoKTtcbi8qKlxuICogQGhpZGRlblxuICovXG5leHBvcnRzLmtleVNpZ25hdHVyZUtleXMgPSBbXG4gICAgXCJDYlwiLFxuICAgIFwiR2JcIixcbiAgICBcIkRiXCIsXG4gICAgXCJBYlwiLFxuICAgIFwiRWJcIixcbiAgICBcIkJiXCIsXG4gICAgXCJGXCIsXG4gICAgXCJDXCIsXG4gICAgXCJHXCIsXG4gICAgXCJEXCIsXG4gICAgXCJBXCIsXG4gICAgXCJFXCIsXG4gICAgXCJCXCIsXG4gICAgXCJGI1wiLFxuICAgIFwiQyNcIixcbl07XG4vKiogVGhlIHBhcnNlZCBtaWRpIGZpbGUgaGVhZGVyICovXG52YXIgSGVhZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEhlYWRlcihtaWRpRGF0YSkge1xuICAgICAgICAvLyBsb29rIHRocm91Z2ggYWxsIHRoZSB0cmFja3MgZm9yIHRlbXBvIGNoYW5nZXNcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBhcnJheSBvZiBhbGwgdGhlIHRlbXBvIGV2ZW50c1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50ZW1wb3MgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0aW1lIHNpZ25hdHVyZXNcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudGltZVNpZ25hdHVyZXMgPSBbXTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0aW1lIHNpZ25hdHVyZXNcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMua2V5U2lnbmF0dXJlcyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogQWRkaXRpb25hbCBtZXRhIGV2ZW50c1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tZXRhID0gW107XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbmFtZSBvZiB0aGUgbWlkaSBmaWxlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm5hbWUgPSBcIlwiO1xuICAgICAgICBwcml2YXRlUFBRTWFwLnNldCh0aGlzLCA0ODApO1xuICAgICAgICBpZiAobWlkaURhdGEpIHtcbiAgICAgICAgICAgIHByaXZhdGVQUFFNYXAuc2V0KHRoaXMsIG1pZGlEYXRhLmhlYWRlci50aWNrc1BlckJlYXQpO1xuICAgICAgICAgICAgLy8gY2hlY2sgdGltZSBzaWduYXR1cmUgYW5kIHRlbXBvIGV2ZW50cyBmcm9tIGFsbCBvZiB0aGUgdHJhY2tzXG4gICAgICAgICAgICBtaWRpRGF0YS50cmFja3MuZm9yRWFjaChmdW5jdGlvbiAodHJhY2spIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhY2suZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50Lm1ldGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSBcInRpbWVTaWduYXR1cmVcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnRpbWVTaWduYXR1cmVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aWNrczogZXZlbnQuYWJzb2x1dGVUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lU2lnbmF0dXJlOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5udW1lcmF0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudC5kZW5vbWluYXRvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT09IFwic2V0VGVtcG9cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnRlbXBvcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnBtOiA2MDAwMDAwMCAvIGV2ZW50Lm1pY3Jvc2Vjb25kc1BlckJlYXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpY2tzOiBldmVudC5hYnNvbHV0ZVRpbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC50eXBlID09PSBcImtleVNpZ25hdHVyZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMua2V5U2lnbmF0dXJlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBleHBvcnRzLmtleVNpZ25hdHVyZUtleXNbZXZlbnQua2V5ICsgN10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOiBldmVudC5zY2FsZSA9PT0gMCA/IFwibWFqb3JcIiA6IFwibWlub3JcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlja3M6IGV2ZW50LmFic29sdXRlVGltZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjaGVjayB0aGUgZmlyc3QgdHJhY2sgZm9yIG90aGVyIHJlbGV2YW50IGRhdGFcbiAgICAgICAgICAgIG1pZGlEYXRhLnRyYWNrc1swXS5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGlmIChldmVudC5tZXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSBcInRyYWNrTmFtZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5uYW1lID0gZXZlbnQudGV4dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChldmVudC50eXBlID09PSBcInRleHRcIiB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQudHlwZSA9PT0gXCJjdWVQb2ludFwiIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC50eXBlID09PSBcIm1hcmtlclwiIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudC50eXBlID09PSBcImx5cmljc1wiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5tZXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGV2ZW50LnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlja3M6IGV2ZW50LmFic29sdXRlVGltZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBldmVudC50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhpcyBtdXN0IGJlIGludm9rZWQgYWZ0ZXIgYW55IGNoYW5nZXMgYXJlIG1hZGUgdG8gdGhlIHRlbXBvIGFycmF5XG4gICAgICogb3IgdGhlIHRpbWVTaWduYXR1cmUgYXJyYXkgZm9yIHRoZSB1cGRhdGVkIHZhbHVlcyB0byBiZSByZWZsZWN0ZWQuXG4gICAgICovXG4gICAgSGVhZGVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBjdXJyZW50VGltZSA9IDA7XG4gICAgICAgIHZhciBsYXN0RXZlbnRCZWF0cyA9IDA7XG4gICAgICAgIC8vIG1ha2Ugc3VyZSBpdCdzIHNvcnRlZFxuICAgICAgICB0aGlzLnRlbXBvcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLnRpY2tzIC0gYi50aWNrczsgfSk7XG4gICAgICAgIHRoaXMudGVtcG9zLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50LCBpbmRleCkge1xuICAgICAgICAgICAgdmFyIGxhc3RCUE0gPSBpbmRleCA+IDAgPyBfdGhpcy50ZW1wb3NbaW5kZXggLSAxXS5icG0gOiBfdGhpcy50ZW1wb3NbMF0uYnBtO1xuICAgICAgICAgICAgdmFyIGJlYXRzID0gZXZlbnQudGlja3MgLyBfdGhpcy5wcHEgLSBsYXN0RXZlbnRCZWF0cztcbiAgICAgICAgICAgIHZhciBlbGFwc2VkU2Vjb25kcyA9ICg2MCAvIGxhc3RCUE0pICogYmVhdHM7XG4gICAgICAgICAgICBldmVudC50aW1lID0gZWxhcHNlZFNlY29uZHMgKyBjdXJyZW50VGltZTtcbiAgICAgICAgICAgIGN1cnJlbnRUaW1lID0gZXZlbnQudGltZTtcbiAgICAgICAgICAgIGxhc3RFdmVudEJlYXRzICs9IGJlYXRzO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy50aW1lU2lnbmF0dXJlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLnRpY2tzIC0gYi50aWNrczsgfSk7XG4gICAgICAgIHRoaXMudGltZVNpZ25hdHVyZXMuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQsIGluZGV4KSB7XG4gICAgICAgICAgICB2YXIgbGFzdEV2ZW50ID0gaW5kZXggPiAwXG4gICAgICAgICAgICAgICAgPyBfdGhpcy50aW1lU2lnbmF0dXJlc1tpbmRleCAtIDFdXG4gICAgICAgICAgICAgICAgOiBfdGhpcy50aW1lU2lnbmF0dXJlc1swXTtcbiAgICAgICAgICAgIHZhciBlbGFwc2VkQmVhdHMgPSAoZXZlbnQudGlja3MgLSBsYXN0RXZlbnQudGlja3MpIC8gX3RoaXMucHBxO1xuICAgICAgICAgICAgdmFyIGVsYXBzZWRNZWFzdXJlcyA9IGVsYXBzZWRCZWF0cyAvXG4gICAgICAgICAgICAgICAgbGFzdEV2ZW50LnRpbWVTaWduYXR1cmVbMF0gL1xuICAgICAgICAgICAgICAgIChsYXN0RXZlbnQudGltZVNpZ25hdHVyZVsxXSAvIDQpO1xuICAgICAgICAgICAgbGFzdEV2ZW50Lm1lYXN1cmVzID0gbGFzdEV2ZW50Lm1lYXN1cmVzIHx8IDA7XG4gICAgICAgICAgICBldmVudC5tZWFzdXJlcyA9IGVsYXBzZWRNZWFzdXJlcyArIGxhc3RFdmVudC5tZWFzdXJlcztcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IHRpY2tzIGludG8gc2Vjb25kcyBiYXNlZCBvbiB0aGUgdGVtcG8gY2hhbmdlc1xuICAgICAqL1xuICAgIEhlYWRlci5wcm90b3R5cGUudGlja3NUb1NlY29uZHMgPSBmdW5jdGlvbiAodGlja3MpIHtcbiAgICAgICAgLy8gZmluZCB0aGUgcmVsZXZhbnQgcG9zaXRpb25cbiAgICAgICAgdmFyIGluZGV4ID0gQmluYXJ5U2VhcmNoXzEuc2VhcmNoKHRoaXMudGVtcG9zLCB0aWNrcyk7XG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgIHZhciB0ZW1wbyA9IHRoaXMudGVtcG9zW2luZGV4XTtcbiAgICAgICAgICAgIHZhciB0ZW1wb1RpbWUgPSB0ZW1wby50aW1lO1xuICAgICAgICAgICAgdmFyIGVsYXBzZWRCZWF0cyA9ICh0aWNrcyAtIHRlbXBvLnRpY2tzKSAvIHRoaXMucHBxO1xuICAgICAgICAgICAgcmV0dXJuIHRlbXBvVGltZSArICg2MCAvIHRlbXBvLmJwbSkgKiBlbGFwc2VkQmVhdHM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBhc3N1bWUgMTIwXG4gICAgICAgICAgICB2YXIgYmVhdHMgPSB0aWNrcyAvIHRoaXMucHBxO1xuICAgICAgICAgICAgcmV0dXJuICg2MCAvIDEyMCkgKiBiZWF0cztcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29udmVydCB0aWNrcyBpbnRvIG1lYXN1cmVzIGJhc2VkIG9mZiBvZiB0aGUgdGltZSBzaWduYXR1cmVzXG4gICAgICovXG4gICAgSGVhZGVyLnByb3RvdHlwZS50aWNrc1RvTWVhc3VyZXMgPSBmdW5jdGlvbiAodGlja3MpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gQmluYXJ5U2VhcmNoXzEuc2VhcmNoKHRoaXMudGltZVNpZ25hdHVyZXMsIHRpY2tzKTtcbiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgdmFyIHRpbWVTaWdFdmVudCA9IHRoaXMudGltZVNpZ25hdHVyZXNbaW5kZXhdO1xuICAgICAgICAgICAgdmFyIGVsYXBzZWRCZWF0cyA9ICh0aWNrcyAtIHRpbWVTaWdFdmVudC50aWNrcykgLyB0aGlzLnBwcTtcbiAgICAgICAgICAgIHJldHVybiAodGltZVNpZ0V2ZW50Lm1lYXN1cmVzICtcbiAgICAgICAgICAgICAgICBlbGFwc2VkQmVhdHMgL1xuICAgICAgICAgICAgICAgICAgICAodGltZVNpZ0V2ZW50LnRpbWVTaWduYXR1cmVbMF0gL1xuICAgICAgICAgICAgICAgICAgICAgICAgdGltZVNpZ0V2ZW50LnRpbWVTaWduYXR1cmVbMV0pIC9cbiAgICAgICAgICAgICAgICAgICAgNCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGlja3MgLyB0aGlzLnBwcSAvIDQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShIZWFkZXIucHJvdG90eXBlLCBcInBwcVwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbnVtYmVyIG9mIHRpY2tzIHBlciBxdWFydGVyIG5vdGVcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHByaXZhdGVQUFFNYXAuZ2V0KHRoaXMpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IHNlY29uZHMgdG8gdGlja3MgYmFzZWQgb24gdGhlIHRlbXBvIGV2ZW50c1xuICAgICAqL1xuICAgIEhlYWRlci5wcm90b3R5cGUuc2Vjb25kc1RvVGlja3MgPSBmdW5jdGlvbiAoc2Vjb25kcykge1xuICAgICAgICAvLyBmaW5kIHRoZSByZWxldmFudCBwb3NpdGlvblxuICAgICAgICB2YXIgaW5kZXggPSBCaW5hcnlTZWFyY2hfMS5zZWFyY2godGhpcy50ZW1wb3MsIHNlY29uZHMsIFwidGltZVwiKTtcbiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgdmFyIHRlbXBvID0gdGhpcy50ZW1wb3NbaW5kZXhdO1xuICAgICAgICAgICAgdmFyIHRlbXBvVGltZSA9IHRlbXBvLnRpbWU7XG4gICAgICAgICAgICB2YXIgZWxhcHNlZFRpbWUgPSBzZWNvbmRzIC0gdGVtcG9UaW1lO1xuICAgICAgICAgICAgdmFyIGVsYXBzZWRCZWF0cyA9IGVsYXBzZWRUaW1lIC8gKDYwIC8gdGVtcG8uYnBtKTtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHRlbXBvLnRpY2tzICsgZWxhcHNlZEJlYXRzICogdGhpcy5wcHEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gYXNzdW1lIDEyMFxuICAgICAgICAgICAgdmFyIGJlYXRzID0gc2Vjb25kcyAvICg2MCAvIDEyMCk7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChiZWF0cyAqIHRoaXMucHBxKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29udmVydCB0aGUgaGVhZGVyIGludG8gYW4gb2JqZWN0LlxuICAgICAqL1xuICAgIEhlYWRlci5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2V5U2lnbmF0dXJlczogdGhpcy5rZXlTaWduYXR1cmVzLFxuICAgICAgICAgICAgbWV0YTogdGhpcy5tZXRhLFxuICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lLFxuICAgICAgICAgICAgcHBxOiB0aGlzLnBwcSxcbiAgICAgICAgICAgIHRlbXBvczogdGhpcy50ZW1wb3MubWFwKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgYnBtOiB0LmJwbSxcbiAgICAgICAgICAgICAgICAgICAgdGlja3M6IHQudGlja3MsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGltZVNpZ25hdHVyZXM6IHRoaXMudGltZVNpZ25hdHVyZXMsXG4gICAgICAgIH07XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBwYXJzZSBhIGhlYWRlciBqc29uIG9iamVjdC5cbiAgICAgKi9cbiAgICBIZWFkZXIucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICAgICAgdGhpcy5uYW1lID0ganNvbi5uYW1lO1xuICAgICAgICAvLyBjbG9uZSBhbGwgdGhlIGF0dHJpYnV0ZXNcbiAgICAgICAgdGhpcy50ZW1wb3MgPSBqc29uLnRlbXBvcy5tYXAoZnVuY3Rpb24gKHQpIHsgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHQpOyB9KTtcbiAgICAgICAgdGhpcy50aW1lU2lnbmF0dXJlcyA9IGpzb24udGltZVNpZ25hdHVyZXMubWFwKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmtleVNpZ25hdHVyZXMgPSBqc29uLmtleVNpZ25hdHVyZXMubWFwKGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm1ldGEgPSBqc29uLm1ldGEubWFwKGZ1bmN0aW9uICh0KSB7IHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0KTsgfSk7XG4gICAgICAgIHByaXZhdGVQUFFNYXAuc2V0KHRoaXMsIGpzb24ucHBxKTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgdGVtcG8gb2YgdGhlIG1pZGkgdG8gYSBzaW5nbGUgdGVtcG8uIFdpbGwgcmVtb3ZlIGFuZCByZXBsYWNlXG4gICAgICogYW55IG90aGVyIHRlbXBvcyBjdXJyZW50bHkgc2V0IGFuZCB1cGRhdGUgYWxsIG9mIHRoZSBldmVudCB0aW1pbmcuXG4gICAgICogQHBhcmFtIGJwbSBUaGUgdGVtcG8gaW4gYmVhdHMgcGVyIHNlY29uZFxuICAgICAqL1xuICAgIEhlYWRlci5wcm90b3R5cGUuc2V0VGVtcG8gPSBmdW5jdGlvbiAoYnBtKSB7XG4gICAgICAgIHRoaXMudGVtcG9zID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGJwbTogYnBtLFxuICAgICAgICAgICAgICAgIHRpY2tzOiAwLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXTtcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9O1xuICAgIHJldHVybiBIZWFkZXI7XG59KCkpO1xuZXhwb3J0cy5IZWFkZXIgPSBIZWFkZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1IZWFkZXIuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgSW5zdHJ1bWVudE1hcHNfMSA9IHJlcXVpcmUoXCIuL0luc3RydW1lbnRNYXBzXCIpO1xuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbnZhciBwcml2YXRlVHJhY2tNYXAgPSBuZXcgV2Vha01hcCgpO1xuLyoqXG4gKiBEZXNjcmliZXMgdGhlIG1pZGkgaW5zdHJ1bWVudCBvZiBhIHRyYWNrXG4gKi9cbnZhciBJbnN0cnVtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB0cmFja0RhdGFcbiAgICAgKiBAcGFyYW0gdHJhY2tcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBJbnN0cnVtZW50KHRyYWNrRGF0YSwgdHJhY2spIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBpbnN0cnVtZW50IG51bWJlclxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5udW1iZXIgPSAwO1xuICAgICAgICBwcml2YXRlVHJhY2tNYXAuc2V0KHRoaXMsIHRyYWNrKTtcbiAgICAgICAgdGhpcy5udW1iZXIgPSAwO1xuICAgICAgICBpZiAodHJhY2tEYXRhKSB7XG4gICAgICAgICAgICB2YXIgcHJvZ3JhbUNoYW5nZSA9IHRyYWNrRGF0YS5maW5kKGZ1bmN0aW9uIChlKSB7IHJldHVybiBlLnR5cGUgPT09IFwicHJvZ3JhbUNoYW5nZVwiOyB9KTtcbiAgICAgICAgICAgIGlmIChwcm9ncmFtQ2hhbmdlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5udW1iZXIgPSBwcm9ncmFtQ2hhbmdlLnByb2dyYW1OdW1iZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEluc3RydW1lbnQucHJvdG90eXBlLCBcIm5hbWVcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGNvbW1vbiBuYW1lIG9mIHRoZSBpbnN0cnVtZW50XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBlcmN1c3Npb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSW5zdHJ1bWVudE1hcHNfMS5EcnVtS2l0QnlQYXRjaElEW3RoaXMubnVtYmVyXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBJbnN0cnVtZW50TWFwc18xLmluc3RydW1lbnRCeVBhdGNoSURbdGhpcy5udW1iZXJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChuKSB7XG4gICAgICAgICAgICB2YXIgcGF0Y2hOdW1iZXIgPSBJbnN0cnVtZW50TWFwc18xLmluc3RydW1lbnRCeVBhdGNoSUQuaW5kZXhPZihuKTtcbiAgICAgICAgICAgIGlmIChwYXRjaE51bWJlciAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm51bWJlciA9IHBhdGNoTnVtYmVyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW5zdHJ1bWVudC5wcm90b3R5cGUsIFwiZmFtaWx5XCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBpbnN0cnVtZW50IGZhbWlseSwgZS5nLiBcInBpYW5vXCIuXG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBlcmN1c3Npb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJkcnVtc1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEluc3RydW1lbnRNYXBzXzEuSW5zdHJ1bWVudEZhbWlseUJ5SURbTWF0aC5mbG9vcih0aGlzLm51bWJlciAvIDgpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEluc3RydW1lbnQucHJvdG90eXBlLCBcInBlcmN1c3Npb25cIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgdGhlIGluc3RydW1lbnQgaXMgYSBwZXJjdXNzaW9uIGluc3RydW1lbnRcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRyYWNrID0gcHJpdmF0ZVRyYWNrTWFwLmdldCh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiB0cmFjay5jaGFubmVsID09PSA5O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IGl0IHRvIEpTT04gZm9ybVxuICAgICAqL1xuICAgIEluc3RydW1lbnQucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZhbWlseTogdGhpcy5mYW1pbHksXG4gICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICAgICAgICBudW1iZXI6IHRoaXMubnVtYmVyLFxuICAgICAgICB9O1xuICAgIH07XG4gICAgLyoqXG4gICAgICogQ29udmVydCBmcm9tIEpTT04gZm9ybVxuICAgICAqL1xuICAgIEluc3RydW1lbnQucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICAgICAgdGhpcy5udW1iZXIgPSBqc29uLm51bWJlcjtcbiAgICB9O1xuICAgIHJldHVybiBJbnN0cnVtZW50O1xufSgpKTtcbmV4cG9ydHMuSW5zdHJ1bWVudCA9IEluc3RydW1lbnQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1JbnN0cnVtZW50LmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5pbnN0cnVtZW50QnlQYXRjaElEID0gW1xuICAgIFwiYWNvdXN0aWMgZ3JhbmQgcGlhbm9cIixcbiAgICBcImJyaWdodCBhY291c3RpYyBwaWFub1wiLFxuICAgIFwiZWxlY3RyaWMgZ3JhbmQgcGlhbm9cIixcbiAgICBcImhvbmt5LXRvbmsgcGlhbm9cIixcbiAgICBcImVsZWN0cmljIHBpYW5vIDFcIixcbiAgICBcImVsZWN0cmljIHBpYW5vIDJcIixcbiAgICBcImhhcnBzaWNob3JkXCIsXG4gICAgXCJjbGF2aVwiLFxuICAgIFwiY2VsZXN0YVwiLFxuICAgIFwiZ2xvY2tlbnNwaWVsXCIsXG4gICAgXCJtdXNpYyBib3hcIixcbiAgICBcInZpYnJhcGhvbmVcIixcbiAgICBcIm1hcmltYmFcIixcbiAgICBcInh5bG9waG9uZVwiLFxuICAgIFwidHVidWxhciBiZWxsc1wiLFxuICAgIFwiZHVsY2ltZXJcIixcbiAgICBcImRyYXdiYXIgb3JnYW5cIixcbiAgICBcInBlcmN1c3NpdmUgb3JnYW5cIixcbiAgICBcInJvY2sgb3JnYW5cIixcbiAgICBcImNodXJjaCBvcmdhblwiLFxuICAgIFwicmVlZCBvcmdhblwiLFxuICAgIFwiYWNjb3JkaW9uXCIsXG4gICAgXCJoYXJtb25pY2FcIixcbiAgICBcInRhbmdvIGFjY29yZGlvblwiLFxuICAgIFwiYWNvdXN0aWMgZ3VpdGFyIChueWxvbilcIixcbiAgICBcImFjb3VzdGljIGd1aXRhciAoc3RlZWwpXCIsXG4gICAgXCJlbGVjdHJpYyBndWl0YXIgKGphenopXCIsXG4gICAgXCJlbGVjdHJpYyBndWl0YXIgKGNsZWFuKVwiLFxuICAgIFwiZWxlY3RyaWMgZ3VpdGFyIChtdXRlZClcIixcbiAgICBcIm92ZXJkcml2ZW4gZ3VpdGFyXCIsXG4gICAgXCJkaXN0b3J0aW9uIGd1aXRhclwiLFxuICAgIFwiZ3VpdGFyIGhhcm1vbmljc1wiLFxuICAgIFwiYWNvdXN0aWMgYmFzc1wiLFxuICAgIFwiZWxlY3RyaWMgYmFzcyAoZmluZ2VyKVwiLFxuICAgIFwiZWxlY3RyaWMgYmFzcyAocGljaylcIixcbiAgICBcImZyZXRsZXNzIGJhc3NcIixcbiAgICBcInNsYXAgYmFzcyAxXCIsXG4gICAgXCJzbGFwIGJhc3MgMlwiLFxuICAgIFwic3ludGggYmFzcyAxXCIsXG4gICAgXCJzeW50aCBiYXNzIDJcIixcbiAgICBcInZpb2xpblwiLFxuICAgIFwidmlvbGFcIixcbiAgICBcImNlbGxvXCIsXG4gICAgXCJjb250cmFiYXNzXCIsXG4gICAgXCJ0cmVtb2xvIHN0cmluZ3NcIixcbiAgICBcInBpenppY2F0byBzdHJpbmdzXCIsXG4gICAgXCJvcmNoZXN0cmFsIGhhcnBcIixcbiAgICBcInRpbXBhbmlcIixcbiAgICBcInN0cmluZyBlbnNlbWJsZSAxXCIsXG4gICAgXCJzdHJpbmcgZW5zZW1ibGUgMlwiLFxuICAgIFwic3ludGhzdHJpbmdzIDFcIixcbiAgICBcInN5bnRoc3RyaW5ncyAyXCIsXG4gICAgXCJjaG9pciBhYWhzXCIsXG4gICAgXCJ2b2ljZSBvb2hzXCIsXG4gICAgXCJzeW50aCB2b2ljZVwiLFxuICAgIFwib3JjaGVzdHJhIGhpdFwiLFxuICAgIFwidHJ1bXBldFwiLFxuICAgIFwidHJvbWJvbmVcIixcbiAgICBcInR1YmFcIixcbiAgICBcIm11dGVkIHRydW1wZXRcIixcbiAgICBcImZyZW5jaCBob3JuXCIsXG4gICAgXCJicmFzcyBzZWN0aW9uXCIsXG4gICAgXCJzeW50aGJyYXNzIDFcIixcbiAgICBcInN5bnRoYnJhc3MgMlwiLFxuICAgIFwic29wcmFubyBzYXhcIixcbiAgICBcImFsdG8gc2F4XCIsXG4gICAgXCJ0ZW5vciBzYXhcIixcbiAgICBcImJhcml0b25lIHNheFwiLFxuICAgIFwib2JvZVwiLFxuICAgIFwiZW5nbGlzaCBob3JuXCIsXG4gICAgXCJiYXNzb29uXCIsXG4gICAgXCJjbGFyaW5ldFwiLFxuICAgIFwicGljY29sb1wiLFxuICAgIFwiZmx1dGVcIixcbiAgICBcInJlY29yZGVyXCIsXG4gICAgXCJwYW4gZmx1dGVcIixcbiAgICBcImJsb3duIGJvdHRsZVwiLFxuICAgIFwic2hha3VoYWNoaVwiLFxuICAgIFwid2hpc3RsZVwiLFxuICAgIFwib2NhcmluYVwiLFxuICAgIFwibGVhZCAxIChzcXVhcmUpXCIsXG4gICAgXCJsZWFkIDIgKHNhd3Rvb3RoKVwiLFxuICAgIFwibGVhZCAzIChjYWxsaW9wZSlcIixcbiAgICBcImxlYWQgNCAoY2hpZmYpXCIsXG4gICAgXCJsZWFkIDUgKGNoYXJhbmcpXCIsXG4gICAgXCJsZWFkIDYgKHZvaWNlKVwiLFxuICAgIFwibGVhZCA3IChmaWZ0aHMpXCIsXG4gICAgXCJsZWFkIDggKGJhc3MgKyBsZWFkKVwiLFxuICAgIFwicGFkIDEgKG5ldyBhZ2UpXCIsXG4gICAgXCJwYWQgMiAod2FybSlcIixcbiAgICBcInBhZCAzIChwb2x5c3ludGgpXCIsXG4gICAgXCJwYWQgNCAoY2hvaXIpXCIsXG4gICAgXCJwYWQgNSAoYm93ZWQpXCIsXG4gICAgXCJwYWQgNiAobWV0YWxsaWMpXCIsXG4gICAgXCJwYWQgNyAoaGFsbylcIixcbiAgICBcInBhZCA4IChzd2VlcClcIixcbiAgICBcImZ4IDEgKHJhaW4pXCIsXG4gICAgXCJmeCAyIChzb3VuZHRyYWNrKVwiLFxuICAgIFwiZnggMyAoY3J5c3RhbClcIixcbiAgICBcImZ4IDQgKGF0bW9zcGhlcmUpXCIsXG4gICAgXCJmeCA1IChicmlnaHRuZXNzKVwiLFxuICAgIFwiZnggNiAoZ29ibGlucylcIixcbiAgICBcImZ4IDcgKGVjaG9lcylcIixcbiAgICBcImZ4IDggKHNjaS1maSlcIixcbiAgICBcInNpdGFyXCIsXG4gICAgXCJiYW5qb1wiLFxuICAgIFwic2hhbWlzZW5cIixcbiAgICBcImtvdG9cIixcbiAgICBcImthbGltYmFcIixcbiAgICBcImJhZyBwaXBlXCIsXG4gICAgXCJmaWRkbGVcIixcbiAgICBcInNoYW5haVwiLFxuICAgIFwidGlua2xlIGJlbGxcIixcbiAgICBcImFnb2dvXCIsXG4gICAgXCJzdGVlbCBkcnVtc1wiLFxuICAgIFwid29vZGJsb2NrXCIsXG4gICAgXCJ0YWlrbyBkcnVtXCIsXG4gICAgXCJtZWxvZGljIHRvbVwiLFxuICAgIFwic3ludGggZHJ1bVwiLFxuICAgIFwicmV2ZXJzZSBjeW1iYWxcIixcbiAgICBcImd1aXRhciBmcmV0IG5vaXNlXCIsXG4gICAgXCJicmVhdGggbm9pc2VcIixcbiAgICBcInNlYXNob3JlXCIsXG4gICAgXCJiaXJkIHR3ZWV0XCIsXG4gICAgXCJ0ZWxlcGhvbmUgcmluZ1wiLFxuICAgIFwiaGVsaWNvcHRlclwiLFxuICAgIFwiYXBwbGF1c2VcIixcbiAgICBcImd1bnNob3RcIixcbl07XG5leHBvcnRzLkluc3RydW1lbnRGYW1pbHlCeUlEID0gW1xuICAgIFwicGlhbm9cIixcbiAgICBcImNocm9tYXRpYyBwZXJjdXNzaW9uXCIsXG4gICAgXCJvcmdhblwiLFxuICAgIFwiZ3VpdGFyXCIsXG4gICAgXCJiYXNzXCIsXG4gICAgXCJzdHJpbmdzXCIsXG4gICAgXCJlbnNlbWJsZVwiLFxuICAgIFwiYnJhc3NcIixcbiAgICBcInJlZWRcIixcbiAgICBcInBpcGVcIixcbiAgICBcInN5bnRoIGxlYWRcIixcbiAgICBcInN5bnRoIHBhZFwiLFxuICAgIFwic3ludGggZWZmZWN0c1wiLFxuICAgIFwid29ybGRcIixcbiAgICBcInBlcmN1c3NpdmVcIixcbiAgICBcInNvdW5kIGVmZmVjdHNcIixcbl07XG5leHBvcnRzLkRydW1LaXRCeVBhdGNoSUQgPSB7XG4gICAgMDogXCJzdGFuZGFyZCBraXRcIixcbiAgICA4OiBcInJvb20ga2l0XCIsXG4gICAgMTY6IFwicG93ZXIga2l0XCIsXG4gICAgMjQ6IFwiZWxlY3Ryb25pYyBraXRcIixcbiAgICAyNTogXCJ0ci04MDgga2l0XCIsXG4gICAgMzI6IFwiamF6eiBraXRcIixcbiAgICA0MDogXCJicnVzaCBraXRcIixcbiAgICA0ODogXCJvcmNoZXN0cmEga2l0XCIsXG4gICAgNTY6IFwic291bmQgZngga2l0XCIsXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SW5zdHJ1bWVudE1hcHMuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbnZhciBfX2dlbmVyYXRvciA9ICh0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBib2R5KSB7XG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG1pZGlfZmlsZV8xID0gcmVxdWlyZShcIm1pZGktZmlsZVwiKTtcbnZhciBFbmNvZGVfMSA9IHJlcXVpcmUoXCIuL0VuY29kZVwiKTtcbnZhciBIZWFkZXJfMSA9IHJlcXVpcmUoXCIuL0hlYWRlclwiKTtcbnZhciBUcmFja18xID0gcmVxdWlyZShcIi4vVHJhY2tcIik7XG4vKipcbiAqIFRoZSBtYWluIG1pZGkgcGFyc2luZyBjbGFzc1xuICovXG52YXIgTWlkaSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBQYXJzZSB0aGUgbWlkaSBkYXRhXG4gICAgICovXG4gICAgZnVuY3Rpb24gTWlkaShtaWRpQXJyYXkpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgLy8gcGFyc2UgdGhlIG1pZGkgZGF0YSBpZiB0aGVyZSBpcyBhbnlcbiAgICAgICAgdmFyIG1pZGlEYXRhID0gbnVsbDtcbiAgICAgICAgaWYgKG1pZGlBcnJheSkge1xuICAgICAgICAgICAgaWYgKG1pZGlBcnJheSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgbWlkaUFycmF5ID0gbmV3IFVpbnQ4QXJyYXkobWlkaUFycmF5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1pZGlEYXRhID0gbWlkaV9maWxlXzEucGFyc2VNaWRpKG1pZGlBcnJheSk7XG4gICAgICAgICAgICAvLyBhZGQgdGhlIGFic29sdXRlIHRpbWVzIHRvIGVhY2ggb2YgdGhlIHRyYWNrc1xuICAgICAgICAgICAgbWlkaURhdGEudHJhY2tzLmZvckVhY2goZnVuY3Rpb24gKHRyYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaWNrcyA9IDA7XG4gICAgICAgICAgICAgICAgdHJhY2suZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRpY2tzICs9IGV2ZW50LmRlbHRhVGltZTtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuYWJzb2x1dGVUaW1lID0gY3VycmVudFRpY2tzO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBlbnN1cmUgYXQgbW9zdCBvbmUgaW5zdHJ1bWVudCBwZXIgdHJhY2tcbiAgICAgICAgICAgIG1pZGlEYXRhLnRyYWNrcyA9IHNwbGl0VHJhY2tzKG1pZGlEYXRhLnRyYWNrcyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5oZWFkZXIgPSBuZXcgSGVhZGVyXzEuSGVhZGVyKG1pZGlEYXRhKTtcbiAgICAgICAgdGhpcy50cmFja3MgPSBbXTtcbiAgICAgICAgLy8gcGFyc2UgdGhlIG1pZGkgZGF0YVxuICAgICAgICBpZiAobWlkaUFycmF5KSB7XG4gICAgICAgICAgICAvLyBmb3JtYXQgMCwgZXZlcnl0aGluZyBpcyBvbiB0aGUgc2FtZSB0cmFja1xuICAgICAgICAgICAgdGhpcy50cmFja3MgPSBtaWRpRGF0YS50cmFja3MubWFwKGZ1bmN0aW9uICh0cmFja0RhdGEpIHsgcmV0dXJuIG5ldyBUcmFja18xLlRyYWNrKHRyYWNrRGF0YSwgX3RoaXMuaGVhZGVyKTsgfSk7XG4gICAgICAgICAgICAvLyBpZiBpdCdzIGZvcm1hdCAxIGFuZCB0aGVyZSBhcmUgbm8gbm90ZXMgb24gdGhlIGZpcnN0IHRyYWNrLCByZW1vdmUgaXRcbiAgICAgICAgICAgIGlmIChtaWRpRGF0YS5oZWFkZXIuZm9ybWF0ID09PSAxICYmIHRoaXMudHJhY2tzWzBdLmR1cmF0aW9uID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50cmFja3Muc2hpZnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBEb3dubG9hZCBhbmQgcGFyc2UgdGhlIE1JREkgZmlsZS4gUmV0dXJucyBhIHByb21pc2VcbiAgICAgKiB3aGljaCByZXNvbHZlcyB0byB0aGUgZ2VuZXJhdGVkIG1pZGkgZmlsZVxuICAgICAqIEBwYXJhbSB1cmwgVGhlIHVybCB0byBmZXRjaFxuICAgICAqL1xuICAgIE1pZGkuZnJvbVVybCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlc3BvbnNlLCBhcnJheUJ1ZmZlcjtcbiAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgZmV0Y2godXJsKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCByZXNwb25zZS5hcnJheUJ1ZmZlcigpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXlCdWZmZXIgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbmV3IE1pZGkoYXJyYXlCdWZmZXIpXTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOiB0aHJvdyBuZXcgRXJyb3IoXCJjb3VsZCBub3QgbG9hZCBcIiArIHVybCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1pZGkucHJvdG90eXBlLCBcIm5hbWVcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG5hbWUgb2YgdGhlIG1pZGkgZmlsZSwgdGFrZW4gZnJvbSB0aGUgZmlyc3QgdHJhY2tcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyLm5hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyLm5hbWUgPSBuO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWlkaS5wcm90b3R5cGUsIFwiZHVyYXRpb25cIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRvdGFsIGxlbmd0aCBvZiB0aGUgZmlsZSBpbiBzZWNvbmRzXG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIGdldCB0aGUgbWF4IG9mIHRoZSBsYXN0IG5vdGUgb2YgYWxsIHRoZSB0cmFja3NcbiAgICAgICAgICAgIHZhciBkdXJhdGlvbnMgPSB0aGlzLnRyYWNrcy5tYXAoZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHQuZHVyYXRpb247IH0pO1xuICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4LmFwcGx5KE1hdGgsIGR1cmF0aW9ucyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNaWRpLnByb3RvdHlwZSwgXCJkdXJhdGlvblRpY2tzXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0b3RhbCBsZW5ndGggb2YgdGhlIGZpbGUgaW4gdGlja3NcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gZ2V0IHRoZSBtYXggb2YgdGhlIGxhc3Qgbm90ZSBvZiBhbGwgdGhlIHRyYWNrc1xuICAgICAgICAgICAgdmFyIGR1cmF0aW9uVGlja3MgPSB0aGlzLnRyYWNrcy5tYXAoZnVuY3Rpb24gKHQpIHsgcmV0dXJuIHQuZHVyYXRpb25UaWNrczsgfSk7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5tYXguYXBwbHkoTWF0aCwgZHVyYXRpb25UaWNrcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIC8qKlxuICAgICAqIEFkZCBhIHRyYWNrIHRvIHRoZSBtaWRpIGZpbGVcbiAgICAgKi9cbiAgICBNaWRpLnByb3RvdHlwZS5hZGRUcmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRyYWNrID0gbmV3IFRyYWNrXzEuVHJhY2sodW5kZWZpbmVkLCB0aGlzLmhlYWRlcik7XG4gICAgICAgIHRoaXMudHJhY2tzLnB1c2godHJhY2spO1xuICAgICAgICByZXR1cm4gdHJhY2s7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBFbmNvZGUgdGhlIG1pZGkgYXMgYSBVaW50OEFycmF5LlxuICAgICAqL1xuICAgIE1pZGkucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBFbmNvZGVfMS5lbmNvZGUodGhpcyk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IHRoZSBtaWRpIG9iamVjdCB0byBKU09OLlxuICAgICAqL1xuICAgIE1pZGkucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhlYWRlcjogdGhpcy5oZWFkZXIudG9KU09OKCksXG4gICAgICAgICAgICB0cmFja3M6IHRoaXMudHJhY2tzLm1hcChmdW5jdGlvbiAodHJhY2spIHsgcmV0dXJuIHRyYWNrLnRvSlNPTigpOyB9KSxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0LiBXaWxsIG92ZXJ3cml0ZSB0aGUgY3VycmVudFxuICAgICAqIHRyYWNrcyBhbmQgaGVhZGVyLlxuICAgICAqL1xuICAgIE1pZGkucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5oZWFkZXIgPSBuZXcgSGVhZGVyXzEuSGVhZGVyKCk7XG4gICAgICAgIHRoaXMuaGVhZGVyLmZyb21KU09OKGpzb24uaGVhZGVyKTtcbiAgICAgICAgdGhpcy50cmFja3MgPSBqc29uLnRyYWNrcy5tYXAoZnVuY3Rpb24gKHRyYWNrSlNPTikge1xuICAgICAgICAgICAgdmFyIHRyYWNrID0gbmV3IFRyYWNrXzEuVHJhY2sodW5kZWZpbmVkLCBfdGhpcy5oZWFkZXIpO1xuICAgICAgICAgICAgdHJhY2suZnJvbUpTT04odHJhY2tKU09OKTtcbiAgICAgICAgICAgIHJldHVybiB0cmFjaztcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBDbG9uZSB0aGUgZW50aXJlIG9iamVjdCBtaWRpIG9iamVjdFxuICAgICAqL1xuICAgIE1pZGkucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbWlkaSA9IG5ldyBNaWRpKCk7XG4gICAgICAgIG1pZGkuZnJvbUpTT04odGhpcy50b0pTT04oKSk7XG4gICAgICAgIHJldHVybiBtaWRpO1xuICAgIH07XG4gICAgcmV0dXJuIE1pZGk7XG59KCkpO1xuZXhwb3J0cy5NaWRpID0gTWlkaTtcbnZhciBUcmFja18yID0gcmVxdWlyZShcIi4vVHJhY2tcIik7XG5leHBvcnRzLlRyYWNrID0gVHJhY2tfMi5UcmFjaztcbnZhciBIZWFkZXJfMiA9IHJlcXVpcmUoXCIuL0hlYWRlclwiKTtcbmV4cG9ydHMuSGVhZGVyID0gSGVhZGVyXzIuSGVhZGVyO1xuLyoqXG4gKiBHaXZlbiBhIGxpc3Qgb2YgTUlESSB0cmFja3MsIG1ha2Ugc3VyZSB0aGF0IGVhY2ggY2hhbm5lbCBjb3JyZXNwb25kcyB0byBhdFxuICogbW9zdCBvbmUgY2hhbm5lbCBhbmQgYXQgbW9zdCBvbmUgaW5zdHJ1bWVudC4gVGhpcyBtZWFucyBzcGxpdHRpbmcgdXAgdHJhY2tzXG4gKiB0aGF0IGNvbnRhaW4gbW9yZSB0aGFuIG9uZSBjaGFubmVsIG9yIGluc3RydW1lbnQuXG4gKi9cbmZ1bmN0aW9uIHNwbGl0VHJhY2tzKHRyYWNrcykge1xuICAgIHZhciBuZXdUcmFja3MgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRyYWNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgZGVmYXVsdFRyYWNrID0gbmV3VHJhY2tzLmxlbmd0aDtcbiAgICAgICAgLy8gYSBtYXAgZnJvbSBbcHJvZ3JhbSwgY2hhbm5lbF0gdHVwbGVzIHRvIG5ldyB0cmFjayBudW1iZXJzXG4gICAgICAgIHZhciB0cmFja01hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgLy8gYSBtYXAgZnJvbSBjaGFubmVsIG51bWJlcnMgdG8gY3VycmVudCBwcm9ncmFtIG51bWJlcnNcbiAgICAgICAgdmFyIGN1cnJlbnRQcm9ncmFtID0gQXJyYXkoMTYpLmZpbGwoMCk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0cmFja3NbaV07IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnRfMSA9IF9hW19pXTtcbiAgICAgICAgICAgIHZhciB0YXJnZXRUcmFjayA9IGRlZmF1bHRUcmFjaztcbiAgICAgICAgICAgIC8vIElmIHRoZSBldmVudCBoYXMgYSBjaGFubmVsLCB3ZSBuZWVkIHRvIGZpbmQgdGhhdCBjaGFubmVsJ3MgY3VycmVudFxuICAgICAgICAgICAgLy8gcHJvZ3JhbSBudW1iZXIgYW5kIHRoZSBhcHByb3ByaWF0ZSB0cmFjayBmb3IgdGhpcyBbcHJvZ3JhbSwgY2hhbm5lbF1cbiAgICAgICAgICAgIC8vIHBhaXIuXG4gICAgICAgICAgICB2YXIgY2hhbm5lbCA9IGV2ZW50XzEuY2hhbm5lbDtcbiAgICAgICAgICAgIGlmIChjaGFubmVsICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnRfMS50eXBlID09PSBcInByb2dyYW1DaGFuZ2VcIikge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJvZ3JhbVtjaGFubmVsXSA9IGV2ZW50XzEucHJvZ3JhbU51bWJlcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHByb2dyYW0gPSBjdXJyZW50UHJvZ3JhbVtjaGFubmVsXTtcbiAgICAgICAgICAgICAgICB2YXIgdHJhY2tLZXkgPSBwcm9ncmFtICsgXCIgXCIgKyBjaGFubmVsO1xuICAgICAgICAgICAgICAgIGlmICh0cmFja01hcC5oYXModHJhY2tLZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFRyYWNrID0gdHJhY2tNYXAuZ2V0KHRyYWNrS2V5KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFRyYWNrID0gZGVmYXVsdFRyYWNrICsgdHJhY2tNYXAuc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tNYXAuc2V0KHRyYWNrS2V5LCB0YXJnZXRUcmFjayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFuZXdUcmFja3NbdGFyZ2V0VHJhY2tdKSB7XG4gICAgICAgICAgICAgICAgbmV3VHJhY2tzLnB1c2goW10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3VHJhY2tzW3RhcmdldFRyYWNrXS5wdXNoKGV2ZW50XzEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXdUcmFja3M7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1NaWRpLmpzLm1hcCIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyoqXG4gKiBDb252ZXJ0IGEgbWlkaSBub3RlIGludG8gYSBwaXRjaFxuICovXG5mdW5jdGlvbiBtaWRpVG9QaXRjaChtaWRpKSB7XG4gICAgdmFyIG9jdGF2ZSA9IE1hdGguZmxvb3IobWlkaSAvIDEyKSAtIDE7XG4gICAgcmV0dXJuIG1pZGlUb1BpdGNoQ2xhc3MobWlkaSkgKyBvY3RhdmUudG9TdHJpbmcoKTtcbn1cbi8qKlxuICogQ29udmVydCBhIG1pZGkgbm90ZSB0byBhIHBpdGNoIGNsYXNzIChqdXN0IHRoZSBwaXRjaCBubyBvY3RhdmUpXG4gKi9cbmZ1bmN0aW9uIG1pZGlUb1BpdGNoQ2xhc3MobWlkaSkge1xuICAgIHZhciBzY2FsZUluZGV4VG9Ob3RlID0gW1wiQ1wiLCBcIkMjXCIsIFwiRFwiLCBcIkQjXCIsIFwiRVwiLCBcIkZcIiwgXCJGI1wiLCBcIkdcIiwgXCJHI1wiLCBcIkFcIiwgXCJBI1wiLCBcIkJcIl07XG4gICAgdmFyIG5vdGUgPSBtaWRpICUgMTI7XG4gICAgcmV0dXJuIHNjYWxlSW5kZXhUb05vdGVbbm90ZV07XG59XG4vKipcbiAqIENvbnZlcnQgYSBwaXRjaCBjbGFzcyB0byBhIE1JREkgbm90ZVxuICovXG5mdW5jdGlvbiBwaXRjaENsYXNzVG9NaWRpKHBpdGNoKSB7XG4gICAgdmFyIHNjYWxlSW5kZXhUb05vdGUgPSBbXCJDXCIsIFwiQyNcIiwgXCJEXCIsIFwiRCNcIiwgXCJFXCIsIFwiRlwiLCBcIkYjXCIsIFwiR1wiLCBcIkcjXCIsIFwiQVwiLCBcIkEjXCIsIFwiQlwiXTtcbiAgICByZXR1cm4gc2NhbGVJbmRleFRvTm90ZS5pbmRleE9mKHBpdGNoKTtcbn1cbi8qKlxuICogQ29udmVydCBhIHBpdGNoIHRvIGEgbWlkaSBudW1iZXJcbiAqL1xuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBvbmx5LWFycm93LWZ1bmN0aW9ucyB0eXBlZGVmXG52YXIgcGl0Y2hUb01pZGkgPSAoZnVuY3Rpb24gKCkge1xuICAgIHZhciByZWdleHAgPSAvXihbYS1nXXsxfSg/OmJ8I3x4fGJiKT8pKC0/WzAtOV0rKS9pO1xuICAgIHZhciBub3RlVG9TY2FsZUluZGV4ID0ge1xuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG9iamVjdC1saXRlcmFsLXNvcnQta2V5c1xuICAgICAgICBjYmI6IC0yLCBjYjogLTEsIGM6IDAsIFwiYyNcIjogMSwgY3g6IDIsXG4gICAgICAgIGRiYjogMCwgZGI6IDEsIGQ6IDIsIFwiZCNcIjogMywgZHg6IDQsXG4gICAgICAgIGViYjogMiwgZWI6IDMsIGU6IDQsIFwiZSNcIjogNSwgZXg6IDYsXG4gICAgICAgIGZiYjogMywgZmI6IDQsIGY6IDUsIFwiZiNcIjogNiwgZng6IDcsXG4gICAgICAgIGdiYjogNSwgZ2I6IDYsIGc6IDcsIFwiZyNcIjogOCwgZ3g6IDksXG4gICAgICAgIGFiYjogNywgYWI6IDgsIGE6IDksIFwiYSNcIjogMTAsIGF4OiAxMSxcbiAgICAgICAgYmJiOiA5LCBiYjogMTAsIGI6IDExLCBcImIjXCI6IDEyLCBieDogMTMsXG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG5vdGUpIHtcbiAgICAgICAgdmFyIHNwbGl0ID0gcmVnZXhwLmV4ZWMobm90ZSk7XG4gICAgICAgIHZhciBwaXRjaCA9IHNwbGl0WzFdO1xuICAgICAgICB2YXIgb2N0YXZlID0gc3BsaXRbMl07XG4gICAgICAgIHZhciBpbmRleCA9IG5vdGVUb1NjYWxlSW5kZXhbcGl0Y2gudG9Mb3dlckNhc2UoKV07XG4gICAgICAgIHJldHVybiBpbmRleCArIChwYXJzZUludChvY3RhdmUsIDEwKSArIDEpICogMTI7XG4gICAgfTtcbn0oKSk7XG52YXIgcHJpdmF0ZUhlYWRlck1hcCA9IG5ldyBXZWFrTWFwKCk7XG4vKipcbiAqIEEgTm90ZSBjb25zaXN0cyBvZiBhIG5vdGVPbiBhbmQgbm90ZU9mZiBldmVudFxuICovXG52YXIgTm90ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBOb3RlKG5vdGVPbiwgbm90ZU9mZiwgaGVhZGVyKSB7XG4gICAgICAgIHByaXZhdGVIZWFkZXJNYXAuc2V0KHRoaXMsIGhlYWRlcik7XG4gICAgICAgIHRoaXMubWlkaSA9IG5vdGVPbi5taWRpO1xuICAgICAgICB0aGlzLnZlbG9jaXR5ID0gbm90ZU9uLnZlbG9jaXR5O1xuICAgICAgICB0aGlzLm5vdGVPZmZWZWxvY2l0eSA9IG5vdGVPZmYudmVsb2NpdHk7XG4gICAgICAgIHRoaXMudGlja3MgPSBub3RlT24udGlja3M7XG4gICAgICAgIHRoaXMuZHVyYXRpb25UaWNrcyA9IG5vdGVPZmYudGlja3MgLSBub3RlT24udGlja3M7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RlLnByb3RvdHlwZSwgXCJuYW1lXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBub3RlIG5hbWUgYW5kIG9jdGF2ZSBpbiBzY2llbnRpZmljIHBpdGNoIG5vdGF0aW9uLCBlLmcuIFwiQzRcIlxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbWlkaVRvUGl0Y2godGhpcy5taWRpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgdGhpcy5taWRpID0gcGl0Y2hUb01pZGkobik7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RlLnByb3RvdHlwZSwgXCJvY3RhdmVcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG5vdGVzIG9jdGF2ZSBudW1iZXJcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IodGhpcy5taWRpIC8gMTIpIC0gMTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAobykge1xuICAgICAgICAgICAgdmFyIGRpZmYgPSBvIC0gdGhpcy5vY3RhdmU7XG4gICAgICAgICAgICB0aGlzLm1pZGkgKz0gZGlmZiAqIDEyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTm90ZS5wcm90b3R5cGUsIFwicGl0Y2hcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHBpdGNoIGNsYXNzIG5hbWUuIGUuZy4gXCJBXCJcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG1pZGlUb1BpdGNoQ2xhc3ModGhpcy5taWRpKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgdGhpcy5taWRpID0gMTIgKiAodGhpcy5vY3RhdmUgKyAxKSArIHBpdGNoQ2xhc3NUb01pZGkocCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RlLnByb3RvdHlwZSwgXCJkdXJhdGlvblwiLCB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZHVyYXRpb24gb2YgdGhlIHNlZ21lbnQgaW4gc2Vjb25kc1xuICAgICAgICAgKi9cbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaGVhZGVyID0gcHJpdmF0ZUhlYWRlck1hcC5nZXQodGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gaGVhZGVyLnRpY2tzVG9TZWNvbmRzKHRoaXMudGlja3MgKyB0aGlzLmR1cmF0aW9uVGlja3MpIC0gaGVhZGVyLnRpY2tzVG9TZWNvbmRzKHRoaXMudGlja3MpO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChkKSB7XG4gICAgICAgICAgICB2YXIgaGVhZGVyID0gcHJpdmF0ZUhlYWRlck1hcC5nZXQodGhpcyk7XG4gICAgICAgICAgICB2YXIgbm90ZUVuZFRpY2tzID0gaGVhZGVyLnNlY29uZHNUb1RpY2tzKHRoaXMudGltZSArIGQpO1xuICAgICAgICAgICAgdGhpcy5kdXJhdGlvblRpY2tzID0gbm90ZUVuZFRpY2tzIC0gdGhpcy50aWNrcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vdGUucHJvdG90eXBlLCBcInRpbWVcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIHRpbWUgb2YgdGhlIGV2ZW50IGluIHNlY29uZHNcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGhlYWRlciA9IHByaXZhdGVIZWFkZXJNYXAuZ2V0KHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIGhlYWRlci50aWNrc1RvU2Vjb25kcyh0aGlzLnRpY2tzKTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgdmFyIGhlYWRlciA9IHByaXZhdGVIZWFkZXJNYXAuZ2V0KHRoaXMpO1xuICAgICAgICAgICAgdGhpcy50aWNrcyA9IGhlYWRlci5zZWNvbmRzVG9UaWNrcyh0KTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE5vdGUucHJvdG90eXBlLCBcImJhcnNcIiwge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIG51bWJlciBvZiBtZWFzdXJlcyAoYW5kIHBhcnRpYWwgbWVhc3VyZXMpIHRvIHRoaXMgYmVhdC5cbiAgICAgICAgICogVGFrZXMgaW50byBhY2NvdW50IHRpbWUgc2lnbmF0dXJlIGNoYW5nZXNcbiAgICAgICAgICogQHJlYWRvbmx5XG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBoZWFkZXIgPSBwcml2YXRlSGVhZGVyTWFwLmdldCh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiBoZWFkZXIudGlja3NUb01lYXN1cmVzKHRoaXMudGlja3MpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBOb3RlLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBkdXJhdGlvbjogdGhpcy5kdXJhdGlvbixcbiAgICAgICAgICAgIGR1cmF0aW9uVGlja3M6IHRoaXMuZHVyYXRpb25UaWNrcyxcbiAgICAgICAgICAgIG1pZGk6IHRoaXMubWlkaSxcbiAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZSxcbiAgICAgICAgICAgIHRpY2tzOiB0aGlzLnRpY2tzLFxuICAgICAgICAgICAgdGltZTogdGhpcy50aW1lLFxuICAgICAgICAgICAgdmVsb2NpdHk6IHRoaXMudmVsb2NpdHksXG4gICAgICAgIH07XG4gICAgfTtcbiAgICByZXR1cm4gTm90ZTtcbn0oKSk7XG5leHBvcnRzLk5vdGUgPSBOb3RlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Tm90ZS5qcy5tYXAiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcml2YXRlSGVhZGVyTWFwID0gbmV3IFdlYWtNYXAoKTtcbi8qKlxuICogUmVwcmVzZW50cyBhIHBpdGNoIGJlbmQgZXZlbnRcbiAqL1xudmFyIFBpdGNoQmVuZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgKiBAcGFyYW0gaGVhZGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gUGl0Y2hCZW5kKGV2ZW50LCBoZWFkZXIpIHtcbiAgICAgICAgcHJpdmF0ZUhlYWRlck1hcC5zZXQodGhpcywgaGVhZGVyKTtcbiAgICAgICAgdGhpcy50aWNrcyA9IGV2ZW50LmFic29sdXRlVGltZTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IGV2ZW50LnZhbHVlO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGl0Y2hCZW5kLnByb3RvdHlwZSwgXCJ0aW1lXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSB0aW1lIG9mIHRoZSBldmVudCBpbiBzZWNvbmRzXG4gICAgICAgICAqL1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBoZWFkZXIgPSBwcml2YXRlSGVhZGVyTWFwLmdldCh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiBoZWFkZXIudGlja3NUb1NlY29uZHModGhpcy50aWNrcyk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgIHZhciBoZWFkZXIgPSBwcml2YXRlSGVhZGVyTWFwLmdldCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMudGlja3MgPSBoZWFkZXIuc2Vjb25kc1RvVGlja3ModCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFBpdGNoQmVuZC5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdGlja3M6IHRoaXMudGlja3MsXG4gICAgICAgICAgICB0aW1lOiB0aGlzLnRpbWUsXG4gICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZSxcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIHJldHVybiBQaXRjaEJlbmQ7XG59KCkpO1xuZXhwb3J0cy5QaXRjaEJlbmQgPSBQaXRjaEJlbmQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1QaXRjaEJlbmQuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgQmluYXJ5U2VhcmNoXzEgPSByZXF1aXJlKFwiLi9CaW5hcnlTZWFyY2hcIik7XG52YXIgQ29udHJvbENoYW5nZV8xID0gcmVxdWlyZShcIi4vQ29udHJvbENoYW5nZVwiKTtcbnZhciBDb250cm9sQ2hhbmdlc18xID0gcmVxdWlyZShcIi4vQ29udHJvbENoYW5nZXNcIik7XG52YXIgUGl0Y2hCZW5kXzEgPSByZXF1aXJlKFwiLi9QaXRjaEJlbmRcIik7XG52YXIgSW5zdHJ1bWVudF8xID0gcmVxdWlyZShcIi4vSW5zdHJ1bWVudFwiKTtcbnZhciBOb3RlXzEgPSByZXF1aXJlKFwiLi9Ob3RlXCIpO1xudmFyIHByaXZhdGVIZWFkZXJNYXAgPSBuZXcgV2Vha01hcCgpO1xuLyoqXG4gKiBBIFRyYWNrIGlzIGEgY29sbGVjdGlvbiBvZiBub3RlcyBhbmQgY29udHJvbENoYW5nZXNcbiAqL1xudmFyIFRyYWNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRyYWNrKHRyYWNrRGF0YSwgaGVhZGVyKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgbmFtZSBvZiB0aGUgdHJhY2tcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubmFtZSA9IFwiXCI7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgdHJhY2sncyBub3RlIGV2ZW50c1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ub3RlcyA9IFtdO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGNvbnRyb2wgY2hhbmdlIGV2ZW50c1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5jb250cm9sQ2hhbmdlcyA9IENvbnRyb2xDaGFuZ2VzXzEuY3JlYXRlQ29udHJvbENoYW5nZXMoKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBwaXRjaCBiZW5kIGV2ZW50c1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5waXRjaEJlbmRzID0gW107XG4gICAgICAgIHByaXZhdGVIZWFkZXJNYXAuc2V0KHRoaXMsIGhlYWRlcik7XG4gICAgICAgIGlmICh0cmFja0RhdGEpIHtcbiAgICAgICAgICAgIHZhciBuYW1lRXZlbnQgPSB0cmFja0RhdGEuZmluZChmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS50eXBlID09PSBcInRyYWNrTmFtZVwiOyB9KTtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IG5hbWVFdmVudCA/IG5hbWVFdmVudC50ZXh0IDogXCJcIjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluc3RydW1lbnQgPSBuZXcgSW5zdHJ1bWVudF8xLkluc3RydW1lbnQodHJhY2tEYXRhLCB0aGlzKTtcbiAgICAgICAgLy8gZGVmYXVsdHMgdG8gMFxuICAgICAgICB0aGlzLmNoYW5uZWwgPSAwO1xuICAgICAgICBpZiAodHJhY2tEYXRhKSB7XG4gICAgICAgICAgICB2YXIgbm90ZU9ucyA9IHRyYWNrRGF0YS5maWx0ZXIoZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBldmVudC50eXBlID09PSBcIm5vdGVPblwiOyB9KTtcbiAgICAgICAgICAgIHZhciBub3RlT2ZmcyA9IHRyYWNrRGF0YS5maWx0ZXIoZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBldmVudC50eXBlID09PSBcIm5vdGVPZmZcIjsgfSk7XG4gICAgICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudE5vdGUgPSBub3RlT25zLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBjaGFubmVsIGJhc2VkIG9uIHRoZSBub3RlXG4gICAgICAgICAgICAgICAgdGhpc18xLmNoYW5uZWwgPSBjdXJyZW50Tm90ZS5jaGFubmVsO1xuICAgICAgICAgICAgICAgIC8vIGZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgbm90ZSBvZmZcbiAgICAgICAgICAgICAgICB2YXIgb2ZmSW5kZXggPSBub3RlT2Zmcy5maW5kSW5kZXgoZnVuY3Rpb24gKG5vdGUpIHsgcmV0dXJuIG5vdGUubm90ZU51bWJlciA9PT0gY3VycmVudE5vdGUubm90ZU51bWJlciAmJiBub3RlLmFic29sdXRlVGltZSA+PSBjdXJyZW50Tm90ZS5hYnNvbHV0ZVRpbWU7IH0pO1xuICAgICAgICAgICAgICAgIGlmIChvZmZJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gb25jZSBpdCdzIGdvdCB0aGUgbm90ZSBvZmYsIGFkZCBpdFxuICAgICAgICAgICAgICAgICAgICB2YXIgbm90ZU9mZiA9IG5vdGVPZmZzLnNwbGljZShvZmZJbmRleCwgMSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHRoaXNfMS5hZGROb3RlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uVGlja3M6IG5vdGVPZmYuYWJzb2x1dGVUaW1lIC0gY3VycmVudE5vdGUuYWJzb2x1dGVUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWlkaTogY3VycmVudE5vdGUubm90ZU51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGVPZmZWZWxvY2l0eTogbm90ZU9mZi52ZWxvY2l0eSAvIDEyNyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2tzOiBjdXJyZW50Tm90ZS5hYnNvbHV0ZVRpbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB2ZWxvY2l0eTogY3VycmVudE5vdGUudmVsb2NpdHkgLyAxMjcsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgdGhpc18xID0gdGhpcztcbiAgICAgICAgICAgIHdoaWxlIChub3RlT25zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIF9sb29wXzEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjb250cm9sQ2hhbmdlcyA9IHRyYWNrRGF0YS5maWx0ZXIoZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBldmVudC50eXBlID09PSBcImNvbnRyb2xsZXJcIjsgfSk7XG4gICAgICAgICAgICBjb250cm9sQ2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmFkZENDKHtcbiAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiBldmVudC5jb250cm9sbGVyVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgdGlja3M6IGV2ZW50LmFic29sdXRlVGltZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGV2ZW50LnZhbHVlIC8gMTI3LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgcGl0Y2hCZW5kcyA9IHRyYWNrRGF0YS5maWx0ZXIoZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBldmVudC50eXBlID09PSBcInBpdGNoQmVuZFwiOyB9KTtcbiAgICAgICAgICAgIHBpdGNoQmVuZHMuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5hZGRQaXRjaEJlbmQoe1xuICAgICAgICAgICAgICAgICAgICB0aWNrczogZXZlbnQuYWJzb2x1dGVUaW1lLFxuICAgICAgICAgICAgICAgICAgICAvLyBzY2FsZSB0aGUgdmFsdWUgYmV0d2VlbiAtMl4xMyB0byAyXjEzIHRvIC0yIHRvIDJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGV2ZW50LnZhbHVlIC8gTWF0aC5wb3coMiwgMTMpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjb25zdCBlbmRPZlRyYWNrID0gdHJhY2tEYXRhLmZpbmQoZXZlbnQgPT4gZXZlbnQudHlwZSA9PT0gXCJlbmRPZlRyYWNrXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZCBhIG5vdGUgdG8gdGhlIG5vdGVzIGFycmF5XG4gICAgICogQHBhcmFtIHByb3BzIFRoZSBub3RlIHByb3BlcnRpZXMgdG8gYWRkXG4gICAgICovXG4gICAgVHJhY2sucHJvdG90eXBlLmFkZE5vdGUgPSBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICAgICAgdmFyIGhlYWRlciA9IHByaXZhdGVIZWFkZXJNYXAuZ2V0KHRoaXMpO1xuICAgICAgICB2YXIgbm90ZSA9IG5ldyBOb3RlXzEuTm90ZSh7XG4gICAgICAgICAgICBtaWRpOiAwLFxuICAgICAgICAgICAgdGlja3M6IDAsXG4gICAgICAgICAgICB2ZWxvY2l0eTogMSxcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdGlja3M6IDAsXG4gICAgICAgICAgICB2ZWxvY2l0eTogMCxcbiAgICAgICAgfSwgaGVhZGVyKTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihub3RlLCBwcm9wcyk7XG4gICAgICAgIEJpbmFyeVNlYXJjaF8xLmluc2VydCh0aGlzLm5vdGVzLCBub3RlLCBcInRpY2tzXCIpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIEFkZCBhIGNvbnRyb2wgY2hhbmdlIHRvIHRoZSB0cmFja1xuICAgICAqIEBwYXJhbSBwcm9wc1xuICAgICAqL1xuICAgIFRyYWNrLnByb3RvdHlwZS5hZGRDQyA9IGZ1bmN0aW9uIChwcm9wcykge1xuICAgICAgICB2YXIgaGVhZGVyID0gcHJpdmF0ZUhlYWRlck1hcC5nZXQodGhpcyk7XG4gICAgICAgIHZhciBjYyA9IG5ldyBDb250cm9sQ2hhbmdlXzEuQ29udHJvbENoYW5nZSh7XG4gICAgICAgICAgICBjb250cm9sbGVyVHlwZTogcHJvcHMubnVtYmVyLFxuICAgICAgICB9LCBoZWFkZXIpO1xuICAgICAgICBkZWxldGUgcHJvcHMubnVtYmVyO1xuICAgICAgICBPYmplY3QuYXNzaWduKGNjLCBwcm9wcyk7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh0aGlzLmNvbnRyb2xDaGFuZ2VzW2NjLm51bWJlcl0pKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xDaGFuZ2VzW2NjLm51bWJlcl0gPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBCaW5hcnlTZWFyY2hfMS5pbnNlcnQodGhpcy5jb250cm9sQ2hhbmdlc1tjYy5udW1iZXJdLCBjYywgXCJ0aWNrc1wiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBBZGQgYSBjb250cm9sIGNoYW5nZSB0byB0aGUgdHJhY2tcbiAgICAgKi9cbiAgICBUcmFjay5wcm90b3R5cGUuYWRkUGl0Y2hCZW5kID0gZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgICAgIHZhciBoZWFkZXIgPSBwcml2YXRlSGVhZGVyTWFwLmdldCh0aGlzKTtcbiAgICAgICAgdmFyIHBiID0gbmV3IFBpdGNoQmVuZF8xLlBpdGNoQmVuZCh7fSwgaGVhZGVyKTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihwYiwgcHJvcHMpO1xuICAgICAgICBCaW5hcnlTZWFyY2hfMS5pbnNlcnQodGhpcy5waXRjaEJlbmRzLCBwYiwgXCJ0aWNrc1wiKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVHJhY2sucHJvdG90eXBlLCBcImR1cmF0aW9uXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBlbmQgdGltZSBvZiB0aGUgbGFzdCBldmVudCBpbiB0aGUgdHJhY2tcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLm5vdGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG1heER1cmF0aW9uID0gdGhpcy5ub3Rlc1t0aGlzLm5vdGVzLmxlbmd0aCAtIDFdLnRpbWUgKyB0aGlzLm5vdGVzW3RoaXMubm90ZXMubGVuZ3RoIC0gMV0uZHVyYXRpb247XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm90ZXMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gdGhpcy5ub3Rlc1tpXS50aW1lICsgdGhpcy5ub3Rlc1tpXS5kdXJhdGlvbjtcbiAgICAgICAgICAgICAgICBpZiAobWF4RHVyYXRpb24gPCBkdXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBtYXhEdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtYXhEdXJhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRyYWNrLnByb3RvdHlwZSwgXCJkdXJhdGlvblRpY2tzXCIsIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBlbmQgdGltZSBvZiB0aGUgbGFzdCBldmVudCBpbiB0aGUgdHJhY2sgaW4gdGlja3NcbiAgICAgICAgICovXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLm5vdGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG1heER1cmF0aW9uID0gdGhpcy5ub3Rlc1t0aGlzLm5vdGVzLmxlbmd0aCAtIDFdLnRpY2tzICsgdGhpcy5ub3Rlc1t0aGlzLm5vdGVzLmxlbmd0aCAtIDFdLmR1cmF0aW9uVGlja3M7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm90ZXMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gdGhpcy5ub3Rlc1tpXS50aWNrcyArIHRoaXMubm90ZXNbaV0uZHVyYXRpb25UaWNrcztcbiAgICAgICAgICAgICAgICBpZiAobWF4RHVyYXRpb24gPCBkdXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBtYXhEdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtYXhEdXJhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLyoqXG4gICAgICogQXNzaWduIHRoZSBqc29uIHZhbHVlcyB0byB0aGlzIHRyYWNrXG4gICAgICovXG4gICAgVHJhY2sucHJvdG90eXBlLmZyb21KU09OID0gZnVuY3Rpb24gKGpzb24pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5uYW1lID0ganNvbi5uYW1lO1xuICAgICAgICB0aGlzLmNoYW5uZWwgPSBqc29uLmNoYW5uZWw7XG4gICAgICAgIHRoaXMuaW5zdHJ1bWVudCA9IG5ldyBJbnN0cnVtZW50XzEuSW5zdHJ1bWVudCh1bmRlZmluZWQsIHRoaXMpO1xuICAgICAgICB0aGlzLmluc3RydW1lbnQuZnJvbUpTT04oanNvbi5pbnN0cnVtZW50KTtcbiAgICAgICAgZm9yICh2YXIgbnVtYmVyIGluIGpzb24uY29udHJvbENoYW5nZXMpIHtcbiAgICAgICAgICAgIGlmIChqc29uLmNvbnRyb2xDaGFuZ2VzW251bWJlcl0pIHtcbiAgICAgICAgICAgICAgICBqc29uLmNvbnRyb2xDaGFuZ2VzW251bWJlcl0uZm9yRWFjaChmdW5jdGlvbiAoY2MpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuYWRkQ0Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgbnVtYmVyOiBjYy5udW1iZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aWNrczogY2MudGlja3MsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogY2MudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGpzb24ubm90ZXMuZm9yRWFjaChmdW5jdGlvbiAobikge1xuICAgICAgICAgICAgX3RoaXMuYWRkTm90ZSh7XG4gICAgICAgICAgICAgICAgZHVyYXRpb25UaWNrczogbi5kdXJhdGlvblRpY2tzLFxuICAgICAgICAgICAgICAgIG1pZGk6IG4ubWlkaSxcbiAgICAgICAgICAgICAgICB0aWNrczogbi50aWNrcyxcbiAgICAgICAgICAgICAgICB2ZWxvY2l0eTogbi52ZWxvY2l0eSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIENvbnZlcnQgdGhlIHRyYWNrIGludG8gYSBKU09OIGZvcm1hdFxuICAgICAqL1xuICAgIFRyYWNrLnByb3RvdHlwZS50b0pTT04gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIGNvbnZlcnQgYWxsIHRoZSBDQ3MgdG8gSlNPTlxuICAgICAgICB2YXIgY29udHJvbENoYW5nZXMgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMjc7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY29udHJvbENoYW5nZXMuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sQ2hhbmdlc1tpXSA9IHRoaXMuY29udHJvbENoYW5nZXNbaV0ubWFwKGZ1bmN0aW9uIChjKSB7IHJldHVybiBjLnRvSlNPTigpOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hhbm5lbDogdGhpcy5jaGFubmVsLFxuICAgICAgICAgICAgY29udHJvbENoYW5nZXM6IGNvbnRyb2xDaGFuZ2VzLFxuICAgICAgICAgICAgcGl0Y2hCZW5kczogdGhpcy5waXRjaEJlbmRzLm1hcChmdW5jdGlvbiAocGIpIHsgcmV0dXJuIHBiLnRvSlNPTigpOyB9KSxcbiAgICAgICAgICAgIGluc3RydW1lbnQ6IHRoaXMuaW5zdHJ1bWVudC50b0pTT04oKSxcbiAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZSxcbiAgICAgICAgICAgIG5vdGVzOiB0aGlzLm5vdGVzLm1hcChmdW5jdGlvbiAobikgeyByZXR1cm4gbi50b0pTT04oKTsgfSksXG4gICAgICAgIH07XG4gICAgfTtcbiAgICByZXR1cm4gVHJhY2s7XG59KCkpO1xuZXhwb3J0cy5UcmFjayA9IFRyYWNrO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhY2suanMubWFwIiwiJ3VzZSBzdHJpY3QnXG5cbi8qKlxuICogRXhwb3NlIGBhcnJheUZsYXR0ZW5gLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZsYXR0ZW5cbm1vZHVsZS5leHBvcnRzLmZyb20gPSBmbGF0dGVuRnJvbVxubW9kdWxlLmV4cG9ydHMuZGVwdGggPSBmbGF0dGVuRGVwdGhcbm1vZHVsZS5leHBvcnRzLmZyb21EZXB0aCA9IGZsYXR0ZW5Gcm9tRGVwdGhcblxuLyoqXG4gKiBGbGF0dGVuIGFuIGFycmF5LlxuICpcbiAqIEBwYXJhbSAge0FycmF5fSBhcnJheVxuICogQHJldHVybiB7QXJyYXl9XG4gKi9cbmZ1bmN0aW9uIGZsYXR0ZW4gKGFycmF5KSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShhcnJheSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdFeHBlY3RlZCB2YWx1ZSB0byBiZSBhbiBhcnJheScpXG4gIH1cblxuICByZXR1cm4gZmxhdHRlbkZyb20oYXJyYXkpXG59XG5cbi8qKlxuICogRmxhdHRlbiBhbiBhcnJheS1saWtlIHN0cnVjdHVyZS5cbiAqXG4gKiBAcGFyYW0gIHtBcnJheX0gYXJyYXlcbiAqIEByZXR1cm4ge0FycmF5fVxuICovXG5mdW5jdGlvbiBmbGF0dGVuRnJvbSAoYXJyYXkpIHtcbiAgcmV0dXJuIGZsYXR0ZW5Eb3duKGFycmF5LCBbXSlcbn1cblxuLyoqXG4gKiBGbGF0dGVuIGFuIGFycmF5LWxpa2Ugc3RydWN0dXJlIHdpdGggZGVwdGguXG4gKlxuICogQHBhcmFtICB7QXJyYXl9ICBhcnJheVxuICogQHBhcmFtICB7bnVtYmVyfSBkZXB0aFxuICogQHJldHVybiB7QXJyYXl9XG4gKi9cbmZ1bmN0aW9uIGZsYXR0ZW5EZXB0aCAoYXJyYXksIGRlcHRoKSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShhcnJheSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdFeHBlY3RlZCB2YWx1ZSB0byBiZSBhbiBhcnJheScpXG4gIH1cblxuICByZXR1cm4gZmxhdHRlbkZyb21EZXB0aChhcnJheSwgZGVwdGgpXG59XG5cbi8qKlxuICogRmxhdHRlbiBhbiBhcnJheS1saWtlIHN0cnVjdHVyZSB3aXRoIGRlcHRoLlxuICpcbiAqIEBwYXJhbSAge0FycmF5fSAgYXJyYXlcbiAqIEBwYXJhbSAge251bWJlcn0gZGVwdGhcbiAqIEByZXR1cm4ge0FycmF5fVxuICovXG5mdW5jdGlvbiBmbGF0dGVuRnJvbURlcHRoIChhcnJheSwgZGVwdGgpIHtcbiAgaWYgKHR5cGVvZiBkZXB0aCAhPT0gJ251bWJlcicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdFeHBlY3RlZCB0aGUgZGVwdGggdG8gYmUgYSBudW1iZXInKVxuICB9XG5cbiAgcmV0dXJuIGZsYXR0ZW5Eb3duRGVwdGgoYXJyYXksIFtdLCBkZXB0aClcbn1cblxuLyoqXG4gKiBGbGF0dGVuIGFuIGFycmF5IGluZGVmaW5pdGVseS5cbiAqXG4gKiBAcGFyYW0gIHtBcnJheX0gYXJyYXlcbiAqIEBwYXJhbSAge0FycmF5fSByZXN1bHRcbiAqIEByZXR1cm4ge0FycmF5fVxuICovXG5mdW5jdGlvbiBmbGF0dGVuRG93biAoYXJyYXksIHJlc3VsdCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHZhbHVlID0gYXJyYXlbaV1cblxuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgZmxhdHRlbkRvd24odmFsdWUsIHJlc3VsdClcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0LnB1c2godmFsdWUpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdFxufVxuXG4vKipcbiAqIEZsYXR0ZW4gYW4gYXJyYXkgd2l0aCBkZXB0aC5cbiAqXG4gKiBAcGFyYW0gIHtBcnJheX0gIGFycmF5XG4gKiBAcGFyYW0gIHtBcnJheX0gIHJlc3VsdFxuICogQHBhcmFtICB7bnVtYmVyfSBkZXB0aFxuICogQHJldHVybiB7QXJyYXl9XG4gKi9cbmZ1bmN0aW9uIGZsYXR0ZW5Eb3duRGVwdGggKGFycmF5LCByZXN1bHQsIGRlcHRoKSB7XG4gIGRlcHRoLS1cblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIHZhbHVlID0gYXJyYXlbaV1cblxuICAgIGlmIChkZXB0aCA+IC0xICYmIEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICBmbGF0dGVuRG93bkRlcHRoKHZhbHVlLCByZXN1bHQsIGRlcHRoKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHQucHVzaCh2YWx1ZSlcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzdWx0XG59XG4iLCJleHBvcnRzLnBhcnNlTWlkaSA9IHJlcXVpcmUoJy4vbGliL21pZGktcGFyc2VyJylcbmV4cG9ydHMud3JpdGVNaWRpID0gcmVxdWlyZSgnLi9saWIvbWlkaS13cml0ZXInKVxuIiwiLy8gZGF0YSBjYW4gYmUgYW55IGFycmF5LWxpa2Ugb2JqZWN0LiAgSXQganVzdCBuZWVkcyB0byBzdXBwb3J0IC5sZW5ndGgsIC5zbGljZSwgYW5kIGFuIGVsZW1lbnQgZ2V0dGVyIFtdXG5cbmZ1bmN0aW9uIHBhcnNlTWlkaShkYXRhKSB7XG4gIHZhciBwID0gbmV3IFBhcnNlcihkYXRhKVxuXG4gIHZhciBoZWFkZXJDaHVuayA9IHAucmVhZENodW5rKClcbiAgaWYgKGhlYWRlckNodW5rLmlkICE9ICdNVGhkJylcbiAgICB0aHJvdyBcIkJhZCBNSURJIGZpbGUuICBFeHBlY3RlZCAnTUhkcicsIGdvdDogJ1wiICsgaGVhZGVyQ2h1bmsuaWQgKyBcIidcIlxuICB2YXIgaGVhZGVyID0gcGFyc2VIZWFkZXIoaGVhZGVyQ2h1bmsuZGF0YSlcblxuICB2YXIgdHJhY2tzID0gW11cbiAgZm9yICh2YXIgaT0wOyAhcC5lb2YoKSAmJiBpIDwgaGVhZGVyLm51bVRyYWNrczsgaSsrKSB7XG4gICAgdmFyIHRyYWNrQ2h1bmsgPSBwLnJlYWRDaHVuaygpXG4gICAgaWYgKHRyYWNrQ2h1bmsuaWQgIT0gJ01UcmsnKVxuICAgICAgdGhyb3cgXCJCYWQgTUlESSBmaWxlLiAgRXhwZWN0ZWQgJ01UcmsnLCBnb3Q6ICdcIiArIHRyYWNrQ2h1bmsuaWQgKyBcIidcIlxuICAgIHZhciB0cmFjayA9IHBhcnNlVHJhY2sodHJhY2tDaHVuay5kYXRhKVxuICAgIHRyYWNrcy5wdXNoKHRyYWNrKVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBoZWFkZXI6IGhlYWRlcixcbiAgICB0cmFja3M6IHRyYWNrc1xuICB9XG59XG5cblxuZnVuY3Rpb24gcGFyc2VIZWFkZXIoZGF0YSkge1xuICB2YXIgcCA9IG5ldyBQYXJzZXIoZGF0YSlcblxuICB2YXIgZm9ybWF0ID0gcC5yZWFkVUludDE2KClcbiAgdmFyIG51bVRyYWNrcyA9IHAucmVhZFVJbnQxNigpXG5cbiAgdmFyIHJlc3VsdCA9IHtcbiAgICBmb3JtYXQ6IGZvcm1hdCxcbiAgICBudW1UcmFja3M6IG51bVRyYWNrc1xuICB9XG5cbiAgdmFyIHRpbWVEaXZpc2lvbiA9IHAucmVhZFVJbnQxNigpXG4gIGlmICh0aW1lRGl2aXNpb24gJiAweDgwMDApIHtcbiAgICByZXN1bHQuZnJhbWVzUGVyU2Vjb25kID0gMHgxMDAgLSAodGltZURpdmlzaW9uID4+IDgpXG4gICAgcmVzdWx0LnRpY2tzUGVyRnJhbWUgPSB0aW1lRGl2aXNpb24gJiAweEZGXG4gIH0gZWxzZSB7XG4gICAgcmVzdWx0LnRpY2tzUGVyQmVhdCA9IHRpbWVEaXZpc2lvblxuICB9XG5cbiAgcmV0dXJuIHJlc3VsdFxufVxuXG5mdW5jdGlvbiBwYXJzZVRyYWNrKGRhdGEpIHtcbiAgdmFyIHAgPSBuZXcgUGFyc2VyKGRhdGEpXG5cbiAgdmFyIGV2ZW50cyA9IFtdXG4gIHdoaWxlICghcC5lb2YoKSkge1xuICAgIHZhciBldmVudCA9IHJlYWRFdmVudCgpXG4gICAgZXZlbnRzLnB1c2goZXZlbnQpXG4gIH1cblxuICByZXR1cm4gZXZlbnRzXG5cbiAgdmFyIGxhc3RFdmVudFR5cGVCeXRlID0gbnVsbFxuXG4gIGZ1bmN0aW9uIHJlYWRFdmVudCgpIHtcbiAgICB2YXIgZXZlbnQgPSB7fVxuICAgIGV2ZW50LmRlbHRhVGltZSA9IHAucmVhZFZhckludCgpXG5cbiAgICB2YXIgZXZlbnRUeXBlQnl0ZSA9IHAucmVhZFVJbnQ4KClcblxuICAgIGlmICgoZXZlbnRUeXBlQnl0ZSAmIDB4ZjApID09PSAweGYwKSB7XG4gICAgICAvLyBzeXN0ZW0gLyBtZXRhIGV2ZW50XG4gICAgICBpZiAoZXZlbnRUeXBlQnl0ZSA9PT0gMHhmZikge1xuICAgICAgICAvLyBtZXRhIGV2ZW50XG4gICAgICAgIGV2ZW50Lm1ldGEgPSB0cnVlXG4gICAgICAgIHZhciBtZXRhdHlwZUJ5dGUgPSBwLnJlYWRVSW50OCgpXG4gICAgICAgIHZhciBsZW5ndGggPSBwLnJlYWRWYXJJbnQoKVxuICAgICAgICBzd2l0Y2ggKG1ldGF0eXBlQnl0ZSkge1xuICAgICAgICAgIGNhc2UgMHgwMDpcbiAgICAgICAgICAgIGV2ZW50LnR5cGUgPSAnc2VxdWVuY2VOdW1iZXInXG4gICAgICAgICAgICBpZiAobGVuZ3RoICE9PSAyKSB0aHJvdyBcIkV4cGVjdGVkIGxlbmd0aCBmb3Igc2VxdWVuY2VOdW1iZXIgZXZlbnQgaXMgMiwgZ290IFwiICsgbGVuZ3RoXG4gICAgICAgICAgICBldmVudC5udW1iZXIgPSBwLnJlYWRVSW50MTYoKVxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50XG4gICAgICAgICAgY2FzZSAweDAxOlxuICAgICAgICAgICAgZXZlbnQudHlwZSA9ICd0ZXh0J1xuICAgICAgICAgICAgZXZlbnQudGV4dCA9IHAucmVhZFN0cmluZyhsZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgICAgICBjYXNlIDB4MDI6XG4gICAgICAgICAgICBldmVudC50eXBlID0gJ2NvcHlyaWdodE5vdGljZSdcbiAgICAgICAgICAgIGV2ZW50LnRleHQgPSBwLnJlYWRTdHJpbmcobGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50XG4gICAgICAgICAgY2FzZSAweDAzOlxuICAgICAgICAgICAgZXZlbnQudHlwZSA9ICd0cmFja05hbWUnXG4gICAgICAgICAgICBldmVudC50ZXh0ID0gcC5yZWFkU3RyaW5nKGxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiBldmVudFxuICAgICAgICAgIGNhc2UgMHgwNDpcbiAgICAgICAgICAgIGV2ZW50LnR5cGUgPSAnaW5zdHJ1bWVudE5hbWUnXG4gICAgICAgICAgICBldmVudC50ZXh0ID0gcC5yZWFkU3RyaW5nKGxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiBldmVudFxuICAgICAgICAgIGNhc2UgMHgwNTpcbiAgICAgICAgICAgIGV2ZW50LnR5cGUgPSAnbHlyaWNzJ1xuICAgICAgICAgICAgZXZlbnQudGV4dCA9IHAucmVhZFN0cmluZyhsZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgICAgICBjYXNlIDB4MDY6XG4gICAgICAgICAgICBldmVudC50eXBlID0gJ21hcmtlcidcbiAgICAgICAgICAgIGV2ZW50LnRleHQgPSBwLnJlYWRTdHJpbmcobGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50XG4gICAgICAgICAgY2FzZSAweDA3OlxuICAgICAgICAgICAgZXZlbnQudHlwZSA9ICdjdWVQb2ludCdcbiAgICAgICAgICAgIGV2ZW50LnRleHQgPSBwLnJlYWRTdHJpbmcobGVuZ3RoKVxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50XG4gICAgICAgICAgY2FzZSAweDIwOlxuICAgICAgICAgICAgZXZlbnQudHlwZSA9ICdjaGFubmVsUHJlZml4J1xuICAgICAgICAgICAgaWYgKGxlbmd0aCAhPSAxKSB0aHJvdyBcIkV4cGVjdGVkIGxlbmd0aCBmb3IgY2hhbm5lbFByZWZpeCBldmVudCBpcyAxLCBnb3QgXCIgKyBsZW5ndGhcbiAgICAgICAgICAgIGV2ZW50LmNoYW5uZWwgPSBwLnJlYWRVSW50OCgpXG4gICAgICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgICAgICBjYXNlIDB4MjE6XG4gICAgICAgICAgICBldmVudC50eXBlID0gJ3BvcnRQcmVmaXgnXG4gICAgICAgICAgICBpZiAobGVuZ3RoICE9IDEpIHRocm93IFwiRXhwZWN0ZWQgbGVuZ3RoIGZvciBwb3J0UHJlZml4IGV2ZW50IGlzIDEsIGdvdCBcIiArIGxlbmd0aFxuICAgICAgICAgICAgZXZlbnQucG9ydCA9IHAucmVhZFVJbnQ4KClcbiAgICAgICAgICAgIHJldHVybiBldmVudFxuICAgICAgICAgIGNhc2UgMHgyZjpcbiAgICAgICAgICAgIGV2ZW50LnR5cGUgPSAnZW5kT2ZUcmFjaydcbiAgICAgICAgICAgIGlmIChsZW5ndGggIT0gMCkgdGhyb3cgXCJFeHBlY3RlZCBsZW5ndGggZm9yIGVuZE9mVHJhY2sgZXZlbnQgaXMgMCwgZ290IFwiICsgbGVuZ3RoXG4gICAgICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgICAgICBjYXNlIDB4NTE6XG4gICAgICAgICAgICBldmVudC50eXBlID0gJ3NldFRlbXBvJztcbiAgICAgICAgICAgIGlmIChsZW5ndGggIT0gMykgdGhyb3cgXCJFeHBlY3RlZCBsZW5ndGggZm9yIHNldFRlbXBvIGV2ZW50IGlzIDMsIGdvdCBcIiArIGxlbmd0aFxuICAgICAgICAgICAgZXZlbnQubWljcm9zZWNvbmRzUGVyQmVhdCA9IHAucmVhZFVJbnQyNCgpXG4gICAgICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgICAgICBjYXNlIDB4NTQ6XG4gICAgICAgICAgICBldmVudC50eXBlID0gJ3NtcHRlT2Zmc2V0JztcbiAgICAgICAgICAgIGlmIChsZW5ndGggIT0gNSkgdGhyb3cgXCJFeHBlY3RlZCBsZW5ndGggZm9yIHNtcHRlT2Zmc2V0IGV2ZW50IGlzIDUsIGdvdCBcIiArIGxlbmd0aFxuICAgICAgICAgICAgdmFyIGhvdXJCeXRlID0gcC5yZWFkVUludDgoKVxuICAgICAgICAgICAgdmFyIEZSQU1FX1JBVEVTID0geyAweDAwOiAyNCwgMHgyMDogMjUsIDB4NDA6IDI5LCAweDYwOiAzMCB9XG4gICAgICAgICAgICBldmVudC5mcmFtZVJhdGUgPSBGUkFNRV9SQVRFU1tob3VyQnl0ZSAmIDB4NjBdXG4gICAgICAgICAgICBldmVudC5ob3VyID0gaG91ckJ5dGUgJiAweDFmXG4gICAgICAgICAgICBldmVudC5taW4gPSBwLnJlYWRVSW50OCgpXG4gICAgICAgICAgICBldmVudC5zZWMgPSBwLnJlYWRVSW50OCgpXG4gICAgICAgICAgICBldmVudC5mcmFtZSA9IHAucmVhZFVJbnQ4KClcbiAgICAgICAgICAgIGV2ZW50LnN1YkZyYW1lID0gcC5yZWFkVUludDgoKVxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50XG4gICAgICAgICAgY2FzZSAweDU4OlxuICAgICAgICAgICAgZXZlbnQudHlwZSA9ICd0aW1lU2lnbmF0dXJlJ1xuICAgICAgICAgICAgaWYgKGxlbmd0aCAhPSA0KSB0aHJvdyBcIkV4cGVjdGVkIGxlbmd0aCBmb3IgdGltZVNpZ25hdHVyZSBldmVudCBpcyA0LCBnb3QgXCIgKyBsZW5ndGhcbiAgICAgICAgICAgIGV2ZW50Lm51bWVyYXRvciA9IHAucmVhZFVJbnQ4KClcbiAgICAgICAgICAgIGV2ZW50LmRlbm9taW5hdG9yID0gKDEgPDwgcC5yZWFkVUludDgoKSlcbiAgICAgICAgICAgIGV2ZW50Lm1ldHJvbm9tZSA9IHAucmVhZFVJbnQ4KClcbiAgICAgICAgICAgIGV2ZW50LnRoaXJ0eXNlY29uZHMgPSBwLnJlYWRVSW50OCgpXG4gICAgICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgICAgICBjYXNlIDB4NTk6XG4gICAgICAgICAgICBldmVudC50eXBlID0gJ2tleVNpZ25hdHVyZSdcbiAgICAgICAgICAgIGlmIChsZW5ndGggIT0gMikgdGhyb3cgXCJFeHBlY3RlZCBsZW5ndGggZm9yIGtleVNpZ25hdHVyZSBldmVudCBpcyAyLCBnb3QgXCIgKyBsZW5ndGhcbiAgICAgICAgICAgIGV2ZW50LmtleSA9IHAucmVhZEludDgoKVxuICAgICAgICAgICAgZXZlbnQuc2NhbGUgPSBwLnJlYWRVSW50OCgpXG4gICAgICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgICAgICBjYXNlIDB4N2Y6XG4gICAgICAgICAgICBldmVudC50eXBlID0gJ3NlcXVlbmNlclNwZWNpZmljJ1xuICAgICAgICAgICAgZXZlbnQuZGF0YSA9IHAucmVhZEJ5dGVzKGxlbmd0aClcbiAgICAgICAgICAgIHJldHVybiBldmVudFxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBldmVudC50eXBlID0gJ3Vua25vd25NZXRhJ1xuICAgICAgICAgICAgZXZlbnQuZGF0YSA9IHAucmVhZEJ5dGVzKGxlbmd0aClcbiAgICAgICAgICAgIGV2ZW50Lm1ldGF0eXBlQnl0ZSA9IG1ldGF0eXBlQnl0ZVxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoZXZlbnRUeXBlQnl0ZSA9PSAweGYwKSB7XG4gICAgICAgIGV2ZW50LnR5cGUgPSAnc3lzRXgnXG4gICAgICAgIHZhciBsZW5ndGggPSBwLnJlYWRWYXJJbnQoKVxuICAgICAgICBldmVudC5kYXRhID0gcC5yZWFkQnl0ZXMobGVuZ3RoKVxuICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgIH0gZWxzZSBpZiAoZXZlbnRUeXBlQnl0ZSA9PSAweGY3KSB7XG4gICAgICAgIGV2ZW50LnR5cGUgPSAnZW5kU3lzRXgnXG4gICAgICAgIHZhciBsZW5ndGggPSBwLnJlYWRWYXJJbnQoKVxuICAgICAgICBldmVudC5kYXRhID0gcC5yZWFkQnl0ZXMobGVuZ3RoKVxuICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IFwiVW5yZWNvZ25pc2VkIE1JREkgZXZlbnQgdHlwZSBieXRlOiBcIiArIGV2ZW50VHlwZUJ5dGVcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gY2hhbm5lbCBldmVudFxuICAgICAgdmFyIHBhcmFtMVxuICAgICAgaWYgKChldmVudFR5cGVCeXRlICYgMHg4MCkgPT09IDApIHtcbiAgICAgICAgLy8gcnVubmluZyBzdGF0dXMgLSByZXVzZSBsYXN0RXZlbnRUeXBlQnl0ZSBhcyB0aGUgZXZlbnQgdHlwZS5cbiAgICAgICAgLy8gZXZlbnRUeXBlQnl0ZSBpcyBhY3R1YWxseSB0aGUgZmlyc3QgcGFyYW1ldGVyXG4gICAgICAgIGlmIChsYXN0RXZlbnRUeXBlQnl0ZSA9PT0gbnVsbClcbiAgICAgICAgICB0aHJvdyBcIlJ1bm5pbmcgc3RhdHVzIGJ5dGUgZW5jb3VudGVyZWQgYmVmb3JlIHN0YXR1cyBieXRlXCJcbiAgICAgICAgcGFyYW0xID0gZXZlbnRUeXBlQnl0ZVxuICAgICAgICBldmVudFR5cGVCeXRlID0gbGFzdEV2ZW50VHlwZUJ5dGVcbiAgICAgICAgZXZlbnQucnVubmluZyA9IHRydWVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcmFtMSA9IHAucmVhZFVJbnQ4KClcbiAgICAgICAgbGFzdEV2ZW50VHlwZUJ5dGUgPSBldmVudFR5cGVCeXRlXG4gICAgICB9XG4gICAgICB2YXIgZXZlbnRUeXBlID0gZXZlbnRUeXBlQnl0ZSA+PiA0XG4gICAgICBldmVudC5jaGFubmVsID0gZXZlbnRUeXBlQnl0ZSAmIDB4MGZcbiAgICAgIHN3aXRjaCAoZXZlbnRUeXBlKSB7XG4gICAgICAgIGNhc2UgMHgwODpcbiAgICAgICAgICBldmVudC50eXBlID0gJ25vdGVPZmYnXG4gICAgICAgICAgZXZlbnQubm90ZU51bWJlciA9IHBhcmFtMVxuICAgICAgICAgIGV2ZW50LnZlbG9jaXR5ID0gcC5yZWFkVUludDgoKVxuICAgICAgICAgIHJldHVybiBldmVudFxuICAgICAgICBjYXNlIDB4MDk6XG4gICAgICAgICAgdmFyIHZlbG9jaXR5ID0gcC5yZWFkVUludDgoKVxuICAgICAgICAgIGV2ZW50LnR5cGUgPSB2ZWxvY2l0eSA9PT0gMCA/ICdub3RlT2ZmJyA6ICdub3RlT24nXG4gICAgICAgICAgZXZlbnQubm90ZU51bWJlciA9IHBhcmFtMVxuICAgICAgICAgIGV2ZW50LnZlbG9jaXR5ID0gdmVsb2NpdHlcbiAgICAgICAgICBpZiAodmVsb2NpdHkgPT09IDApIGV2ZW50LmJ5dGU5ID0gdHJ1ZVxuICAgICAgICAgIHJldHVybiBldmVudFxuICAgICAgICBjYXNlIDB4MGE6XG4gICAgICAgICAgZXZlbnQudHlwZSA9ICdub3RlQWZ0ZXJ0b3VjaCdcbiAgICAgICAgICBldmVudC5ub3RlTnVtYmVyID0gcGFyYW0xXG4gICAgICAgICAgZXZlbnQuYW1vdW50ID0gcC5yZWFkVUludDgoKVxuICAgICAgICAgIHJldHVybiBldmVudFxuICAgICAgICBjYXNlIDB4MGI6XG4gICAgICAgICAgZXZlbnQudHlwZSA9ICdjb250cm9sbGVyJ1xuICAgICAgICAgIGV2ZW50LmNvbnRyb2xsZXJUeXBlID0gcGFyYW0xXG4gICAgICAgICAgZXZlbnQudmFsdWUgPSBwLnJlYWRVSW50OCgpXG4gICAgICAgICAgcmV0dXJuIGV2ZW50XG4gICAgICAgIGNhc2UgMHgwYzpcbiAgICAgICAgICBldmVudC50eXBlID0gJ3Byb2dyYW1DaGFuZ2UnXG4gICAgICAgICAgZXZlbnQucHJvZ3JhbU51bWJlciA9IHBhcmFtMVxuICAgICAgICAgIHJldHVybiBldmVudFxuICAgICAgICBjYXNlIDB4MGQ6XG4gICAgICAgICAgZXZlbnQudHlwZSA9ICdjaGFubmVsQWZ0ZXJ0b3VjaCdcbiAgICAgICAgICBldmVudC5hbW91bnQgPSBwYXJhbTFcbiAgICAgICAgICByZXR1cm4gZXZlbnRcbiAgICAgICAgY2FzZSAweDBlOlxuICAgICAgICAgIGV2ZW50LnR5cGUgPSAncGl0Y2hCZW5kJ1xuICAgICAgICAgIGV2ZW50LnZhbHVlID0gKHBhcmFtMSArIChwLnJlYWRVSW50OCgpIDw8IDcpKSAtIDB4MjAwMFxuICAgICAgICAgIHJldHVybiBldmVudFxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IFwiVW5yZWNvZ25pc2VkIE1JREkgZXZlbnQgdHlwZTogXCIgKyBldmVudFR5cGVcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gUGFyc2VyKGRhdGEpIHtcbiAgdGhpcy5idWZmZXIgPSBkYXRhXG4gIHRoaXMuYnVmZmVyTGVuID0gdGhpcy5idWZmZXIubGVuZ3RoXG4gIHRoaXMucG9zID0gMFxufVxuXG5QYXJzZXIucHJvdG90eXBlLmVvZiA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5wb3MgPj0gdGhpcy5idWZmZXJMZW5cbn1cblxuUGFyc2VyLnByb3RvdHlwZS5yZWFkVUludDggPSBmdW5jdGlvbigpIHtcbiAgdmFyIHJlc3VsdCA9IHRoaXMuYnVmZmVyW3RoaXMucG9zXVxuICB0aGlzLnBvcyArPSAxXG4gIHJldHVybiByZXN1bHRcbn1cblxuUGFyc2VyLnByb3RvdHlwZS5yZWFkSW50OCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgdSA9IHRoaXMucmVhZFVJbnQ4KClcbiAgaWYgKHUgJiAweDgwKVxuICAgIHJldHVybiB1IC0gMHgxMDBcbiAgZWxzZVxuICAgIHJldHVybiB1XG59XG5cblBhcnNlci5wcm90b3R5cGUucmVhZFVJbnQxNiA9IGZ1bmN0aW9uKCkge1xuICB2YXIgYjAgPSB0aGlzLnJlYWRVSW50OCgpLFxuICAgICAgYjEgPSB0aGlzLnJlYWRVSW50OCgpXG5cbiAgICByZXR1cm4gKGIwIDw8IDgpICsgYjFcbn1cblxuUGFyc2VyLnByb3RvdHlwZS5yZWFkSW50MTYgPSBmdW5jdGlvbigpIHtcbiAgdmFyIHUgPSB0aGlzLnJlYWRVSW50MTYoKVxuICBpZiAodSAmIDB4ODAwMClcbiAgICByZXR1cm4gdSAtIDB4MTAwMDBcbiAgZWxzZVxuICAgIHJldHVybiB1XG59XG5cblBhcnNlci5wcm90b3R5cGUucmVhZFVJbnQyNCA9IGZ1bmN0aW9uKCkge1xuICB2YXIgYjAgPSB0aGlzLnJlYWRVSW50OCgpLFxuICAgICAgYjEgPSB0aGlzLnJlYWRVSW50OCgpLFxuICAgICAgYjIgPSB0aGlzLnJlYWRVSW50OCgpXG5cbiAgICByZXR1cm4gKGIwIDw8IDE2KSArIChiMSA8PCA4KSArIGIyXG59XG5cblBhcnNlci5wcm90b3R5cGUucmVhZEludDI0ID0gZnVuY3Rpb24oKSB7XG4gIHZhciB1ID0gdGhpcy5yZWFkVUludDI0KClcbiAgaWYgKHUgJiAweDgwMDAwMClcbiAgICByZXR1cm4gdSAtIDB4MTAwMDAwMFxuICBlbHNlXG4gICAgcmV0dXJuIHVcbn1cblxuUGFyc2VyLnByb3RvdHlwZS5yZWFkVUludDMyID0gZnVuY3Rpb24oKSB7XG4gIHZhciBiMCA9IHRoaXMucmVhZFVJbnQ4KCksXG4gICAgICBiMSA9IHRoaXMucmVhZFVJbnQ4KCksXG4gICAgICBiMiA9IHRoaXMucmVhZFVJbnQ4KCksXG4gICAgICBiMyA9IHRoaXMucmVhZFVJbnQ4KClcblxuICAgIHJldHVybiAoYjAgPDwgMjQpICsgKGIxIDw8IDE2KSArIChiMiA8PCA4KSArIGIzXG59XG5cblBhcnNlci5wcm90b3R5cGUucmVhZEJ5dGVzID0gZnVuY3Rpb24obGVuKSB7XG4gIHZhciBieXRlcyA9IHRoaXMuYnVmZmVyLnNsaWNlKHRoaXMucG9zLCB0aGlzLnBvcyArIGxlbilcbiAgdGhpcy5wb3MgKz0gbGVuXG4gIHJldHVybiBieXRlc1xufVxuXG5QYXJzZXIucHJvdG90eXBlLnJlYWRTdHJpbmcgPSBmdW5jdGlvbihsZW4pIHtcbiAgdmFyIGJ5dGVzID0gdGhpcy5yZWFkQnl0ZXMobGVuKVxuICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBieXRlcylcbn1cblxuUGFyc2VyLnByb3RvdHlwZS5yZWFkVmFySW50ID0gZnVuY3Rpb24oKSB7XG4gIHZhciByZXN1bHQgPSAwXG4gIHdoaWxlICghdGhpcy5lb2YoKSkge1xuICAgIHZhciBiID0gdGhpcy5yZWFkVUludDgoKVxuICAgIGlmIChiICYgMHg4MCkge1xuICAgICAgcmVzdWx0ICs9IChiICYgMHg3ZilcbiAgICAgIHJlc3VsdCA8PD0gN1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBiIGlzIGxhc3QgYnl0ZVxuICAgICAgcmV0dXJuIHJlc3VsdCArIGJcbiAgICB9XG4gIH1cbiAgLy8gcHJlbWF0dXJlIGVvZlxuICByZXR1cm4gcmVzdWx0XG59XG5cblBhcnNlci5wcm90b3R5cGUucmVhZENodW5rID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpZCA9IHRoaXMucmVhZFN0cmluZyg0KVxuICB2YXIgbGVuZ3RoID0gdGhpcy5yZWFkVUludDMyKClcbiAgdmFyIGRhdGEgPSB0aGlzLnJlYWRCeXRlcyhsZW5ndGgpXG4gIHJldHVybiB7XG4gICAgaWQ6IGlkLFxuICAgIGxlbmd0aDogbGVuZ3RoLFxuICAgIGRhdGE6IGRhdGFcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHBhcnNlTWlkaVxuIiwiLy8gZGF0YSBzaG91bGQgYmUgdGhlIHNhbWUgdHlwZSBvZiBmb3JtYXQgcmV0dXJuZWQgYnkgcGFyc2VNaWRpXG4vLyBmb3IgbWF4aW11bSBjb21wYXRpYmlsaWx0eSwgcmV0dXJucyBhbiBhcnJheSBvZiBieXRlIHZhbHVlcywgc3VpdGFibGUgZm9yIGNvbnZlcnNpb24gdG8gQnVmZmVyLCBVaW50OEFycmF5LCBldGMuXG5cbi8vIG9wdHM6XG4vLyAtIHJ1bm5pbmcgICAgICAgICAgICAgIHJldXNlIHByZXZpb3VzIGV2ZW50VHlwZUJ5dGUgd2hlbiBwb3NzaWJsZSwgdG8gY29tcHJlc3MgZmlsZVxuLy8gLSB1c2VCeXRlOUZvck5vdGVPZmYgICB1c2UgMHgwOSBmb3Igbm90ZU9mZiB3aGVuIHZlbG9jaXR5IGlzIHplcm9cblxuZnVuY3Rpb24gd3JpdGVNaWRpKGRhdGEsIG9wdHMpIHtcbiAgaWYgKHR5cGVvZiBkYXRhICE9PSAnb2JqZWN0JylcbiAgICB0aHJvdyAnSW52YWxpZCBNSURJIGRhdGEnXG5cbiAgb3B0cyA9IG9wdHMgfHwge31cblxuICB2YXIgaGVhZGVyID0gZGF0YS5oZWFkZXIgfHwge31cbiAgdmFyIHRyYWNrcyA9IGRhdGEudHJhY2tzIHx8IFtdXG4gIHZhciBpLCBsZW4gPSB0cmFja3MubGVuZ3RoXG5cbiAgdmFyIHcgPSBuZXcgV3JpdGVyKClcbiAgd3JpdGVIZWFkZXIodywgaGVhZGVyLCBsZW4pXG5cbiAgZm9yIChpPTA7IGkgPCBsZW47IGkrKykge1xuICAgIHdyaXRlVHJhY2sodywgdHJhY2tzW2ldLCBvcHRzKVxuICB9XG5cbiAgcmV0dXJuIHcuYnVmZmVyXG59XG5cbmZ1bmN0aW9uIHdyaXRlSGVhZGVyKHcsIGhlYWRlciwgbnVtVHJhY2tzKSB7XG4gIHZhciBmb3JtYXQgPSBoZWFkZXIuZm9ybWF0ID09IG51bGwgPyAxIDogaGVhZGVyLmZvcm1hdFxuXG4gIHZhciB0aW1lRGl2aXNpb24gPSAxMjhcbiAgaWYgKGhlYWRlci50aW1lRGl2aXNpb24pIHtcbiAgICB0aW1lRGl2aXNpb24gPSBoZWFkZXIudGltZURpdmlzaW9uXG4gIH0gZWxzZSBpZiAoaGVhZGVyLnRpY2tzUGVyRnJhbWUgJiYgaGVhZGVyLmZyYW1lc1BlclNlY29uZCkge1xuICAgIHRpbWVEaXZpc2lvbiA9ICgtKGhlYWRlci5mcmFtZXNQZXJTZWNvbmQgJiAweEZGKSA8PCA4KSB8IChoZWFkZXIudGlja3NQZXJGcmFtZSAmIDB4RkYpXG4gIH0gZWxzZSBpZiAoaGVhZGVyLnRpY2tzUGVyQmVhdCkge1xuICAgIHRpbWVEaXZpc2lvbiA9IGhlYWRlci50aWNrc1BlckJlYXQgJiAweDdGRkZcbiAgfVxuXG4gIHZhciBoID0gbmV3IFdyaXRlcigpXG4gIGgud3JpdGVVSW50MTYoZm9ybWF0KVxuICBoLndyaXRlVUludDE2KG51bVRyYWNrcylcbiAgaC53cml0ZVVJbnQxNih0aW1lRGl2aXNpb24pXG5cbiAgdy53cml0ZUNodW5rKCdNVGhkJywgaC5idWZmZXIpXG59XG5cbmZ1bmN0aW9uIHdyaXRlVHJhY2sodywgdHJhY2ssIG9wdHMpIHtcbiAgdmFyIHQgPSBuZXcgV3JpdGVyKClcbiAgdmFyIGksIGxlbiA9IHRyYWNrLmxlbmd0aFxuICB2YXIgZXZlbnRUeXBlQnl0ZSA9IG51bGxcbiAgZm9yIChpPTA7IGkgPCBsZW47IGkrKykge1xuICAgIC8vIFJldXNlIGxhc3QgZXZlbnRUeXBlQnl0ZSB3aGVuIG9wdHMucnVubmluZyBpcyBzZXQsIG9yIGV2ZW50LnJ1bm5pbmcgaXMgZXhwbGljaXRseSBzZXQgb24gaXQuXG4gICAgLy8gcGFyc2VNaWRpIHdpbGwgc2V0IGV2ZW50LnJ1bm5pbmcgZm9yIGVhY2ggZXZlbnQsIHNvIHRoYXQgd2UgY2FuIGdldCBhbiBleGFjdCBjb3B5IGJ5IGRlZmF1bHQuXG4gICAgLy8gRXhwbGljaXRseSBzZXQgb3B0cy5ydW5uaW5nIHRvIGZhbHNlLCB0byBvdmVycmlkZSBldmVudC5ydW5uaW5nIGFuZCBuZXZlciByZXVzZSBsYXN0IGV2ZW50VHlwZUJ5dGUuXG4gICAgaWYgKG9wdHMucnVubmluZyA9PT0gZmFsc2UgfHwgIW9wdHMucnVubmluZyAmJiAhdHJhY2tbaV0ucnVubmluZykgZXZlbnRUeXBlQnl0ZSA9IG51bGxcblxuICAgIGV2ZW50VHlwZUJ5dGUgPSB3cml0ZUV2ZW50KHQsIHRyYWNrW2ldLCBldmVudFR5cGVCeXRlLCBvcHRzLnVzZUJ5dGU5Rm9yTm90ZU9mZilcbiAgfVxuICB3LndyaXRlQ2h1bmsoJ01UcmsnLCB0LmJ1ZmZlcilcbn1cblxuZnVuY3Rpb24gd3JpdGVFdmVudCh3LCBldmVudCwgbGFzdEV2ZW50VHlwZUJ5dGUsIHVzZUJ5dGU5Rm9yTm90ZU9mZikge1xuICB2YXIgdHlwZSA9IGV2ZW50LnR5cGVcbiAgdmFyIGRlbHRhVGltZSA9IGV2ZW50LmRlbHRhVGltZVxuICB2YXIgdGV4dCA9IGV2ZW50LnRleHQgfHwgJydcbiAgdmFyIGRhdGEgPSBldmVudC5kYXRhIHx8IFtdXG4gIHZhciBldmVudFR5cGVCeXRlID0gbnVsbFxuICB3LndyaXRlVmFySW50KGRlbHRhVGltZSlcblxuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAvLyBtZXRhIGV2ZW50c1xuICAgIGNhc2UgJ3NlcXVlbmNlTnVtYmVyJzpcbiAgICAgIHcud3JpdGVVSW50OCgweEZGKVxuICAgICAgdy53cml0ZVVJbnQ4KDB4MDApXG4gICAgICB3LndyaXRlVmFySW50KDIpXG4gICAgICB3LndyaXRlVUludDE2KGV2ZW50Lm51bWJlcilcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAndGV4dCc6XG4gICAgICB3LndyaXRlVUludDgoMHhGRilcbiAgICAgIHcud3JpdGVVSW50OCgweDAxKVxuICAgICAgdy53cml0ZVZhckludCh0ZXh0Lmxlbmd0aClcbiAgICAgIHcud3JpdGVTdHJpbmcodGV4dClcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnY29weXJpZ2h0Tm90aWNlJzpcbiAgICAgIHcud3JpdGVVSW50OCgweEZGKVxuICAgICAgdy53cml0ZVVJbnQ4KDB4MDIpXG4gICAgICB3LndyaXRlVmFySW50KHRleHQubGVuZ3RoKVxuICAgICAgdy53cml0ZVN0cmluZyh0ZXh0KVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICd0cmFja05hbWUnOlxuICAgICAgdy53cml0ZVVJbnQ4KDB4RkYpXG4gICAgICB3LndyaXRlVUludDgoMHgwMylcbiAgICAgIHcud3JpdGVWYXJJbnQodGV4dC5sZW5ndGgpXG4gICAgICB3LndyaXRlU3RyaW5nKHRleHQpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ2luc3RydW1lbnROYW1lJzpcbiAgICAgIHcud3JpdGVVSW50OCgweEZGKVxuICAgICAgdy53cml0ZVVJbnQ4KDB4MDQpXG4gICAgICB3LndyaXRlVmFySW50KHRleHQubGVuZ3RoKVxuICAgICAgdy53cml0ZVN0cmluZyh0ZXh0KVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdseXJpY3MnOlxuICAgICAgdy53cml0ZVVJbnQ4KDB4RkYpXG4gICAgICB3LndyaXRlVUludDgoMHgwNSlcbiAgICAgIHcud3JpdGVWYXJJbnQodGV4dC5sZW5ndGgpXG4gICAgICB3LndyaXRlU3RyaW5nKHRleHQpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ21hcmtlcic6XG4gICAgICB3LndyaXRlVUludDgoMHhGRilcbiAgICAgIHcud3JpdGVVSW50OCgweDA2KVxuICAgICAgdy53cml0ZVZhckludCh0ZXh0Lmxlbmd0aClcbiAgICAgIHcud3JpdGVTdHJpbmcodGV4dClcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnY3VlUG9pbnQnOlxuICAgICAgdy53cml0ZVVJbnQ4KDB4RkYpXG4gICAgICB3LndyaXRlVUludDgoMHgwNylcbiAgICAgIHcud3JpdGVWYXJJbnQodGV4dC5sZW5ndGgpXG4gICAgICB3LndyaXRlU3RyaW5nKHRleHQpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ2NoYW5uZWxQcmVmaXgnOlxuICAgICAgdy53cml0ZVVJbnQ4KDB4RkYpXG4gICAgICB3LndyaXRlVUludDgoMHgyMClcbiAgICAgIHcud3JpdGVWYXJJbnQoMSlcbiAgICAgIHcud3JpdGVVSW50OChldmVudC5jaGFubmVsKVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdwb3J0UHJlZml4JzpcbiAgICAgIHcud3JpdGVVSW50OCgweEZGKVxuICAgICAgdy53cml0ZVVJbnQ4KDB4MjEpXG4gICAgICB3LndyaXRlVmFySW50KDEpXG4gICAgICB3LndyaXRlVUludDgoZXZlbnQucG9ydClcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnZW5kT2ZUcmFjayc6XG4gICAgICB3LndyaXRlVUludDgoMHhGRilcbiAgICAgIHcud3JpdGVVSW50OCgweDJGKVxuICAgICAgdy53cml0ZVZhckludCgwKVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdzZXRUZW1wbyc6XG4gICAgICB3LndyaXRlVUludDgoMHhGRilcbiAgICAgIHcud3JpdGVVSW50OCgweDUxKVxuICAgICAgdy53cml0ZVZhckludCgzKVxuICAgICAgdy53cml0ZVVJbnQyNChldmVudC5taWNyb3NlY29uZHNQZXJCZWF0KVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdzbXB0ZU9mZnNldCc6XG4gICAgICB3LndyaXRlVUludDgoMHhGRilcbiAgICAgIHcud3JpdGVVSW50OCgweDU0KVxuICAgICAgdy53cml0ZVZhckludCg1KVxuICAgICAgdmFyIEZSQU1FX1JBVEVTID0geyAyNDogMHgwMCwgMjU6IDB4MjAsIDI5OiAweDQwLCAzMDogMHg2MCB9XG4gICAgICB2YXIgaG91ckJ5dGUgPSAoZXZlbnQuaG91ciAmIDB4MUYpIHwgRlJBTUVfUkFURVNbZXZlbnQuZnJhbWVSYXRlXVxuICAgICAgdy53cml0ZVVJbnQ4KGhvdXJCeXRlKVxuICAgICAgdy53cml0ZVVJbnQ4KGV2ZW50Lm1pbilcbiAgICAgIHcud3JpdGVVSW50OChldmVudC5zZWMpXG4gICAgICB3LndyaXRlVUludDgoZXZlbnQuZnJhbWUpXG4gICAgICB3LndyaXRlVUludDgoZXZlbnQuc3ViRnJhbWUpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ3RpbWVTaWduYXR1cmUnOlxuICAgICAgdy53cml0ZVVJbnQ4KDB4RkYpXG4gICAgICB3LndyaXRlVUludDgoMHg1OClcbiAgICAgIHcud3JpdGVWYXJJbnQoNClcbiAgICAgIHcud3JpdGVVSW50OChldmVudC5udW1lcmF0b3IpXG4gICAgICB2YXIgZGVub21pbmF0b3IgPSBNYXRoLmZsb29yKChNYXRoLmxvZyhldmVudC5kZW5vbWluYXRvcikgLyBNYXRoLkxOMikpICYgMHhGRlxuICAgICAgdy53cml0ZVVJbnQ4KGRlbm9taW5hdG9yKVxuICAgICAgdy53cml0ZVVJbnQ4KGV2ZW50Lm1ldHJvbm9tZSlcbiAgICAgIHcud3JpdGVVSW50OChldmVudC50aGlydHlzZWNvbmRzIHx8IDgpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ2tleVNpZ25hdHVyZSc6XG4gICAgICB3LndyaXRlVUludDgoMHhGRilcbiAgICAgIHcud3JpdGVVSW50OCgweDU5KVxuICAgICAgdy53cml0ZVZhckludCgyKVxuICAgICAgdy53cml0ZUludDgoZXZlbnQua2V5KVxuICAgICAgdy53cml0ZVVJbnQ4KGV2ZW50LnNjYWxlKVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdzZXF1ZW5jZXJTcGVjaWZpYyc6XG4gICAgICB3LndyaXRlVUludDgoMHhGRilcbiAgICAgIHcud3JpdGVVSW50OCgweDdGKVxuICAgICAgdy53cml0ZVZhckludChkYXRhLmxlbmd0aClcbiAgICAgIHcud3JpdGVCeXRlcyhkYXRhKVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICd1bmtub3duTWV0YSc6XG4gICAgICBpZiAoZXZlbnQubWV0YXR5cGVCeXRlICE9IG51bGwpIHtcbiAgICAgICAgdy53cml0ZVVJbnQ4KDB4RkYpXG4gICAgICAgIHcud3JpdGVVSW50OChldmVudC5tZXRhdHlwZUJ5dGUpXG4gICAgICAgIHcud3JpdGVWYXJJbnQoZGF0YS5sZW5ndGgpXG4gICAgICAgIHcud3JpdGVCeXRlcyhkYXRhKVxuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICAvLyBzeXN0ZW0tZXhjbHVzaXZlXG4gICAgY2FzZSAnc3lzRXgnOlxuICAgICAgdy53cml0ZVVJbnQ4KDB4RjApXG4gICAgICB3LndyaXRlVmFySW50KGRhdGEubGVuZ3RoKVxuICAgICAgdy53cml0ZUJ5dGVzKGRhdGEpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ2VuZFN5c0V4JzpcbiAgICAgIHcud3JpdGVVSW50OCgweEY3KVxuICAgICAgdy53cml0ZVZhckludChkYXRhLmxlbmd0aClcbiAgICAgIHcud3JpdGVCeXRlcyhkYXRhKVxuICAgICAgYnJlYWs7XG5cbiAgICAvLyBjaGFubmVsIGV2ZW50c1xuICAgIGNhc2UgJ25vdGVPZmYnOlxuICAgICAgLy8gVXNlIDB4OTAgd2hlbiBvcHRzLnVzZUJ5dGU5Rm9yTm90ZU9mZiBpcyBzZXQgYW5kIHZlbG9jaXR5IGlzIHplcm8sIG9yIHdoZW4gZXZlbnQuYnl0ZTkgaXMgZXhwbGljaXRseSBzZXQgb24gaXQuXG4gICAgICAvLyBwYXJzZU1pZGkgd2lsbCBzZXQgZXZlbnQuYnl0ZTkgZm9yIGVhY2ggZXZlbnQsIHNvIHRoYXQgd2UgY2FuIGdldCBhbiBleGFjdCBjb3B5IGJ5IGRlZmF1bHQuXG4gICAgICAvLyBFeHBsaWNpdGx5IHNldCBvcHRzLnVzZUJ5dGU5Rm9yTm90ZU9mZiB0byBmYWxzZSwgdG8gb3ZlcnJpZGUgZXZlbnQuYnl0ZTkgYW5kIGFsd2F5cyB1c2UgMHg4MCBmb3Igbm90ZU9mZiBldmVudHMuXG4gICAgICB2YXIgbm90ZUJ5dGUgPSAoKHVzZUJ5dGU5Rm9yTm90ZU9mZiAhPT0gZmFsc2UgJiYgZXZlbnQuYnl0ZTkpIHx8ICh1c2VCeXRlOUZvck5vdGVPZmYgJiYgZXZlbnQudmVsb2NpdHkgPT0gMCkpID8gMHg5MCA6IDB4ODBcblxuICAgICAgZXZlbnRUeXBlQnl0ZSA9IG5vdGVCeXRlIHwgZXZlbnQuY2hhbm5lbFxuICAgICAgaWYgKGV2ZW50VHlwZUJ5dGUgIT09IGxhc3RFdmVudFR5cGVCeXRlKSB3LndyaXRlVUludDgoZXZlbnRUeXBlQnl0ZSlcbiAgICAgIHcud3JpdGVVSW50OChldmVudC5ub3RlTnVtYmVyKVxuICAgICAgdy53cml0ZVVJbnQ4KGV2ZW50LnZlbG9jaXR5KVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdub3RlT24nOlxuICAgICAgZXZlbnRUeXBlQnl0ZSA9IDB4OTAgfCBldmVudC5jaGFubmVsXG4gICAgICBpZiAoZXZlbnRUeXBlQnl0ZSAhPT0gbGFzdEV2ZW50VHlwZUJ5dGUpIHcud3JpdGVVSW50OChldmVudFR5cGVCeXRlKVxuICAgICAgdy53cml0ZVVJbnQ4KGV2ZW50Lm5vdGVOdW1iZXIpXG4gICAgICB3LndyaXRlVUludDgoZXZlbnQudmVsb2NpdHkpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ25vdGVBZnRlcnRvdWNoJzpcbiAgICAgIGV2ZW50VHlwZUJ5dGUgPSAweEEwIHwgZXZlbnQuY2hhbm5lbFxuICAgICAgaWYgKGV2ZW50VHlwZUJ5dGUgIT09IGxhc3RFdmVudFR5cGVCeXRlKSB3LndyaXRlVUludDgoZXZlbnRUeXBlQnl0ZSlcbiAgICAgIHcud3JpdGVVSW50OChldmVudC5ub3RlTnVtYmVyKVxuICAgICAgdy53cml0ZVVJbnQ4KGV2ZW50LmFtb3VudClcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnY29udHJvbGxlcic6XG4gICAgICBldmVudFR5cGVCeXRlID0gMHhCMCB8IGV2ZW50LmNoYW5uZWxcbiAgICAgIGlmIChldmVudFR5cGVCeXRlICE9PSBsYXN0RXZlbnRUeXBlQnl0ZSkgdy53cml0ZVVJbnQ4KGV2ZW50VHlwZUJ5dGUpXG4gICAgICB3LndyaXRlVUludDgoZXZlbnQuY29udHJvbGxlclR5cGUpXG4gICAgICB3LndyaXRlVUludDgoZXZlbnQudmFsdWUpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ3Byb2dyYW1DaGFuZ2UnOlxuICAgICAgZXZlbnRUeXBlQnl0ZSA9IDB4QzAgfCBldmVudC5jaGFubmVsXG4gICAgICBpZiAoZXZlbnRUeXBlQnl0ZSAhPT0gbGFzdEV2ZW50VHlwZUJ5dGUpIHcud3JpdGVVSW50OChldmVudFR5cGVCeXRlKVxuICAgICAgdy53cml0ZVVJbnQ4KGV2ZW50LnByb2dyYW1OdW1iZXIpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ2NoYW5uZWxBZnRlcnRvdWNoJzpcbiAgICAgIGV2ZW50VHlwZUJ5dGUgPSAweEQwIHwgZXZlbnQuY2hhbm5lbFxuICAgICAgaWYgKGV2ZW50VHlwZUJ5dGUgIT09IGxhc3RFdmVudFR5cGVCeXRlKSB3LndyaXRlVUludDgoZXZlbnRUeXBlQnl0ZSlcbiAgICAgIHcud3JpdGVVSW50OChldmVudC5hbW91bnQpXG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ3BpdGNoQmVuZCc6XG4gICAgICBldmVudFR5cGVCeXRlID0gMHhFMCB8IGV2ZW50LmNoYW5uZWxcbiAgICAgIGlmIChldmVudFR5cGVCeXRlICE9PSBsYXN0RXZlbnRUeXBlQnl0ZSkgdy53cml0ZVVJbnQ4KGV2ZW50VHlwZUJ5dGUpXG4gICAgICB2YXIgdmFsdWUxNCA9IDB4MjAwMCArIGV2ZW50LnZhbHVlXG4gICAgICB2YXIgbHNiMTQgPSAodmFsdWUxNCAmIDB4N0YpXG4gICAgICB2YXIgbXNiMTQgPSAodmFsdWUxNCA+PiA3KSAmIDB4N0ZcbiAgICAgIHcud3JpdGVVSW50OChsc2IxNClcbiAgICAgIHcud3JpdGVVSW50OChtc2IxNClcbiAgICBicmVhaztcblxuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyAnVW5yZWNvZ25pemVkIGV2ZW50IHR5cGU6ICcgKyB0eXBlXG4gIH1cbiAgcmV0dXJuIGV2ZW50VHlwZUJ5dGVcbn1cblxuXG5mdW5jdGlvbiBXcml0ZXIoKSB7XG4gIHRoaXMuYnVmZmVyID0gW11cbn1cblxuV3JpdGVyLnByb3RvdHlwZS53cml0ZVVJbnQ4ID0gZnVuY3Rpb24odikge1xuICB0aGlzLmJ1ZmZlci5wdXNoKHYgJiAweEZGKVxufVxuV3JpdGVyLnByb3RvdHlwZS53cml0ZUludDggPSBXcml0ZXIucHJvdG90eXBlLndyaXRlVUludDhcblxuV3JpdGVyLnByb3RvdHlwZS53cml0ZVVJbnQxNiA9IGZ1bmN0aW9uKHYpIHtcbiAgdmFyIGIwID0gKHYgPj4gOCkgJiAweEZGLFxuICAgICAgYjEgPSB2ICYgMHhGRlxuXG4gIHRoaXMud3JpdGVVSW50OChiMClcbiAgdGhpcy53cml0ZVVJbnQ4KGIxKVxufVxuV3JpdGVyLnByb3RvdHlwZS53cml0ZUludDE2ID0gV3JpdGVyLnByb3RvdHlwZS53cml0ZVVJbnQxNlxuXG5Xcml0ZXIucHJvdG90eXBlLndyaXRlVUludDI0ID0gZnVuY3Rpb24odikge1xuICB2YXIgYjAgPSAodiA+PiAxNikgJiAweEZGLFxuICAgICAgYjEgPSAodiA+PiA4KSAmIDB4RkYsXG4gICAgICBiMiA9IHYgJiAweEZGXG5cbiAgdGhpcy53cml0ZVVJbnQ4KGIwKVxuICB0aGlzLndyaXRlVUludDgoYjEpXG4gIHRoaXMud3JpdGVVSW50OChiMilcbn1cbldyaXRlci5wcm90b3R5cGUud3JpdGVJbnQyNCA9IFdyaXRlci5wcm90b3R5cGUud3JpdGVVSW50MjRcblxuV3JpdGVyLnByb3RvdHlwZS53cml0ZVVJbnQzMiA9IGZ1bmN0aW9uKHYpIHtcbiAgdmFyIGIwID0gKHYgPj4gMjQpICYgMHhGRixcbiAgICAgIGIxID0gKHYgPj4gMTYpICYgMHhGRixcbiAgICAgIGIyID0gKHYgPj4gOCkgJiAweEZGLFxuICAgICAgYjMgPSB2ICYgMHhGRlxuXG4gIHRoaXMud3JpdGVVSW50OChiMClcbiAgdGhpcy53cml0ZVVJbnQ4KGIxKVxuICB0aGlzLndyaXRlVUludDgoYjIpXG4gIHRoaXMud3JpdGVVSW50OChiMylcbn1cbldyaXRlci5wcm90b3R5cGUud3JpdGVJbnQzMiA9IFdyaXRlci5wcm90b3R5cGUud3JpdGVVSW50MzJcblxuXG5Xcml0ZXIucHJvdG90eXBlLndyaXRlQnl0ZXMgPSBmdW5jdGlvbihhcnIpIHtcbiAgdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5jb25jYXQoQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyLCAwKSlcbn1cblxuV3JpdGVyLnByb3RvdHlwZS53cml0ZVN0cmluZyA9IGZ1bmN0aW9uKHN0cikge1xuICB2YXIgaSwgbGVuID0gc3RyLmxlbmd0aCwgYXJyID0gW11cbiAgZm9yIChpPTA7IGkgPCBsZW47IGkrKykge1xuICAgIGFyci5wdXNoKHN0ci5jb2RlUG9pbnRBdChpKSlcbiAgfVxuICB0aGlzLndyaXRlQnl0ZXMoYXJyKVxufVxuXG5Xcml0ZXIucHJvdG90eXBlLndyaXRlVmFySW50ID0gZnVuY3Rpb24odikge1xuICBpZiAodiA8IDApIHRocm93IFwiQ2Fubm90IHdyaXRlIG5lZ2F0aXZlIHZhcmlhYmxlLWxlbmd0aCBpbnRlZ2VyXCJcblxuICBpZiAodiA8PSAweDdGKSB7XG4gICAgdGhpcy53cml0ZVVJbnQ4KHYpXG4gIH0gZWxzZSB7XG4gICAgdmFyIGkgPSB2XG4gICAgdmFyIGJ5dGVzID0gW11cbiAgICBieXRlcy5wdXNoKGkgJiAweDdGKVxuICAgIGkgPj49IDdcbiAgICB3aGlsZSAoaSkge1xuICAgICAgdmFyIGIgPSBpICYgMHg3RiB8IDB4ODBcbiAgICAgIGJ5dGVzLnB1c2goYilcbiAgICAgIGkgPj49IDdcbiAgICB9XG4gICAgdGhpcy53cml0ZUJ5dGVzKGJ5dGVzLnJldmVyc2UoKSlcbiAgfVxufVxuXG5Xcml0ZXIucHJvdG90eXBlLndyaXRlQ2h1bmsgPSBmdW5jdGlvbihpZCwgZGF0YSkge1xuICB0aGlzLndyaXRlU3RyaW5nKGlkKVxuICB0aGlzLndyaXRlVUludDMyKGRhdGEubGVuZ3RoKVxuICB0aGlzLndyaXRlQnl0ZXMoZGF0YSlcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB3cml0ZU1pZGlcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDUEE7QUFBQTtBQUFBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0RBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2ZBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDL3RCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2hKQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDMUJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0hBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDSEE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2JBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ1hBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDekRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNwR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3pJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ3hMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMxUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMvRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUNqS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDM09BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUMvSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDNU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0FDM0dBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7OztBQ2pWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0EiLCJzb3VyY2VSb290IjoiIn0=