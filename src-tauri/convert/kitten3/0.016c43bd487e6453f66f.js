(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1457:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(230);t.NAMESPACE="AUTOMATEDTESTS",t.ns_id=function(e){return s.namespaced_id(t.NAMESPACE,e)}},1463:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1464);t.AssertType=s.AssertType,t.create=function(){return new a};var a=function(){function e(){this.passed=[],this.failed=[]}return e.prototype.plan=function(e){this.planned=e},e.prototype.fail=function(e){this.failed.push({type:s.AssertType.fail,message:e||"TestBlock[fail]"})},e.prototype.pass=function(e){this.passed.push({type:s.AssertType.pass,message:e||"TestBlock[pass]"})},e.prototype.truthy=function(e,t){var n={type:s.AssertType.truthy,params:{value:e},message:t||""};e?this.passed.push(n):(n.message=t||"TestBlock[truthy] Value is not truthy: "+e,this.failed.push(n))},e.prototype.falsy=function(e,t){var n={type:s.AssertType.falsy,params:{value:e},message:""};e?(n.message=t||"TestBlock[falsy] Value is not falsy: "+e,this.failed.push(n)):this.passed.push(n)},e.prototype.is=function(e,t,n){var a={type:s.AssertType.is,params:{value:e,expected:t},message:n||""};e===t?this.passed.push(a):(a.message=n||"TestBlock[is] Expected ["+t+"] but got ["+e+"]",this.failed.push(a))},e.prototype.not=function(e,t,n){var a={type:s.AssertType.not,params:{value:e,expected:t},message:n||""};e!==t?this.passed.push(a):(a.message=n||"TestBlock[not] Value is the same as: "+e,this.failed.push(a))},e.prototype.get_result=function(){return this.update_planned_result(),this.failed.length>0?{success:!1,message:this.failed.map((function(e){return e.message})).join("\n")}:0!=this.planned&&0===this.passed.length?{success:!1,message:"Test finished with no assertion."}:{success:!0,message:"Passed "+this.passed.length+" assertion"+this.get_plural_by_amt(this.passed.length)+"."}},e.prototype.reset=function(){this.failed=[],this.passed=[],this.planned=void 0},e.prototype.get_plural_by_amt=function(e){return 1===e?"":"s"},e.prototype.update_planned_result=function(){if(void 0!==this.planned){var e=this.failed.length+this.passed.length;this.is(e,this.planned,"Planned for "+this.planned+" assertion"+this.get_plural_by_amt(this.planned)+" but got "+e+".")}},e}()},1464:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.pass=0]="pass",e[e.fail=1]="fail",e[e.truthy=2]="truthy",e[e.falsy=3]="falsy",e[e.is=4]="is",e[e.not=5]="not"}(t.AssertType||(t.AssertType={}))},1465:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1466),a=n(230),i=n(1467),o=n(1457),r=n(1468);function u(e){var t=o.NAMESPACE;e.register_action_type({namespace:t,id:"testaction"}),e.register({namespace:t,id:"pull_event_test",metadata:{restart_when_finished:!0}}),e.register({namespace:t,id:"on_test_action",respond:{to_action:{namespace:t,id:"testaction"},type:a.ResponderType.Action,async:!0,entity_specific:!1}});["controls_if_dropdown","controls_if_dropdown_simple","controls_if_dropdown_promise"].forEach((function(n){e.register({namespace:t,id:n,metadata:{is_if_dropdown:!0}})}))}t.register_blocks=function(e){var t=o.NAMESPACE;for(var n in i.block_config)e.register({namespace:t,id:n,block_config:i.block_config[n],xml:s[n]?s[n]:void 0})},t.register_compile_dependencies=u,t.register_domain_functions=function(e,t){u(e);var n=o.NAMESPACE,s=[],a=r.get_domain_functions(t,(function(){for(var e=0;e<s.length;e++)s[e]()}))();for(var i in a){var l=a[i];e.register({namespace:n,id:i,domain_function:l})}return{subscribe_test_done:function(e){s.push(e)}}}},1466:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s='\n  <value name="message">\n    <shadow type="text">\n      <field name="TEXT"></field>\n    </shadow>\n  </value>\n';t.plan='\n  <value name="n_planned_assertions">\n    <shadow type="math_number">\n      <field name="NUM">1</field>\n    </shadow>\n  </value>\n',t.fail=s,t.pass=s,t.truthy=s,t.falsy=s,t.is=s,t.not=s,t.good_promise='\n  <value name="returns">\n    <shadow type="text">\n      <field name="TEXT">success</field>\n    </shadow>\n  </value>\n  <value name="milliseconds">\n    <shadow type="math_number">\n      <field name="NUM">40</field>\n    </shadow>\n  </value>\n',t.bad_promise=s,t.send_test_action='\n  <value name="parameter_value">\n    <shadow type="text">\n      <field name="TEXT">hello</field>\n    </shadow>\n  </value>\n',t.console_log=s,t.create_entity_instance='\n  <value name="typeclass_id">\n    <shadow type="text">\n      <field name="TEXT">typeclassid</field>\n    </shadow>\n  </value>\n'},1467:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(1457),a={type:"input_value",name:"message",check:"String",align:"CENTRE"};t.block_config={plan:{message0:"Plan %1 assertions",args0:[{type:"input_value",name:"n_planned_assertions",check:"Number",align:"CENTRE"}],previousStatement:null,nextStatement:null,tooltip:"",colour:"#505050",inputsInline:!0},fail:{message0:"Fail (%1)",args0:[a],previousStatement:null,nextStatement:null,tooltip:"",colour:"#661515",inputsInline:!0},pass:{message0:"Pass (%1)",args0:[a],previousStatement:null,nextStatement:null,tooltip:"",colour:"#156615",inputsInline:!0},truthy:{message0:"Is truthy: %1 (%2)",args0:[{type:"input_value",name:"value"},a],previousStatement:null,nextStatement:null,tooltip:"",colour:"#505050",inputsInline:!0},falsy:{message0:"Is falsy: %1 (%2)",args0:[{type:"input_value",name:"value"},a],previousStatement:null,nextStatement:null,tooltip:"",colour:"#505050",inputsInline:!0},is:{message0:"Expect %1 to be %2 (%3)",args0:[{type:"input_value",name:"value"},{type:"input_value",name:"expected"},a],previousStatement:null,nextStatement:null,tooltip:"",colour:"#505050",inputsInline:!0},not:{message0:"Expect %1 to NOT be %2 (%3)",args0:[{type:"input_value",name:"value"},{type:"input_value",name:"expected"},a],previousStatement:null,nextStatement:null,tooltip:"",colour:"#505050",inputsInline:!0},done:{message0:"Test is done",args0:[],previousStatement:null,nextStatement:void 0,tooltip:"",colour:"#505050",inputsInline:!0},bad_promise:{message0:"Promise: Fail with message %1",args0:[a],previousStatement:null,nextStatement:null,tooltip:"",colour:"%{BKY_SENSING_HUE}",inputsInline:!0},good_promise:{message0:"Promise: Return %1 in %2 milliseconds",args0:[{type:"input_value",name:"returns"},{type:"input_value",name:"milliseconds",check:"Number",align:"CENTRE"}],previousStatement:void 0,nextStatement:void 0,tooltip:"",colour:"%{BKY_SENSING_HUE}",output:["String"],inputsInline:!0},call_user_procedure:{message0:"Call user procedure %1 arg one is %2",args0:[{type:"input_value",name:"function_id"},{type:"input_value",name:"argone"}],previousStatement:null,nextStatement:null,tooltip:"",colour:"%{BKY_PROCEDURES_HUE}",inputsInline:!0},send_test_action:{message0:"Send test action with parameter %1",args0:[{type:"input_value",name:"parameter_value"}],previousStatement:null,nextStatement:null,tooltip:"",colour:"%{BKY_EVENTS_HUE}",inputsInline:!0},get_test_action_parameter:{message0:"test action parameter",args0:[],previousStatement:void 0,nextStatement:void 0,tooltip:"",colour:"%{BKY_EVENTS_HUE}",output:["String"],inputsInline:!0},on_test_action:{message0:"On test action %1 %2",args0:[{type:"input_dummy",align:"CENTRE"},{type:"input_statement",name:"DO"}],tooltip:"",colour:"%{BKY_EVENTS_HUE}",inputsInline:!0},create_entity_instance:{message0:"Create entity instance %1",args0:[{type:"input_value",name:"typeclass_id",check:"String",align:"CENTRE"}],previousStatement:null,nextStatement:null,tooltip:"",colour:"#156615",inputsInline:!0},console_log:{message0:"Console log %1",args0:[a],previousStatement:null,nextStatement:null,tooltip:"",colour:"#156615",inputsInline:!0},pull_event_test:{message0:"Pull event test %1 %2",args0:[{type:"input_dummy",align:"CENTRE"},{type:"input_statement",name:"DO"}],colour:"%{BKY_EVENTS_HUE}",inputsInline:!0},throw_error:{message0:"Throw error",args0:[],previousStatement:null,nextStatement:null,tooltip:"",colour:"#661515",inputsInline:!0},set_test_state:{message0:"Send test state %1",args0:[{type:"field_dropdown",name:"state",options:[["true","true"],["false","false"]]}],previousStatement:null,nextStatement:null,tooltip:"",colour:"%{BKY_CONTROL_HUE}",inputsInline:!0},get_test_state:{message0:"Get test state",args0:[],tooltip:"",colour:"%{BKY_CONTROL_HUE}",output:["Boolean"],inputsInline:!0},controls_if_dropdown:{message0:"If %1 %2 %3 else if %4 %5 %6 else %7 %8",args0:[{type:"field_dropdown",name:"IF0",options:[["state_is_true",s.ns_id("test_state_true")],["state_is_false",s.ns_id("test_state_false")]]},{type:"input_dummy",align:"CENTRE"},{type:"input_statement",name:"DO0"},{type:"field_dropdown",name:"IF1",options:[["state_is_not_true",s.ns_id("test_state_false")],["state_is_not_false",s.ns_id("test_state_true")]]},{type:"input_dummy",align:"CENTRE"},{type:"input_statement",name:"DO1"},{type:"input_dummy",align:"CENTRE"},{type:"input_statement",name:"ELSE"}],tooltip:"",previousStatement:null,nextStatement:null,colour:"%{BKY_CONTROL_HUE}",inputsInline:!0},controls_if_dropdown_simple:{message0:"If %1 %2 %3",args0:[{type:"field_dropdown",name:"IF0",options:[["state_is_true",s.ns_id("test_state_true")],["state_is_false",s.ns_id("test_state_false")]]},{type:"input_dummy",align:"CENTRE"},{type:"input_statement",name:"DO0"}],tooltip:"",previousStatement:null,nextStatement:null,colour:"%{BKY_CONTROL_HUE}",inputsInline:!0},controls_if_dropdown_promise:{message0:"If (promise) %1 %2 %3",args0:[{type:"field_dropdown",name:"IF0",options:[["state_is_true",s.ns_id("test_state_true_promise")],["state_is_false",s.ns_id("test_state_false_promise")]]},{type:"input_dummy",align:"CENTRE"},{type:"input_statement",name:"DO0"}],tooltip:"",previousStatement:null,nextStatement:null,colour:"%{BKY_CONTROL_HUE}",inputsInline:!0}}},1468:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(12);function a(e){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){return[2,new Promise((function(t,n){setTimeout((function(){return t()}),e)}))]}))}))}t.get_domain_functions=function(e,t){var n=0,i=!1,o=e,r={plan:function(e,t,n,s){o.plan(e.n_planned_assertions)},fail:function(e,t,n,s){o.fail(e.message)},pass:function(e,t,n,s){o.pass(e.message)},truthy:function(e,t,n,s){o.truthy(e.value,e.message)},falsy:function(e,t,n,s){o.falsy(e.value,e.message)},is:function(e,t,n,s){o.is(e.value,e.expected,e.message)},not:function(e,t,n,s){o.not(e.value,e.expected,e.message)},done:function(e,n,s,a){t()},bad_promise:function(e,t,n,a){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(e){throw a.create_domain_function_error({native_error:new Error("Threw error on purpose."),id:"Annotation: Threw error in bad_promise on purpose.",namespace:"AUTOMATEDTESTS"})}))}))},good_promise:function(e,t,n,a){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(t){return[2,new Promise((function(t,n){setTimeout((function(){return t(e.returns)}),e.milliseconds)}))]}))}))},call_user_procedure:function(e,t,n,s){s.add_user_procedure_call_to_stack(e.function_id,n,{argone:e.argone})},send_test_action:function(e,t,n,s){s.runtime_manager.send_action({id:"testaction",namespace:"AUTOMATEDTESTS",parameters:{test_parameter:e.parameter_value}})},get_test_action_parameter:function(e,t,n,s){return s.get_action_parameter("test_parameter")},create_entity_instance:function(e,t,s,a){var i=e.typeclass_id,o=a.runtime_manager,r="test_createentityinstance_"+n;n+=1;for(var u=o.create_entity_instance(i,r),l=0;l<u.length;l++){var p=u[l];if("error"==p.kind)throw console.error(p),new Error("Error creating entity instance.")}},console_log:function(e,t,n,s){console.log("log: "+e.message)},pull_event_test:function(e,t,n,s){return!0},throw_error:function(e,t,n,s){throw s.create_domain_function_error({native_error:new Error("Threw error on purpose."),id:"Annotation: Threw error in throw_error on purpose.",namespace:"AUTOMATEDTESTS"})},set_test_state:function(e,t,n,s){i="true"===e.state},get_test_state:function(e,t,n,s){return i},test_state_true:function(e,t,n,s){return i},test_state_false:function(e,t,n,s){return!i},test_state_true_promise:function(e,t,n,o){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(e){switch(e.label){case 0:return[4,a(66)];case 1:return e.sent(),[2,i]}}))}))},test_state_false_promise:function(e,t,n,o){return s.__awaiter(this,void 0,void 0,(function(){return s.__generator(this,(function(e){switch(e.label){case 0:return[4,a(66)];case 1:return e.sent(),[2,!i]}}))}))}};return function(){return r}},t.wait=a}}]);